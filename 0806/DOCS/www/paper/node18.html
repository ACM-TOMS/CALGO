
<html><head>
<title>
  Quasi-random numbers
</title>
</head>


<body bgcolor="#ffffff" alink="#CC3300" vlink="#666666"
link="#006666">

 
 <A NAME="tex2html203" HREF="node19.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="./next_motif.gif"></A> <A NAME="tex2html201" HREF="paper.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="http://www.phy.ohiou.edu/../icons//up_motif.gif"></A> <A NAME="tex2html195" HREF="node17.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="http://www.phy.ohiou.edu/../icons//previous_motif.gif"></A>   <BR> 
<B> Next:</B> <A NAME="tex2html204" HREF="node19.html">References</A> 
<B>Up:</B> <A NAME="tex2html202" HREF="paper.html">No Title</A> 
<B> Previous:</B> <A NAME="tex2html196" HREF="node17.html">Parallel Tests</A> 
<BR> <P> 
<H1><A NAME="SECTION00050000000000000000">Quasi-random numbers</A></H1> 
<P> 
It is well known that the error estimate from any MC calculations (or in  
general from a simulation) converges as <IMG WIDTH=46 HEIGHT=16 ALIGN=BOTTOM ALT="tex2html_wrap_inline1619" SRC="img70.gif"> where <I>N</I> is the  
number of random samples or equivalently the computer time expended. 
Recently there has been much research into whether non-random sequences could 
result in faster convergence, but still have the advantages of MC in being 
applicable to high-dimensional problems. 
<P> 
Consider the integral: 
<BR><IMG WIDTH=500 HEIGHT=40 ALIGN=BOTTOM ALT="equation1312" SRC="img71.gif"><BR> 
The Monte Carlo estimate for this integral is: 
<BR><IMG WIDTH=500 HEIGHT=46 ALIGN=BOTTOM ALT="equation1314" SRC="img72.gif"><BR> 
where the points <IMG WIDTH=14 HEIGHT=17 ALIGN=MIDDLE ALT="tex2html_wrap_inline1623" SRC="img73.gif"> are to be uniformly distributed in the 
<I>s</I>-dimensional unit cube.  An important, and very general, result 
that bounds the absolute error of the Monte Carlo estimate is 
the Koksma-Hlwaka inequality&nbsp;[<A HREF="node19.html#N13">25</A>]: 
<BR><A NAME="EQNKH">&#160;</A><IMG WIDTH=500 HEIGHT=21 ALIGN=BOTTOM ALT="equation1316" SRC="img74.gif"><BR> 
where <IMG WIDTH=49 HEIGHT=26 ALIGN=MIDDLE ALT="tex2html_wrap_inline1627" SRC="img75.gif"> is the discrepancy of the points <IMG WIDTH=14 HEIGHT=17 ALIGN=MIDDLE ALT="tex2html_wrap_inline1623" SRC="img73.gif"> as 
defined by Eq.&nbsp;(<A HREF="node18.html#EQNDiscrep"><IMG  ALIGN=BOTTOM ALT="gif" SRC="http://www.phy.ohiou.edu/../icons//cross_ref_motif.gif"></A>), and  
<I>V</I>(<I>f</I>) is the total variation of <I>f</I> on <IMG WIDTH=41 HEIGHT=27 ALIGN=MIDDLE ALT="tex2html_wrap_inline1635" SRC="img76.gif"> in the sense of 
Hardy and Krause&nbsp;[<A HREF="node19.html#Hlwaka">38</A>].   
The total variation is roughly the average absolute value of the <IMG WIDTH=19 HEIGHT=15 ALIGN=BOTTOM ALT="tex2html_wrap_inline1637" SRC="img77.gif"> 
derivative of <I>f</I>(<I>x</I>). 
<P> 
Note that Eq.&nbsp;(<A HREF="node18.html#EQNKH"><IMG  ALIGN=BOTTOM ALT="gif" SRC="http://www.phy.ohiou.edu/../icons//cross_ref_motif.gif"></A>) gives a deterministic 
error bound for integration  because <I>V</I>(<I>f</I>) 
depends only on the nature of the function.  Similarly, 
the discrepancy of a point set is a purely geometric property of that point 
set.  When given a numerical quadrature problem, we must cope with whatever 
function we are given, it is really only the points, <IMG WIDTH=14 HEIGHT=17 ALIGN=MIDDLE ALT="tex2html_wrap_inline1623" SRC="img73.gif">, that we control.   
Thus one approach to efficient integration is to seek 
point sets with small discrepancies.   
Such sets are necessarily not random 
but are instead referred to as <I>quasi-random numbers</I> (QRNs). 
<P> 
The <I>s</I> dimensional discrepancy of the <I>N</I> points, <IMG WIDTH=14 HEIGHT=17 ALIGN=MIDDLE ALT="tex2html_wrap_inline1623" SRC="img73.gif"> 
is defined as: 
<BR><A NAME="EQNDiscrep">&#160;</A><IMG WIDTH=500 HEIGHT=40 ALIGN=BOTTOM ALT="equation1318" SRC="img78.gif"><BR> 
Here <I>B</I> is any rectangular subvolume inside the <I>s</I>-dimensional unit cube 
with sides parallel to the axes and volume <IMG WIDTH=28 HEIGHT=26 ALIGN=MIDDLE ALT="tex2html_wrap_inline1655" SRC="img79.gif">. 
 The function <IMG WIDTH=62 HEIGHT=26 ALIGN=MIDDLE ALT="tex2html_wrap_inline1657" SRC="img80.gif"> counts the number of 
points of <IMG WIDTH=14 HEIGHT=17 ALIGN=MIDDLE ALT="tex2html_wrap_inline1623" SRC="img73.gif"> in <I>B</I>. 
Hence a set of points with a low discrepancy covers the unit cube more uniformly 
than one with a large discrepancy. 
A lattice has a very low discrepancy, however adding additional points to the 
lattice is slow in high dimensions. 
The discrepancy of a lattice does not decrease smoothly with increasing <I>N</I>. 
<P> 
A remarkable fact is that there is a lower (Roth) bound to the 
its discrepancy&nbsp;[<A HREF="node19.html#Roth">39</A>]: 
<BR><A NAME="EQNRoth">&#160;</A><IMG WIDTH=500 HEIGHT=21 ALIGN=BOTTOM ALT="equation1320" SRC="img81.gif"><BR> 
This gives us a target to aim at for the construction of low-discrepancy point 
sets (quasi-random numbers).  For comparison, the estimated error with 
random sequences is: 
<BR><A NAME="EQNPRNbound">&#160;</A><IMG WIDTH=500 HEIGHT=48 ALIGN=BOTTOM ALT="equation1322" SRC="img82.gif"><BR> 
The quantity in brackets, the variance, only depends on <I>f</I>. 
Hence the standard deviation of the Monte Carlo estimate is 
<IMG WIDTH=72 HEIGHT=32 ALIGN=MIDDLE ALT="tex2html_wrap_inline1667" SRC="img83.gif">.  This is much worse than  the bounds  of Eq.&nbsp;(<A HREF="node18.html#EQNRoth"><IMG  ALIGN=BOTTOM ALT="gif" SRC="http://www.phy.ohiou.edu/../icons//cross_ref_motif.gif"></A>) as a function of the 
number of points. 
It is this fact that has 
motivated the search for quasi-random points. 
<P> 
What goes wrong with this argument as far as most high-dimensional 
problems in physical science is that the Koksma-Hlwaka bound is 
extremely poor for large <I>s</I>.  Typical integrands become more and more 
singular the more one differentiates.  The worse case is the 
Metropolis rejection step: the acceptance is itself 
discontinuous. Even assuming <I>V</I>(<I>f</I>) were finite, it is likely to be so 
large (for large <I>s</I>) that truly astronomical values of <I>N</I> would be 
required for the bound in Eq.&nbsp;(<A HREF="node18.html#EQNRoth"><IMG  ALIGN=BOTTOM ALT="gif" SRC="http://www.phy.ohiou.edu/../icons//cross_ref_motif.gif"></A>) to be less than the MC 
convergence rate given in Eq.&nbsp;(<A HREF="node18.html#EQNPRNbound"><IMG  ALIGN=BOTTOM ALT="gif" SRC="http://www.phy.ohiou.edu/../icons//cross_ref_motif.gif"></A>). 
<P> 
We will now present a very brief description of quasi-random 
sequences. Those interested in a much more detailed review of the 
subject are encouraged to consult the recent work of Niederreiter&nbsp;[<A HREF="node19.html#N13">25</A>].  An example of a one-dimensional set of quasi-random 
numbers is the van der Corput sequence.  First we choose a base, <I>b</I>, 
and write an integer <I>n</I> in base <I>b</I> as <IMG WIDTH=114 HEIGHT=37 ALIGN=MIDDLE ALT="tex2html_wrap_inline1683" SRC="img84.gif">.  Then we define the van der Corput sequence as 
<IMG WIDTH=150 HEIGHT=37 ALIGN=MIDDLE ALT="tex2html_wrap_inline1685" SRC="img85.gif">. For base <I>b</I>=3, the first 
12 terms of the van der Corput sequence are:  
<BR><IMG WIDTH=514 HEIGHT=39 ALIGN=BOTTOM ALT="equation1324" SRC="img86.gif"><BR>  
One sees intuitively how this 
sequence, while not behaving in a random fashion, fills in all the 
holes in a regular and low-discrepancy way. 
<P> 
There are many other low-discrepancy point sets and sequences.  Some, like the  
Halton sequence&nbsp;[<A HREF="node19.html#Halton">40</A>] use the van der Corput sequence.  There have 
been many others which are thought to be more general and have provably 
smaller discrepancy.  Of particular note are the explicit constructions of 
Faure&nbsp;[<A HREF="node19.html#Faure">41</A>] and Niederreiter&nbsp;[<A HREF="node19.html#BFN">42</A>]. 
<P> 
The use of quasi-random numbers in quadrature has not been widespread  
because the claims of superiority of quasi-random over pseudo-random 
for quadrature have not been shown empirically especially for high dimensional 
integrals and never in MCMC simulations&nbsp;[<A HREF="node19.html#MC">43</A>].   
 QRNs work best in low dimensional spaces 
where the spacing between the points can be made small with respect to 
the curvature of the integrand. QRNs work well for very smooth integrands. 
The Boltzmann distribution <IMG WIDTH=138 HEIGHT=27 ALIGN=MIDDLE ALT="tex2html_wrap_inline1689" SRC="img87.gif"> is highly peaked for <I>R</I> a  
many dimensional point.  Empirical studies have shown that 
the number of integration points needed for QRN error to be less than the MC 
error increases  very rapidly with the dimensionality. 
Until the asymptotic region is reached, the error of QRN is not very different from 
simple MC. Also there are many MC tricks which can be used to reduce the 
variance such as importance sampling, antithetic sampling and so forth. 
Finally MC has a very robust way of estimating errors; that is one of its 
main advantages as a method. Integrations with QRNs have to rely on  
empirical error estimates since the rigorous upper bound is exceedingly large. 
It may happen that the integrand in some way correlates with the QRN sequence 
so that these error estimates are completely wrong, just as sometimes happens 
with other deterministic integration methods. 
<P> 
There seem to be some 
advantages of quasi-random over pseudo-random for simple smooth integrands 
that are effectively low dimensional (say less than 15 dimensions), 
but they are much smaller 
than one is lead to expect from the mathematical results. 
<P> 
<p>

</body></html>
