
<html><head>
<title>
  Parallel Tests
</title>
</head>


<body bgcolor="#ffffff" alink="#CC3300" vlink="#666666"
link="#006666">

 
 <A NAME="tex2html193" HREF="node18.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="./next_motif.gif"></A> <A NAME="tex2html191" HREF="node16.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="http://www.phy.ohiou.edu/../icons//up_motif.gif"></A> <A NAME="tex2html187" HREF="node16.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="http://www.phy.ohiou.edu/../icons//previous_motif.gif"></A>   <BR> 
<B> Next:</B> <A NAME="tex2html194" HREF="node18.html">Quasi-random numbers</A> 
<B>Up:</B> <A NAME="tex2html192" HREF="node16.html">Testing Random Number Generators</A> 
<B> Previous:</B> <A NAME="tex2html188" HREF="node16.html">Testing Random Number Generators</A> 
<BR> <P> 
<H2><A NAME="SECTION00041000000000000000">Parallel Tests</A></H2> 
<P> 
<A NAME="paralleltests">&#160;</A> 
We now mention some tests of parallel random number generators. 
<P> 
<I>Exponential sums:</I> The exponential sum (Fourier transform of the density) of a sequence <IMG WIDTH=64 HEIGHT=17 ALIGN=MIDDLE ALT="tex2html_wrap_inline1591" SRC="img60.gif"> is: 
<BR><A NAME="expsumeq">&#160;</A><IMG WIDTH=500 HEIGHT=52 ALIGN=BOTTOM ALT="equation1080" SRC="img61.gif"><BR> 
For a random sequence  <IMG WIDTH=105 HEIGHT=32 ALIGN=MIDDLE ALT="tex2html_wrap_inline1593" SRC="img62.gif"> (for <IMG WIDTH=40 HEIGHT=27 ALIGN=MIDDLE ALT="tex2html_wrap_inline1595" SRC="img63.gif">). 
This fact can be used to test correlation within, and 
between, random number sequences&nbsp;[<A HREF="node19.html#MCPR1">13</A>, <A HREF="node19.html#mascagni">16</A>]. Consider two 
random sequences <I>X</I> and <I>Y</I> and define the exponential sum 
cross-correlation: 
<BR><A NAME="expsumcrosseq">&#160;</A><IMG WIDTH=500 HEIGHT=52 ALIGN=BOTTOM ALT="equation1087" SRC="img64.gif"><BR> 
In each term of this sum, we find the difference between an element of 
each sequence at a fixed offset apart. If this difference were 
uniformly distributed, then we should have: <IMG WIDTH=127 HEIGHT=31 ALIGN=MIDDLE ALT="tex2html_wrap_inline1601" SRC="img65.gif"> 
<P> 
<I>Parallel spectral test:</I> Percus and Kalos&nbsp;[<A HREF="node19.html#percuskalos">14</A>] have 
developed a version of the spectral test for parallel linear 
congruential generators. 
<P> 
<I>Interleaved tests:</I> 
We create a new random sequence by interleaving 
several random sequences, and test this new sequence for randomness  
using standard sequential tests. 
<P> 
<I>Fourier transform test:</I> 
Generate a two dimensional array of 
random numbers with each row in the array consisting of consecutive 
random numbers from one particular sequence. The two dimensional 
Fourier transform can be performed. For a truly uncorrelated set of 
sequences the coefficients (except the constant term) should 
be close to 0. 
<P> 
<I>Blocking test:</I> 
In the blocking test we add random 
numbers from several streams as well as from within a stream.  
If the streams are independent, then the 
distribution of these sums will approach the normal distribution. 
<P> 
We now give some test results for the LCG with (parameterized) prime 
addend and a modified version of the LFG.  Both of these 
generators performed acceptably in the sequential tests with <IMG WIDTH=29 HEIGHT=16 ALIGN=BOTTOM ALT="tex2html_wrap_inline1603" SRC="img66.gif"> 
random numbers. Preliminary results from other tests of PPRNG can also 
be found in the paper by Coddington&nbsp;[<A HREF="node19.html#coddington2">37</A>]. 
<P> 
We first tested the generators by interleaving about 1000 pairs of 
 random sequences each containing about <IMG WIDTH=22 HEIGHT=16 ALIGN=BOTTOM ALT="tex2html_wrap_inline1415" SRC="img22.gif"> PRNs.  Both the 
 generators passed this tests.  Next we simulated parallelism on the 
 <IMG WIDTH=54 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline1607" SRC="img67.gif"> Ising model by using a different random sequence for 
 each lattice site in the Metropolis algorithm.  The LCG (with 
 identical seeds) failed badly as can be seen from the dashed line in 
 Fig.&nbsp;<A HREF="node17.html#Emetrolcgpar"><IMG  ALIGN=BOTTOM ALT="gif" SRC="http://www.phy.ohiou.edu/../icons//cross_ref_motif.gif"></A>.  We then generalized the statistical 
 tests, interleaving 256 sequences at a time. The LCG again failed, 
 demonstrating the effectiveness of these tests in detecting 
 non-random behavior. The modified LFG passed these tests. 
<P> 
<P><A NAME="1107">&#160;</A><A NAME="Emetrolcgpar">&#160;</A><IMG WIDTH=474 HEIGHT=375 ALIGN=BOTTOM ALT="figure1102" SRC="img68.gif"><BR> 
<STRONG>Figure:</STRONG> Plot of the actual error versus the internally estimated standard deviation 
of the energy 
error for Ising model simulations with the Metropolis algorithm on a <IMG WIDTH=54 HEIGHT=24 ALIGN=MIDDLE ALT="tex2html_wrap_inline1607" SRC="img67.gif"> lattice with a 
different Linear Congruential sequence at each lattice site. The 
dashed line shows the results when all the Linear Congruential 
sequences were started with the same seeds but with different additive constants.  
The solid line shows the 
results when the sequences were started with different seeds.  
We expect around 95% of the points to be below the dotted 
line (which represents an error of two standard deviations) with a good generator.<BR> 
<P> 
<P> 
In the tests mentioned above, we had started each parameterized LCG 
with the same seed but used different additive constants. Even when we 
discarded the first million random numbers from each sequence, the 
sequences were still correlated. However, when we started the streams 
from different, systematically spaced seeds, the LCG passed all 
statistical tests (including parallel ones) with up to <IMG WIDTH=29 HEIGHT=16 ALIGN=BOTTOM ALT="tex2html_wrap_inline1613" SRC="img69.gif"> - 
<IMG WIDTH=29 HEIGHT=16 ALIGN=BOTTOM ALT="tex2html_wrap_inline1333" SRC="img3.gif"> numbers.  We finally repeated the parallel Metropolis 
algorithm simulation with <IMG WIDTH=29 HEIGHT=16 ALIGN=BOTTOM ALT="tex2html_wrap_inline1603" SRC="img66.gif"> random numbers, and both 
generators performed acceptably, as can be seen from the solid line in 
Fig.&nbsp;<A HREF="node17.html#Emetrolcgpar"><IMG  ALIGN=BOTTOM ALT="gif" SRC="http://www.phy.ohiou.edu/../icons//cross_ref_motif.gif"></A>. 
<P> 
Apart from verifying the quality of two particular generators, our 
results illustrate that it is commonplace for generators to pass some 
test and fail others.  It is important to test parallel 
generators the way they will be seeded, since 
correlations in the seeding can lead to correlations in the resulting 
sequences. 
<P> 
<HR><A NAME="tex2html193" HREF="node18.html"><IMG WIDTH=37 HEIGHT=24 ALIGN=BOTTOM ALT="next" SRC="http://www.phy.ohiou.edu/../icons//next_motif.gif"></A> <A NAME="tex2html191" HREF="node16.html"><IMG WIDTH=26 HEIGHT=24 ALIGN=BOTTOM ALT="up" SRC="http://www.phy.ohiou.edu/../icons//up_motif.gif"></A> <A NAME="tex2html187" HREF="node16.html"><IMG WIDTH=63 HEIGHT=24 ALIGN=BOTTOM ALT="previous" SRC="http://www.phy.ohiou.edu/../icons//previous_motif.gif"></A>   <BR> 
<B> Next:</B> <A NAME="tex2html194" HREF="node18.html">Quasi-random numbers</A> 
<B>Up:</B> <A NAME="tex2html192" HREF="node16.html">Testing Random Number Generators</A> 
<B> Previous:</B> <A NAME="tex2html188" HREF="node16.html">Testing Random Number Generators</A> 
<p>

</body></html>
