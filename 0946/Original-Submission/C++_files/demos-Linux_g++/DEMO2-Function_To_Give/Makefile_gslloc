# Makefile to create a main program that tests RELIADIFF on a laplace Transforms and its Inverse with a locally installed GSL
# Version 1.0


ifneq ($(CC),g++)
CC = g++
endif

ifndef rootdir 
rootdir = ../../
endif

ifndef RELdir
RELdir = $(rootdir)/src
endif

ifndef incdir 
incdir = $(rootdir)
endif

ifndef utildir
utildir = ../utility
endif

ifndef gsllib																							  
gsllib = ../GSL
endif

ifndef gsldirinc
gsldirinc = $(gsllib)/include
endif

ifndef gsldirlib
gsldirlib = $(gsllib)/lib
endif

ifndef CFLAGS
CFLAGS = -Wall -ansi -pedantic -g
endif

ifndef RM
RM = rm -f -r
endif


LIBS = -lm -L$(RELdir) -lreliadiff -L$(utildir) -lutil -L$(gsldirlib) -lgsl -lgslcblas 

OBJ = TEST_FunctionToGive.o 
BIN = test_functiontogive

all: $(BIN) 

relib: 
	@echo
	@echo
	@echo "############################################################################"
	@echo "RELIADIFF DEMO: creating RELIADIFF library"
	@echo "############################################################################"
	@$(MAKE) -C $(RELdir)

util: $(gsldirinc)/gsl relib
	@echo
	@echo
	@echo "############################################################################"
	@echo "RELIADIFF DEMO: creating utility library"
	@echo "############################################################################"
	@$(MAKE) -C $(utildir) 

$(OBJ): TEST_FunctionToGive.c FunctionForTest.c util
	@echo
	@echo
	@echo "#########################################################################################"
	@echo "RELIADIFF DEMO: compiling main program to test RELIADIFF on provided Transform/Inverse..."
	@echo "#########################################################################################"
	@$(CC) $(CFLAGS) -I$(gsldirinc) -I$(incdir) -c TEST_FunctionToGive.c FunctionForTest.c 
	
$(BIN): $(OBJ) 
	@echo
	@echo
	@echo "#########################################################################################"
	@echo "RELIADIFF DEMO: linking main program to test RELIADIFF on provided Transform/Inverse..."
	@echo "#########################################################################################"
	@$(CC) $(CFLAGS) -o $(BIN) $(OBJ) $(LIBS)
	@${RM} $(OBJ) 
	@echo
	@echo
	@echo "############################################################################"
	@echo "############################################################################"
	@echo "############################################################################"
	@echo "############################################################################"
	@echo "Test driver installed!!!"
	@echo "Now you can run the program $(BIN) or a script calling it in this directory."
	@echo "(Consult the RELIADIFF_userguide.pdf file to know about the arguments)"
	@echo "############################################################################"
	@echo "############################################################################"
	@echo "############################################################################"
	@echo "############################################################################"

clean: 
	@echo "RELIADIFF TEST_FunctionToGive: deleting existing executable and output files..."
	@${RM} $(BIN) fz**.txt $(RELdir)/*.a $(utildir)/*.a








	
	
