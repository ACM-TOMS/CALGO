
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>loadData</title><meta name="generator" content="MATLAB 9.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-04-30"><meta name="DC.source" content="loadData.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>loadData</h1><!--introduction--><p>Loads real-world (experimentally measured) data from Institute Fresnel. (A consistent name would be "expData" instead of "loadData").</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Syntax</a></li><li><a href="#2">Description</a></li><li><a href="#3">Example</a></li><li><a href="#4">Input Arguments</a></li><li><a href="#5">Output Arguments</a></li><li><a href="#6">More About</a></li><li><a href="#7">See Also</a></li><li><a href="#8">Code: loadData</a></li><li><a href="#16">Code: Compare methods to compute incField on ROI (some unused tests...)</a></li></ul></div><h2 id="1">Syntax</h2><pre class="language-matlab">seti = loadData(seti)
seti = loadData(seti,dispDepth)
seti = loadData(seti,dispDepth,out)
</pre><h2 id="2">Description</h2><p><tt>seti = loadData(seti)</tt> loads data from the Fresnel database via function <tt>readRAWData</tt> and stores them in structure array <tt>seti</tt>.</p><p><tt>seti = loadData(seti,dispDepth)</tt> does the same but allows to control the displayed messages by <tt>dispDepth</tt>.</p><p><tt>seti = loadData(seti,dispDepth,out)</tt> does the same but transfers the argument <tt>out</tt> for output depth (plot no figure (0), plot figures (1), plot and save figure (2)).</p><h2 id="3">Example</h2><p>Make sure that the database from 1st opus of Institute Fresnel is available as described in <a href="readRAWData.html">readRAWData.html</a>.</p><pre class="language-matlab">init;
seti.expData = <span class="string">'fresnel'</span>;
seti = checkConsisExpData(seti);
seti = loadData(seti);
</pre><h2 id="4">Input Arguments</h2><div><ul><li><tt>seti</tt>      : structure array</li></ul></div><p>The input arguments are the input and output arguments of <tt>checkConsisExpData</tt> in case of <tt>seti.expData = 'fresnel'</tt>, i.e.:</p><div><ul><li><tt>seti.rCD</tt>  : Size of computational domain [-rCD,rCD)^dim                 (default: 0.2 m), see <a href="setGrid.html">setGrid.html</a>.</li><li><tt>seti.nCD</tt>  : Number of discretization points for each dimension of CD                 (default: 256), see <a href="setGrid.html">setGrid.html</a>.</li><li><tt>seti.fresnelFreq</tt>  : Frequency of the Fresnel data set                         (default: 5 GHz = <tt>5*1E9</tt>)</li><li><tt>seti.fresnelFile</tt>  : path to the file with data from Institute Fresnel                         (default: 'inexpdata/fresnel_opus_1/twodielTM_8f.exp').</li></ul></div><div><ul><li><tt>seti.nuMax</tt>    : match incident field using Hankel functions of first kind and orders                     <img src="loadData_eq00607479568482278673.png" alt="$\nu = -\texttt{nuMax}, ..., -1, 0, 1, ...,                     \texttt{nuMax}$"> (default: 7)</li><li><tt>seti.ampCalc</tt>  : method to compute the coefficients c (1, 2 or 3),                     (default: 1), see <a href="matchIncField.html">matchIncField.html</a>.</li></ul></div><div><ul><li><tt>seti.dim = 2</tt>  : The dimension of the problem is 2.</li><li><tt>seti.incType =  'pointSource'</tt> : The type of incident field is set to point sources.</li><li><tt>seti.measType = 'nearField'</tt>   : The measurement type is set to near field data.</li></ul></div><p><b>Optional Input Arguments</b></p><div><ul><li>dispDepth   : depth of displayed messages (number between 0 and 5).</li><li>out         : depth of output: no figure (0), plot figure (1), plot and save figure (2).</li></ul></div><h2 id="5">Output Arguments</h2><p>Most important output arguments, i.e. fields in structure array <tt>seti</tt>.</p><div><ul><li><tt>seti.incNb</tt>      :   number of transmitters (number of incident fields)</li><li><tt>seti.measNb</tt>     :   number of receivers (number of measurements)</li><li><tt>seti.radSrc</tt>     :   radius of circle transmitters are arranged on</li><li><tt>seti.radMeas</tt>    :   radius of circle receivers are arranged on</li></ul></div><div><ul><li><tt>seti.k</tt>          :   wave number (<img src="loadData_eq04436290039412608758.png" alt="$k = 2 \pi f/c$"> with frequency f and light velocity c)</li><li><tt>seti.FmeasDelta</tt> :   scattered field at receivers' positions (i.e. 'the data') for each transmitter                         (uScaRX = uTotRX - uIncRX, i.e. total field minus incident field)                         (complex matrix of size seti.measNb x seti.incNb)</li><li><tt>seti.incField</tt>   :   Incident field in the region of interest (ROI)                         for each transmitter                         (complex matrix of size seti.nROI^seti.dim x seti.incNb)</li></ul></div><h2 id="6">More About</h2><p>This function does the following steps:</p><div><ol><li>Read experimental data from Institute Fresnel.</li><li>Choose data to specific frequency.</li><li>Compute wave number.</li><li>Compute the scattered field <tt>FmeasDelta</tt> at receivers positions.</li><li>Set geometry and simulation to loaded data.</li><li>Compute the incident field <tt>incField</tt> on region of interest (ROI).</li></ol></div><p>Some more comments are in the code.</p><h2 id="7">See Also</h2><div><ul><li><a href="expData.html">expData.html</a></li><li><a href="readRAWData.html">readRAWData.html</a></li><li><a href="setGeomSim.html">setGeomSim.html</a></li><li><a href="matchIncField.html">matchIncField.html</a></li></ul></div><h2 id="8">Code: loadData</h2><pre class="codeinput"><span class="keyword">function</span> seti = loadData(seti,varargin)
</pre><pre class="codeinput"><span class="keyword">if</span> nargin == 2
    dispDepth = varargin{1};
    out = 0;
<span class="keyword">elseif</span> nargin == 3
    dispDepth = varargin{1};
    out = varargin{2};
<span class="keyword">else</span>
    dispDepth = 0;
    out = 0;
<span class="keyword">end</span>
</pre><p><b>Read experimental data from Institute Fresnel</b></p><div><ul><li>uTotRX and uIncRX contain NaN-values, when there are no Fresnel data.</li><li>Used transmitter and receiver position IDs will be marked   with activeTX and activeRX (note that all TX are active, but not all RX at once)</li></ul></div><pre class="codeinput">filename = seti.fresnelFile;    <span class="comment">% filename of the data</span>
frequencyHz = seti.fresnelFreq; <span class="comment">% frequency in Hz</span>
[uTotRX, uIncRX, frequencies, seti.radSrc, seti.incNb, seti.radMeas, seti.measNb] = readRAWData(filename);
<span class="comment">% frequencies : contains all possible frequencies in Hz</span>
</pre><p><b>Choose data to specific frequency</b></p><pre class="codeinput">frequencyId = find(frequencies == frequencyHz);
<span class="keyword">if</span> dispDepth &gt;= 1
    fprintf(<span class="string">'   FrequencyHz = %g\n'</span>,frequencyHz);
    fprintf(<span class="string">'   frequencyId = %g\n'</span>,frequencyId);
<span class="keyword">end</span>

<span class="keyword">if</span> numel(frequencyId) == 0
    frequencyId = numel(frequencies);
    frequencyHz = frequencies(frequencyId);
    <span class="keyword">if</span> dispDepth &gt;= 1
        fprintf(<span class="string">'   Desired frequency not found, using %1.0f GHz instead.\n'</span>, frequencyHz/1E9);
    <span class="keyword">end</span>
<span class="keyword">end</span>
</pre><p><b>Compute wave number</b></p><pre class="codeinput"><span class="comment">%c = physconst('LightSpeed'); % To use 'physconst', you might need: physconst - Phased Array System Toolbox</span>
cLight = 2.99792458E8; <span class="comment">% light velocity in vacuum</span>
seti.k = 2*pi*frequencyHz/cLight;
</pre><p><b>Compute the scattered field <tt>FmeasDelta</tt> at receivers positions</b></p><div><ul><li>Conjugate the fields to adapt from time dependence exp(iwt) to exp(-iwt).</li><li>FmeasDelta = uScaRX = uTotRX - uIncRX</li></ul></div><pre class="codeinput"><span class="comment">% Conjugate the fields to adapt from time dependence exp(iwt) to exp(-iwt).</span>
uTotRX   = conj(uTotRX);
uIncRX   = conj(uIncRX);

uTotRX = uTotRX(:,:,frequencyId);
uIncRX = uIncRX(:,:,frequencyId);

seti.FmeasDelta = uTotRX - uIncRX; <span class="comment">% uScaRX = uTotRX - uIncRX</span>

<span class="comment">% Workaround to deal with undefined measurements:</span>
<span class="comment">% undefined values are set to zero.</span>
seti.FmeasDelta(isnan(seti.FmeasDelta)) = 0;
</pre><p><b>Set geometry and simulation to loaded data</b></p><p>See also <a href="setGeomSim.html">setGeomSim.html</a></p><pre class="codeinput">disp(<span class="string">' - Set geometry and simulation to loaded data'</span>)
seti = setGeomSim(seti,dispDepth,out);
</pre><p><b>Compute the incident field <tt>incField</tt> on region of interest (ROI)</b></p><p>See also <a href="matchIncField.html">matchIncField.html</a>.</p><pre class="codeinput">[uIncROI,errC] = matchIncField(uIncRX,seti,<span class="string">'ROI'</span>);
seti.errC = errC;
seti.incField = 1/seti.dSInc*uIncROI;
<span class="comment">% This works only in case of equidistant transmitters because 1/seti.dSInc.</span>
<span class="comment">% The factor 1/seti.dSInc is important because in mimo.m:</span>
<span class="comment">% SL = dSInc(jj)*seti.incField(:,jj);</span>
</pre><h2 id="16">Code: Compare methods to compute incField on ROI (some unused tests...)</h2><pre class="codeinput"><span class="comment">% incField on CD is to compare</span>
<span class="keyword">if</span> 0

    <span class="keyword">if</span> 0
        [uIncROI,~] = matchIncField(uIncRX,seti,<span class="string">'ROI'</span>);
        incFieldROI = uIncROI;
        incFieldROIAltern = matchIncidentFieldAlternative(uIncRX,seti,<span class="string">'ROI'</span>);
        figure(101); imagesc(real(seti.G(incFieldROI(:,1)))); title(<span class="string">'incField on ROI, inc 1'</span>); colorbar; axis <span class="string">xy</span>;
        figure(102); imagesc(real(seti.G(incFieldROIAltern(:,1)))); title(<span class="string">'incField on ROI, inc 1, alternative'</span>); colorbar; axis <span class="string">xy</span>;
    <span class="keyword">end</span>

    <span class="comment">% different: a small shift and other scale factor...</span>
    <span class="comment">% use grid and nCD to have a better comparison with Sources...</span>

    <span class="comment">% using nCD (only to plot it, not used later)</span>
    [uIncCD,errC] = matchIncField(uIncRX,seti,<span class="string">'CD'</span>);
    seti.incFieldCD = uIncCD;
    <span class="comment">%figure(103); imagesc(real(seti.GCD(incFieldCD(:,1)))); title('real part of incField on CD, inc 1'); colorbar; axis xy;</span>
    <span class="keyword">if</span> 0
        incFieldCDAltern = matchIncidentFieldAlternative(uIncRX,seti,<span class="string">'CD'</span>);
        figure(104); imagesc(real(seti.GCD(incFieldCDAltern(:,1)))); axis <span class="string">xy</span>; title(<span class="string">'real part of incField on CD, inc 1, alternative'</span>); colorbar
        figure(105); imagesc(imag(seti.GCD(incFieldCD(:,1)))); axis <span class="string">xy</span>; title(<span class="string">'imag part of incField on CD, inc 1'</span>); colorbar
        figure(106); imagesc(imag(seti.GCD(incFieldCDAltern(:,1)))); axis <span class="string">xy</span>; title(<span class="string">'imag part of incField on CD, inc 1, alternative'</span>); colorbar
        ifield = incFieldCD(:,1);
        [phi,~] = cart2pol(real(ifield), imag(ifield));
        ifield = incFieldCDAltern(:,1);
        [phiAltern,~] = cart2pol(real(ifield), imag(ifield));
        figure(107); imagesc(seti.GCD(phi)); axis <span class="string">xy</span>; title(<span class="string">'phase of incField on CD, inc 1'</span>); colorbar
        figure(108); imagesc(seti.GCD(phiAltern)); axis <span class="string">xy</span>; title(<span class="string">'phase of incField on CD, inc 1, alternative'</span>); colorbar
    <span class="keyword">end</span>

<span class="keyword">end</span>
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2018b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% loadData
% Loads real-world (experimentally measured) data from Institute Fresnel. 
% (A consistent name would be "expData" instead of "loadData").
%
%% Syntax
%   seti = loadData(seti)
%   seti = loadData(seti,dispDepth)
%   seti = loadData(seti,dispDepth,out)
%
%% Description
% |seti = loadData(seti)| loads data from the Fresnel database via 
% function |readRAWData| and stores them in structure array |seti|.
%
% |seti = loadData(seti,dispDepth)| does the same but allows to control the
% displayed messages by |dispDepth|.
%
% |seti = loadData(seti,dispDepth,out)| does the same but transfers the argument
% |out| for output depth (plot no figure (0), plot figures (1), plot and
% save figure (2)).
%
%% Example
%
% Make sure that the database from 1st opus of Institute Fresnel is available
% as described in <readRAWData.html>.
%
%   init;
%   seti.expData = 'fresnel';
%   seti = checkConsisExpData(seti);
%   seti = loadData(seti);
%
%% Input Arguments
%
% * |seti|      : structure array
%
% The input arguments are the input and output arguments of
% |checkConsisExpData| in case of |seti.expData = 'fresnel'|, i.e.:
%
% * |seti.rCD|  : Size of computational domain [-rCD,rCD)^dim
%                 (default: 0.2 m), see <setGrid.html>.
% * |seti.nCD|  : Number of discretization points for each dimension of CD
%                 (default: 256), see <setGrid.html>.
% * |seti.fresnelFreq|  : Frequency of the Fresnel data set
%                         (default: 5 GHz = |5*1E9|)
% * |seti.fresnelFile|  : path to the file with data from Institute Fresnel
%                         (default: 'inexpdata/fresnel_opus_1/twodielTM_8f.exp').
%
% * |seti.nuMax|    : match incident field using Hankel functions of first kind and orders
%                     $\nu = -\texttt{nuMax}, ..., -1, 0, 1, ...,
%                     \texttt{nuMax}$ (default: 7)
% * |seti.ampCalc|  : method to compute the coefficients c (1, 2 or 3),
%                     (default: 1), see <matchIncField.html>.
%
% * |seti.dim = 2|  : The dimension of the problem is 2.
% * |seti.incType =  'pointSource'| : The type of incident field is set to point sources.
% * |seti.measType = 'nearField'|   : The measurement type is set to near field data.
%
% *Optional Input Arguments*
%
% * dispDepth   : depth of displayed messages (number between 0 and 5).
% * out         : depth of output: no figure (0), plot figure (1), plot and save figure (2).
%
%% Output Arguments
% Most important output arguments, i.e. fields in structure array |seti|.
%
% * |seti.incNb|      :   number of transmitters (number of incident fields)
% * |seti.measNb|     :   number of receivers (number of measurements)
% * |seti.radSrc|     :   radius of circle transmitters are arranged on
% * |seti.radMeas|    :   radius of circle receivers are arranged on
%
% * |seti.k|          :   wave number ($k = 2 \pi f/c$ with frequency f and light velocity c)
% * |seti.FmeasDelta| :   scattered field at receivers' positions (i.e. 'the data') for each transmitter
%                         (uScaRX = uTotRX - uIncRX, i.e. total field minus incident field)
%                         (complex matrix of size seti.measNb x seti.incNb)
% * |seti.incField|   :   Incident field in the region of interest (ROI)
%                         for each transmitter
%                         (complex matrix of size seti.nROI^seti.dim x seti.incNb)
%
%% More About
% This function does the following steps:
%
% # Read experimental data from Institute Fresnel.
% # Choose data to specific frequency.
% # Compute wave number.
% # Compute the scattered field |FmeasDelta| at receivers positions.
% # Set geometry and simulation to loaded data.
% # Compute the incident field |incField| on region of interest (ROI).
%
% Some more comments are in the code.
%
%% See Also
% * <expData.html>
% * <readRAWData.html>
% * <setGeomSim.html>
% * <matchIncField.html>

%% Code: loadData
function seti = loadData(seti,varargin)

if nargin == 2
    dispDepth = varargin{1};
    out = 0;
elseif nargin == 3
    dispDepth = varargin{1};
    out = varargin{2};
else
    dispDepth = 0;
    out = 0;
end

%%
% *Read experimental data from Institute Fresnel*
%
% * uTotRX and uIncRX contain NaN-values, when there are no Fresnel data.
% * Used transmitter and receiver position IDs will be marked
%   with activeTX and activeRX (note that all TX are active, but not all RX at once)

filename = seti.fresnelFile;    % filename of the data
frequencyHz = seti.fresnelFreq; % frequency in Hz
[uTotRX, uIncRX, frequencies, seti.radSrc, seti.incNb, seti.radMeas, seti.measNb] = readRAWData(filename);
% frequencies : contains all possible frequencies in Hz

%%
% *Choose data to specific frequency*
frequencyId = find(frequencies == frequencyHz);
if dispDepth >= 1
    fprintf('   FrequencyHz = %g\n',frequencyHz);
    fprintf('   frequencyId = %g\n',frequencyId);
end

if numel(frequencyId) == 0
    frequencyId = numel(frequencies);
    frequencyHz = frequencies(frequencyId);
    if dispDepth >= 1
        fprintf('   Desired frequency not found, using %1.0f GHz instead.\n', frequencyHz/1E9);
    end
end

%%
% *Compute wave number*

%c = physconst('LightSpeed'); % To use 'physconst', you might need: physconst - Phased Array System Toolbox
cLight = 2.99792458E8; % light velocity in vacuum
seti.k = 2*pi*frequencyHz/cLight;

%%
% *Compute the scattered field |FmeasDelta| at receivers positions*
%
% * Conjugate the fields to adapt from time dependence exp(iwt) to exp(-iwt).
% * FmeasDelta = uScaRX = uTotRX - uIncRX

% Conjugate the fields to adapt from time dependence exp(iwt) to exp(-iwt).
uTotRX   = conj(uTotRX);
uIncRX   = conj(uIncRX);

uTotRX = uTotRX(:,:,frequencyId);
uIncRX = uIncRX(:,:,frequencyId);

seti.FmeasDelta = uTotRX - uIncRX; % uScaRX = uTotRX - uIncRX

% Workaround to deal with undefined measurements:
% undefined values are set to zero.
seti.FmeasDelta(isnan(seti.FmeasDelta)) = 0;

%%
% *Set geometry and simulation to loaded data*
%
% See also <setGeomSim.html>

disp(' - Set geometry and simulation to loaded data')
seti = setGeomSim(seti,dispDepth,out);

%%
% *Compute the incident field |incField| on region of interest (ROI)*
%
% See also <matchIncField.html>.
%
[uIncROI,errC] = matchIncField(uIncRX,seti,'ROI');
seti.errC = errC;
seti.incField = 1/seti.dSInc*uIncROI;
% This works only in case of equidistant transmitters because 1/seti.dSInc.
% The factor 1/seti.dSInc is important because in mimo.m:
% SL = dSInc(jj)*seti.incField(:,jj);


%% Code: Compare methods to compute incField on ROI (some unused tests...)

% incField on CD is to compare
if 0

    if 0
        [uIncROI,~] = matchIncField(uIncRX,seti,'ROI');
        incFieldROI = uIncROI;
        incFieldROIAltern = matchIncidentFieldAlternative(uIncRX,seti,'ROI');
        figure(101); imagesc(real(seti.G(incFieldROI(:,1)))); title('incField on ROI, inc 1'); colorbar; axis xy;
        figure(102); imagesc(real(seti.G(incFieldROIAltern(:,1)))); title('incField on ROI, inc 1, alternative'); colorbar; axis xy;
    end
    
    % different: a small shift and other scale factor...
    % use grid and nCD to have a better comparison with Sources...

    % using nCD (only to plot it, not used later)
    [uIncCD,errC] = matchIncField(uIncRX,seti,'CD');
    seti.incFieldCD = uIncCD;
    %figure(103); imagesc(real(seti.GCD(incFieldCD(:,1)))); title('real part of incField on CD, inc 1'); colorbar; axis xy;
    if 0
        incFieldCDAltern = matchIncidentFieldAlternative(uIncRX,seti,'CD');
        figure(104); imagesc(real(seti.GCD(incFieldCDAltern(:,1)))); axis xy; title('real part of incField on CD, inc 1, alternative'); colorbar
        figure(105); imagesc(imag(seti.GCD(incFieldCD(:,1)))); axis xy; title('imag part of incField on CD, inc 1'); colorbar
        figure(106); imagesc(imag(seti.GCD(incFieldCDAltern(:,1)))); axis xy; title('imag part of incField on CD, inc 1, alternative'); colorbar
        ifield = incFieldCD(:,1);
        [phi,~] = cart2pol(real(ifield), imag(ifield));
        ifield = incFieldCDAltern(:,1);
        [phiAltern,~] = cart2pol(real(ifield), imag(ifield));
        figure(107); imagesc(seti.GCD(phi)); axis xy; title('phase of incField on CD, inc 1'); colorbar
        figure(108); imagesc(seti.GCD(phiAltern)); axis xy; title('phase of incField on CD, inc 1, alternative'); colorbar
    end

end

end

##### SOURCE END #####
--></body></html>