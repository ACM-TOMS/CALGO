
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>plotAndSaveFigures</title><meta name="generator" content="MATLAB 9.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-04-30"><meta name="DC.source" content="plotAndSaveFigures.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>plotAndSaveFigures</h1><!--introduction--><p>Plot and save figures of reconstruction.</p><p>Reserved numbers: 11-20. Used numbers 11-16, see <a href="start.html">start.html</a>.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Syntax</a></li><li><a href="#2">Description</a></li><li><a href="#3">Input Arguments</a></li><li><a href="#4">Output Arguments</a></li><li><a href="#5">See Also</a></li><li><a href="#6">Code</a></li></ul></div><h2 id="1">Syntax</h2><pre class="language-matlab">plotAndSaveFigures(seti,qROIexact,qROIcomp,iOut,out)
</pre><h2 id="2">Description</h2><p><tt>plotAndSaveFigures(seti,qROIexact,qROIcomp,iOut,out)</tt> plots and saves figures of outer iteration <tt>iOut</tt> in dependence of <tt>out</tt>.</p><p>In case of 3D sectional planes through the contrast are plotted to. The sectional plane is prepared in the subfunction <tt>plot3Dsec</tt>.</p><h2 id="3">Input Arguments</h2><div><ul><li>seti      : structural array</li><li>qROIexact : predefined (i.e. exact) contrast</li><li>qROIcomp  : reconstructed (i.e. computed) contrast</li><li>iOut      : number of outer iteration</li><li>out       : Output depth: generate no plots (0),               generate plots (1), generate plots and save them (2).</li></ul></div><p>Specific fields in <tt>seti</tt> influencing the figures are described in <a href="setGeomSim.html">setGeomSim.html</a> in the section "Subfunction: setFigureSettings".</p><p>The most important fields for this function in <tt>seti</tt> are:</p><div><ul><li>seti.dis : relative discrepancies</li><li>seti.err : relative errors</li><li>seti.MTv : result of Tikhonov funtional</li><li>seti.M1v : result of first part of Tikhonov functional</li><li>seti.M2v : result of second part of Tikhonov functional</li></ul></div><p>Further details of this fields are described in <a href="recon.html">recon.html</a>.</p><h2 id="4">Output Arguments</h2><p>Plots, see <a href="start.html">start.html</a>.</p><p>Note that figure 11 is plotted in <a href="subplots.html">subplots.html</a>, but saved in this file.</p><h2 id="5">See Also</h2><div><ul><li><a href="start.html">start.html</a></li><li><a href="savePngFig.html">savePngFig.html</a></li><li><a href="setGeomSim.html">setGeomSim.html</a></li><li><a href="recon.html">recon.html</a></li><li><a href="subplots.html">subplots.html</a></li><li><a href="plot2DstylePublish.html">plot2DstylePublish.html</a></li><li><a href="plot3DstylePublish.html">plot3DstylePublish.html</a></li><li><a href="litman.html">litman.html</a></li></ul></div><h2 id="6">Code</h2><pre class="codeinput"><span class="keyword">function</span> plotAndSaveFigures(seti,qROIexact,qROIcomp,iOut,out)
</pre><pre class="codeinput"><span class="comment">% qROIexact is seti.qROIexact.</span>
<span class="comment">% Note that this function will be used with source problem too</span>
<span class="comment">% (source problem is not available in public version).</span>
</pre><p><b>iOut &gt; iOutIni: figure 11 (save subplots)</b></p><pre class="codeinput"><span class="keyword">if</span> out == 2 &amp;&amp; iOut &gt; seti.iOutIni <span class="comment">% iOut = iOutIni shows only the true contrast</span>

    <span class="comment">% figure 11: subplots (save)</span>
    savePngFig(11,iOut,seti); <span class="comment">% figure 11: subplots (was already plotted but not saved)</span>
<span class="keyword">end</span>
</pre><p><b>iOut &gt; iOutIni: figure 12-16</b></p><pre class="codeinput"><span class="keyword">if</span> out &gt;= 1 &amp;&amp; iOut &gt; seti.iOutIni
</pre><p><b>figure 12: discrepancy and error (as in subplot)</b></p><pre class="codeinput">    figure(12);
    set(gcf,<span class="string">'Visible'</span>,seti.plotVisible);
    hplot = plot((0:iOut), [seti.disIni seti.dis(1:iOut)], <span class="string">'b-'</span>, (0:iOut), [seti.errIni seti.err(1:iOut)], <span class="string">'r:'</span>);
    <span class="keyword">if</span> seti.plotPublish
        set(gca,<span class="string">'FontSize'</span>,seti.pubFontSize)
        lw = 2;
        set(hplot(1),<span class="string">'LineWidth'</span>,lw);
        set(hplot(2),<span class="string">'LineWidth'</span>,lw);
    <span class="keyword">else</span>
        legend(<span class="string">'discrepancy'</span>,<span class="string">'error'</span>);
        title(<span class="string">'Discrepancy and error'</span>);
    <span class="keyword">end</span>
    axis <span class="string">square</span>;
    <span class="keyword">if</span> out == 2
        savePngFig(12,iOut,seti);
    <span class="keyword">end</span>
</pre><p><b>figure 13: Tikhonov functional (as in subplots)</b></p><pre class="codeinput">    figure(13);
    set(gcf,<span class="string">'Visible'</span>,seti.plotVisible);
    x = 1:iOut;
    <span class="keyword">if</span> length(x) == 1
        [ax,h1,h2] = plotyy(x',seti.M1v(x)',x',seti.M2v(x));
    <span class="keyword">else</span>
        [ax,h1,h2] = plotyy(x',seti.M1v(x)',[x',x'],[seti.M2v(x)',seti.MTv(x)']);
    <span class="keyword">end</span>
    <span class="keyword">if</span> seti.plotPublish
        set(gca,<span class="string">'FontSize'</span>,seti.pubFontSize)
        lw = 2;
        set(hplot(1),<span class="string">'LineWidth'</span>,lw);
        set(hplot(2),<span class="string">'LineWidth'</span>,lw);
    <span class="keyword">else</span>
        <span class="keyword">if</span> length(x) == 1
            legend([h1;h2],<span class="string">'M1 (left axis)'</span>,<span class="string">'M2 (right axis)'</span>);
        <span class="keyword">else</span>
            legend([h1;h2],<span class="string">'M1 (left ax.)'</span>,<span class="string">'M2 (right ax.)'</span>,<span class="string">'MT = M1 + M2 (right ax.)'</span>);
        <span class="keyword">end</span>
        title(<span class="string">'Min. Tikhonov funct. MT'</span>);
        xlabel(<span class="string">'outer iterations iOut'</span>)
    <span class="keyword">end</span>
    axis(ax,<span class="string">'square'</span>);
    <span class="keyword">if</span> out == 2
        savePngFig(13,iOut,seti);
    <span class="keyword">end</span>
</pre><p><b>figure 14: reconstructed contrast (real part)</b></p><pre class="codeinput">    figure(14);
    set(gcf,<span class="string">'Visible'</span>,seti.plotVisible);
    <span class="keyword">if</span> seti.dim == 2
        <span class="comment">%imagesc(seti.G(real(qROIcomp))); colormap(cmapPrint); colorbar; % alternative colormap</span>
        imagesc(seti.G(real(qROIcomp))); colormap(litman); colorbar;
        axis <span class="string">xy</span>;
        <span class="keyword">if</span> seti.usecbarlim
            caxis(seti.cbarlim);
        <span class="keyword">end</span>
    <span class="keyword">elseif</span> seti.dim == 3
        <span class="comment">% isosurface(seti.G(real(qROIPrev))); colormap(litman); caxis([-1,3]); colorbar;</span>
        <span class="comment">% title('real part of reconstructed contrast (isosurface plot)');</span>
        contourPlotROI(qROIcomp, seti, <span class="string">'real'</span>);
    <span class="keyword">end</span>
    <span class="keyword">if</span> seti.plotPublish
        <span class="keyword">if</span> seti.dim == 2
            plot2DstylePublish;
        <span class="keyword">elseif</span> seti.dim == 3
            plot3DstylePublish;
        <span class="keyword">end</span>
    <span class="keyword">else</span>
        title(<span class="string">'reconstructed contrast (real part)'</span>);
    <span class="keyword">end</span>
    axis <span class="string">square</span>;
    <span class="keyword">if</span> out == 2
        savePngFig(14,iOut,seti);
    <span class="keyword">end</span>
    close(14);
    <span class="comment">% It is important to close this figure</span>
    <span class="comment">% because otherwise the projection in 3D is a problem.</span>
</pre><p><b>figure 15: reconstructed contrast (imag part)</b></p><pre class="codeinput">    figure(15);
    set(gcf,<span class="string">'Visible'</span>,seti.plotVisible);
    <span class="keyword">if</span> seti.dim == 2
        imagesc(seti.G(imag(qROIcomp))); colormap(litman); colorbar;
        axis <span class="string">xy</span>;
    <span class="keyword">elseif</span> seti.dim == 3
        contourPlotROI(qROIcomp, seti, <span class="string">'imag'</span>);
    <span class="keyword">end</span>
    <span class="keyword">if</span> seti.usecbarlim
        caxis(seti.cbarlim);
    <span class="keyword">end</span>
    <span class="keyword">if</span> seti.plotPublish
        <span class="keyword">if</span> seti.dim == 2
            plot2DstylePublish;
        <span class="keyword">elseif</span> seti.dim == 3
            plot3DstylePublish;
        <span class="keyword">end</span>
    <span class="keyword">else</span>
        title(<span class="string">'reconstructed contrast (imag part)'</span>);
    <span class="keyword">end</span>
    axis <span class="string">square</span>;
    <span class="keyword">if</span> out == 2
        savePngFig(15,iOut,seti);
    <span class="keyword">end</span>
    close(15);
    <span class="comment">% It is important to close this figure</span>
    <span class="comment">% because otherwise the projection in 3D is a problem.</span>
</pre><p><b>figure 16: difference of reconstructed and true contrast (abs)</b></p><pre class="codeinput"><span class="keyword">if</span> 0
    figure(16);
    set(gcf,<span class="string">'Visible'</span>,seti.plotVisible);
    img = seti.G(abs(qROIprev-qROIexact));
    <span class="keyword">if</span> seti.dim == 3
        <span class="comment">% Display only a slice of the data:</span>
        N2 = ceil((seti.nROI-1)/2);
        img = img(:,:,N2);
    <span class="keyword">end</span>
    imagesc(img); colormap(litman); colorbar;
    axis <span class="string">xy</span>;
    <span class="keyword">if</span> seti.usecbarlim
        caxis(seti.cbarlim);
    <span class="keyword">end</span>
    <span class="keyword">if</span> seti.plotPublish
        plot2DstylePublish;
    <span class="keyword">else</span>
        title(<span class="string">'difference of reconstructed and true contrast (abs)'</span>);
    <span class="keyword">end</span>
    axis <span class="string">square</span>;
    <span class="keyword">if</span> out == 2
        savePngFig(16,iOut,seti);
    <span class="keyword">end</span>
<span class="keyword">end</span>
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><p><b>figures 21-30 reserved for 3D reconstruction</b></p><div><ul><li>figure 21-26</li><li>21-23: predefined contrast (real part) (3D sections)</li><li>24-26: reconstructed contrast (real part) (3D sections)</li></ul></div><pre class="codeinput"><span class="keyword">if</span> out &gt;= 1 &amp;&amp; seti.dim == 3 &amp;&amp; <span class="keyword">...</span>
   (strcmp(<span class="string">'corner3D'</span>,seti.contrast) || strcmp(<span class="string">'twoTripods3D'</span>,seti.contrast) ||<span class="keyword">...</span>
    strcmp(<span class="string">'twoTripodsRealImag3D'</span>,seti.contrast) || strcmp(<span class="string">'cubeLike3D'</span>,seti.contrast) ||<span class="keyword">...</span>
    strcmp(<span class="string">'cross3D'</span>,seti.contrast))
    <span class="keyword">switch</span> seti.contrast
        <span class="keyword">case</span> {<span class="string">'corner3D'</span>, <span class="string">'twoTripods3D'</span>, <span class="string">'twoTripodsRealImag3D'</span>, <span class="string">'cubeLike3D'</span>}
            seca = -(1-3.5/8);
            <span class="comment">%secn = 2; % most interesting</span>
        <span class="keyword">case</span> <span class="string">'cross3D'</span>
            seca = 0;
            <span class="comment">%secn = 2; % 1, 2 or 3... in coordinate system</span>
    <span class="keyword">end</span>
    <span class="keyword">if</span> iOut == 0
        plot3Dsec(qROIexact,<span class="string">'predefined'</span>,seca,1,seti,iOut,out,21);
        plot3Dsec(qROIexact,<span class="string">'predefined'</span>,seca,2,seti,iOut,out,22);
        plot3Dsec(qROIexact,<span class="string">'predefined'</span>,seca,3,seti,iOut,out,23);
    <span class="keyword">else</span>
        plot3Dsec(qROIcomp,<span class="string">'reconstructed'</span>,seca,1,seti,iOut,out,24);
        plot3Dsec(qROIcomp,<span class="string">'reconstructed'</span>,seca,2,seti,iOut,out,25);
        plot3Dsec(qROIcomp,<span class="string">'reconstructed'</span>,seca,3,seti,iOut,out,26);
    <span class="keyword">end</span>
<span class="keyword">end</span>
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><p><b>Code: subfunction: plot3Dsec</b></p><p>plot sectional plane in case of 3D</p><pre class="codeinput"><span class="keyword">function</span> plot3Dsec(qROI,contrastKind,seca,secn,seti,iOut,out,figno)
<span class="comment">% qROI: seti.qROIexact (exact/predefined) OR qROIprev (reconstructed)</span>
<span class="comment">% contrastKind: in title of plot, i.e. predefined or reconstructed</span>
R = seti.rCD/2;
ind = floor((seca*R+R)/(2*R)*seti.nROI);
A = seti.G(qROI);

<span class="keyword">switch</span> secn
    <span class="keyword">case</span> 1
        B = A(ind,:,:);
    <span class="keyword">case</span> 2
        B = A(:,ind,:);
    <span class="keyword">case</span> 3
        B = A(:,:,ind);
    <span class="keyword">otherwise</span>
        error(<span class="string">'n must be 1, 2 or 3.'</span>);
<span class="keyword">end</span>
B = squeeze(real(B));
B = transpose(B);

figure(figno);
set(gcf,<span class="string">'Visible'</span>,seti.plotVisible);
imagesc(B); colormap(litman); colorbar;
axis <span class="string">xy</span>;
<span class="keyword">if</span> seti.usecbarlim
    caxis(seti.cbarlim);
<span class="keyword">end</span>
<span class="keyword">if</span> seti.plotPublish
    plot2DstylePublish;
<span class="keyword">else</span>
    titles = sprintf(<span class="string">'%s contrast (real part), X%d'</span>,contrastKind,secn);
    title(titles);
<span class="keyword">end</span>
axis <span class="string">square</span>;
<span class="keyword">if</span> out == 2
    savePngFig(figno,iOut,seti);
<span class="keyword">end</span>
<span class="keyword">end</span>
</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2018b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% plotAndSaveFigures
% Plot and save figures of reconstruction.
%
% Reserved numbers: 11-20. Used numbers 11-16, see <start.html>.
%
%% Syntax
%
%   plotAndSaveFigures(seti,qROIexact,qROIcomp,iOut,out)
%
%% Description
% |plotAndSaveFigures(seti,qROIexact,qROIcomp,iOut,out)| plots and saves
% figures of outer iteration |iOut| in dependence of |out|.
%
% In case of 3D sectional planes through the contrast are plotted to. The
% sectional plane is prepared in the subfunction |plot3Dsec|.
%
%% Input Arguments
%
% * seti      : structural array
% * qROIexact : predefined (i.e. exact) contrast
% * qROIcomp  : reconstructed (i.e. computed) contrast
% * iOut      : number of outer iteration
% * out       : Output depth: generate no plots (0),
%               generate plots (1), generate plots and save them (2).
%
% Specific fields in |seti| influencing the figures are described in 
% <setGeomSim.html> in the section "Subfunction: setFigureSettings".
%
% The most important fields for this function in |seti| are:
%
% * seti.dis : relative discrepancies
% * seti.err : relative errors
% * seti.MTv : result of Tikhonov funtional
% * seti.M1v : result of first part of Tikhonov functional
% * seti.M2v : result of second part of Tikhonov functional
%
% Further details of this fields are described in <recon.html>.
%
%% Output Arguments
%
% Plots, see <start.html>.
%
% Note that figure 11 is plotted in <subplots.html>, but saved in this
% file.
%
%
%% See Also
%
% * <start.html>
% * <savePngFig.html>
% * <setGeomSim.html>
% * <recon.html>
% * <subplots.html>
% * <plot2DstylePublish.html>
% * <plot3DstylePublish.html>
% * <litman.html>
%
%% Code
%
function plotAndSaveFigures(seti,qROIexact,qROIcomp,iOut,out)
% qROIexact is seti.qROIexact.
% Note that this function will be used with source problem too
% (source problem is not available in public version).

%%
% *iOut > iOutIni: figure 11 (save subplots)*

if out == 2 && iOut > seti.iOutIni % iOut = iOutIni shows only the true contrast
    
    % figure 11: subplots (save)
    savePngFig(11,iOut,seti); % figure 11: subplots (was already plotted but not saved)
end

%%
% *iOut > iOutIni: figure 12-16*

if out >= 1 && iOut > seti.iOutIni

%%
% *figure 12: discrepancy and error (as in subplot)*

    figure(12);
    set(gcf,'Visible',seti.plotVisible);
    hplot = plot((0:iOut), [seti.disIni seti.dis(1:iOut)], 'b-', (0:iOut), [seti.errIni seti.err(1:iOut)], 'r:');
    if seti.plotPublish
        set(gca,'FontSize',seti.pubFontSize)
        lw = 2;
        set(hplot(1),'LineWidth',lw);
        set(hplot(2),'LineWidth',lw);
    else
        legend('discrepancy','error');
        title('Discrepancy and error');
    end
    axis square;
    if out == 2
        savePngFig(12,iOut,seti);
    end

%%
% *figure 13: Tikhonov functional (as in subplots)*

    figure(13);
    set(gcf,'Visible',seti.plotVisible);
    x = 1:iOut;
    if length(x) == 1
        [ax,h1,h2] = plotyy(x',seti.M1v(x)',x',seti.M2v(x));
    else
        [ax,h1,h2] = plotyy(x',seti.M1v(x)',[x',x'],[seti.M2v(x)',seti.MTv(x)']);
    end
    if seti.plotPublish
        set(gca,'FontSize',seti.pubFontSize)
        lw = 2;
        set(hplot(1),'LineWidth',lw);
        set(hplot(2),'LineWidth',lw);
    else
        if length(x) == 1
            legend([h1;h2],'M1 (left axis)','M2 (right axis)');
        else
            legend([h1;h2],'M1 (left ax.)','M2 (right ax.)','MT = M1 + M2 (right ax.)');
        end
        title('Min. Tikhonov funct. MT');
        xlabel('outer iterations iOut')
    end
    axis(ax,'square');
    if out == 2
        savePngFig(13,iOut,seti);
    end

%%
% *figure 14: reconstructed contrast (real part)*

    figure(14);
    set(gcf,'Visible',seti.plotVisible);
    if seti.dim == 2
        %imagesc(seti.G(real(qROIcomp))); colormap(cmapPrint); colorbar; % alternative colormap
        imagesc(seti.G(real(qROIcomp))); colormap(litman); colorbar;
        axis xy;
        if seti.usecbarlim
            caxis(seti.cbarlim);
        end
    elseif seti.dim == 3
        % isosurface(seti.G(real(qROIPrev))); colormap(litman); caxis([-1,3]); colorbar;
        % title('real part of reconstructed contrast (isosurface plot)');
        contourPlotROI(qROIcomp, seti, 'real');
    end
    if seti.plotPublish
        if seti.dim == 2
            plot2DstylePublish;
        elseif seti.dim == 3
            plot3DstylePublish;
        end
    else
        title('reconstructed contrast (real part)');
    end
    axis square;
    if out == 2
        savePngFig(14,iOut,seti);
    end
    close(14);
    % It is important to close this figure 
    % because otherwise the projection in 3D is a problem.

%%
% *figure 15: reconstructed contrast (imag part)*

    figure(15);
    set(gcf,'Visible',seti.plotVisible);
    if seti.dim == 2
        imagesc(seti.G(imag(qROIcomp))); colormap(litman); colorbar;
        axis xy;
    elseif seti.dim == 3
        contourPlotROI(qROIcomp, seti, 'imag');
    end
    if seti.usecbarlim
        caxis(seti.cbarlim);
    end
    if seti.plotPublish
        if seti.dim == 2
            plot2DstylePublish;
        elseif seti.dim == 3
            plot3DstylePublish;
        end
    else
        title('reconstructed contrast (imag part)');
    end
    axis square;
    if out == 2
        savePngFig(15,iOut,seti);
    end
    close(15);
    % It is important to close this figure 
    % because otherwise the projection in 3D is a problem.

%%
% *figure 16: difference of reconstructed and true contrast (abs)*

if 0
    figure(16);
    set(gcf,'Visible',seti.plotVisible);
    img = seti.G(abs(qROIprev-qROIexact));
    if seti.dim == 3
        % Display only a slice of the data:
        N2 = ceil((seti.nROI-1)/2);
        img = img(:,:,N2);
    end
    imagesc(img); colormap(litman); colorbar;
    axis xy;
    if seti.usecbarlim
        caxis(seti.cbarlim);
    end
    if seti.plotPublish
        plot2DstylePublish;
    else
        title('difference of reconstructed and true contrast (abs)');
    end
    axis square;
    if out == 2
        savePngFig(16,iOut,seti);
    end
end

end

%%
% *figures 21-30 reserved for 3D reconstruction*
%
% * figure 21-26
% * 21-23: predefined contrast (real part) (3D sections)
% * 24-26: reconstructed contrast (real part) (3D sections)
%
if out >= 1 && seti.dim == 3 && ...
   (strcmp('corner3D',seti.contrast) || strcmp('twoTripods3D',seti.contrast) ||...
    strcmp('twoTripodsRealImag3D',seti.contrast) || strcmp('cubeLike3D',seti.contrast) ||...
    strcmp('cross3D',seti.contrast))
    switch seti.contrast
        case {'corner3D', 'twoTripods3D', 'twoTripodsRealImag3D', 'cubeLike3D'}
            seca = -(1-3.5/8);
            %secn = 2; % most interesting
        case 'cross3D'
            seca = 0;
            %secn = 2; % 1, 2 or 3... in coordinate system
    end
    if iOut == 0
        plot3Dsec(qROIexact,'predefined',seca,1,seti,iOut,out,21);
        plot3Dsec(qROIexact,'predefined',seca,2,seti,iOut,out,22);
        plot3Dsec(qROIexact,'predefined',seca,3,seti,iOut,out,23);
    else
        plot3Dsec(qROIcomp,'reconstructed',seca,1,seti,iOut,out,24);
        plot3Dsec(qROIcomp,'reconstructed',seca,2,seti,iOut,out,25);
        plot3Dsec(qROIcomp,'reconstructed',seca,3,seti,iOut,out,26);
    end
end

end

%%
% *Code: subfunction: plot3Dsec*
%
% plot sectional plane in case of 3D

function plot3Dsec(qROI,contrastKind,seca,secn,seti,iOut,out,figno)
% qROI: seti.qROIexact (exact/predefined) OR qROIprev (reconstructed)
% contrastKind: in title of plot, i.e. predefined or reconstructed
R = seti.rCD/2;
ind = floor((seca*R+R)/(2*R)*seti.nROI);
A = seti.G(qROI);

switch secn
    case 1
        B = A(ind,:,:);
    case 2
        B = A(:,ind,:);
    case 3
        B = A(:,:,ind);
    otherwise
        error('n must be 1, 2 or 3.');
end
B = squeeze(real(B));
B = transpose(B);

figure(figno);
set(gcf,'Visible',seti.plotVisible);
imagesc(B); colormap(litman); colorbar;
axis xy;
if seti.usecbarlim
    caxis(seti.cbarlim);
end
if seti.plotPublish
    plot2DstylePublish;
else
    titles = sprintf('%s contrast (real part), X%d',contrastKind,secn);
    title(titles);
end
axis square;
if out == 2
    savePngFig(figno,iOut,seti);
end
end

##### SOURCE END #####
--></body></html>