
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>subplots</title><meta name="generator" content="MATLAB 9.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-04-30"><meta name="DC.source" content="subplots.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>subplots</h1><!--introduction--><p>Plotting subplots in figure 11: (1) true contrast, (2) reconstructed contrast, (3) discrepancy and error, (4) Tikhonov functional minimization.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Syntax</a></li><li><a href="#2">Description</a></li><li><a href="#3">Input Arguments</a></li><li><a href="#4">Output Arguments</a></li><li><a href="#5">See Also</a></li><li><a href="#6">Code</a></li></ul></div><h2 id="1">Syntax</h2><pre class="language-matlab">subplots(seti,qROIexact,qROIcomp,iOut)
</pre><h2 id="2">Description</h2><p><tt>subplots(seti,qROIexact,qROIcomp,iOut)</tt> plots the four subplots in figure 11 for outer iteration <tt>iOut</tt>:</p><div><ul><li>Subplot 1: true contrast</li><li>Subplot 2: reconstructed contrast</li><li>Subplot 3: discrepancy and error</li><li>Subplot 4: Tikhonov functional minimization</li></ul></div><p>Note that the command to save figure 11 is in <a href="plotAndSaveFigures.html">plotAndSaveFigures.html</a>.</p><h2 id="3">Input Arguments</h2><div><ul><li>seti      : structural array</li><li>qROIexact : predefined (i.e. exact) contrast               (usually qROIexact = seti.qROIexact, but in other cases               (e.g. 'source') you can put in something else to plot.)</li><li>qROIcomp  : reconstructed (i.e. computed) contrast</li><li>iOut      : number of outer iteration</li></ul></div><div><ul><li>seti.recname : reconstruction name, e.g. 'contrast' or 'source'.</li></ul></div><p>Specific fields in <tt>seti</tt> influencing the figures are described in <a href="setGeomSim.html">setGeomSim.html</a> in the section "Subfunction: setFigureSettings".</p><h2 id="4">Output Arguments</h2><p>Output is figure 11 as described in description and in section "Output: Figures" in <a href="start.html">start.html</a>.</p><h2 id="5">See Also</h2><div><ul><li><a href="plotAndSaveFigures.html">plotAndSaveFigures.html</a></li><li><a href="contourPlotROI.html">contourPlotROI.html</a></li><li><a href="setGeomSim.html">setGeomSim.html</a></li><li><a href="litman.html">litman.html</a></li></ul></div><h2 id="6">Code</h2><pre class="codeinput"><span class="keyword">function</span> subplots(seti,qROIexact,qROIcomp,iOut)
</pre><pre class="codeinput">figureSupplots = figure(11);
set(gcf,<span class="string">'Visible'</span>,seti.plotVisible);
clf;
sprows = 2; <span class="comment">% subplot rows</span>
spcols = 2; <span class="comment">% subplot cols</span>
</pre><p><b>Subplot 1: true contrast</b></p><pre class="codeinput">subplot(sprows,spcols,1,<span class="string">'Parent'</span>,figureSupplots);
gridax = seti.gridROI(2,1:seti.nROI);
<span class="keyword">switch</span> seti.dim
    <span class="keyword">case</span> 2
        imagesc(gridax,gridax,seti.G(real(qROIexact))); colormap(litman); colorbar;
        axis <span class="string">xy</span>;
        <span class="keyword">if</span> seti.usecbarlim
            caxis(seti.cbarlim);
        <span class="keyword">end</span>
        <span class="comment">% imagesc(gridax,gridax,seti.G(real(seti.wW(seti.qROIexact)))); colormap(litman); colorbar;</span>
        <span class="comment">% to control if matrix of wavelet-coeff. is sparse</span>
    <span class="keyword">case</span> 3
        contourPlotROI(qROIexact, seti, <span class="string">'real'</span>);
<span class="keyword">end</span>
axis <span class="string">square</span>;
title(sprintf(<span class="string">'True %s (real part) on ROI \n (nROI = %g) (rel. noise \\delta = %g)'</span>,seti.recname,seti.nROI,seti.delta));

<span class="keyword">if</span> iOut == 0
    <span class="keyword">return</span> <span class="comment">% other subplots are empty...</span>
<span class="keyword">end</span>
</pre><p><b>Subplot 2: contrast reconstruction</b></p><pre class="codeinput">subplot(sprows,spcols,2,<span class="string">'Parent'</span>,figureSupplots);

        <span class="keyword">if</span> seti.dim == 2
            gridax = seti.gridROI(2,1:seti.nROI);
            qROIplot = qROIcomp;
            imagesc(gridax,gridax,seti.G(real(qROIplot))); colormap(litman); colorbar;
            axis <span class="string">xy</span>;
            <span class="keyword">if</span> seti.usecbarlim
                caxis(seti.cbarlim);
            <span class="keyword">end</span>
        <span class="keyword">elseif</span> seti.dim == 3
            <span class="comment">% gridax = seti.gridROI(2,1:seti.nROI);</span>
            <span class="comment">% isosurface(gridax,gridax,gridax,seti.G(real(qROI)));</span>
            contourPlotROI(qROIcomp, seti, <span class="string">'real'</span>);
        <span class="keyword">else</span>
            disp(<span class="string">'seti.dim = 2 or 3...'</span>)
        <span class="keyword">end</span>
        title(sprintf(<span class="string">'Reconstructed %s \n (real part)'</span>,seti.recname));
        axis <span class="string">square</span>;
</pre><p><b>Subplot 3: discrepancy and error</b></p><pre class="codeinput">subplot(sprows,spcols,3,<span class="string">'Parent'</span>,figureSupplots);
        plot((0:iOut), [seti.disIni seti.dis(1:iOut)], <span class="string">'b-'</span>, (0:iOut), [seti.errIni seti.err(1:iOut)], <span class="string">'r:'</span>);
        legend(<span class="string">'discrepancy'</span>,<span class="string">'error'</span>);
        title(<span class="string">'Discrepancy and error'</span>);
        xlabel(<span class="string">'outer iterations iOut'</span>)
        axis <span class="string">square</span>;
</pre><p><b>Subplot 4: minimize functional</b></p><pre class="codeinput">subplot(sprows,spcols,4,<span class="string">'Parent'</span>,figureSupplots);
    x = 1:iOut;
    <span class="keyword">if</span> length(x) == 1
        [ax,h1,h2] = plotyy(x',seti.M1v(x)',x',seti.M2v(x));
        legend([h1;h2],<span class="string">'M1 (left axis)'</span>,<span class="string">'M2 (right axis)'</span>);
    <span class="keyword">else</span>
        [ax,h1,h2] = plotyy(x',seti.M1v(x)',[x',x'],[seti.M2v(x)',seti.MTv(x)']);
        legend([h1;h2],<span class="string">'M1 (left ax.)'</span>,<span class="string">'M2 (right ax.)'</span>,<span class="string">'MT = M1 + M2 (right ax.)'</span>);
    <span class="keyword">end</span>
    title(<span class="string">'Min. Tikhonov funct. MT'</span>);
    axis(ax,<span class="string">'square'</span>);
    xlabel(<span class="string">'outer iterations iOut'</span>)

    <span class="comment">% plot((1:iOut), seti.MTv(1:iOut), (1:iOut), seti.M1v(1:iOut), (1:iOut), seti.M2v(1:iOut));</span>
    <span class="comment">% legend('MT = M1 + M2','M1','M2');</span>
</pre><p>Error in legend in case of first outer step, i.e. iOut == 1:</p><pre class="codeinput">    <span class="comment">% Same with this example code:</span>
    <span class="comment">% x = 1;</span>
    <span class="comment">% A(x) = 1;</span>
    <span class="comment">% B(x) = 2;</span>
    <span class="comment">% C(x) = 3;</span>
    <span class="comment">% [ax,h1,h2] = plotyy(x',A(x)',[x',x'],[B(x)',C(x)']);</span>
    <span class="comment">% legend([h1;h2],'A','B','C');</span>
    <span class="comment">%</span>
    <span class="comment">% Warning: Ignoring extra legend entries.</span>
    <span class="comment">% &gt; In legend&gt;set_children_and_strings (line 643)</span>
    <span class="comment">%   In legend&gt;make_legend (line 328)</span>
    <span class="comment">%   In legend (line 257)</span>
    <span class="comment">%</span>
    <span class="comment">% No problem if x is a vector: e.g. x = 1:2;</span>
    <span class="comment">%</span>
    <span class="comment">% Kind of solution:</span>
    <span class="comment">% Do not plot MT for first outer iteration...</span>
</pre><pre class="codeinput"><span class="comment">% warning off to avoid: "Warning: Error updating Light. Exceeded the maximum number (8) of light sources"</span>
warning <span class="string">off</span>;
drawnow;
warning <span class="string">on</span>;
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2018b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% subplots
% Plotting subplots in figure 11: 
% (1) true contrast, (2) reconstructed contrast, (3) discrepancy and error,
% (4) Tikhonov functional minimization.
%
%% Syntax
%
%   subplots(seti,qROIexact,qROIcomp,iOut)
%
%% Description
% |subplots(seti,qROIexact,qROIcomp,iOut)| plots the four subplots in
% figure 11 for outer iteration |iOut|:
%
% * Subplot 1: true contrast
% * Subplot 2: reconstructed contrast
% * Subplot 3: discrepancy and error
% * Subplot 4: Tikhonov functional minimization
%
% Note that the command to save figure 11 is in <plotAndSaveFigures.html>.
%
%% Input Arguments
%
% * seti      : structural array
% * qROIexact : predefined (i.e. exact) contrast
%               (usually qROIexact = seti.qROIexact, but in other cases 
%               (e.g. 'source') you can put in something else to plot.)
% * qROIcomp  : reconstructed (i.e. computed) contrast
% * iOut      : number of outer iteration
%
% * seti.recname : reconstruction name, e.g. 'contrast' or 'source'.
%
% Specific fields in |seti| influencing the figures are described in 
% <setGeomSim.html> in the section "Subfunction: setFigureSettings".
%
%% Output Arguments
%
% Output is figure 11 as described in description and in section 
% "Output: Figures" in <start.html>.
%
%% See Also
%
% * <plotAndSaveFigures.html>
% * <contourPlotROI.html>
% * <setGeomSim.html>
% * <litman.html>
%
%% Code
function subplots(seti,qROIexact,qROIcomp,iOut)

figureSupplots = figure(11);
set(gcf,'Visible',seti.plotVisible);
clf;
sprows = 2; % subplot rows
spcols = 2; % subplot cols

%%
% *Subplot 1: true contrast*

subplot(sprows,spcols,1,'Parent',figureSupplots);
gridax = seti.gridROI(2,1:seti.nROI);
switch seti.dim
    case 2
        imagesc(gridax,gridax,seti.G(real(qROIexact))); colormap(litman); colorbar;
        axis xy;
        if seti.usecbarlim
            caxis(seti.cbarlim);
        end
        % imagesc(gridax,gridax,seti.G(real(seti.wW(seti.qROIexact)))); colormap(litman); colorbar;
        % to control if matrix of wavelet-coeff. is sparse
    case 3
        contourPlotROI(qROIexact, seti, 'real');
end
axis square;
title(sprintf('True %s (real part) on ROI \n (nROI = %g) (rel. noise \\delta = %g)',seti.recname,seti.nROI,seti.delta));

if iOut == 0
    return % other subplots are empty...
end

%%
% *Subplot 2: contrast reconstruction*

subplot(sprows,spcols,2,'Parent',figureSupplots);

        if seti.dim == 2
            gridax = seti.gridROI(2,1:seti.nROI);
            qROIplot = qROIcomp;
            imagesc(gridax,gridax,seti.G(real(qROIplot))); colormap(litman); colorbar;
            axis xy;
            if seti.usecbarlim
                caxis(seti.cbarlim);
            end
        elseif seti.dim == 3
            % gridax = seti.gridROI(2,1:seti.nROI);
            % isosurface(gridax,gridax,gridax,seti.G(real(qROI)));
            contourPlotROI(qROIcomp, seti, 'real');
        else
            disp('seti.dim = 2 or 3...')
        end
        title(sprintf('Reconstructed %s \n (real part)',seti.recname));
        axis square;

%%
% *Subplot 3: discrepancy and error*

subplot(sprows,spcols,3,'Parent',figureSupplots);
        plot((0:iOut), [seti.disIni seti.dis(1:iOut)], 'b-', (0:iOut), [seti.errIni seti.err(1:iOut)], 'r:');
        legend('discrepancy','error');
        title('Discrepancy and error');
        xlabel('outer iterations iOut')
        axis square;

%%
% *Subplot 4: minimize functional*

subplot(sprows,spcols,4,'Parent',figureSupplots);
    x = 1:iOut;
    if length(x) == 1
        [ax,h1,h2] = plotyy(x',seti.M1v(x)',x',seti.M2v(x));
        legend([h1;h2],'M1 (left axis)','M2 (right axis)');
    else
        [ax,h1,h2] = plotyy(x',seti.M1v(x)',[x',x'],[seti.M2v(x)',seti.MTv(x)']);
        legend([h1;h2],'M1 (left ax.)','M2 (right ax.)','MT = M1 + M2 (right ax.)');
    end
    title('Min. Tikhonov funct. MT');
    axis(ax,'square');
    xlabel('outer iterations iOut')
 
    % plot((1:iOut), seti.MTv(1:iOut), (1:iOut), seti.M1v(1:iOut), (1:iOut), seti.M2v(1:iOut));
    % legend('MT = M1 + M2','M1','M2');
    
    %%
    % Error in legend in case of first outer step, i.e. iOut == 1:
    
    % Same with this example code:
    % x = 1;
    % A(x) = 1;
    % B(x) = 2;
    % C(x) = 3;
    % [ax,h1,h2] = plotyy(x',A(x)',[x',x'],[B(x)',C(x)']);
    % legend([h1;h2],'A','B','C');
    %
    % Warning: Ignoring extra legend entries. 
    % > In legend>set_children_and_strings (line 643)
    %   In legend>make_legend (line 328)
    %   In legend (line 257) 
    %
    % No problem if x is a vector: e.g. x = 1:2;
    %
    % Kind of solution:
    % Do not plot MT for first outer iteration...

%%

% warning off to avoid: "Warning: Error updating Light. Exceeded the maximum number (8) of light sources"
warning off;
drawnow;
warning on;

end

##### SOURCE END #####
--></body></html>