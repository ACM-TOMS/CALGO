
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>pntsGeometry</title><meta name="generator" content="MATLAB 9.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-04-30"><meta name="DC.source" content="pntsGeometry.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>pntsGeometry</h1><!--introduction--><p>Coordinates of points for given geometries in two dimensional space.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Syntax</a></li><li><a href="#2">Description</a></li><li><a href="#3">Examples</a></li><li><a href="#4">Input Arguments</a></li><li><a href="#5">Output Arguments</a></li><li><a href="#6">More About</a></li><li><a href="#7">See Also</a></li><li><a href="#8">Code: pntsGeometry</a></li><li><a href="#13">Code: Subfunctions</a></li></ul></div><h2 id="1">Syntax</h2><pre class="language-matlab">[Pnts,Nb,dS] = pntsGeometry(seti,type,varargin)
</pre><pre class="language-matlab">[Pnts,Nb,dS] = pntsGeometry(seti,<span class="string">'manually'</span>,Pnts)
[Pnts,Nb,dS] = pntsGeometry(seti,<span class="string">'circle'</span>,Nb,rad)
[Pnts,Nb,dS] = pntsGeometry(seti,<span class="string">'square'</span>,NbEdge,edgeLength)
[Pnts,Nb,dS] = pntsGeometry(seti,<span class="string">'line'</span>,NbLine,lineLength,linePos)
[Pnts,Nb,dS] = pntsGeometry(seti,<span class="string">'borehole'</span>,boreNbLine,boreLineLength,boreLinePos,incMeas)
</pre><h2 id="2">Description</h2><p><tt>[Pnts,Nb,dS] = pntsGeometry(seti,type,varargin)</tt> computes the coordinates in <tt>Pnts</tt> and serves their number <tt>Nb</tt> and an approximation of the infinitesimal element of closed contour in <tt>dS</tt>. The geometry type is defined in <tt>type</tt> and the details in <tt>varargin</tt> depending on the type. <tt>seti</tt> is only used to check that <tt>seti.dim = 2</tt>.</p><p><tt>[Pnts,Nb,dS] = pntsGeometry(seti,'manually',Pnts)</tt> counts the number <tt>Nb</tt> of input points <tt>Pnts</tt> and sets <tt>dS</tt> to 1. Input and output <tt>Pnts</tt> is the same.</p><p><tt>[Pnts,Nb,dS] = pntsGeometry(seti,'circle',Nb,rad)</tt> generates coordinates <tt>Pnts</tt> on a cricle. The number of <tt>Nb</tt> points are equidistant arranged on a circle with radius <tt>rad</tt>. Distance <tt>dS</tt> is computed.</p><p><tt>[Pnts,Nb,dS] = pntsGeometry(seti,'square',NbEdge,edgeLength)</tt> generates coordinates <tt>Pnts</tt> on a square. The number of <tt>NbEdge</tt>+1 points are equidistant arranged on one edge with length <tt>edgeLength</tt>. (Total number of points in square is <tt>4*NbEdge</tt>.  <tt>NbEdge</tt>+1 per edge is because the points in corners belonging to two corners.) This is done for all four edges of the square. Distances <tt>dS</tt> are computed.</p><p><tt>[Pnts,Nb,dS] = pntsGeometry(seti,'line',NbLine,lineLength,linePos)</tt> generates <tt>NbLine</tt> coordinates <tt>Pnts</tt> on a line with length <tt>lineLength</tt> with a position of <tt>linePos</tt> as distance to origin. <tt>dS</tt> is set to 1.</p><p><tt>[Pnts,Nb,dS] = pntsGeometry(seti,'borehole',boreNbLine,boreLineLength,boreLinePos,incMeas)</tt> generates <tt>boreNbLine</tt> coordinates <tt>Pnts</tt> on a line with length <tt>boreLineLength</tt> with a position of <tt>boreLinePos</tt> as distance to origin. <tt>dS</tt> is set to 1. Set <tt>incMeas</tt> to <tt>'inc'</tt> or <tt>'meas'</tt>, then <tt>Pnts</tt> are shifted such that points of both types will be equidistant.</p><h2 id="3">Examples</h2><p><b>Example 1: manually</b></p><p>3 manually positioned points with coordinates (1,0), (0.5,1.5), and (-0.5,1.5).</p><pre class="language-matlab">seti.dim = 2;
Pnts = [1 0.5 -0.5;
        0 1.5  1.5];
[Pnts,Nb,dS] = pntsGeometry(seti,<span class="string">'manually'</span>,Pnts);
figure(101); plot(Pnts(1,:),Pnts(2,:),<span class="string">'b.'</span>,<span class="string">'MarkerSize'</span>,30); axis <span class="string">square</span>;
</pre><p><img vspace="5" hspace="5" src="../extGraph/pntsGeometry_fig101.png" alt=""> </p><p><b>Example 2: circle</b></p><p>Arrange 10 points on a circle with radius 5.</p><pre class="language-matlab">seti.dim = 2;
Nb = 10;
rad = 5;
[Pnts,Nb,dS] = pntsGeometry(seti,<span class="string">'circle'</span>,Nb,rad);
figure(102); plot(Pnts(1,:),Pnts(2,:),<span class="string">'b.'</span>,<span class="string">'MarkerSize'</span>,30); axis <span class="string">square</span>;
</pre><p><img vspace="5" hspace="5" src="../extGraph/pntsGeometry_fig102.png" alt=""> </p><p><b>Example 3: square</b></p><p>Arrange 4+1 points on each edge of a square with length 3. Total number of points is 4*4 = 16.</p><pre class="language-matlab">seti.dim = 2;
NbEdge = 4;
edgeLength = 3;
[Pnts,Nb,dS] = pntsGeometry(seti,<span class="string">'square'</span>,NbEdge,edgeLength);
figure(103); plot(Pnts(1,:),Pnts(2,:),<span class="string">'b.'</span>,<span class="string">'MarkerSize'</span>,30); axis <span class="string">square</span>;
</pre><p><img vspace="5" hspace="5" src="../extGraph/pntsGeometry_fig103.png" alt=""> </p><p><b>Example 4: line</b></p><p>Arrange 5 points on a line with length 3, right to origin with distance 2.</p><pre class="language-matlab">seti.dim = 2;
NbLine = 5;
lineLength = 3;
linePos = 2;
[Pnts,Nb,dS] = pntsGeometry(seti,<span class="string">'line'</span>,NbLine,lineLength,linePos);
figure(104); plot(Pnts(1,:),Pnts(2,:),<span class="string">'b.'</span>,<span class="string">'MarkerSize'</span>,30); axis <span class="string">square</span>;
</pre><p><img vspace="5" hspace="5" src="../extGraph/pntsGeometry_fig104.png" alt=""> </p><p><b>Example 5: borehole</b></p><p>Arrange 10 transmitters and 10 receivers on a line of length 4 with a position 5 right from origin.</p><pre class="language-matlab">seti.dim = 2;
boreNbLine = 10;
boreLineLength = 4;
boreLinePos = 5;
[incPnts,incNb,dSInc] = pntsGeometry(seti,<span class="string">'borehole'</span>,boreNbLine,boreLineLength,boreLinePos,<span class="string">'inc'</span>);
[measPnts,measNb,dSMeas] = pntsGeometry(seti,<span class="string">'borehole'</span>,boreNbLine,boreLineLength,boreLinePos,<span class="string">'meas'</span>);
figure(105);
hold <span class="string">on</span>;
plot(incPnts(1,:),incPnts(2,:),<span class="string">'b.'</span>,<span class="string">'MarkerSize'</span>,30);
plot(measPnts(1,:),measPnts(2,:),<span class="string">'rs'</span>,<span class="string">'MarkerSize'</span>,7,<span class="string">'MarkerFaceColor'</span>,<span class="string">'red'</span>);
hold <span class="string">off</span>;
axis <span class="string">square</span>;
</pre><p><img vspace="5" hspace="5" src="../extGraph/pntsGeometry_fig105.png" alt=""> </p><h2 id="4">Input Arguments</h2><div><ul><li>seti        :   structure array which has to contain <tt>seti.dim = 2</tt>                   because two dimensional space</li><li>type        :   string with type of geometry:                   'manually', 'circle', 'square', 'line', 'borehole'.</li><li>varargin    :   various input arguments depending on choosen type.</li></ul></div><p><b>varargin in case of type = 'manually'</b></p><div><ul><li>Pnts        :   coordinates of points (real matrix of size 2 x Nb).</li></ul></div><p><b>varargin in case of type = 'circle'</b></p><div><ul><li>Nb          :   Number of points</li><li>rad         :   radius of circle</li></ul></div><p><b>varargin in case of type = 'square'</b></p><div><ul><li>NbEdge      :   NbEdge+1 points are on one edge                   (+1 because a point in a corner belongs to two corners).                   (Total number of points in square is <tt>4*NbEdge</tt>.)</li><li>edgeLength  :   Length of one edge.</li></ul></div><p><b>varargin in case of type = 'line'</b></p><div><ul><li>NbLine      :   Number of points on line.</li><li>lineLength  :   Length of line.</li><li>linePos     :   Distance of line right to origin.</li></ul></div><p><b>varargin in case of type = 'borehole'</b></p><div><ul><li>boreNbLine      :   Number of points on line.</li><li>boreLineLength  :   Length of line.</li><li>boreLinePos     :   Distance of line right to origin.</li><li>incMeas         :   Type of points, i.e. 'inc' or 'meas', to shift the                       points, see Example 5 above.</li></ul></div><h2 id="5">Output Arguments</h2><div><ul><li>Pnts    :   Coordinates of points (real matrix of size 2 x Nb).</li><li>Nb      :   Number of points.</li><li>dS      :   Approximation of the infinitesimal element of closed               contour with control points.               A closed contour does not make sense in the cases               'manually', 'line', and 'borehole', then it is set to 1.</li></ul></div><h2 id="6">More About</h2><div><ul><li>currently only in two dimensional space   (this is the reason for seti.dim = 2)</li></ul></div><h2 id="7">See Also</h2><div><ul><li><a href="dS2D.html">dS2D.html</a></li><li><a href="expSetup.html">expSetup.html</a></li><li><a href="setIncPnts.html">setIncPnts.html</a></li><li><a href="setMeasPnts.html">setMeasPnts.html</a></li></ul></div><h2 id="8">Code: pntsGeometry</h2><pre class="codeinput"><span class="keyword">function</span> [Pnts,Nb,dS] = pntsGeometry(seti,type,varargin)
</pre><pre class="codeinput"><span class="keyword">if</span> seti.dim ~= 2
    error(<span class="string">'pntsGeometry currently needs 2D.'</span>)
<span class="keyword">end</span>
</pre><p><b>Split varargin in dependence of parameter type</b></p><pre class="codeinput"><span class="keyword">if</span> strcmp(type,<span class="string">'manually'</span>)
    <span class="comment">%   pntsGeometry(seti,'manually',Pnts)</span>
    Pnts = varargin{1};

<span class="keyword">elseif</span> strcmp(type,<span class="string">'circle'</span>)
    <span class="comment">%   pntsGeometry(seti,'circle',Nb,rad)</span>
    Nb = varargin{1};
    rad = varargin{2};
    Pnts = circle(Nb,rad);

<span class="keyword">elseif</span> strcmp(type,<span class="string">'square'</span>)
    NbEdge = varargin{1}; <span class="comment">% number of points on one edge</span>
    edgeLength = varargin{2}; <span class="comment">% length of edge</span>
    <span class="comment">%   pntsGeometry(seti,'square',NbEdge,edgeLength)</span>
    Pnts = square(NbEdge,edgeLength);

<span class="keyword">elseif</span> strcmp(type,<span class="string">'line'</span>)
    NbLine = varargin{1};
    lineLength = varargin{2};
    linePos = varargin{3}; <span class="comment">% position of line (distance to origin)</span>
    <span class="comment">%   pntsGeometry(seti,'line',NbLine,lineLength,linePos)</span>
    Pnts = line(NbLine,lineLength,linePos);

<span class="keyword">elseif</span> strcmp(type,<span class="string">'borehole'</span>)
    NbLine = varargin{1};
    lineLength = varargin{2};
    linePos = varargin{3}; <span class="comment">% position of line (distance to origin)</span>
    incMeas = varargin{4}; <span class="comment">% 'inc' or 'meas'</span>
    <span class="comment">%   pntsGeometry(seti,'borehole',NbLine,lineLength,linePos,incMeas)</span>
    Pnts = borehole(NbLine,lineLength,linePos,incMeas);
<span class="keyword">end</span>
</pre><p><b>Compute Nb and dS</b></p><pre class="codeinput">[~,Nb] = size(Pnts); <span class="comment">% in some cases (circle, line) it is input, but not in all...</span>
<span class="comment">% Note: Nb = length(Pnts); This is not correct in case of seti.incNb = 1 it</span>
<span class="comment">% results in 2, which is wrong...; that is why size is used...</span>

<span class="keyword">if</span> strcmp(type,<span class="string">'manually'</span>) || strcmp(type,<span class="string">'line'</span>) || strcmp(type,<span class="string">'borehole'</span>)
    dS = 1;
<span class="keyword">else</span>
    <span class="comment">% transpose of Pnts because dS2D expects Nb x 2 and not 2 x Nb</span>
    dS = dS2D(transpose(Pnts));
<span class="keyword">end</span>
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><h2 id="13">Code: Subfunctions</h2><p><b>circle</b></p><pre class="codeinput"><span class="keyword">function</span> Pnts = circle(Nb,rad)
<span class="comment">% set up uniformly spaced points</span>
<span class="comment">%</span>
<span class="comment">% * Nb  :   number of points on circle</span>
<span class="comment">% * rad :   radius</span>
<span class="comment">%</span>
cmplxPnts = exp(2*pi*1i*(0:1:Nb-1)./Nb);
Pnts = [real(rad.*cmplxPnts); imag(rad.*cmplxPnts)];
<span class="comment">%     % next line gives example for measurements on circle on the right of the scattering medium</span>
<span class="comment">%     seti.incPnts = [real(0.3+seti.radSrc.*cmplxPnts); imag(0.3+seti.radSrc.*cmplxPnts)];</span>
<span class="keyword">end</span>
</pre><p><b>square</b></p><pre class="codeinput"><span class="keyword">function</span> Pnts = square(NbEdge,edgeLength)

dist = edgeLength/2;
<span class="comment">% add 2 and then delete the corner points</span>
x = linspace(-dist,+dist,NbEdge+1);
x = x(1:end-1); <span class="comment">% without last entry</span>

distVec = dist*ones(size(x));

<span class="comment">% edges</span>
top    = [distVec; x];
bottom = [-distVec; -x];
left   = [x; -distVec];
right  = [-x; +distVec];

Pnts = [top right bottom left];
<span class="comment">% Pnts are arranged in mathematical negative sense starting top left.</span>
<span class="comment">% Make sure that the vectors are stored in a suitable order because the distances computed in dS2D.</span>
<span class="keyword">end</span>
</pre><p><b>line</b></p><pre class="codeinput"><span class="keyword">function</span> Pnts = line(NbLine,lineLength,linePos)

dist = lineLength/2;
x = linspace(-dist,+dist,NbLine);
Pnts = [linePos*ones(size(x)); x];
<span class="keyword">end</span>
</pre><p><b>borehole</b></p><pre class="codeinput"><span class="keyword">function</span> Pnts = borehole(Nb,lineLength,linePos,type)
<span class="comment">% type: 'inc' or 'meas'</span>

d = lineLength/(2*Nb); <span class="comment">% distance between transmitters and receivers</span>
dist = lineLength/2;
<span class="keyword">if</span> strcmp(type,<span class="string">'inc'</span>)
    x = linspace(-dist,+dist-d,Nb);
<span class="keyword">else</span> <span class="comment">% type = meas</span>
    x = linspace(-dist+d,+dist,Nb);
<span class="keyword">end</span>
Pnts = [linePos*ones(size(x)); x];

<span class="keyword">end</span>
</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2018b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% pntsGeometry
% Coordinates of points for given geometries in two dimensional space.
%
%% Syntax
%
%   [Pnts,Nb,dS] = pntsGeometry(seti,type,varargin)
%
%   [Pnts,Nb,dS] = pntsGeometry(seti,'manually',Pnts)
%   [Pnts,Nb,dS] = pntsGeometry(seti,'circle',Nb,rad)
%   [Pnts,Nb,dS] = pntsGeometry(seti,'square',NbEdge,edgeLength)
%   [Pnts,Nb,dS] = pntsGeometry(seti,'line',NbLine,lineLength,linePos)
%   [Pnts,Nb,dS] = pntsGeometry(seti,'borehole',boreNbLine,boreLineLength,boreLinePos,incMeas)
%
%% Description
% |[Pnts,Nb,dS] = pntsGeometry(seti,type,varargin)|
% computes the coordinates in |Pnts| and serves their number |Nb| and 
% an approximation of the infinitesimal element of closed contour in |dS|.
% The geometry type is defined in |type| and the details in |varargin|
% depending on the type. |seti| is only used to check that |seti.dim = 2|.
%
% |[Pnts,Nb,dS] = pntsGeometry(seti,'manually',Pnts)|
% counts the number |Nb| of input points |Pnts| and sets |dS| to 1. Input
% and output |Pnts| is the same.
%
% |[Pnts,Nb,dS] = pntsGeometry(seti,'circle',Nb,rad)|
% generates coordinates |Pnts| on a cricle. The number of |Nb| points are 
% equidistant arranged on a circle with radius |rad|. 
% Distance |dS| is computed.
%
% |[Pnts,Nb,dS] = pntsGeometry(seti,'square',NbEdge,edgeLength)|
% generates coordinates |Pnts| on a square. The number of |NbEdge|+1 points
% are equidistant arranged on one edge with length |edgeLength|. 
% (Total number of points in square is |4*NbEdge|.
%  |NbEdge|+1 per edge is because the points in corners belonging to two corners.)
% This is done for all four edges of the square. Distances |dS| are computed.
%
% |[Pnts,Nb,dS] = pntsGeometry(seti,'line',NbLine,lineLength,linePos)|
% generates |NbLine| coordinates |Pnts| on a line with length |lineLength|
% with a position of |linePos| as distance to origin. |dS| is set to 1.
%
% |[Pnts,Nb,dS] = pntsGeometry(seti,'borehole',boreNbLine,boreLineLength,boreLinePos,incMeas)|
% generates |boreNbLine| coordinates |Pnts| on a line with length |boreLineLength|
% with a position of |boreLinePos| as distance to origin. |dS| is set to 1.
% Set |incMeas| to |'inc'| or |'meas'|, then |Pnts| are shifted such that
% points of both types will be equidistant.
%
%% Examples
%
% *Example 1: manually*
%
% 3 manually positioned points with coordinates (1,0), (0.5,1.5), and (-0.5,1.5).
%
%   seti.dim = 2;
%   Pnts = [1 0.5 -0.5;
%           0 1.5  1.5];
%   [Pnts,Nb,dS] = pntsGeometry(seti,'manually',Pnts);
%   figure(101); plot(Pnts(1,:),Pnts(2,:),'b.','MarkerSize',30); axis square;
%
% <<../extGraph/pntsGeometry_fig101.png>>
%
%
% *Example 2: circle*
%
% Arrange 10 points on a circle with radius 5.
%
%   seti.dim = 2;
%   Nb = 10;
%   rad = 5;
%   [Pnts,Nb,dS] = pntsGeometry(seti,'circle',Nb,rad);
%   figure(102); plot(Pnts(1,:),Pnts(2,:),'b.','MarkerSize',30); axis square;
%
% <<../extGraph/pntsGeometry_fig102.png>>
%
%
% *Example 3: square*
%
% Arrange 4+1 points on each edge of a square with length 3.
% Total number of points is 4*4 = 16.
%
%   seti.dim = 2;
%   NbEdge = 4;
%   edgeLength = 3;
%   [Pnts,Nb,dS] = pntsGeometry(seti,'square',NbEdge,edgeLength);
%   figure(103); plot(Pnts(1,:),Pnts(2,:),'b.','MarkerSize',30); axis square;
%
% <<../extGraph/pntsGeometry_fig103.png>>
%
%
% *Example 4: line*
%
% Arrange 5 points on a line with length 3, right to origin with
% distance 2.
%
%   seti.dim = 2;
%   NbLine = 5;
%   lineLength = 3;
%   linePos = 2;
%   [Pnts,Nb,dS] = pntsGeometry(seti,'line',NbLine,lineLength,linePos);
%   figure(104); plot(Pnts(1,:),Pnts(2,:),'b.','MarkerSize',30); axis square;
%
% <<../extGraph/pntsGeometry_fig104.png>>
%
%
% *Example 5: borehole*
%
% Arrange 10 transmitters and 10 receivers on a line of length 4 with a
% position 5 right from origin.
%
%   seti.dim = 2;
%   boreNbLine = 10;
%   boreLineLength = 4;
%   boreLinePos = 5;
%   [incPnts,incNb,dSInc] = pntsGeometry(seti,'borehole',boreNbLine,boreLineLength,boreLinePos,'inc');
%   [measPnts,measNb,dSMeas] = pntsGeometry(seti,'borehole',boreNbLine,boreLineLength,boreLinePos,'meas');
%   figure(105); 
%   hold on;
%   plot(incPnts(1,:),incPnts(2,:),'b.','MarkerSize',30);
%   plot(measPnts(1,:),measPnts(2,:),'rs','MarkerSize',7,'MarkerFaceColor','red');
%   hold off;
%   axis square;
%
% <<../extGraph/pntsGeometry_fig105.png>>
%
%
%% Input Arguments
%
% * seti        :   structure array which has to contain |seti.dim = 2|
%                   because two dimensional space
% * type        :   string with type of geometry:
%                   'manually', 'circle', 'square', 'line', 'borehole'.
% * varargin    :   various input arguments depending on choosen type.
%
% *varargin in case of type = 'manually'*
%
% * Pnts        :   coordinates of points (real matrix of size 2 x Nb).
%
% *varargin in case of type = 'circle'*
%
% * Nb          :   Number of points
% * rad         :   radius of circle
%
% *varargin in case of type = 'square'*
%
% * NbEdge      :   NbEdge+1 points are on one edge
%                   (+1 because a point in a corner belongs to two corners).
%                   (Total number of points in square is |4*NbEdge|.)
% * edgeLength  :   Length of one edge.
%
% *varargin in case of type = 'line'*
%
% * NbLine      :   Number of points on line.
% * lineLength  :   Length of line.
% * linePos     :   Distance of line right to origin.
%
% *varargin in case of type = 'borehole'*
%
% * boreNbLine      :   Number of points on line.
% * boreLineLength  :   Length of line.
% * boreLinePos     :   Distance of line right to origin.
% * incMeas         :   Type of points, i.e. 'inc' or 'meas', to shift the
%                       points, see Example 5 above.
%
%
%% Output Arguments
%
% * Pnts    :   Coordinates of points (real matrix of size 2 x Nb).
% * Nb      :   Number of points.
% * dS      :   Approximation of the infinitesimal element of closed 
%               contour with control points.
%               A closed contour does not make sense in the cases
%               'manually', 'line', and 'borehole', then it is set to 1.
%
%
%% More About
%
% * currently only in two dimensional space
%   (this is the reason for seti.dim = 2)
%
%
%% See Also
%
% * <dS2D.html>
% * <expSetup.html>
% * <setIncPnts.html>
% * <setMeasPnts.html>
%
%
%% Code: pntsGeometry
%
function [Pnts,Nb,dS] = pntsGeometry(seti,type,varargin)

if seti.dim ~= 2
    error('pntsGeometry currently needs 2D.')
end

%%
% *Split varargin in dependence of parameter type*

if strcmp(type,'manually')
    %   pntsGeometry(seti,'manually',Pnts)
    Pnts = varargin{1};
    
elseif strcmp(type,'circle')
    %   pntsGeometry(seti,'circle',Nb,rad)
    Nb = varargin{1};
    rad = varargin{2};
    Pnts = circle(Nb,rad);
    
elseif strcmp(type,'square')
    NbEdge = varargin{1}; % number of points on one edge
    edgeLength = varargin{2}; % length of edge
    %   pntsGeometry(seti,'square',NbEdge,edgeLength)
    Pnts = square(NbEdge,edgeLength);
    
elseif strcmp(type,'line')
    NbLine = varargin{1};
    lineLength = varargin{2};
    linePos = varargin{3}; % position of line (distance to origin)
    %   pntsGeometry(seti,'line',NbLine,lineLength,linePos)
    Pnts = line(NbLine,lineLength,linePos);
    
elseif strcmp(type,'borehole')
    NbLine = varargin{1};
    lineLength = varargin{2};
    linePos = varargin{3}; % position of line (distance to origin)
    incMeas = varargin{4}; % 'inc' or 'meas'
    %   pntsGeometry(seti,'borehole',NbLine,lineLength,linePos,incMeas)
    Pnts = borehole(NbLine,lineLength,linePos,incMeas);
end

%% 
% *Compute Nb and dS*

[~,Nb] = size(Pnts); % in some cases (circle, line) it is input, but not in all...
% Note: Nb = length(Pnts); This is not correct in case of seti.incNb = 1 it
% results in 2, which is wrong...; that is why size is used...

if strcmp(type,'manually') || strcmp(type,'line') || strcmp(type,'borehole')
    dS = 1;
else
    % transpose of Pnts because dS2D expects Nb x 2 and not 2 x Nb
    dS = dS2D(transpose(Pnts));
end

end

%% Code: Subfunctions

%%
%
% *circle*
%
function Pnts = circle(Nb,rad)
% set up uniformly spaced points
%
% * Nb  :   number of points on circle
% * rad :   radius
%
cmplxPnts = exp(2*pi*1i*(0:1:Nb-1)./Nb);
Pnts = [real(rad.*cmplxPnts); imag(rad.*cmplxPnts)];
%     % next line gives example for measurements on circle on the right of the scattering medium
%     seti.incPnts = [real(0.3+seti.radSrc.*cmplxPnts); imag(0.3+seti.radSrc.*cmplxPnts)];
end

%%
% *square*
%
function Pnts = square(NbEdge,edgeLength)

dist = edgeLength/2;
% add 2 and then delete the corner points
x = linspace(-dist,+dist,NbEdge+1);
x = x(1:end-1); % without last entry

distVec = dist*ones(size(x));

% edges
top    = [distVec; x];
bottom = [-distVec; -x];
left   = [x; -distVec];
right  = [-x; +distVec];

Pnts = [top right bottom left];
% Pnts are arranged in mathematical negative sense starting top left.
% Make sure that the vectors are stored in a suitable order because the distances computed in dS2D.
end

%%
% *line*
function Pnts = line(NbLine,lineLength,linePos)

dist = lineLength/2;
x = linspace(-dist,+dist,NbLine);
Pnts = [linePos*ones(size(x)); x];
end

%%
% *borehole*
%
function Pnts = borehole(Nb,lineLength,linePos,type)
% type: 'inc' or 'meas'

d = lineLength/(2*Nb); % distance between transmitters and receivers
dist = lineLength/2;
if strcmp(type,'inc')
    x = linspace(-dist,+dist-d,Nb);
else % type = meas
    x = linspace(-dist+d,+dist,Nb);
end
Pnts = [linePos*ones(size(x)); x];

end

##### SOURCE END #####
--></body></html>