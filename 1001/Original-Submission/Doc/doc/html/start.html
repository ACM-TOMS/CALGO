
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>start</title><meta name="generator" content="MATLAB 9.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-04-30"><meta name="DC.source" content="start.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>start</h1><!--introduction--><p>Main file of framework <tt>IPscatt</tt> in MATLAB, i.e. <b>Computational Framework in MATLAB for the Inverse Medium Problem in Scattering</b>.</p><p><b>Warning</b>: <tt>start</tt> clears variables and stores figures and files in the folder <tt>output</tt>. The routine <tt>eval</tt> or <tt>feval</tt> is used in <tt>setInput</tt> and <tt>setContrast</tt>.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Quick start</a></li><li><a href="#2">Input "Arguments"</a></li><li><a href="#3">Output "Arguments"</a></li><li><a href="#4">Output: Figures</a></li><li><a href="#5">Advanced starts</a></li><li><a href="#6">Code: Part 1: Initialization, set input and start diary</a></li><li><a href="#7">Code: Part 2: Set data</a></li><li><a href="#8">Code: Part 3: Variational reconstruction</a></li><li><a href="#9">Code: Part 4: End</a></li><li><a href="#10">More About... Theory: The direct and inverse scattering from inhomogeneous media</a></li><li><a href="#11">Authors</a></li><li><a href="#12">References</a></li><li><a href="#13">See Also</a></li></ul></div><h2 id="1">Quick start</h2><p><b>Adviced usage of MATLAB</b></p><p>The toolbox <tt>IPscatt</tt> generates several figures and data, which are saved in the folder <tt>output</tt>. We recommend to start MATLAB with the option nodisplay to avoid annoying pop-ups of figures.</p><pre class="language-matlab">matlab <span class="string">-nodisplay</span>
</pre><p><b>Simple Example</b></p><p>To run the computational framework, i.e. solve the direct scattering problem, add some noise to the data and start the reconstruction process you can just type in</p><pre class="language-matlab">start
</pre><p>The framework <tt>IPscatt</tt> will set some default parameters, do computation, and save the results in the folder <tt>output</tt>.</p><p><b>Change parameters</b></p><p>To compute with other parameters you can set them in a file, e.g. <tt>example</tt>, in the folder <tt>inseti</tt> and refer to this file by Parameter <tt>inseti</tt>, e.g.</p><pre class="language-matlab">inseti = <span class="string">'example'</span>;
start
</pre><p><b>Attention in usage of the framework</b></p><div><ul><li><tt>start</tt> saves figures and files in the folder <tt>output</tt> without demand.   (Adapt <tt>setInput</tt> and set <tt>out</tt> to 0 or 1 instead of 2 to change this behaviour).</li><li><tt>start</tt> calls <tt>setInput</tt>, in which <b>pre-defined variables</b> (except <tt>closed</tt>, <tt>test</tt>, and <tt>inseti</tt>) <b>are deleted</b>.</li><li>Therefore you <b>must define</b> the struct <b><tt>seti</tt> in</b> such a <b>file</b> (and not in terminal).</li><li>The name of a <b>new file in <tt>inseti</tt></b> must differ from existing functions (because the file in <tt>inseti</tt> is called by <tt>eval</tt>).</li><li>The code was written and tested with MATLAB in version <b>R2016a</b>.</li></ul></div><h2 id="2">Input "Arguments"</h2><p>There are no classical input arguments because start is not a function.</p><p>From default deviating parameters in struct <tt>seti</tt> are set as described in the section Quick Start.</p><p>Some input Parameters are described in <a href="example.html">example.html</a>.</p><h2 id="3">Output "Arguments"</h2><p>There are no classical output arguments because start is not a function.</p><p><b>Output results in folder</b></p><p>Output results are saved in a folder created after <tt>start</tt> like this</p><pre class="language-matlab">output/20160907T111711_example_test
</pre><p>Structure of foldername: <tt>seti.dirOutput</tt> + / + <tt>seti.dirDatetime</tt> + <tt>_</tt> + <tt>seti.inseti</tt> + <tt>seti.dirSuffix</tt></p><div><ul><li>seti.dirOutput is set to "output"</li><li>seti.dirDatetime is date and time separated by the character "T"</li><li>seti.inseti is parameter <tt>inseti</tt> set before <tt>start</tt> (otherwise seti.inseti is set to "noinseti")</li><li>seti.dirSuffix can set in the corresponding file in <tt>inseti</tt></li></ul></div><p><b>Content of output folder</b></p><div><ul><li>figures with prefix <tt>fig_</tt>, see table in the next section (possible output formats are png, eps and fig, see <a href="example.html">example.html</a>)</li><li><tt>diary.log</tt>: contains terminal output.</li><li><tt>inseti_...</tt>: contains a copy of the parameters set in the file committed by <tt>inseti</tt>.</li><li>save_Fmeas.mat: contains exact data <img src="start_eq14744956929831768508.png" alt="$\mathcal{F}_\mathrm{meas}$"> and noisy simulated data <img src="start_eq05590365420468375831.png" alt="$\mathcal{F}_\mathrm{meas}^\delta$"> as <tt>FmeasExact</tt> and <tt>FmeasDelta</tt>.</li><li>save_qROIcomp_iOutStop.mat: contains the reconstructed contrast <tt>qROIcomp</tt> and stop index <tt>iOutStop</tt>.</li><li><tt>save_dis.mat</tt>, <tt>save_err.mat</tt>, and <tt>save_dif.mat</tt> are saved if <tt>seti.savedata</tt> equals 1. They contain relative discrepancy, error, and difference of computed contrast to its predecessor.</li></ul></div><h2 id="4">Output: Figures</h2><p>A table of possible plotted and saved figures and their number.</p><p>
<table>
<tr><td><em>Fig. no.</em></td><td><em>Content</em></td></tr>
<tr><td colspan=2></td></tr>
<tr><td></td><td><strong>01-10 Preliminary definitions...</strong></td></tr>
<tr><td colspan=2></td></tr>
<tr><td></td></td><td><code>expSetup.m</code></td></tr>
<tr><td>01</td><td>source and measurement points plot...</td></tr>
<tr><td></td><td><code>setContrast.m</code></td></tr>
<tr><td>02</td><td>predefined contrast (real part)</td></tr>
<tr><td>03</td><td>predefined contrast (imag part)</td></tr>
<tr><td colspan=2></td></tr>
<tr><td>04-10</td><td>currently unused</td></tr>
<tr><td colspan=2></td></tr>
<tr><td></td><td><strong>11-20 Reconstruction</strong></td></tr>
<tr><td colspan=2></td></tr>
<tr><td>11</td><td>Subplots (<code>subplots.m</code>)<br>
  (1,1) ground truth contrast (real part)<br>
  (1,2) reconstructed contrast (real part)<br>
  (2,1) relative error and relative discrepancy<br>
  (2,2) value of Tikhonov function (function to minimize)</td></tr>
<tr><td colspan=2></td></tr>
<tr><td></td><td><code>plotAndSaveFigures.m</code></td></tr>
<tr><td>12</td><td>discrepancy and error (as in subplot)</td></tr>
<tr><td>13</td><td>Tikhonov functional (as in subplots): M1, M2, MT</td></tr>
<tr><td>14</td><td>reconstructed contrast (real part)</td></tr>
<tr><td>15</td><td>reconstructed contrast (imag part)</td></tr>
<tr><td>16</td><td>difference of reconstructed and true contrast (abs) (switched off by <code>if 0</code>)</td></tr>
<tr><td colspan=2></td></tr>
<tr><td>17-20</td><td>currently unused</td></tr>
<tr><td colspan=2></td></tr>
<tr><td></td><td><strong>21-30 Additional for 3D reconstruction (<code>plotAndSaveFigures.m</code>)</strong><br> (contrast in a sectional plane through the scatterer)</td></tr>
<tr><td colspan=2></td></tr>
<tr><td>21-23</td><td>sectional plane through the predefined contrast (1st, 2nd, 3rd direction)</td></tr>
<tr><td>24-26</td><td>sectional plane through the reconstructed contrast (1st, 2nd, 3rd direction)</td></tr>
<tr><td colspan=2></td></tr>
<tr><td>27-30</td><td>currently unused</td></tr>
<tr><td colspan=2></td></tr>
<tr><td></td><td><strong>31-40 PDA specific additional reconstruction plots</strong><br> over inner iterations (<code>pdaPlot.m</code>)</td></tr>
<tr><td colspan=2></td></tr>
<tr><td>31</td><td>Parts of minimization functional: fd, fs, fg, fp</td></tr>
<tr><td>32</td><td>Error in pda and relLinDisInPda</td></tr>
<tr><td>33</td><td>pda lin. disc. and nonlin. disc.</td></tr>
<tr><td>34</td><td>parts of min. func. M1 = F(Kh), M2 = G(h) (switched off by <code>if 0</code>)</td></tr>
<tr><td>35</td><td>ThetaiOut (inner tolerance principle) (switched off by <code>if 0</code>)</td></tr>
<tr><td>36</td><td>tau, sigma values (switched off by <code>if 0</code>, because currently sigma and tau are not saved)</td></tr>
<tr><td colspan=2></td></tr>
<tr><td>37-40</td><td>currently unused</td></tr>
</table>
</p><p><b>For Output figures see also:</b></p><div><ul><li><a href="pdaPlot.html">pdaPlot.html</a></li><li><a href="plotAndSaveFigures.html">plotAndSaveFigures.html</a></li><li><a href="plotExpSetup.html">plotExpSetup.html</a></li><li><a href="plotPredefinedContrast.html">plotPredefinedContrast.html</a></li><li><a href="subplots.html">subplots.html</a></li></ul></div><h2 id="5">Advanced starts</h2><p>It is possible to run the computational framework with various input parameters. Three cases are prepared (others can add similarly).</p><div><ul><li><tt>varalpha.m</tt>: various input parameters for the regularization parameter <img src="start_eq14221827199139923399.png" alt="$\alpha$"> (sparsity).</li><li><tt>varbeta.m</tt>: various input parameters for the regularization parameter <img src="start_eq17331442575217596290.png" alt="$\beta$"> (total variation).</li><li><tt>vardelta.m</tt>: various input parameters for the relative noise level <img src="start_eq06646721004341227832.png" alt="$\delta$">.</li><li><tt>vartol.m</tt>: various input parameters for the tolerance in GMRES.</li></ul></div><p><b>Usage of advanced starts</b></p><p>We demontrate it in case of various <img src="start_eq14221827199139923399.png" alt="$\alpha$"> inputs.</p><p>In file varalpha:</p><pre class="language-matlab">alpha = [100; 500; 1000];
</pre><p>In terminal:</p><pre class="language-matlab">inseti = <span class="string">'example'</span>; <span class="comment">% setting of seti.alpha inside is overwrittten by varalpha</span>
varalpha
</pre><p>A folder in <tt>output</tt> with suffix <tt>varalpha</tt> is created. Reconstruction results for <img src="start_eq14221827199139923399.png" alt="$\alpha$"> = 100, 500, and 1000 are stored inside.</p><h2 id="6">Code: Part 1: Initialization, set input and start diary</h2><div><ul><li><tt>init</tt>: <a href="init.html">init.html</a>: Addpath and set parameter <tt>closed</tt> in <tt>init.m</tt>, which differs between closed and public version of code (new developments are not published yet).</li><li><tt>setInput</tt>: <a href="setInput.html">setInput.html</a>: Creates folder for output; clears variables except of <tt>closed</tt>, <tt>test</tt>, and <tt>inseti</tt>; deals with various input parameters (<tt>varalpha</tt>, <tt>varbeta</tt>, <tt>vardelta</tt>).</li><li>start diary log (output of terminal is stored in diary.log)</li></ul></div><pre class="codeinput">disp(<span class="string">' '</span>)
disp(<span class="string">'################ -------- start of IPscatt ------- ################'</span>)
disp(<span class="string">' '</span>);
disp(<span class="string">'               Computational Framework in MATLAB for               '</span>)
disp(<span class="string">'              the Inverse Medium Problem in Scattering             '</span>)
disp(<span class="string">' '</span>)

<span class="comment">% Initialization</span>
disp(<span class="string">' '</span>)
disp(<span class="string">'## init -- initialization -----------------------------------------'</span>)
disp(<span class="string">' '</span>)
init;

<span class="comment">% Set input and make directories for output</span>
disp(<span class="string">' '</span>)
disp(<span class="string">'## setInput -- set input and make directories for output ----------'</span>)
disp(<span class="string">' '</span>)
setInput;

<span class="comment">% Diary log: start</span>
disp(<span class="string">' '</span>)
disp(<span class="string">'## diary -- start diary log ---------------------------------------'</span>)
disp(<span class="string">' '</span>)
diary(sprintf(<span class="string">'%s/diary%s.log'</span>,seti.dirname,seti.fileSuffix)); <span class="comment">% store all output in diary</span>
diary <span class="string">on</span>; <span class="comment">% later diary off</span>

<span class="comment">% Set output depth out</span>
dispDepth = 4; <span class="comment">% 0: nearly no display messages; 4: default; 5: too much information</span>
out = 2; <span class="comment">% 0: no figures, 1: figures, 2: save figures or files</span>
</pre><h2 id="7">Code: Part 2: Set data</h2><p><tt>setData.m</tt> (<a href="setData.html">setData.html</a>) does the following:</p><div><ul><li>Load real-world data (if set).</li><li>Set geometry and simulation (grid, kernel, experimental set-up, predefined contrast, general settings for figures)</li><li>Compute exact and noisy data.</li></ul></div><pre class="codeinput"><span class="comment">% Set data</span>
disp(<span class="string">' '</span>)
disp(<span class="string">'## setData -- geometry and experimental set-up, noisy data -------'</span>)
disp(<span class="string">' '</span>)
seti = setData(seti,dispDepth,out); <span class="comment">% geometry and simulation and fresnel etc. is inside setData...</span>
</pre><h2 id="8">Code: Part 3: Variational reconstruction</h2><div><ul><li><tt>setRecon.m</tt> (<a href="setRecon.html">setRecon.html</a>): define functions for reconstruction.</li><li><tt>recon.m</tt> (<a href="recon.html">recon.html</a>): reconstruction process: minimize the Tikhonov functional of the linearized problem by primal-dual algorithm and update the contrast <img src="start_eq15226540192103580117.png" alt="$q$"> (in public version). (The functionals are given in the section "More About...").</li></ul></div><pre class="codeinput"><span class="comment">% Settings for variational reconstruction</span>
disp(<span class="string">' '</span>)
disp(<span class="string">'## setRecon -- variational reconstruction -------------------------'</span>)
disp(<span class="string">' '</span>)
seti = setRecon(seti,dispDepth);

<span class="comment">% Variational reconstruction (process)</span>
disp(<span class="string">' '</span>)
disp(<span class="string">'## recon -- variational reconstruction -------------------------'</span>)
disp(<span class="string">' '</span>)
seti = recon(seti,dispDepth,out);
</pre><h2 id="9">Code: Part 4: End</h2><div><ul><li>Define end of diray log.</li><li>Save workspace (if seti.saveworkspace was set to 1)</li></ul></div><pre class="codeinput"><span class="comment">% Diary log: end</span>
disp(<span class="string">' '</span>)
disp(<span class="string">'## diary -- end diary log -----------------------------------------'</span>)
disp(<span class="string">' '</span>)
diary <span class="string">off</span>;

<span class="comment">% Save workspace</span>
seti = checkfield(seti,<span class="string">'saveworkspace'</span>,0);
<span class="keyword">if</span> seti.saveworkspace == 1 &amp;&amp; out &gt;= 2
    disp(<span class="string">' '</span>)
    disp(<span class="string">'## save workspace ---------------------------------------------'</span>)
    disp(<span class="string">' '</span>)
    save(sprintf(<span class="string">'%s/workspace.mat'</span>,seti.dirname));
<span class="keyword">end</span>
</pre><h2 id="10">More About... Theory: The direct and inverse scattering from inhomogeneous media</h2><p>We give a brief description of the direct and inverse scattering problem. A reference is e.g. Chapter 8 in [1].</p><p><b>The direct scattering problem</b></p><p>We consider a time-harmonic <b>incident wave</b> <img src="start_eq17955056331989370200.png" alt="$u^\mathrm{i}: \bf{R}^d \to \bf{C}$"> in dimension <img src="start_eq14616962283446221621.png" alt="$d = 2, 3$"> with time-dependence <img src="start_eq01310570317960254030.png" alt="$\exp(-\mathrm{i} \omega t)$">, where <img src="start_eq13372879926757515673.png" alt="$\omega &gt; 0$"> is the angular frequency.</p><p>When we omit the time-dependence, the incident field satisfies the <b>Helmholtz equation</b></p><p><img src="start_eq17240593728344425693.png" alt="$$ \Delta u^\mathrm{i}(x) + k^2 u^\mathrm{i}(x) = 0, \quad x \in \bf{R}^d $$"></p><p>with constant wave number <img src="start_eq00383446951591459833.png" alt="$k&gt;0$">.</p><p>The scattering object is described by a refractive index function <img src="start_eq15962099678188152594.png" alt="$n: \bf{R}^d \to \bf{C}$">. This function equals <img src="start_eq18395870634560867587.png" alt="$1$"> outside a bounded domain.</p><p>When the incident wave interacts with a scattering object a <b>scattered wave</b> <img src="start_eq14800498341459335450.png" alt="$u^\mathrm{s}$"> is generated. The <b>total wave</b></p><p><img src="start_eq18430275143430390388.png" alt="$$ (1) \quad u^\mathrm{t} := u^\mathrm{i} + u^\mathrm{s} $$"></p><p>admits the <b>Helmholtz equation</b></p><p><img src="start_eq18284400426967197310.png" alt="$$ (2) \quad \Delta u^\mathrm{t} + k^2 n^2 u^\mathrm{t} = 0 \quad \textrm{in } \bf{R}^d $$">.</p><p>The scattered wave <img src="start_eq14800498341459335450.png" alt="$u^\mathrm{s}$"> satisfies <b>Sommerfeld's radiation condition</b></p><p><img src="start_eq07527966949887968477.png" alt="$$ (3) \quad \lim\limits_{|x|\to\infty} |x|^{(d-1)/2}\left(&#xA;\frac{\partial}{\partial |x|} - \mathrm{i} k\right) u^\mathrm{s}(x) = 0, $$"></p><p>uniformly in all directions <img src="start_eq03237635618063195332.png" alt="$\hat x = x/|x| \in \bf{S} := \{ y \in \bf{R}^d: \, |y| =1\}$">, where <img src="start_eq13763856478187137660.png" alt="$|y|:= \sqrt{y_1^2 + \ldots + y_d^2}$">.</p><p>The <b>direct scattering problem</b> is to find a solution <img src="start_eq11776305044305525613.png" alt="$u$"> to equations (1)-(3).</p><p>We will not solve the above PDE. Instead we will solve the "Lippmann-Schwinger equation", which is a equivalent reformulation.</p><p>Further, instead of the refractive index we will consider the contrast</p><p><img src="start_eq17679845396452011158.png" alt="$$ q := n^2-1 \quad \textrm{in } \bf{R}^d. $$"></p><p><b>The inverse scattering problem</b></p><p>Keep in mind that <img src="start_eq08677226525655855328.png" alt="$u^\mathrm{s} = u^\mathrm{t}-u^\mathrm{i}$">. If we know the incident wave <img src="start_eq13857599303689407370.png" alt="$u^\mathrm{i}$"> and measure the total wave <img src="start_eq09352774926291528475.png" alt="$u^\mathrm{t}$">, we can compute the scattered wave <img src="start_eq14800498341459335450.png" alt="$u^\mathrm{s}$">.</p><p>Then the scattered wave is used as data for the <b>inverse scattering problem</b>: Reconstruct the contrast function <i>q</i> from several measurements of the scattered wave.</p><p>For this we will need <b>multi-static measurements</b>, i.e. several transmitters propagate incident waves one after another and the generated scattered fields are measured by several receivers. (In real-world total fields are measured and scattered fields are computed subtracting the corresponding incident fields.)</p><p><b>More theoretical background</b></p><p>The exact techniques how to tackle the direct and inverse scattering from inhomogeneous media are described in [2]. In the next section we have a brief look at the function we minimize for reconstruction.</p><p><b>Function to minimize...</b></p><p><b>... We would like to</b> find a contrast <img src="start_eq15226540192103580117.png" alt="$q$">, that minimizes the Tikhonov functional of the non-linearized problem, i.e.:</p><p><img src="start_eq18166851708465194823.png" alt="$$ \min_{q \in X}&#xA;     \underbrace{\frac{1}{2}\|\mathcal{F}(q)-F_\mathrm{meas}^\delta\|_\mathrm{F}^2}_{\mathrm{discrepancy}}&#xA;   + \underbrace{\alpha \|q\|_\mathrm{1}}_{\mathrm{sparsity\ penalty}}&#xA;   + \underbrace{\beta \| \nabla q \|_\mathrm{1}}_{\mathrm{total\ variation\ penalty}}&#xA;   + \underbrace{&#xA;         \delta_{[a,b]}( \mathrm{Re}(q) ) +&#xA;         \delta_{[c,d]}(\mathrm{Im}(q) )}_{\mathrm{penalty\ for\ physical\ bounds}&#xA;         }.&#xA;   $$"></p><div><ul><li><img src="start_eq09655200843768505894.png" alt="$\|\cdot\|_\mathrm{F}$"> is the Frobenius norm.</li><li>Actually all norms are weighted. (We ommit it to keep notation simple.)</li><li><img src="start_eq12621905405638516729.png" alt="$\delta_{[a,b]}(x)$"> is a indicator function, i.e.   is 0, if all entries of the vector x are between <img src="start_eq05508344529756732484.png" alt="$a$"> and <img src="start_eq02044268985122151499.png" alt="$b$">,   and is <img src="start_eq16739024125614530807.png" alt="$\infty$">, otherwise.</li></ul></div><p><b>... What we do</b> is to minimize the Tikhonov functional of the linearized problem, i.e. (this is done in <a href="pda.html">pda.html</a>)</p><p><img src="start_eq17549916563290821586.png" alt="$$ \min_{h \in X}&#xA;     \underbrace{\frac{1}{2}\|\mathcal{F}'(q)[h]+\mathcal{F}(q) - F_\mathrm{meas}^\delta\|_\mathrm{F}^2}_{\mathrm{discrepancy\ (linearized\ problem)}}&#xA;   + \underbrace{\alpha \|q+h\|_\mathrm{1}}_{\mathrm{sparsity\ penalty}}&#xA;   + \underbrace{\beta \| \nabla (q+h) \|_\mathrm{1}}_{\mathrm{total\ variation\ penalty}}&#xA;   + \underbrace{&#xA;         \delta_{[a,b]}( \mathrm{Re}(q+h) ) +&#xA;         \delta_{[c,d]}(\mathrm{Im}(q+h) )}_{\mathrm{penalty\ for\ physical\ bounds}&#xA;         }&#xA;   $$"></p><p>and then update <img src="start_eq18145746415082390862.png" alt="$q := q + h$"> (this is done in <a href="minPda.html">minPda.html</a>).</p><p>Next, the Tikhonov functional of the linearized problem is minimized again. (This minimization is done by application of primal-dual algorithm, see [3], on this problem, see [2].)</p><p>The whole process minimizes the Tikhonov functional of the non-linearized inversion problem and leads to the seeked contrast <img src="start_eq15226540192103580117.png" alt="$q$">.</p><h2 id="11">Authors</h2><p>The authors of <tt>IPscatt</tt> are:</p><div><ul><li>Florian B&uuml;rgel (Center for Industrial Mathematics, University of Bremen, Germany, <a href="mailto:fbuergel@uni-bremen.de">fbuergel@uni-bremen.de</a>.)</li><li>Kamil S. Kazimierski (Institute of Mathematics and Scientific Computing, University of Graz, Austria, <a href="mailto:kazimier@uni-graz.at">kazimier@uni-graz.at</a>. The Institute of Mathematics and Scientific Computing is a member of NAWI Graz (www.nawigraz.at) and BioTechMed Graz (www.biotechmed.at).)</li><li>Armin Lechleiter (Center for Industrial Mathematics, University of Bremen, Germany.)</li></ul></div><p>Note that the source code of <a href="gmresKelley.html">gmresKelley.html</a> in the folder <tt>3rdparty</tt> was not written by the authors and contains the corresponding license information.</p><h2 id="12">References</h2><div><ul><li>[1] David Colton and Rainer Kress. <i>Inverse Acoustic and Electromagnetic Scattering Theory</i>. Springer, New York, 2013.</li><li>[2] Florian B&uuml;rgel, Kamil S. Kazimierski, and Armin Lechleiter. A sparsity regularization and total variation based computational framework for the inverse medium problem in scattering. <i>Journal of Computational Physics</i>, 339:1-30, 2017.</li><li>[3] Antonin Chambolle and Thomas Pock. A first-order primal-dual algorithm for convex problems with applications to imaging. <i>Journal of Mathematical Imaging and Vision</i>, 40(1):120-145, 2011.</li></ul></div><h2 id="13">See Also</h2><div><ul><li><a href="example.html">example.html</a></li></ul></div><div><ul><li><a href="varalpha.html">varalpha.html</a></li><li><a href="varbeta.html">varbeta.html</a></li><li><a href="vardelta.html">vardelta.html</a></li><li><a href="vartol.html">vartol.html</a></li></ul></div><div><ul><li><a href="init.html">init.html</a></li><li><a href="setInput.html">setInput.html</a></li><li><a href="setData.html">setData.html</a></li><li><a href="setRecon.html">setRecon.html</a></li><li><a href="recon.html">recon.html</a></li></ul></div><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2018b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% start
% Main file of framework |IPscatt| in MATLAB, i.e. 
% *Computational Framework in MATLAB for the Inverse Medium Problem in Scattering*.
%
% *Warning*: |start| clears variables and stores figures and files in the
% folder |output|. The routine |eval| or |feval| is used in |setInput| and
% |setContrast|.
%
%
%% Quick start
%
% *Adviced usage of MATLAB*
%
% The toolbox |IPscatt| generates several figures and data, which are saved in the folder |output|. 
% We recommend to start MATLAB with the option nodisplay to avoid annoying pop-ups of figures. 
%
%   matlab -nodisplay
%
% *Simple Example*
%
% To run the computational framework, i.e. solve the direct scattering
% problem, add some noise to the data and start the reconstruction process 
% you can just type in
%
%   start
%
% The framework |IPscatt| will set some default parameters, do 
% computation, and save the results in the folder |output|.
%
% *Change parameters*
%
% To compute with other parameters you can set them in a file, e.g. |example|,
% in the folder |inseti| and refer to this file by Parameter |inseti|, e.g.
%
%   inseti = 'example';
%   start
%
% *Attention in usage of the framework*
%
% * |start| saves figures and files in the folder |output| without demand.
%   (Adapt |setInput| and set |out| to 0 or 1 instead of 2 to change this
% behaviour).
% * |start| calls |setInput|, in which *pre-defined variables* (except |closed|, |test|, and |inseti|) *are deleted*.
% * Therefore you *must define* the struct *|seti| in* such a *file* (and not in terminal).
% * The name of a *new file in |inseti|* must differ from existing functions
% (because the file in |inseti| is called by |eval|).
% * The code was written and tested with MATLAB in version *R2016a*.
% 
%
%% Input "Arguments"
% There are no classical input arguments because start is not a function.
%
% From default deviating parameters in struct |seti| are set as described
% in the section Quick Start.
%
% Some input Parameters are described in <example.html>.
%
%
%% Output "Arguments"
% There are no classical output arguments because start is not a function.
%
% *Output results in folder*
%
% Output results are saved in a folder created after |start| like this
%
%   output/20160907T111711_example_test
%
% Structure of foldername: |seti.dirOutput| + / + |seti.dirDatetime| + |_| + |seti.inseti| + |seti.dirSuffix|
% 
% * seti.dirOutput is set to "output"
% * seti.dirDatetime is date and time separated by the character "T"
% * seti.inseti is parameter |inseti| set before |start| (otherwise
% seti.inseti is set to "noinseti")
% * seti.dirSuffix can set in the corresponding file in |inseti|
%
% *Content of output folder*
%
% * figures with prefix |fig_|, see table in the next section (possible
% output formats are png, eps and fig, see <example.html>)
% * |diary.log|: contains terminal output.
% * |inseti_...|: contains a copy of the parameters set in the file
% committed by |inseti|.
% * save_Fmeas.mat: contains exact data $\mathcal{F}_\mathrm{meas}$ and
% noisy simulated data $\mathcal{F}_\mathrm{meas}^\delta$ as 
% |FmeasExact| and |FmeasDelta|.
% * save_qROIcomp_iOutStop.mat: contains the reconstructed contrast
% |qROIcomp| and stop index |iOutStop|.
% * |save_dis.mat|, |save_err.mat|, and |save_dif.mat| are saved if
% |seti.savedata| equals 1. They contain relative discrepancy, error, and difference of 
% computed contrast to its predecessor.
%
%
%% Output: Figures
% A table of possible plotted and saved figures and their number.
%
% <html>
% <table>
% <tr><td><em>Fig. no.</em></td><td><em>Content</em></td></tr>
% <tr><td colspan=2></td></tr>
% <tr><td></td><td><strong>01-10 Preliminary definitions...</strong></td></tr>
% <tr><td colspan=2></td></tr>
% <tr><td></td></td><td><code>expSetup.m</code></td></tr>
% <tr><td>01</td><td>source and measurement points plot...</td></tr>
% <tr><td></td><td><code>setContrast.m</code></td></tr>
% <tr><td>02</td><td>predefined contrast (real part)</td></tr>
% <tr><td>03</td><td>predefined contrast (imag part)</td></tr>
% <tr><td colspan=2></td></tr>
% <tr><td>04-10</td><td>currently unused</td></tr>
% <tr><td colspan=2></td></tr>
% <tr><td></td><td><strong>11-20 Reconstruction</strong></td></tr>
% <tr><td colspan=2></td></tr>
% <tr><td>11</td><td>Subplots (<code>subplots.m</code>)<br>
%   (1,1) ground truth contrast (real part)<br>
%   (1,2) reconstructed contrast (real part)<br>
%   (2,1) relative error and relative discrepancy<br>
%   (2,2) value of Tikhonov function (function to minimize)</td></tr>
% <tr><td colspan=2></td></tr>
% <tr><td></td><td><code>plotAndSaveFigures.m</code></td></tr>
% <tr><td>12</td><td>discrepancy and error (as in subplot)</td></tr>
% <tr><td>13</td><td>Tikhonov functional (as in subplots): M1, M2, MT</td></tr>
% <tr><td>14</td><td>reconstructed contrast (real part)</td></tr>
% <tr><td>15</td><td>reconstructed contrast (imag part)</td></tr>
% <tr><td>16</td><td>difference of reconstructed and true contrast (abs) (switched off by <code>if 0</code>)</td></tr>
% <tr><td colspan=2></td></tr>
% <tr><td>17-20</td><td>currently unused</td></tr>
% <tr><td colspan=2></td></tr>
% <tr><td></td><td><strong>21-30 Additional for 3D reconstruction (<code>plotAndSaveFigures.m</code>)</strong><br> (contrast in a sectional plane through the scatterer)</td></tr>
% <tr><td colspan=2></td></tr>
% <tr><td>21-23</td><td>sectional plane through the predefined contrast (1st, 2nd, 3rd direction)</td></tr>
% <tr><td>24-26</td><td>sectional plane through the reconstructed contrast (1st, 2nd, 3rd direction)</td></tr>
% <tr><td colspan=2></td></tr>
% <tr><td>27-30</td><td>currently unused</td></tr>
% <tr><td colspan=2></td></tr>
% <tr><td></td><td><strong>31-40 PDA specific additional reconstruction plots</strong><br> over inner iterations (<code>pdaPlot.m</code>)</td></tr>
% <tr><td colspan=2></td></tr>
% <tr><td>31</td><td>Parts of minimization functional: fd, fs, fg, fp</td></tr>
% <tr><td>32</td><td>Error in pda and relLinDisInPda</td></tr>
% <tr><td>33</td><td>pda lin. disc. and nonlin. disc.</td></tr>
% <tr><td>34</td><td>parts of min. func. M1 = F(Kh), M2 = G(h) (switched off by <code>if 0</code>)</td></tr>
% <tr><td>35</td><td>ThetaiOut (inner tolerance principle) (switched off by <code>if 0</code>)</td></tr>
% <tr><td>36</td><td>tau, sigma values (switched off by <code>if 0</code>, because currently sigma and tau are not saved)</td></tr>
% <tr><td colspan=2></td></tr>
% <tr><td>37-40</td><td>currently unused</td></tr>
% </table>
% </html>
%
% *For Output figures see also:*
%
% * <pdaPlot.html>
% * <plotAndSaveFigures.html>
% * <plotExpSetup.html>
% * <plotPredefinedContrast.html>
% * <subplots.html>
%
%% Advanced starts
%
% It is possible to run the computational framework with various input
% parameters. Three cases are prepared (others can add similarly).
%
% * |varalpha.m|: various input parameters for the regularization parameter
% $\alpha$ (sparsity).
% * |varbeta.m|: various input parameters for the regularization parameter
% $\beta$ (total variation).
% * |vardelta.m|: various input parameters for the relative noise level $\delta$.
% * |vartol.m|: various input parameters for the tolerance in GMRES.
%
% *Usage of advanced starts*
%
% We demontrate it in case of various $\alpha$ inputs.
%
% In file varalpha:
% 
%   alpha = [100; 500; 1000];
%
% In terminal:
%
%   inseti = 'example'; % setting of seti.alpha inside is overwrittten by varalpha
%   varalpha
%
% A folder in |output| with suffix |varalpha| is created. Reconstruction
% results for $\alpha$ = 100, 500, and 1000 are stored inside.
%
%

%% Code: Part 1: Initialization, set input and start diary
%
% * |init|: <init.html>: Addpath and set parameter |closed| in |init.m|, which differs between
% closed and public version of code (new developments are not published yet).
% * |setInput|: <setInput.html>: Creates folder for output; clears
% variables except of |closed|, |test|, and |inseti|; deals with various input parameters (|varalpha|, |varbeta|, |vardelta|).
% * start diary log (output of terminal is stored in diary.log)
%

disp(' ')
disp('################ REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH start of IPscatt REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH- ################')
disp(' ');
disp('               Computational Framework in MATLAB for               ')
disp('              the Inverse Medium Problem in Scattering             ')
disp(' ')

% Initialization
disp(' ')
disp('## init REPLACE_WITH_DASH_DASH initialization REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-')
disp(' ')
init;

% Set input and make directories for output
disp(' ')
disp('## setInput REPLACE_WITH_DASH_DASH set input and make directories for output REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH')
disp(' ')
setInput;

% Diary log: start
disp(' ')
disp('## diary REPLACE_WITH_DASH_DASH start diary log REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-')
disp(' ')
diary(sprintf('%s/diary%s.log',seti.dirname,seti.fileSuffix)); % store all output in diary
diary on; % later diary off

% Set output depth out
dispDepth = 4; % 0: nearly no display messages; 4: default; 5: too much information
out = 2; % 0: no figures, 1: figures, 2: save figures or files

%% Code: Part 2: Set data
% 
% |setData.m| (<setData.html>) does the following:
%
% * Load real-world data (if set).
% * Set geometry and simulation (grid, kernel, experimental set-up,
% predefined contrast, general settings for figures)
% * Compute exact and noisy data.

% Set data
disp(' ')
disp('## setData REPLACE_WITH_DASH_DASH geometry and experimental set-up, noisy data REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-')
disp(' ')
seti = setData(seti,dispDepth,out); % geometry and simulation and fresnel etc. is inside setData...

%% Code: Part 3: Variational reconstruction
%
% * |setRecon.m| (<setRecon.html>): define functions for reconstruction.
% * |recon.m| (<recon.html>): reconstruction process: minimize the 
% Tikhonov functional of the linearized problem by primal-dual algorithm
% and update the contrast $q$ (in public version).
% (The functionals are given in the section "More About...").
%

% Settings for variational reconstruction
disp(' ')
disp('## setRecon REPLACE_WITH_DASH_DASH variational reconstruction REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-')
disp(' ')
seti = setRecon(seti,dispDepth);

% Variational reconstruction (process)
disp(' ')
disp('## recon REPLACE_WITH_DASH_DASH variational reconstruction REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-')
disp(' ')
seti = recon(seti,dispDepth,out);

%% Code: Part 4: End
%
% * Define end of diray log.
% * Save workspace (if seti.saveworkspace was set to 1)

% Diary log: end
disp(' ')
disp('## diary REPLACE_WITH_DASH_DASH end diary log REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-')
disp(' ')
diary off;

% Save workspace
seti = checkfield(seti,'saveworkspace',0);
if seti.saveworkspace == 1 && out >= 2
    disp(' ')
    disp('## save workspace REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-')
    disp(' ')
    save(sprintf('%s/workspace.mat',seti.dirname));
end

%% More About... Theory: The direct and inverse scattering from inhomogeneous media
%
% We give a brief description of the direct and inverse scattering problem.
% A reference is e.g. Chapter 8 in [1].
%
% *The direct scattering problem*
%
% We consider a time-harmonic *incident wave* $u^\mathrm{i}: \bf{R}^d \to \bf{C}$ in dimension $d = 2, 3$ 
% with time-dependence $\exp(-\mathrm{i} \omega t)$, where $\omega > 0$ is the angular frequency. 
% 
% When we omit the time-dependence, the incident field satisfies the
% *Helmholtz equation* 
% 
% $$ \Delta u^\mathrm{i}(x) + k^2 u^\mathrm{i}(x) = 0, \quad x \in \bf{R}^d $$
% 
% with constant wave number $k>0$.
%
% The scattering object is described by a refractive index function
% $n: \bf{R}^d \to \bf{C}$.
% This function equals $1$ outside a bounded domain.
% 
% When the incident wave interacts with a scattering object 
% a *scattered wave* $u^\mathrm{s}$ is generated. 
% The *total wave*
%
% $$ (1) \quad u^\mathrm{t} := u^\mathrm{i} + u^\mathrm{s} $$
%
% admits the *Helmholtz equation*
%
% $$ (2) \quad \Delta u^\mathrm{t} + k^2 n^2 u^\mathrm{t} = 0 \quad \textrm{in } \bf{R}^d $$.
%
% The scattered wave $u^\mathrm{s}$ satisfies 
% *Sommerfeld's radiation condition*
% 
% $$ (3) \quad \lim\limits_{|x|\to\infty} |x|^{(d-1)/2}\left(
% \frac{\partial}{\partial |x|} - \mathrm{i} k\right) u^\mathrm{s}(x) = 0, $$
%
% uniformly in all directions 
% $\hat x = x/|x| \in \bf{S} := \{ y \in \bf{R}^d: \, |y| =1\}$, 
% where $|y|:= \sqrt{y_1^2 + \ldots + y_d^2}$.
%
% The *direct scattering problem* is to find a solution $u$ to equations (1)-(3).
% 
% We will not solve the above PDE. Instead we will solve the
% "Lippmann-Schwinger equation", which is a equivalent reformulation.
%
% Further, instead of the refractive index we will consider the contrast
%
% $$ q := n^2-1 \quad \textrm{in } \bf{R}^d. $$
%
% *The inverse scattering problem*
%
% Keep in mind that $u^\mathrm{s} = u^\mathrm{t}-u^\mathrm{i}$. 
% If we know the incident wave $u^\mathrm{i}$ and measure the total wave $u^\mathrm{t}$, 
% we can compute the scattered wave $u^\mathrm{s}$.
% 
% Then the scattered wave is used as data for the *inverse scattering problem*: 
% Reconstruct the contrast function _q_ from several measurements of the scattered wave.
%
% For this we will need *multi-static measurements*, i.e. several
% transmitters propagate incident waves one after another and the generated
% scattered fields are measured by several receivers. (In real-world total 
% fields are measured and scattered fields are computed subtracting the 
% corresponding incident fields.)
%
% *More theoretical background*
%
% The exact techniques how to tackle the direct and inverse scattering from 
% inhomogeneous media are described in [2]. In the next section we have a
% brief look at the function we minimize for reconstruction.
%
% *Function to minimize...*
%
% *... We would like to* find a contrast $q$, that minimizes the Tikhonov
% functional of the non-linearized problem, i.e.:
%
% $$ \min_{q \in X} 
%      \underbrace{\frac{1}{2}\|\mathcal{F}(q)-F_\mathrm{meas}^\delta\|_\mathrm{F}^2}_{\mathrm{discrepancy}}
%    + \underbrace{\alpha \|q\|_\mathrm{1}}_{\mathrm{sparsity\ penalty}}
%    + \underbrace{\beta \| \nabla q \|_\mathrm{1}}_{\mathrm{total\ variation\ penalty}}
%    + \underbrace{
%          \delta_{[a,b]}( \mathrm{Re}(q) ) +
%          \delta_{[c,d]}(\mathrm{Im}(q) )}_{\mathrm{penalty\ for\ physical\ bounds}
%          }.
%    $$
%
% * $\|\cdot\|_\mathrm{F}$ is the Frobenius norm.
% * Actually all norms are weighted. (We ommit it to keep notation simple.)
% * $\delta_{[a,b]}(x)$ is a indicator function, i.e. 
%   is 0, if all entries of the vector x are between $a$ and $b$,
%   and is $\infty$, otherwise.
%
% *... What we do* is to minimize the Tikhonov functional of the linearized
% problem, i.e. (this is done in <pda.html>)
%
% $$ \min_{h \in X} 
%      \underbrace{\frac{1}{2}\|\mathcal{F}'(q)[h]+\mathcal{F}(q) - F_\mathrm{meas}^\delta\|_\mathrm{F}^2}_{\mathrm{discrepancy\ (linearized\ problem)}}
%    + \underbrace{\alpha \|q+h\|_\mathrm{1}}_{\mathrm{sparsity\ penalty}}
%    + \underbrace{\beta \| \nabla (q+h) \|_\mathrm{1}}_{\mathrm{total\ variation\ penalty}}
%    + \underbrace{
%          \delta_{[a,b]}( \mathrm{Re}(q+h) ) +
%          \delta_{[c,d]}(\mathrm{Im}(q+h) )}_{\mathrm{penalty\ for\ physical\ bounds}
%          }
%    $$
%
% and then update $q := q + h$ (this is done in <minPda.html>).
%
% Next, the Tikhonov functional of the linearized problem
% is minimized again. (This minimization is done by application of primal-dual algorithm,
% see [3], on this problem, see [2].)
%
% The whole process minimizes the Tikhonov functional of the non-linearized
% inversion problem and leads to the seeked contrast $q$.
%
%
%% Authors
% The authors of |IPscatt| are:
%
% * Florian B&uuml;rgel (Center for Industrial Mathematics, University of Bremen, Germany, fbuergel@uni-bremen.de.)
% * Kamil S. Kazimierski (Institute of Mathematics and Scientific Computing, University of Graz, Austria, kazimier@uni-graz.at. The Institute of Mathematics and Scientific Computing is a member of NAWI Graz (www.nawigraz.at) and BioTechMed Graz (www.biotechmed.at).)
% * Armin Lechleiter (Center for Industrial Mathematics, University of Bremen, Germany.)
%
% Note that the source code of <gmresKelley.html> in the folder |3rdparty| was not written by the authors and contains the corresponding license information.
%
%% References
%
% * [1] David Colton and Rainer Kress. _Inverse Acoustic and Electromagnetic Scattering Theory_. Springer, New York, 2013.
% * [2] Florian B&uuml;rgel, Kamil S. Kazimierski, and Armin Lechleiter. A sparsity regularization and total variation based computational framework for the inverse medium problem in scattering. _Journal of Computational Physics_, 339:1-30, 2017.
% * [3] Antonin Chambolle and Thomas Pock. A first-order primal-dual algorithm for convex problems with applications to imaging. _Journal of Mathematical Imaging and Vision_, 40(1):120-145, 2011.
%
%% See Also
%
% * <example.html>
%
% * <varalpha.html>
% * <varbeta.html>
% * <vardelta.html>
% * <vartol.html>
%
% * <init.html>
% * <setInput.html>
% * <setData.html>
% * <setRecon.html>
% * <recon.html>

##### SOURCE END #####
--></body></html>