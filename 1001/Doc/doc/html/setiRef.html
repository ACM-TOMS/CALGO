
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>Reference of the structure array seti</title><meta name="generator" content="MATLAB 9.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-04-30"><meta name="DC.source" content="setiRef.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>Reference of the structure array seti</h1><!--introduction--><p>Descriptions of fields of structure array seti.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">More About this file</a></li><li><a href="#2">setInput: Input Arguments</a></li><li><a href="#3">setInput: Output Arguments</a></li><li><a href="#4">setInput:dirMake: Input Arguments</a></li><li><a href="#5">setInput:dirMake: Output Arguments</a></li><li><a href="#6">setData: Input Arguments</a></li><li><a href="#7">setData: Output Arguments</a></li><li><a href="#8">setData: checkConsisExpData: Input Arguments</a></li><li><a href="#9">setData:checkConsisExpData: Output Arguments</a></li><li><a href="#10">setData:loadData: Input Arguments</a></li><li><a href="#11">setData:loadData: Output Arguments</a></li><li><a href="#12">setData:loadData:matchIncField: Input Arguments</a></li><li><a href="#13">setData:loadData:matchIncField: Output Arguments</a></li><li><a href="#14">setData:setGeomSim: Input Arguments</a></li><li><a href="#15">setData:setGeomSim: Output Arguments</a></li><li><a href="#16">setData:setGeomSim: setGrid: Input Arguments</a></li><li><a href="#17">setData:setGeomSim: setGrid: Output Arguments</a></li><li><a href="#18">setData:setGeomSim:setReshapeVecMat: Input Arguments</a></li><li><a href="#19">setData:setGeomSim:setReshapeVecMat: Output Arguments</a></li><li><a href="#20">setData:setGeomSim:setGridScale: Input Arguments</a></li><li><a href="#21">setData:setGeomSim:setGridScale: Output Arguments</a></li><li><a href="#22">setData:setGeomSim:setIdImagReal: Input Arguments</a></li><li><a href="#23">setData:setGeomSim:setIdImagReal: Output Arguments</a></li><li><a href="#24">setData:setGeomSim:setKernel: Input Arguments</a></li><li><a href="#25">setData:setGeomSim:setKernel: Output Arguments</a></li><li><a href="#26">setData:setGeomSim:expSetup: Input Arguments</a></li><li><a href="#27">Input Arguments</a></li><li><a href="#28">setData:setGeomSim:expSetup: Output Arguments</a></li><li><a href="#29">setData:setGeomSim:expSetup:setIncPnts: Input Arguments</a></li><li><a href="#30">setData:setGeomSim:expSetup:setIncPnts: Output Arguments</a></li><li><a href="#31">setData:setGeomSim:setMeasPnts: Input Arguments</a></li><li><a href="#32">setData:setGeomSim:setMeasPnts: Output Arguments</a></li><li><a href="#33">setData:setGeomSim:setIncField: Input Arguments</a></li><li><a href="#34">setData:setGeomSim:setIncField: Output Arguments</a></li><li><a href="#35">setData:setGeomSim:setMeasKer: Input Arguments</a></li><li><a href="#36">setData:setGeomSim:setMeasKer: Output Arguments</a></li><li><a href="#37">setData:setGeomSim:setContrast: Input Arguments</a></li><li><a href="#38">setData:setGeomSim:setContrast: Output Arguments</a></li><li><a href="#39">setData:mimo: Input Arguments</a></li><li><a href="#40">setData:mimo: Output Arguments</a></li><li><a href="#41">setData:addNoise: Input Arguments</a></li><li><a href="#42">setData:addNoise: Output Arguments</a></li><li><a href="#43">setRecon: Input Arguments</a></li><li><a href="#44">setRecon: Output Arguments</a></li><li><a href="#45">setRecon:setInvType: Input Arguments</a></li><li><a href="#46">setRecon:setInvType: Output Arguments</a></li><li><a href="#47">setRecon: checkConsisRec: Input Arguments</a></li><li><a href="#48">setRecon:checkConsisRec: Output Argument</a></li><li><a href="#49">setRecon:shrinkFuncs: Input Arguments</a></li><li><a href="#50">setRecon:shrinkFuncs: Output Arguments</a></li><li><a href="#51">setRecon:setFuncsPda: Input Arguments</a></li><li><a href="#52">setRecon:setFuncsPda: Output Arguments</a></li><li><a href="#53">recon: Input Arguments</a></li><li><a href="#54">recon: Output Arguments</a></li><li><a href="#55">recon: subplots: Input Arguments</a></li><li><a href="#56">recon: subplots: Output Arguments</a></li><li><a href="#57">recon: plotAndSaveFigures: Input Arguments</a></li><li><a href="#58">recon: plotAndSaveFigures: Output Arguments</a></li><li><a href="#59">recon: pdaPlot: Input Arguments</a></li><li><a href="#60">recon: pdaPlot: Output Arguments</a></li><li><a href="#61">recon: minPda: Input Arguments</a></li><li><a href="#62">recon: minPda: Output Arguments</a></li><li><a href="#63">recon: minPda: minTolIn: Input Arguments</a></li><li><a href="#64">recon: minPda: minTolIn: Output Arguments</a></li><li><a href="#65">recon: minPda: minTolOut: Input Arguments</a></li><li><a href="#66">recon: minPda: minTolOut: Output Arguments</a></li><li><a href="#67">recon: minPda: pda: Input Arguments</a></li><li><a href="#68">recon: minPda: pda: Output Arguments</a></li></ul></div><h2 id="1">More About this file</h2><div><ul><li>This file summarizes the fields of the main structure array <tt>seti</tt> for each function in one file.</li><li>Therefore we copied the descriptions of the fields seti, that are available in the sections "Input Arguments" and "Output arguments" of the source code documentation of each file (the order bases on <a href="programStructure.html">programStructure.html</a>). Therefore duplicates will occur. Please note that we only summarized the fields of <tt>seti</tt>. For other input or output arguments see the source code documentation of the corresponding file.</li><li>In the headlines we do not describe the path but the dependence of the function, e.g. <tt>setData:setGeomSim</tt> does mean that the routine <tt>setGeomSim</tt> depends on the function <tt>setData</tt>.</li><li>The dependence starts at the function <tt>start</tt>.</li></ul></div><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="2">setInput: Input Arguments</h2><p>All fields are set automatically, if they does not exist:</p><div><ul><li>seti.dirOutput  :   name of folder in which directories for output                       files and figures are created.                       (default: 'output')</li><li>seti.dirDatetime    :   date and time separated by the character "T",                           e.g. 20161006T105735.</li><li>seti.dirSuffix      :   suffix for dirname (default: '')</li><li>seti.dirSuffixAdd   :   additional suffix of dirname                           (e.g. in case of varalpha, varbeta, vardelta, gscale; or expData is 'fresnel')</li><li>seti.dirname        :   dirname of files and figures for current                           computation, default:                           <tt>seti.dirOutput + / + seti.datetime + _ + seti.inseti + seti.dirSuffix + seti.dirSuffixAdd</tt>                           If seti.inseti is empty, 'noinseti' is used in                           dirname, e.g.                           <tt>seti.dirname =                           'output/20161006T102740_noinseti'</tt>. Not set automatically:</li></ul></div><div><ul><li>seti.expData : see <a href="setData.html">setData.html</a></li></ul></div><h2 id="3">setInput: Output Arguments</h2><div><ul><li>seti.dirDatetime    : date and time (format: YYYYMMDDThhmmss)</li><li>seti.fileSuffix     : suffix name for filename</li></ul></div><div><ul><li>seti.inseti     :   name of function including input parameters in folder inseti.</li><li>seti.closed     :   is always 0 in public version                       (value 1 would mean that closed code is available)                        (see also <a href="init.html">init.html</a> for variable <tt>closed</tt>)</li></ul></div><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="4">setInput:dirMake: Input Arguments</h2><p>seti : structural array</p><p><i>The following fields can be set by user (otherwise set default values):</i></p><div><ul><li>seti.gscale  : grid scaling on (1) or off (0), see <a href="setGridScale.html">setGridScale.html</a></li><li>seti.expData : e.g. 'fresnel' if data from Institute Fresnel are used, see <a href="setData.html">setData.html</a></li></ul></div><p>See <a href="setInput.html">setInput.html</a> for the following fields (they can be defined by user too):</p><div><ul><li>seti.dirOutput</li><li>seti.dirDatetime</li><li>seti.dirSuffix</li><li>seti.dirSuffixAdd</li><li>seti.dirname</li></ul></div><h2 id="5">setInput:dirMake: Output Arguments</h2><p>Several fields in seti, if they was not set as input argument; see above.</p><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="6">setData: Input Arguments</h2><p>We only mention explictly the input arguments to deal with experimentally measured data from Institute Fresnel.</p><div><ul><li>seti.expData    :   Set 'fresnel' to load real-world data                       (experimentally measured) from Institute Fresnel.</li></ul></div><p><b>The following parameters can be set by user only in case of  seti.expData = 'fresnel'</b></p><p>For further details see <a href="loadData.html">loadData.html</a> and <a href="matchIncField.html">matchIncField.html</a>.</p><div><ul><li>seti.fresnelFreq    :   frequency of Fresnel data set in Hz                           (default: 5e+09)</li><li>seti.fresnelFile    :   path to real-world data                           (default:                           'inexpdata/fresnel_opus_1/twodielTM_8f.exp')                           (Make sure to use data with <tt>TM</tt> in the filemname,                           which stands for transverse magnetic (TM)                           polarization, because the Helmholtz equation                           only models electromagnetic waves in the TM                           case, see Section 2 in [1].)</li><li>seti.nuMax          :   match incident field parameter (default: 7)</li><li>seti.ampCalc        :   method to compute the coefficients c (1, 2 or 3),                           we recommend to use method 1.</li></ul></div><h2 id="7">setData: Output Arguments</h2><div><ul><li>seti    :   structure array</li></ul></div><p>For the following output arguments see <a href="setGeomSim.html">setGeomSim.html</a>:</p><div><ul><li>seti.tol</li></ul></div><p>For the following output arguments see Subfunction <tt>setFigureSettings</tt> in <a href="setGeomSim.html">setGeomSim.html</a>:</p><p><i>Can be set by user (otherwise default is set)</i>:</p><div><ul><li>seti.plotFreq       :   default: 1</li><li>seti.usecbarlim     :   default: 1</li><li>seti.cbarlim        :   default: [-0.2 1.4]</li><li>seti.plotPublish    :   default: 0</li><li>seti.pubFontSize    :   default: 20</li><li>seti.plotVisible    :   default: 'off'</li><li>seti.savepng        :   default: 1</li><li>seti.saveepsc       :   default: 0</li><li>seti.savefig        :   default: 0</li><li>seti.plotFreqiPda   :   default: 0</li></ul></div><p>For the following output arguments see <a href="setGrid.html">setGrid.html</a>:</p><p><i>Can be set by user (otherwise default is set)</i>:</p><div><ul><li>seti.dim            :   default: 2</li><li>seti.rCD            :   default: 0.2</li><li>seti.nCD            :   default: 256</li></ul></div><p><i>Are set automatically</i>:</p><div><ul><li>seti.h              :   2*rCD/nCD</li><li>seti.dV</li><li>seti.grid           :   size: seti.dim x seti.nCD^seti.dim</li><li>seti.ballMask       :   size: seti.nCD x seti.nCD (logical)</li><li>seti.nROI</li><li>seti.gridROI        :   size: seti.dim x seti.nROI^seti.dim</li><li>seti.ROImask        :   size: nCD x nCD (logical)</li><li>seti.ballMaskROI    :   size: nROI x nROI (logical)</li></ul></div><p>For the following output arguments see <a href="setReshapeVecMat.html">setReshapeVecMat.html</a>:</p><p><i>Are set automatically:</i></p><div><ul><li>seti.GROI</li><li>seti.GCD</li><li>seti.G</li><li>seti.iG</li></ul></div><p>For the following output arguments see <a href="setGridScale.html">setGridScale.html</a>:</p><p><i>Can be set by user (otherwise default is set)</i>:</p><div><ul><li>seti.gscale     : default: 0</li><li>seti.nCDinv     :</li></ul></div><p><i>Are set automatically:</i></p><div><ul><li>seti.nInv       :</li><li>seti.hInv       :</li><li>seti.dVinv      :</li><li>seti.GInv       :</li><li>seti.GU         :</li><li>seti.GD         :</li></ul></div><p>For the following output arguments see <a href="setIdImagReal.html">setIdImagReal.html</a>:</p><p><i>Are set automatically:</i></p><div><ul><li>seti.S  :</li><li>seti.R  :</li><li>seti.I  :</li><li>seti.T  :</li></ul></div><p>For the following output arguments see <a href="setKernel.html">setKernel.html</a>:</p><p><i>Can be set by user (otherwise default is set)</i>:</p><div><ul><li>seti.k      : default: 250</li><li>seti.model  : default: 'helmholtz2D'</li></ul></div><p><i>Are set automatically:</i></p><div><ul><li>seti.kHat   : size nCD x nCD</li></ul></div><p>For the following output arguments see <a href="expSetup.html">expSetup.html</a>:</p><p><i>Can be set by user (otherwise default is set)</i>:</p><div><ul><li>seti.incType        :   default: 'pointSource'</li><li>seti.measType       :   default: 'nearField'</li><li>seti.incNb          :   default: 35</li><li>seti.measNb         :   default: 35</li><li>seti.radSrc         :   default: 5</li><li>seti.radMeas        :   default: 5</li><li>seti.incPntsType    :   default: 'circle'</li><li>seti.measPntsType   :   default: 'circle'</li></ul></div><p><i>Are set automatically:</i></p><div><ul><li>seti.incPnts        :   size seti.dim x seti.incNb</li><li>seti.dSInc          :</li><li>seti.measPnts       :   size seti.dim x seti.measNb</li><li>seti.dSMeas         :</li></ul></div><div><ul><li>seti.incField       :   complex matrix of size                           seti.nROI^seti.dim x seti.incNb</li><li>seti.measKer        :   complex matrix of size                           seti.measNb x seti.nROI^seti.dim</li></ul></div><p>For the following output arguments see <a href="setContrast.html">setContrast.html</a>:</p><p><i>Can be set by user (otherwise default is set)</i>:</p><div><ul><li>seti.contrast   :   default: 'cornerBallSparse2D'</li></ul></div><p><i>Are set automatically:</i></p><div><ul><li>seti.qCDexact   :   size: seti.nCD^seti.dim x 1</li><li>seti.qROIexact  :   size: seti.nROI^seti.dim x 1</li></ul></div><p>For the following output argument see <a href="setGeomSim.html">setGeomSim.html</a>:</p><p>Note that seti.mCD unequal 0 is not supported in public version.</p><p><i>Can be set by user (otherwise default is set)</i>:</p><div><ul><li>seti.mCD    :   default: 0</li></ul></div><p>For the following output arguments see <a href="addNoise.html">addNoise.html</a>:</p><p><i>Can be set by user (otherwise default is set)</i>:</p><div><ul><li>seti.delta      :   default: 0.01</li><li>seti.whichNoise :   default: 'normal'</li><li>seti.seed       :   default: 0</li></ul></div><p>The following output arguments are set in setData (this function):</p><p><i>Can be set by user (otherwise default is set)</i>:</p><div><ul><li>seti.loadFmeas      :   path to mat-file containing variables                           FmeasExact and FmeasDelta.                           (default: empty, i.e. '').</li><li>seti.useFmeasDelta  :   Set it to 1 to use FmeasDelta in loadFmeas                           (default: 1).</li></ul></div><p><i>Are set automatically:</i></p><div><ul><li>seti.FmeasExact     :   scattered field evaluated on receivers positions                           (complex matrix of size seti.measNb x seti.incNb),                           see also <a href="mimo.html">mimo.html</a>.</li><li>seti.FmeasDelta     :   FmeasExact with noise (synthetic data), see <a href="addNoise.html">addNoise.html</a>                           (complex matrix of size seti.measNb x seti.incNb).</li></ul></div><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="8">setData: checkConsisExpData: Input Arguments</h2><div><ul><li>seti    : structure array</li></ul></div><div><ul><li>seti.expData    : This field is not required. If it is not set, the structure <tt>seti</tt> is not changed. Possible inputs: <tt>'fresnel'</tt>. (Note that <tt>'simonetti'</tt> is not supported in the public version of this ode.)</li></ul></div><p>The following input arguments can be set by user, otherwise default values are set (in case of <tt>seti.expData = 'fresnel'</tt>):</p><div><ul><li><tt>seti.rCD</tt>  : Size of computational domain [-rCD,rCD)^dim                 (default: 0.2 m), see <a href="setGrid.html">setGrid.html</a>.</li><li><tt>seti.nCD</tt>  : Number of discretization points for each dimension of CD                 (default: 256), see <a href="setGrid.html">setGrid.html</a>.</li><li><tt>seti.fresnelFreq</tt>  : Frequency of the Fresnel data set (default: 5 GHz = <tt>5*1E9</tt>)</li><li><tt>seti.fresnelFile</tt>  : path to the file with data from Institute Fresnel                         (default: 'inexpdata/fresnel_opus_1/twodielTM_8f.exp').</li></ul></div><div><ul><li><tt>seti.nuMax</tt>    : match incident field using Hankel functions of first kind and orders                     <img src="setiRef_eq00607479568482278673.png" alt="$\nu = -\texttt{nuMax}, ..., -1, 0, 1, ...,                     \texttt{nuMax}$"> (default: 7)</li><li><tt>seti.ampCalc</tt>  : method to compute the coefficients c (1, 2 or 3),                     (default: 1), see <a href="matchIncField.html">matchIncField.html</a>.</li></ul></div><h2 id="9">setData:checkConsisExpData: Output Arguments</h2><div><ul><li>seti    : structure array</li></ul></div><p>In case of <tt>seti.expData = 'fresnel'</tt> the output arguments of <tt>seti</tt> are</p><div><ul><li><tt>seti.dim = 2</tt>  : The dimension of the problem is 2.</li><li><tt>seti.incType =  'pointSource'</tt> : The type of incident field is set to point sources.</li><li><tt>seti.measType = 'nearField'</tt>   : The measurement type is set to near field data.</li></ul></div><p>Additional fields of <tt>seti</tt> may set, if they was not set by the user (see Input Arguments).</p><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="10">setData:loadData: Input Arguments</h2><div><ul><li><tt>seti</tt>      : structure array</li></ul></div><p>The input arguments are the input and output arguments of <tt>checkConsisExpData</tt> in case of <tt>seti.expData = 'fresnel'</tt>, i.e.:</p><div><ul><li><tt>seti.rCD</tt>  : Size of computational domain [-rCD,rCD)^dim                 (default: 0.2 m), see <a href="setGrid.html">setGrid.html</a>.</li><li><tt>seti.nCD</tt>  : Number of discretization points for each dimension of CD                 (default: 256), see <a href="setGrid.html">setGrid.html</a>.</li><li><tt>seti.fresnelFreq</tt>  : Frequency of the Fresnel data set                         (default: 5 GHz = <tt>5*1E9</tt>)</li><li><tt>seti.fresnelFile</tt>  : path to the file with data from Institute Fresnel                         (default: 'inexpdata/fresnel_opus_1/twodielTM_8f.exp').</li></ul></div><div><ul><li><tt>seti.nuMax</tt>    : match incident field using Hankel functions of first kind and orders                     <img src="setiRef_eq00607479568482278673.png" alt="$\nu = -\texttt{nuMax}, ..., -1, 0, 1, ...,                     \texttt{nuMax}$"> (default: 7)</li><li><tt>seti.ampCalc</tt>  : method to compute the coefficients c (1, 2 or 3),                     (default: 1), see <a href="matchIncField.html">matchIncField.html</a>.</li></ul></div><div><ul><li><tt>seti.dim = 2</tt>  : The dimension of the problem is 2.</li><li><tt>seti.incType =  'pointSource'</tt> : The type of incident field is set to point sources.</li><li><tt>seti.measType = 'nearField'</tt>   : The measurement type is set to near field data.</li></ul></div><p><b>Optional Input Arguments</b></p><div><ul><li>dispDepth   : depth of displayed messages (number between 0 and 5).</li><li>out         : depth of output: no figure (0), plot figure (1), plot and save figure (2).</li></ul></div><h2 id="11">setData:loadData: Output Arguments</h2><p>Most important output arguments, i.e. fields in structure array <tt>seti</tt>.</p><div><ul><li><tt>seti.incNb</tt>      :   number of transmitters (number of incident fields)</li><li><tt>seti.measNb</tt>     :   number of receivers (number of measurements)</li><li><tt>seti.radSrc</tt>     :   radius of circle transmitters are arranged on</li><li><tt>seti.radMeas</tt>    :   radius of circle receivers are arranged on</li></ul></div><div><ul><li><tt>seti.k</tt>          :   wave number (<img src="setiRef_eq04436290039412608758.png" alt="$k = 2 \pi f/c$"> with frequency f and light velocity c)</li><li><tt>seti.FmeasDelta</tt> :   scattered field at receivers' positions (i.e. 'the data') for each transmitter                         (uScaRX = uTotRX - uIncRX, i.e. total field minus incident field)                         (complex matrix of size seti.measNb x seti.incNb)</li><li><tt>seti.incField</tt>   :   Incident field in the region of interest (ROI)                         for each transmitter                         (complex matrix of size seti.nROI^seti.dim x seti.incNb)</li></ul></div><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="12">setData:loadData:matchIncField: Input Arguments</h2><div><ul><li>seti.dim        :   dimension of the problem: 2 (3 not available)</li><li>seti.incNb      :   number of transmitters</li><li>seti.k          :   wave number</li><li>seti.incPnts    :   Positions of the transmitters,                       (matrix of size seti.dim x seti.incNb),                       seti.incPnts = [5 -2 3; 0 4 2]                       describes coordinates (5,0), (-2,4), and (3,2).</li><li>seti.measPnts   :   Positions of the receivers                       (matrix of size seti.dim x seti.measNb),                       coordinates analogical to seti.incPnts.</li><li>seti.gridROI    :   grid of region of interest (ROI)                       (in case of region = 'ROI')                       (matrix of size seti.dim x seti.nROI^seti.dim)</li><li>seti.grid       :   grid of computational domain (CD)                       (in case of region = 'CD')                       (seti.dim x seti.nCD^seti.dim)</li></ul></div><div><ul><li>seti.ampCalc    :   method to compute the coefficients c (1, 2 or 3),                       we recommend to use method 1 (default)                       because it is the most accurate and fast, as shown in [1].                       (1: best-approximation to V c = z via MATLAB                       function,                       2: <img src="setiRef_eq05663473293913421361.png" alt="$c = (\gamma I + V^\ast\ V)^{-1} (V^\ast\                       \texttt{uIncRX})$">                           via linear Tikhonov regularization,                       3: Landweber iteration)</li><li>seti.nuMax      :   match incident field using Hankel functions of first kind and orders                       <img src="setiRef_eq13234211905659582027.png" alt="$\nu = -\texttt{nuMax}, ..., -1, 0, 1, ...,                       \texttt{nuMax}$"> (default: 7)</li></ul></div><div><ul><li>uIncRX          :   incident field at receivers' positions for each                       transmitter                       (complex matrix of size seti.measNb x seti.incNb)</li><li>region          :   'ROI' or 'CD' (region of interest or computational domain)                       (usually we are interested in ROI)</li></ul></div><h2 id="13">setData:loadData:matchIncField: Output Arguments</h2><p>No fields of <tt>seti</tt>.</p><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="14">setData:setGeomSim: Input Arguments</h2><div><ul><li>seti    :   structure array, see below in "Output Arguments" and also <a href="setData.html">setData.html</a>.</li></ul></div><h2 id="15">setData:setGeomSim: Output Arguments</h2><div><ul><li>seti        :   structure array</li></ul></div><p>Following parameters can be set by user (otherwise default is set):</p><div><ul><li>seti.tol    :   tolerance for GMRES in <a href="solveLippmannSchwinger.html">solveLippmannSchwinger.html</a>                   (default: 1E-6)</li><li>seti.mCD    :   coarse grid size (default: 0).                   If mCD = 0, then two-grid is disabled.                   Note that coarse gris is not supported in public version.</li></ul></div><div><ul><li>Fields of seti, that are directly processed in setGeomSim, are described in this file.</li><li>Other fields are explained in the corresponding functions (<a href="setGrid.html">setGrid.html</a>, <a href="setReshapeVecMat.html">setReshapeVecMat.html</a>, <a href="setGridScale.html">setGridScale.html</a>, <a href="setIdImagReal.html">setIdImagReal.html</a>, <a href="setKernel.html">setKernel.html</a>, <a href="expSetup.html">expSetup.html</a>, <a href="setContrast.html">setContrast.html</a>). An assignment of the fields to the functions is given in <a href="setData.html">setData.html</a>.</li></ul></div><p><b>Subfunction: setFigureSettings</b></p><p>Following parameters can be set by user (otherwise default is set):</p><div><ul><li>seti.plotFreq       :   (default: 1)                           0: do not plot;                           n &gt; 0: plot each n-th outer iteration.</li><li>seti.usecbarlim     :   (default: 1)                           0: colorbar limits are set automatically;                           1: set the limits manually (for real and imag colorbars in 2D)</li><li>seti.cbarlim        :   (default: [-0.2 1.4]) vector [cbarmin,cbarmax].</li><li>seti.plotPublish    :   (default: 0)                           0 or 1, save figures designed for publications,                           i.e. no title, no axis, bigger font size for colorbar.,                           see <a href="plot2DstylePublish.html">plot2DstylePublish.html</a> and <a href="plot3DstylePublish.html">plot3DstylePublish.html</a>.</li><li>seti.pubFontSize    :   (default: 20) font size for publishing figures.</li><li>seti.plotVisible    :   (default: 'off')                           figure visibility by MATLAB figure property                           "Visible", see [1].</li><li>seti.savepng        :   (default: 1) 0 or 1, save figures as *.png.</li><li>seti.saveepsc       :   (default: 0) 0 or 1, save figures as colored *.eps.</li><li>seti.savefig        :   (default: 0) 0 or 1, save figures as *.fig.</li><li>seti.plotFreqiPda   :   (default: 0) Frequency of plots inside pda                           A folder is made for every outer iteration.                           (This option is not available in public version.)</li></ul></div><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="16">setData:setGeomSim: setGrid: Input Arguments</h2><div><ul><li>seti    :   structure array</li></ul></div><p>If input arguments are not set, default values will be used.</p><div><ul><li>seti.dim     :  dimension of the problem (2 or 3) (default: 2)</li><li>seti.nCD     :  number of discretization points for each dimension                   of computational domain (CD) (in samples)                   (default: 256).</li><li>seti.rCD     :  Size of computational domain [-rCD,rCD)^dim                   (default: 0.2) (in meters)</li></ul></div><h2 id="17">setData:setGeomSim: setGrid: Output Arguments</h2><div><ul><li>seti    :   structure array</li></ul></div><div><ul><li>seti.h          :   length of the infinitesimal element of CD.</li><li>seti.dV         :   area/volume of the infinitesimal element (pixel/voxel) of CD</li><li>seti.grid       :   grid of computational domain (CD)                       (seti.dim x seti.nCD^seti.dim)</li><li>seti.ballMask   :   mask (logical matrix of size seti.nCD x seti.nCD)                       to restrict (later) the contrast in CD                       to the mathematical sensible region.</li><li>seti.nROI       :   discretization points for each dimension                       of region of interest (ROI) (in samples)</li><li>seti.gridROI    :   grid of region of interest (ROI)                       (matrix of size seti.dim x seti.nROI^seti.dim)</li><li>seti.ROImask    :   mask (logical matrix of size seti.nCD x seti.nCD)                       to restrict (later) the contrast in CD                       to the region of interest (ROI).</li><li>seti.ballMaskROI :   mask (logical matrix of size seti.nROI x seti.nROI)                       to restrict (later) the contrast in ROI                       to the mathematical sensible region.                       (This mask is currently useless, see "More About".)</li></ul></div><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="18">setData:setGeomSim:setReshapeVecMat: Input Arguments</h2><div><ul><li>seti.dim    : see <a href="setGrid.html">setGrid.html</a>.</li><li>seti.nCD    : see <a href="setGrid.html">setGrid.html</a>.</li><li>seti.nROI   : see <a href="setGrid.html">setGrid.html</a>.</li></ul></div><h2 id="19">setData:setGeomSim:setReshapeVecMat: Output Arguments</h2><div><ul><li>seti.GROI   : reshapes a vector of size seti.nROI^seti.dim                 into a matrix of size seti.nROI x seti.nROI in 2D                 and seti.nROI x seti.nROI x seti.nROI in 3D.</li><li>seti.GCD    : reshapes a vector of size seti.nCD^seti.dim                 into a matrix of size seti.nCD x seti.nCD in 2D                 and seti.nCD x seti.nCD x seti.nCD in 3D.</li><li>seti.G      : same as seti.GROI.</li><li>seti.iG     : reshapes a matrix into a vector.</li></ul></div><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="20">setData:setGeomSim:setGridScale: Input Arguments</h2><p>If the fields was not defined, default values are set.</p><div><ul><li>seti.gscale     :   1: use a down scaled grid for reconstruction;                       0: do not use grid scaling (default)</li><li>seti.nCDinv     :   number of discretization points                       <i>of the downscaled grid</i>                       for each dimension of CD.                       (for nCD see <a href="setGrid.html">setGrid.html</a>).                       (default: <tt>floor(seti.nCD/2)</tt>).</li></ul></div><h2 id="21">setData:setGeomSim:setGridScale: Output Arguments</h2><div><ul><li>seti.nInv   :   The analogue to seti.nROI, see <a href="setGrid.html">setGrid.html</a>, for the downscaled grid.</li><li>seti.hInv   :   The analogue to seti.h, see <a href="setGrid.html">setGrid.html</a>, for the downscaled grid.</li><li>seti.dVinv  :   The analogoue to seti.dV, see <a href="setGrid.html">setGrid.html</a>, for the downscaled grid.</li><li>seti.GInv   :   The analogue to seti.G, see <a href="setReshapeVecMat.html">setReshapeVecMat.html</a>, for the downscaled grid.</li></ul></div><div><ul><li>seti.GU     :   function to scale up the grid                   (input: down scaled contrast as a vector of size seti.nInv^seti.dim;                   output: up scaled contrast as a vector of size seti.nROI^seti.dim)</li><li>seti.GD     :   function to scale down the grid                   (input: up scaled contrast as a vector of size seti.nROI^seti.dim;                   output: down scaled contrast as a vector of size seti.nInv^seti.dim)</li></ul></div><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="22">setData:setGeomSim:setIdImagReal: Input Arguments</h2><div><ul><li>seti    :   structure array (no fields are needed)</li></ul></div><h2 id="23">setData:setGeomSim:setIdImagReal: Output Arguments</h2><div><ul><li>seti.S  :   function to identify complex with real vectors/matrices               (input: complex vector/matrix; output: real vector/matrix)</li><li>seti.R  :   extracts the originally real (R) part of the output of seti.S</li><li>seti.I  :   extracts the originally imag (I) part of the output of seti.S</li><li>seti.T  :   function to identify real with complex vectors/matrices               (input: real vector/matrix (R x R); output: complex vector/matrix)</li></ul></div><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="24">setData:setGeomSim:setKernel: Input Arguments</h2><p><i>This arguments was set in rebis before setKernel is called</i>:</p><div><ul><li>seti.dim    : see <a href="setGrid.html">setGrid.html</a>.</li><li>seti.nCD    : see <a href="setGrid.html">setGrid.html</a>.</li><li>seti.rCD    : see <a href="setGrid.html">setGrid.html</a>.</li></ul></div><p><i>Can be set by user (otherwise default is set)</i>:</p><div><ul><li>seti.k      : Wave number, default: 250</li><li>seti.model  : Model of the problem, default: 'helmholtz2D'</li></ul></div><h2 id="25">setData:setGeomSim:setKernel: Output Arguments</h2><div><ul><li>seti.kHat   : kernel, complex matrix of size nCD x nCD.</li></ul></div><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="26">setData:setGeomSim:expSetup: Input Arguments</h2><h2 id="27">Input Arguments</h2><div><ul><li><tt>seti</tt>  :   structure array</li></ul></div><p>Several fields in <tt>seti</tt> are required. Because this is an internal function we do not list them.</p><p><b>Optional Input Arguments to differ from default values</b></p><p>For details of the the following fields look inside subfunction <tt>expSetupCons</tt> below and the functions  <a href="setIncPnts.html">setIncPnts.html</a>, <a href="setMeasPnts.html">setMeasPnts.html</a>, <a href="pntsGeometry.html">pntsGeometry.html</a> and <a href="pntsGeometry3D.html">pntsGeometry3D.html</a>:</p><div><ul><li>seti.incType        :   type of incident field, default: 'pointSource'                           ('planeWave' or 'pointSource')</li><li>seti.measType       :   type of measurement, default: 'nearField'                           ('nearField' or 'farField')</li><li>seti.incNb          :   number of transmitters, default: 35</li><li>seti.measNb         :   number of receivers, default: 35</li><li>seti.radSrc         :   radius of circle for transmitters, default: 5                           (not necessary in case of incType='planeWave').</li><li>seti.radMeas        :   radius of circle for receivers, default: 5                           (not necessary in case of measType='farField')</li><li>seti.incPntsType    :   string with type of geometry for transmitters, default: 'circle'</li><li>seti.measPntsType   :   string with type of geometry for receivers, default: 'circle'</li></ul></div><h2 id="28">setData:setGeomSim:expSetup: Output Arguments</h2><div><ul><li><tt>seti</tt>  :   structure array</li></ul></div><p>The following fields in <tt>seti</tt> are defined. Look in documentation of corresponding functions and subfunctions (subfunctions are in the Section Code).</p><p>For details of the the following fields see the functions <a href="setIncPnts.html">setIncPnts.html</a>, <a href="setMeasPnts.html">setMeasPnts.html</a>, <a href="pntsGeometry.html">pntsGeometry.html</a>:</p><div><ul><li>seti.incPnts        :   coordinates of transmitters, size seti.dim x seti.incNb</li><li>seti.dSInc          :   Approximation of the infinitesimal element of closed contour with control points.</li><li>seti.measPnts       :   coordinates of receivers, size seti.dim x seti.measNb</li><li>seti.dSMeas         :   Approximation of the infinitesimal element of closed contour with control points.</li></ul></div><p>Further details of the following parameter are in <a href="setIncField.html">setIncField.html</a>:</p><div><ul><li>seti.incField       :   incident fields, complex matrix of size                           seti.nROI^seti.dim x seti.incNb</li></ul></div><p>Further details of the following parameter are in <a href="seMeasKer.html">seMeasKer.html</a>:</p><div><ul><li>seti.measKer        :   measurement kernel on region of interest (ROI)                           for each receiver                           (complex matrix of size seti.measNb x seti.nROI^seti.dim)</li></ul></div><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="29">setData:setGeomSim:expSetup:setIncPnts: Input Arguments</h2><div><ul><li>seti.dim            :   dimension of the problem (2 or 3)</li><li>seti.incType        :   Type of incident field: 'pointSource' (default) or 'planeWave'</li></ul></div><p><b>Input Arguments in case of 2D (seti.dim = 2) and point sources (seti.incType = 'pointSource')</b></p><div><ul><li>seti.incPntsType    :   string with type of geometry:                           'manually', 'circle' (default), 'square', 'line', 'borehole'</li></ul></div><p>It follows a <b>list of type-depending input parameters</b> to describe the details of the geometry. The names are analog to the parameters in <a href="pntsGeometry.html">pntsGeometry.html</a> (mostly with the prefix inc and a big letter, exceptions are marked with emphasized). Examples are in <a href="pntsGeometry.html">pntsGeometry.html</a>. If these parameters are not set, default values are set automatically (see inside the code).</p><p><i>varargin in case of seti.incPntsType = 'manually'</i></p><div><ul><li>seti.incPnts        :   coordinates of points (real matrix of size 2 x Nb).</li></ul></div><p><i>varargin in case of seti.incPntsType = 'circle'</i></p><div><ul><li>seti.incNb             :   Number of points (transmitters)</li><li><i>seti.radSrc</i>          :   radius of circle</li></ul></div><p><i>varargin in case of seti.incPntsType = 'square'</i></p><div><ul><li>seti.incNbEdge      :   incNbEdge+1 points are on one edge                           (+1 because a point in a corner belongs to two corners).                           (Total number of points in square is <tt>4*incNbEdge</tt>.)</li><li>seti.incEdgeLength  :   Length of one edge.</li></ul></div><p><i>varargin in case of seti.incPntsType = 'line'</i></p><div><ul><li>seti.incNbLine      :   Number of points on line.</li><li>seti.incLineLength  :   Length of line.</li><li>seti.incLinePos     :   Distance of line right to origin.</li></ul></div><p><i>varargin in case of seti.incPntsType = 'borehole'</i></p><div><ul><li><i>seti.boreNbLine</i>      :   Number of points on line.</li><li><i>seti.boreLineLength</i>  :   Length of line.</li><li><i>seti.boreLinePos</i>     :   Distance of line right to origin.</li></ul></div><p><b>Input Arguments in case of 3D (seti.dim = 3)</b></p><div><ul><li>seti.incPntsType    :   string with type of geometry:                           'manually', 'sphereLatLon', 'sphereFibo' (default).</li></ul></div><p>It follows a <b>list of type-depending input parameters</b> to describe the details of the geometry. The names are analog to the parameters in <a href="pntsGeometry3D.html">pntsGeometry3D.html</a> (mostly with the prefix inc and a big letter, exceptions are marked with emphasized). Examples are in <a href="pntsGeometry3D.html">pntsGeometry3D.html</a>. If these parameters are not set, default values are set automatically (see inside the code).</p><p><i>varargin in case of seti.incPntsType = 'manually'</i></p><div><ul><li>seti.incPnts        :   coordinates of points (real matrix of size 3 x Nb).</li></ul></div><p><i>varargin in case of seti.incPntsType = 'sphereLatLon' or 'sphereFibo'</i></p><div><ul><li>seti.incNb             :   Number of points (transmitters)</li><li><i>seti.radSrc</i>          :   radius of sphere</li></ul></div><h2 id="30">setData:setGeomSim:expSetup:setIncPnts: Output Arguments</h2><div><ul><li>seti.incPnts    :   Coordinates of points (real matrix of size seti.dim x Nb).</li><li>seti.incNb      :   Number of points.</li><li>seti.dSInc      :   Approximation of the infinitesimal element of closed                       contour with control points.                       A closed contour does not make sense in the cases                       'manually', 'line', and 'borehole', then it is set to 1.</li></ul></div><p>For further information see the corresponding parameters Pnts, Nb, and dS in <a href="pntsGeometry.html">pntsGeometry.html</a> and <a href="pntsGeometry3D.html">pntsGeometry3D.html</a>.</p><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="31">setData:setGeomSim:setMeasPnts: Input Arguments</h2><div><ul><li>seti.dim            :   dimension of the problem (2 or 3)</li><li>seti.measType       :   Type of measurement field: 'nearField' (default) or 'farField'</li></ul></div><p><b>Input Arguments in case of 2D (seti.dim = 2) and near field (seti.incType = 'nearField')</b></p><div><ul><li>seti.measPntsType   :   string with type of geometry:                           'manually', 'circle' (default), 'square', 'line', 'borehole'</li></ul></div><p>It follows a <b>list of type-depending input parameters</b> to describe the details of the geometry. The names are analog to the parameters in <a href="pntsGeometry.html">pntsGeometry.html</a> (mostly with the prefix meas and a big letter, exceptions are marked with emphasized). Examples are in <a href="pntsGeometry.html">pntsGeometry.html</a>. If these parameters are not set, default values are set automatically (see inside the code).</p><p><i>varargin in case of seti.measPntsType = 'manually'</i></p><div><ul><li>seti.measPnts        :   coordinates of points (real matrix of size 2 x Nb).</li></ul></div><p><i>varargin in case of seti.measPntsType = 'circle'</i></p><div><ul><li>seti.measNb             :   Number of points (transmitters)</li><li><i>seti.radMeas</i>          :   radius of circle</li></ul></div><p><i>varargin in case of seti.measPntsType = 'square'</i></p><div><ul><li>seti.measNbEdge      :  measNbEdge+1 points are on one edge                           (+1 because a point in a corner belongs to two corners).                           (Total number of points in square is <tt>4*measNbEdge</tt>.)</li><li>seti.measEdgeLength  :  Length of one edge.</li></ul></div><p><i>varargin in case of seti.measPntsType = 'line'</i></p><div><ul><li>seti.measNbLine      :   Number of points on line.</li><li>seti.measLineLength  :   Length of line.</li><li>seti.measLinePos     :   Distance of line right to origin.</li></ul></div><p><i>varargin in case of seti.measPntsType = 'borehole'</i></p><p>Note: Option 'borehole' is only useful if seti.incPntsType is also 'borhole'.</p><div><ul><li><i>seti.boreNbLine</i>      :   Number of points on line.</li><li><i>seti.boreLineLength</i>  :   Length of line.</li><li><i>seti.boreLinePos</i>     :   Distance of line right to origin.</li></ul></div><p><b>Input Arguments in case of 3D (seti.dim = 3)</b></p><div><ul><li>seti.incPntsType    :   string with type of geometry:                           'manually', 'sphereLatLon', 'sphereFibo' (default).</li></ul></div><p>It follows a <b>list of type-depending input parameters</b> to describe the details of the geometry. The names are analog to the parameters in <a href="pntsGeometry3D.html">pntsGeometry3D.html</a> (mostly with the prefix meas and a big letter, exceptions are marked with emphasized). Examples are in <a href="pntsGeometry3D.html">pntsGeometry3D.html</a>. If these parameters are not set, default values are set automatically (see inside the code).</p><p><i>varargin in case of seti.measPntsType = 'manually'</i></p><div><ul><li>seti.measPnts        :   coordinates of points (real matrix of size 3 x Nb).</li></ul></div><p><i>varargin in case of seti.measPntsType = 'sphereLatLon' or 'sphereFibo'</i></p><div><ul><li>seti.measNb             :   Number of points (receivers)</li><li><i>seti.radMeas</i>          :   radius of sphere</li></ul></div><h2 id="32">setData:setGeomSim:setMeasPnts: Output Arguments</h2><div><ul><li>seti.measPnts    :   Coordinates of points (real matrix of size seti.dim x Nb).</li><li>seti.measNb      :   Number of points.</li><li>seti.dSMeas      :   Approximation of the infinitesimal element of closed                        contour with control points.                        A closed contour does not make sense in the cases                        'manually', 'line', and 'borehole', then it is set to 1.</li></ul></div><p>For further information see the corresponding parameters Pnts, Nb, and dS in <a href="pntsGeometry.html">pntsGeometry.html</a> and <a href="pntsGeometry3D.html">pntsGeometry3D.html</a>.</p><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="33">setData:setGeomSim:setIncField: Input Arguments</h2><div><ul><li>seti.incType    :   Type of incident field: 'pointSource' or 'planeWave'</li><li>seti.incNb      :   number of transmitters</li></ul></div><div><ul><li>seti.k      :   wave number, see <a href="setKernel.html">setKernel.html</a></li><li>seti.model  :   Model of problem 'helmholtz2D' or 'helmholtz3D',                   see <a href="setKernel.html">setKernel.html</a></li></ul></div><div><ul><li>seti.nROI    : discretization points for each dimension                  of region of interest (ROI) (in samples),                  see <a href="setGrid.html">setGrid.html</a>.</li><li>seti.gridROI : grid of region of interest (ROI)                  (matrix of size seti.dim x seti.nROI^seti.dim)                  see <a href="setGrid.html">setGrid.html</a>.</li></ul></div><div><ul><li>seti.incPnts    : coordinates of transmitters                     (real matrix of size 2 x seti.incNb), see <a href="setIncPnts.html">setIncPnts.html</a>.</li></ul></div><h2 id="34">setData:setGeomSim:setIncField: Output Arguments</h2><div><ul><li><tt>seti.incField</tt>   :   incident field on region of interest (ROI)                         for each transmitter                         (complex matrix of size seti.nROI^seti.dim x seti.incNb)</li></ul></div><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="35">setData:setGeomSim:setMeasKer: Input Arguments</h2><div><ul><li>seti.measType    :   Type of scattered field: 'nearField' or 'farField'</li><li>seti.measNb      :   number of receivers</li></ul></div><div><ul><li>seti.k      :   wave number, see <a href="setKernel.html">setKernel.html</a></li><li>seti.model  :   Model of problem 'helmholtz2D' or 'helmholtz3D',                   see <a href="setKernel.html">setKernel.html</a></li></ul></div><div><ul><li>seti.nROI    : discretization points for each dimension                  of region of interest (ROI) (in samples),                  see <a href="setGrid.html">setGrid.html</a>.</li><li>seti.gridROI : grid of region of interest (ROI)                  (matrix of size seti.dim x seti.nROI^seti.dim)                  see <a href="setGrid.html">setGrid.html</a>.</li></ul></div><div><ul><li>seti.measPnts    : coordinates of receivers                      (real matrix of size seti.dim x seti.measNb), see <a href="setMeasPnts.html">setMeasPnts.html</a>.</li></ul></div><h2 id="36">setData:setGeomSim:setMeasKer: Output Arguments</h2><div><ul><li><tt>seti.measKer</tt>      :   measurement kernel on region of interest (ROI)                           for each receiver                           (complex matrix of size seti.measNb x seti.nROI^seti.dim)</li></ul></div><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="37">setData:setGeomSim:setContrast: Input Arguments</h2><div><ul><li>seti    :   structure array</li></ul></div><div><ul><li><tt>seti.contrast</tt>   :   name of predefined contrast function</li><li><tt>seti.rotation</tt>   :   mathematical positive rotation of the contrast in degrees (only in 2D).                         (If the field rotation does not exist, no rotation                         is done.)</li></ul></div><h2 id="38">setData:setGeomSim:setContrast: Output Arguments</h2><div><ul><li><tt>seti.qCDexact</tt>     :   predefined contrast evalutated on CD                           (computational domain)                           (as vector of size seti.nCD^seti.dim x 1).</li><li><tt>seti.qROIexact</tt>    :   predefined contrast evalutated on ROI                           (region of interest)                           (as vector of size seti.nROI^seti.dim x 1).</li></ul></div><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="39">setData:mimo: Input Arguments</h2><div><ul><li><tt>seti</tt>       :    struct, details see below.</li></ul></div><p><b>struct <tt>seti</tt></b></p><p>As in convenience functions <a href="adjOfDer.html">adjOfDer.html</a>, <a href="forward.html">forward.html</a> and <a href="derivative.html">derivative.html</a> all necessary fields (and more) are set by</p><pre class="language-matlab">seti = setGeomSim(seti);
</pre><p>A list of all necessary (and not more) fields is below.</p><p>seti in <a href="setGeomSim.html">setGeomSim.html</a>:</p><div><ul><li><tt>seti.mCD</tt>      : internal parameter, set seti.mCD = 0                     (no coarse grid is used)</li><li><tt>seti.tol</tt>      : internal parameter, set 1E-6, is used in simo and solveLippmannSchwinger</li></ul></div><p>seti in <a href="setGrid.html">setGrid.html</a>:</p><div><ul><li><tt>seti.dim</tt>     : dimension of the problem (2 or 3)</li><li><tt>seti.nCD</tt>     : number of discretization points for each dimension                    of computational domain (CD)</li><li><tt>seti.nROI</tt>    : discretization points for each dimension                    of region of interest (ROI)</li><li><tt>seti.gridROI</tt> : grid of region of interest (ROI)                    (matrix of size seti.dim x seti.nROI^seti.dim)</li><li><tt>seti.ROImask</tt> : biggest square in 2D (cube in 3D) in ball with radius rCD/2                    (logical array of size seti.nCD x seti.nCD)</li><li><tt>seti.dV</tt>      : pixel/voxel area/volume (number)</li></ul></div><p>seti in <a href="setKernel.html">setKernel.html</a>:</p><div><ul><li><tt>seti.model</tt>   : model (helmholtz2D or helmholtz3D)</li><li><tt>seti.k</tt>       : wave number</li><li><tt>seti.kHat</tt>    : Fourier coefficients of discretized integral operator                    (seti.nCD x seti.nCD)</li></ul></div><p>seti in <a href="expSetup.html">expSetup.html</a> (subfiles <a href="pntsGeometry.html">pntsGeometry.html</a>, <a href="setIncField.html">setIncField.html</a>, <a href="setMeasKer.html">setMeasKer.html</a>):</p><div><ul><li><tt>seti.measNb</tt>   : number of receivers (number of measurements)</li><li><tt>seti.incNb</tt>    : number of transmitters (number of incident fields)</li><li><tt>seti.dSInc</tt>    : approximation of the infinitesimal element of closed contour with control points in case of transmitters</li><li><tt>seti.dSMeas</tt>   : approximation of the infinitesimal element of closed contour with control points in case of receivers</li><li><tt>seti.incField</tt> : incident field, <a href="setIncField.html">setIncField.html</a>                     (matrix of size seti.nROI^seti.dim x seti.incNb)</li><li><tt>seti.measKer</tt>  : matrix to compute simulated measurement data from solution, <a href="setMeasKer.html">setMeasKer.html</a>                     (size seti.measNb x seti.nROI^seti.dim)</li></ul></div><h2 id="40">setData:mimo: Output Arguments</h2><p>No output fields of <tt>seti</tt>.</p><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="41">setData:addNoise: Input Arguments</h2><div><ul><li>seti        : structure array</li></ul></div><p><i>The following field of the structure array is required:</i></p><div><ul><li>seti.dSMeas         : Approximation of the infinitesimal element of closed                         contour with control points, see <a href="setMeasPnts.html">setMeasPnts.html</a>.</li></ul></div><p><i>The following fields of the structure array are optional (otherwise default values are set):</i></p><div><ul><li>seti.delta          : Relative (artificial) noise level of data                         (default: 0.01)</li><li>seti.whichNoise     : Type of used probability density function to                         noise the data:                         'laplace', 'uniform', 'normal' (default).</li><li>seti.seed           : Number to control the random number generator.                         Using a non-negative integer (default: 0).</li></ul></div><h2 id="42">setData:addNoise: Output Arguments</h2><div><ul><li>seti    :   structure array</li></ul></div><p>If the fields <tt>delta</tt>, <tt>whichNoise</tt>, and <tt>seed</tt> of <tt>seti</tt> was not set, default values are set.</p><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="43">setRecon: Input Arguments</h2><div><ul><li>seti    :   structure array</li></ul></div><h2 id="44">setRecon: Output Arguments</h2><div><ul><li>seti    :   structure array</li></ul></div><p>The added fields in <tt>seti</tt> can be found in the called functions</p><div><ul><li><a href="setInvType.html">setInvType.html</a></li><li><a href="checkConsisRec.html">checkConsisRec.html</a></li><li><a href="shrinkFuncs.html">shrinkFuncs.html</a></li><li><a href="setFuncsPda.html">setFuncsPda.html</a></li></ul></div><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="45">setRecon:setInvType: Input Arguments</h2><div><ul><li><tt>seti</tt>        :   struct seti</li></ul></div><p><b>Optional Input Arguments of structure <tt>seti</tt></b></p><p>If the fields does not exist, default values are set in this function.</p><div><ul><li><tt>seti.invNo</tt>  : Number of reconstruction setting (default: 6)                   (invNo = 6 is the only one supported in public version)</li><li><tt>seti.alpha</tt>  : Regularization parameter for sparsity penalty                   (default: 500).</li><li><tt>seti.beta</tt>   : Regularization parameter for total variation penalty                   (default: 1E-5).</li><li><tt>seti.tau</tt>    : Discrepancy principle stops at parameter tau * delta                   (default: 2.5). (Note that delta is the relative noise                   level <tt>seti.delta</tt>.)</li></ul></div><h2 id="46">setRecon:setInvType: Output Arguments</h2><div><ul><li><tt>seti.inv</tt>        : Type of reconstruction method: 'pda' or 'shrinkage'</li><li><tt>seti.useWavelet</tt> : Using wavelets (1) or not (0)                       (Wavelets are not available in public version)</li><li><tt>seti.tF</tt>     : Terms belonging to functional F                   (e.g. <tt>seti.tF = {'fd','fg'}</tt>; See table below.)</li><li><tt>seti.tG</tt>     : Terms belonging to functional G                   (e.g. <tt>seti.tG = {'fs','fp'}</tt>; See table below.)</li><li><tt>seti.pNorm</tt>  : Index p for p-Schatten-Norm of measurements to define                   discrepancy.</li><li><i>More about pNorm:</i>   default: pNorm = 2, i.e. essentially Frobenius-Norm</li><li><i>More about pNorm:</i>   in case of inv = 'pda' with invNo 3 to 6                         set pNorm = 2 (automatically) because it is required</li><li><tt>seti.qNorm</tt>      : Index q for q-Norm of contrasts to define sparsity penalty</li><li><i>More about qNorm</i>: Standard: qNorm = 1 -&gt; l^1 minimization.</li><li><i>More about qNorm</i>: in case of inv = 'pda' set qNorm = 1 (automatically)                       because it is required.</li><li><tt>seti.p</tt>      : Exponent in discrepancy-term <img src="setiRef_eq12114434532218645993.png" alt="$1/p ||...||^p_2$"> with <img src="setiRef_eq03135539543662799617.png" alt="$p = 1$"> or <img src="setiRef_eq17262503285923366262.png" alt="$2$">                   (used e.g. in <a href="setFuncsPda.html">setFuncsPda.html</a>)                   (default: <tt>seti.p = 2</tt>).</li></ul></div><p>Note: <b>p ~= pNorm</b> in general!                   (but: in case of inv = 'shrinkage':                   pNorm and qNorm are used as exponents too.)</p><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="47">setRecon: checkConsisRec: Input Arguments</h2><div><ul><li><tt>seti</tt>        :   struct seti</li></ul></div><p><b>Optional Input Arguments of structure <tt>seti</tt></b></p><p>If the fields does not exist, default values are set in this function.</p><div><ul><li><tt>seti.useWavelet</tt>   : Use wavelets for reconstruction (default: 0).                         Note that wavelets are not supported in the                         public version of this code. Therefore the                         wavelet-specific fields <tt>wavWeight</tt>,                         <tt>genWhiteNoiseNew</tt>, <tt>adaptWeightsMan</tt>, <tt>wavelet</tt>,                         <tt>extension</tt>, <tt>smin</tt> and <tt>samples</tt> are not                         documented.</li><li><tt>seti.recname</tt>      : What is reconstructed? A <tt>'constrast'</tt> (default)                         or a <tt>'source'</tt>. Influences the title in                         <a href="subplots.html">subplots.html</a>.</li><li><tt>seti.physBounds</tt>   : Bounds for real/imaginary part of contrast:                         [reMin, reMax, imMin, imMax]                         (default: [-1,3,0,3])                         (consider also the penalty for physical bounds in                         <a href="pda.html">pda.html</a> Section "More About".)</li><li><tt>seti.tolDelta</tt>     : Tolerance for physical bounds' delta-function                         (default: 1E-14) in <a href="setFuncsPda.html">setFuncsPda.html</a>.</li><li><tt>seti.useDis</tt>       : If it is 1 (default), the discrepancy principle                         is used to stop the outer iteration. (Otherwise 0).</li><li><tt>seti.nOut</tt>         : Maximal number of outer iterations (default: 30).</li></ul></div><p>If the primal-dual algorithm is used (|seti.inv = 'pda') and the following fields does not exist, default values are set in this function.</p><div><ul><li><tt>seti.pdaN</tt>         : Number of inner iterations (PDA) (default: 50) (see <a href="pda.html">pda.html</a>).</li><li><tt>seti.pdaStepsize</tt>  : Method to choose primal and dual stepsizes                         (<tt>'fix'</tt> (default) or <tt>'adaptive'</tt>)                         see <a href="pdaChoosingStepsizes.html">pdaChoosingStepsizes.html</a>.</li><li><tt>seti.vartheta</tt>     : Parameter in (0,1) used in case of adaptive stepsizes,                         see <a href="pdaChoosingStepsizes.html">pdaChoosingStepsizes.html</a>.</li><li><tt>seti.useTolIn</tt>     : If it is set to 1 (default: 0), the inner                         tolerance principle is used to stop the inner                         iterations (primal-dual algorithm), see                         <a href="minPda.html">minPda.html</a> and <a href="minTolIn.html">minTolIn.html</a>.</li><li><tt>seti.useTolOut</tt>    : If it is set to 1 (default: 0), the outer                         tolerance principle is used to stop the inner                         iterations, see <a href="minPda.html">minPda.html</a>, <a href="minTolOut.html">minTolOut.html</a>.</li></ul></div><p>In case of <tt>seti.inv = 'pda'</tt> and <tt>seti.useTolIn = 1</tt> and the following fields does not exist, default values are set in this function.</p><div><ul><li><tt>seti.ThetaStart</tt>   : (default: 0.925), see <a href="minTolIn.html">minTolIn.html</a>.</li><li><tt>seti.ThetaMax</tt>     : (default: 0.95), see <a href="minTolIn.html">minTolIn.html</a>.</li><li><tt>seti.TolGamma</tt>     : (default: 0.90), see <a href="minTolIn.html">minTolIn.html</a>.</li><li><tt>seti.pdaNmax</tt>      : Maximal iteration number, if <tt>seti.useTolIn</tt> or                         <tt>seti.useTolOut</tt> are 1 (default : 250).</li></ul></div><p>In case of <tt>seti.inv = 'pda'</tt> and <tt>seti.useTolOut = 1</tt> and the following fields does not exist, default values are set in this function.</p><div><ul><li><tt>seti.relDisTol</tt>    : Outer tolerance (default: 0.05), see <a href="minTolOut.html">minTolOut.html</a>.</li><li><tt>seti.pdaNmax</tt>      : Maximal iteration number, if <tt>seti.useTolIn</tt> or                         <tt>seti.useTolOut</tt> are 1 (default : 250).</li></ul></div><p>The following fields should have been set in <a href="setInvType.html">setInvType.html</a>:</p><div><ul><li><tt>seti.inv</tt></li><li><tt>seti.alpha</tt></li><li><tt>seti.beta</tt></li><li><tt>seti.pNorm</tt></li><li><tt>seti.qNorm</tt></li><li><tt>seti.tau</tt></li></ul></div><p>See <a href="recon.html">recon.html</a> for the following fields of <tt>seti</tt>:</p><div><ul><li><tt>seti.saveqROIcomp</tt></li><li><tt>seti.loadqROIcomp</tt></li><li><tt>seti.savedata</tt></li></ul></div><p>Currently unused fields:</p><div><ul><li><tt>seti.lambda</tt>   : Wavelength (default: <img src="setiRef_eq17780364819335905377.png" alt="$\lambda = 2\pi/k$"> with                     wave number <img src="setiRef_eq02025168988717450165.png" alt="$k = \texttt{seti.k}$">) (currently not used anywhere).</li></ul></div><h2 id="48">setRecon:checkConsisRec: Output Argument</h2><div><ul><li><tt>seti</tt>  : structure array, see "Optional Input Arguments of structure <tt>seti</tt>", because default values are set, if fields was not already defined.</li></ul></div><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="49">setRecon:shrinkFuncs: Input Arguments</h2><div><ul><li>seti    :   structure array</li></ul></div><div><ul><li>seti.qNorm  :   in sparsity term <img src="setiRef_eq16708064331235039529.png" alt="$f_\mathrm{spa}$"> a norm with index                   <tt>seti.qNorm = 1</tt> is used                   (other values are not supported in public version).                   (Index q = 1 does essentially (up to some factor) mean <img src="setiRef_eq08523020348422778765.png" alt="$l^1$"> minimization)</li><li>seti.physBounds     :   contains the physical bounds (min and max)                           for real and imaginary part of the contrast as                           4-vector with structure                           <tt>[reMin reMax imMin imMax]</tt>.</li></ul></div><h2 id="50">setRecon:shrinkFuncs: Output Arguments</h2><div><ul><li>seti.shrkRe = @(x,alpha)    :   extended soft-shrinkage function for real part</li><li>seti.shrkIm = @(x,alpha)    :   extended soft-shrinkage function for imaginary part</li></ul></div><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="51">setRecon:setFuncsPda: Input Arguments</h2><div><ul><li>seti    :   structure array</li></ul></div><h2 id="52">setRecon:setFuncsPda: Output Arguments</h2><div><ul><li>seti    :   structure array</li></ul></div><p>For the fields of the structrual array <tt>seti</tt> see the section "More About".</p><p><b>--- More About ---</b></p><p>We only give a overview of the functions. See also <a href="pda.html">pda.html</a>. Detailed information are in Section 4.5 in [1].</p><p>Note that grid scaling is respected in the code, but for simplicitiy is not presented in the formulas.</p><p><b>Auxiliary quantities</b></p><p>For <img src="setiRef_eq08693472390149360398.png" alt="$\texttt{seti.S} = T_{\bf{C}\to\bf{R}^2}$"> and <img src="setiRef_eq09451177321936060719.png" alt="$\texttt{seti.T} = T_{\bf{R}^2\to\bf{C}}$">, see "More About" in <a href="pda.html">pda.html</a>.</p><div><ul><li><img src="setiRef_eq17637375530191488658.png" alt="$\texttt{seti.Kd} = K_\mathrm{dis} :=   T_{\bf{C}\to\bf{R}^2} [\mathcal{F}'(T_{\bf{R}^2\to\bf{C}}\ q)]T_{\bf{R}^2\to\bf{C}}$">,</li><li><img src="setiRef_eq16938998143789232994.png" alt="$\texttt{seti.vd} = v_\mathrm{dis} :=   T_{\bf{C}\to\bf{R}^2}(\mathcal{F}(T_{\bf{R}^2\to\bf{C}}\ q)-F_\mathrm{meas}^\delta)$">,</li><li><img src="setiRef_eq02825363139747132373.png" alt="$\texttt{seti.Kg} = K_\mathrm{tv}  :=   \beta\,T_{\bf{C}\to\bf{R}^2}\nabla T_{\bf{R}^2\to\bf{C}}$"></li><li><img src="setiRef_eq05078065785412364417.png" alt="$\texttt{seti.vg} = v_\mathrm{tv} :=   \beta\, T_{\bf{C}\to\bf{R}^2} \nabla T_{\bf{R}^2\to\bf{C}}\ q$">.</li></ul></div><p>Note that the names <tt>Kg</tt> and <tt>vg</tt> were choosen because the appearance of the gradient.</p><p><b>Parts of functional to minimize</b></p><div><ul><li><img src="setiRef_eq15175230372041173335.png" alt="$\texttt{seti.fd} = f_\mathrm{dis}(h) :=   \frac{1}{2} \|K_\mathrm{dis} h+  v_\mathrm{dis} \|_{\mathrm{dis},\bf{R}}^2$">   <img src="setiRef_eq14974224158754676687.png" alt="$\quad$"> is the discrepancy (linearized problem),</li><li><img src="setiRef_eq04901215922585328928.png" alt="$\texttt{seti.fs} = f_\mathrm{spa}(h) :=   \alpha \| h + q\|_{\mathrm{spa}, \bf{R}}$">   <img src="setiRef_eq14974224158754676687.png" alt="$\quad$"> is the sparsity penalty,</li><li><img src="setiRef_eq07387345009002004759.png" alt="$\texttt{seti.fg} = f_\mathrm{tv}(h) :=   \|K_\mathrm{tv} h + v_\mathrm{tv} \|_{\mathrm{tv},\bf{R}}$">   <img src="setiRef_eq14974224158754676687.png" alt="$\quad$"> is the TV-penalty,</li><li><img src="setiRef_eq15868304027089988726.png" alt="$\texttt{seti.fp} = f_\mathrm{phy}(h) :=   \delta_{[a,b,c,d]}(h + q)$">   <img src="setiRef_eq14974224158754676687.png" alt="$\quad$"> is the penalty for physical bounds.</li></ul></div><p>Note that <img src="setiRef_eq05585738636747232515.png" alt="$\delta_{[a,b,c,d]}(x)$"> is a indicator function, i.e. is 0, if all entries of the vector <img src="setiRef_eq12045799382761315906.png" alt="$\mathrm{real}(x)$"> are between <img src="setiRef_eq05508344529756732484.png" alt="$a$"> and <img src="setiRef_eq02044268985122151499.png" alt="$b$"> and all entries of the vector <img src="setiRef_eq15408084442914943985.png" alt="$\mathrm{imag}(x)$"> are between <img src="setiRef_eq08422257486649890878.png" alt="$c$"> and <img src="setiRef_eq17615571056258974497.png" alt="$d$">; and is <img src="setiRef_eq16739024125614530807.png" alt="$\infty$">, otherwise.</p><p><b>Definition of parts of Tikhonov functional</b></p><p>The Tikhonov functional is <tt>MT = M1 + M2</tt>. Function <img src="setiRef_eq08597826192214703288.png" alt="$F$"> is <img src="setiRef_eq17040488434551444591.png" alt="$M_1$">, function <img src="setiRef_eq07365524530707038546.png" alt="$G$"> is <img src="setiRef_eq17449863970030415324.png" alt="$M_2$"> (with <img src="setiRef_eq08597826192214703288.png" alt="$F$"> and <img src="setiRef_eq07365524530707038546.png" alt="$G$"> from PDA) This is done in function <tt>minPda</tt> (<a href="minPda.html">minPda.html</a>) when function <tt>pda</tt> (<a href="pda.html">pda.html</a>) is called.</p><p><b>Further comments (especially interesting in not public version)</b></p><div><ul><li>In case of inversion by pda, it is always (automatically) set   <tt>seti.pNorm = 2</tt> and <tt>seti.qNorm = 1</tt> (except for invNo = 7), see   <a href="setInvType.html">setInvType.html</a>.</li><li>Exponent p of the discrepancy term, see <a href="setInvType.html">setInvType.html</a>, is usually   <tt>seti.p = 2</tt>.   In case of shrinkage or pda with wavelets it may differ, see   <a href="setInvType.html">setInvType.html</a>.</li><li><tt>vs</tt> and <tt>vp</tt> in term <img src="setiRef_eq07365524530707038546.png" alt="$G$">: If you choose <tt>vs</tt> and <tt>vp</tt> manually and   <tt>fs</tt> and <tt>fp</tt> belong to term <img src="setiRef_eq07365524530707038546.png" alt="$G$">, then <tt>vs = vp</tt> is required.</li></ul></div><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="53">recon: Input Arguments</h2><div><ul><li><tt>seti</tt>    :   structure array</li></ul></div><p>Because this is a internal function we do not explain all fields in seti.</p><div><ul><li><tt>seti.loadqROIcomp</tt> : Path to load a mat-file containing the reconstructed                         contrast <tt>qROIcomp</tt> after <tt>iOutStop</tt> outer iterations                         (default: empty, i.\,e. <tt>''</tt> or <tt>[]</tt>, then no data is loaded).</li><li><tt>seti.saveqROIcomp</tt> : Optional: Path to save reconstructed contrast                         (default: same folder as figures, i.e.                         <tt>sprintf('%s/save_qROIcomp_iOutStop%s.mat',seti.dirname,seti.fileSuffix)</tt>)</li></ul></div><div><ul><li><tt>seti.nOut</tt>         : Maximal number of outer iterations.</li></ul></div><div><ul><li><tt>seti.useDis</tt>       : Use discrepancy principle to stop outer iteration?                         (If yes set it to 1.)</li><li><tt>seti.tau</tt>          : Tolerance parameter for discrepancy principle                         (seti.tau &gt; 1).</li></ul></div><div><ul><li><tt>seti.plotFreq</tt>     : Frequency to plot figures of outer iteration steps                         (0: no figures).</li><li><tt>seti.savedata</tt>     : If it is set to 1,                         relative discrepancies, errors, and differences                         of iterated contrasts are saved                         (as <tt>save_dis.mat</tt>, <tt>save_err.mat</tt> and <tt>save_dif.mat</tt>).</li></ul></div><div><ul><li><tt>seti.qROIexact</tt>    : Predefined (exact) contrast                         (complex vector of <tt>size seti.nROI</tt>^|seti.dim| x 1).</li></ul></div><p><b>Further specific input parameters</b> for primal-dual algorithm can be found in <a href="minPda.html">minPda.html</a> and <a href="pda.html">pda.html</a>.</p><p><b>Optional Input Argument</b></p><div><ul><li><tt>dispDepth</tt>     : depth of displayed text.                     (from 0 to 5, default sparse: 2; default details: 4; too much information: 5);</li><li><tt>out</tt>           : output depth for figures and files: no figure (0), plot figure (1),                     save figures and files (2).                     (This argument requires that argument <tt>dispDepth</tt> was                     defined.)</li></ul></div><h2 id="54">recon: Output Arguments</h2><div><ul><li><tt>seti</tt>    :   structure array</li></ul></div><p>Because this is a internal function we do not explain all fields in seti.</p><div><ul><li><tt>seti.qROIcomp</tt>     : Reconstructed contrast                         (complex vector of size <tt>seti.nROI</tt>^|seti.dim| x 1).</li><li><tt>seti.iOutStop</tt>     : Stop index of outer iterations.</li></ul></div><p><b>Discrepancy, error, and difference</b></p><div><ul><li><tt>seti.dis</tt>        : Relative discrepancy for each outer iteration                       (vector of size 1 x seti.nOut).</li><li><tt>seti.err</tt>        : Relative error for each outer iteration                       (vector of size 1 x seti.nOut).</li><li><tt>seti.dif</tt>        : Relative difference of iterated contrast qROI to previously qROI                       for each outer iteration                       (vector of size 1 x seti.nOut).</li></ul></div><p>Note that <tt>seti.dis(iOut)</tt> is the relative discrepancy <i>after</i> iteration <tt>iOut</tt>. (Analog seti.err(iOut) and seti.dif(iOut).)</p><p><b>Minimized Tikhonov functional</b></p><div><ul><li><tt>seti.MTv</tt>        :   Result of minimized Tikhonov functional                         for each outer iteration                         (vector of size 1 x seti.nOut).</li><li><tt>seti.M1v</tt>        :   Result of first part of min. functional                         for each outer iteration                         (vector of size 1 x seti.nOut).</li><li><tt>seti.M2v</tt>        :   Result of second part of min. functional                         for each outer iteration                         (vector of size 1 x seti.nOut).</li></ul></div><p><i>More about M1v and M2v</i></p><div><ul><li>In case of primal-dual algorithm (i.e. <tt>seti.inv = 'pda'</tt>)   <tt>M1v</tt> is F and <tt>M2</tt> is G, see <a href="pda.html">pda.html</a> for F and G.</li><li>In case of shrinkage (i.e. <tt>seti.inv = 'shrinkage'</tt>)   (not available in public version)   <tt>M1</tt> = discrepancy and <tt>M2</tt> = sparsity (setFuncsShrink.m)</li></ul></div><p><b>structure array pdas</b></p><div><ul><li><tt>pdas</tt>        : Structure array                   (only in case of pda, i.e. <tt>seti.inv = 'pda'</tt>).</li></ul></div><div><ul><li><tt>pdas.disLin</tt> : Last relative discrepancy of linearized problem in inner iteration of pda                   for each outer iteration                   (vector of size 1 x seti.nOut).</li><li><tt>pdas.relDis</tt> : Quotient disLin/dis                   for each outer iteration                   (rel. discrepancy of linearized problem / rel. discrepancy of the non-linearized problem)                   (vector of size 1 x seti.nOut).</li><li><tt>pdas.pdaNv</tt>  : Number of inner iterations for each outer iteration                   (vector of size 1 x seti.nOut).</li><li><tt>pdas.ThetaiOutV</tt> : Inner tolerance for each outer iteration                       (in case of inner tolerance principle, see                       <a href="minTolIn.html">minTolIn.html</a>).</li></ul></div><p><b>Further output arguments</b></p><div><ul><li><tt>seti.disIni</tt>   : Relative discrepancy before 1st iteration.</li><li><tt>seti.errIni</tt>   : Relative error before 1st iteration.</li></ul></div><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="55">recon: subplots: Input Arguments</h2><div><ul><li>seti      : structural array</li><li>qROIexact : predefined (i.e. exact) contrast               (usually qROIexact = seti.qROIexact, but in other cases               (e.g. 'source') you can put in something else to plot.)</li><li>qROIcomp  : reconstructed (i.e. computed) contrast</li><li>iOut      : number of outer iteration</li></ul></div><div><ul><li>seti.recname : reconstruction name, e.g. 'contrast' or 'source'.</li></ul></div><p>Specific fields in <tt>seti</tt> influencing the figures are described in <a href="setGeomSim.html">setGeomSim.html</a> in the section "Subfunction: setFigureSettings".</p><h2 id="56">recon: subplots: Output Arguments</h2><p>Output is figure 11 as described in description and in section "Output: Figures" in <a href="start.html">start.html</a>.</p><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="57">recon: plotAndSaveFigures: Input Arguments</h2><div><ul><li>seti      : structural array</li><li>qROIexact : predefined (i.e. exact) contrast</li><li>qROIcomp  : reconstructed (i.e. computed) contrast</li><li>iOut      : number of outer iteration</li><li>out       : Output depth: generate no plots (0),               generate plots (1), generate plots and save them (2).</li></ul></div><p>Specific fields in <tt>seti</tt> influencing the figures are described in <a href="setGeomSim.html">setGeomSim.html</a> in the section "Subfunction: setFigureSettings".</p><p>The most important fields for this function in <tt>seti</tt> are:</p><div><ul><li>seti.dis : relative discrepancies</li><li>seti.err : relative errors</li><li>seti.MTv : result of Tikhonov funtional</li><li>seti.M1v : result of first part of Tikhonov functional</li><li>seti.M2v : result of second part of Tikhonov functional</li></ul></div><p>Further details of this fields are described in <a href="recon.html">recon.html</a>.</p><h2 id="58">recon: plotAndSaveFigures: Output Arguments</h2><p>Plots, see <a href="start.html">start.html</a>.</p><p>Note that figure 11 is plotted in <a href="subplots.html">subplots.html</a>, but saved in this file.</p><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="59">recon: pdaPlot: Input Arguments</h2><div><ul><li>iOut    : number of outer iteration</li><li>seti    : structural array</li><li>pdas    : structural array with specific results from primal-dual             algorithm, see <a href="recon.html">recon.html</a> for details.</li><li>out     : Output depth: generate plots (1), generate plots and save them (2).</li></ul></div><p>Specific fields in <tt>seti</tt> influencing the figures are described in <a href="setGeomSim.html">setGeomSim.html</a> in the section "Subfunction: setFigureSettings".</p><h2 id="60">recon: pdaPlot: Output Arguments</h2><p>Figures are plotted and saved, see <a href="start.html">start.html</a></p><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="61">recon: minPda: Input Arguments</h2><p>Specific input arguments for primal-dual algorithm are described in <a href="pda.html">pda.html</a>.</p><div><ul><li>seti            :   structure array</li><li>seti.pdaNmax    :   maximal iteration number of inner iteration,                       if useTolIn or useTolOut (default : 250)</li></ul></div><div><ul><li>pdas        :   structure array for pda specific outputs,                   see below and also <a href="recon.html">recon.html</a>.</li></ul></div><p><b>structure array pdas</b></p><div><ul><li>pdas.pdaStopInd     :   stop index of inner iteration (i.e. primal-dual algorithm)</li><li>pdas.MTvN           :   result of minimized Tikhonov functional</li><li>pdas.M1vN           :   result of first part of min. functional</li><li>pdas.M2vN           :   result of second part of min. functional</li><li>See also <a href="recon.html">recon.html</a>.</li></ul></div><div><ul><li>pdas.relLinDisInPda :   quotient: relLinDis = disLin / dis (vector of size seti.pdaN x 1)</li><li>pdas.disLinInPda    :   discrepancy of linearized problem for each inner iteration step (vector of size seti.pdaN x 1)</li><li>pdas.errInPda       :   relative error of the reconstructed contrast qROI (vector of size seti.pdaN x 1)</li><li>pdas.minf = minf    :   struct with parts of the minimization functional (Tikhonov functional)</li><li>See also <a href="pda.html">pda.html</a>.</li></ul></div><div><ul><li>pdas.disLin :   last relative discrepancy of linearized problem in inner iteration of pda                   for each outer iteration                   (vector of size 1 x seti.nOut)</li><li>pdas.relDis :   quotient disLin/dis                   for each outer iteration                   (rel. discrepancy of linearized problem / rel. discrepancy of the non-linearized problem)                   (vector of size 1 x seti.nOut)</li><li>pdas.pdaNv  :   number of inner iterations for each outer iteration                   (vector of size 1 x seti.nOut)</li><li>pdas.ThetaiOutV     :   inner tolerance for each outer iteration                           (in case of inner tolerance principle, see                           <a href="minTolIn.html">minTolIn.html</a>.)</li></ul></div><h2 id="62">recon: minPda: Output Arguments</h2><div><ul><li>seti    :   structure array</li><li>seti.qROIcomp   :   new computed reconstruction of the contrast                       (complex vector of size seti.nROI^seti.dim x 1)</li><li>pdas    :   structure array for pda specific output,               expanded for currently computed iteration step               (see "Input Arguments" for a reference).</li></ul></div><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="63">recon: minPda: minTolIn: Input Arguments</h2><p>Parameters for inner tolerance, see Section "More About". We give values of parameters, which worked fine.</p><div><ul><li>seti.ThetaStart = 0.925</li><li>seti.ThetaMax = 0.95</li><li>seti.TolGamma = 0.90</li></ul></div><p>Other parameters in struct seti:</p><div><ul><li><tt>seti.tau</tt>    :   Discrepancy principle stops at parameter tau . delta.</li><li><tt>seti.delta</tt>  :   relative noise level</li><li><tt>seti.FmeasDelta</tt> :   scattered field at receivers positions (i.e. 'the data')                         (uScaRX = uTotRX - uIncRX, i.e. total field minus incident field)                         (complex matrix of size seti.measNb x seti.incNb)</li></ul></div><h2 id="64">recon: minPda: minTolIn: Output Arguments</h2><p>No fields of struct seti as output.</p><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="65">recon: minPda: minTolOut: Input Arguments</h2><div><ul><li><tt>seti.pdaNmax</tt>      : Maximal iteration number, if <tt>seti.useTolIn</tt> or                         <tt>seti.useTolOut</tt> are 1 (default : 250).</li><li><tt>seti.relDisTol</tt>    : Outer tolerance (default: 0.05).</li></ul></div><h2 id="66">recon: minPda: minTolOut: Output Arguments</h2><p>No fields of struct seti.</p><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><h2 id="67">recon: minPda: pda: Input Arguments</h2><p>Most important input arguments (there are more...)</p><div><ul><li>seti        :   struct seti</li></ul></div><p><b>Some of the fields in struct seti</b></p><p>Note that several fields in struct seti are necessary to run pda.</p><p>The routine <tt>pda</tt> is an internal one that needs the specific environment created in the package.</p><div><ul><li>seti.dim    :   dimension of the problem (2 or 3)</li><li>seti.nROI   :   discretization points for each dimension                   of region of interest (ROI) (in samples)</li></ul></div><div><ul><li>seti.pdaN   :   number of inner iterations (PDA) (is called nPda)</li><li>seti.pdaStepsize    :   method to choose primal and dual stepsizes                           (<tt>'fix'</tt> (default) or <tt>'adaptive'</tt>),                           see <a href="pdaChoosingStepsizes.html">pdaChoosingStepsizes.html</a>.</li><li>seti.vartheta       :   parameter in (0,1) used in case of adaptive stepsizes,                           see <a href="pdaChoosingStepsizes.html">pdaChoosingStepsizes.html</a>.</li></ul></div><h2 id="68">recon: minPda: pda: Output Arguments</h2><p>No fields of struct seti.</p><pre class="codeinput"><span class="comment">%%%%%</span>
</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2018b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% Reference of the structure array seti
%
% Descriptions of fields of structure array seti.
%

%% More About this file
%
% * This file summarizes the fields of the main structure array |seti| for each function in one file. 
% * Therefore we copied the descriptions of the fields seti, that are available in the sections "Input Arguments" and "Output arguments" of the source code documentation of each file (the order bases on <programStructure.html>). Therefore duplicates will occur. Please note that we only summarized the fields of |seti|. For other input or output arguments see the source code documentation of the corresponding file.
% * In the headlines we do not describe the path but the dependence of the function, e.g. |setData:setGeomSim| does mean that the routine |setGeomSim| depends on the function |setData|.
% * The dependence starts at the function |start|.

%%%%%

%% setInput: Input Arguments
%
% All fields are set automatically, if they does not exist:
%
% * seti.dirOutput  :   name of folder in which directories for output 
%                       files and figures are created.
%                       (default: 'output')
% * seti.dirDatetime    :   date and time separated by the character "T",
%                           e.g. 20161006T105735.
% * seti.dirSuffix      :   suffix for dirname (default: '')
% * seti.dirSuffixAdd   :   additional suffix of dirname 
%                           (e.g. in case of varalpha, varbeta, vardelta, gscale; or expData is 'fresnel')
% * seti.dirname        :   dirname of files and figures for current
%                           computation, default:
%                           |seti.dirOutput + / + seti.datetime + _ + seti.inseti + seti.dirSuffix + seti.dirSuffixAdd|
%                           If seti.inseti is empty, 'noinseti' is used in
%                           dirname, e.g.
%                           |seti.dirname =
%                           'output/20161006T102740_noinseti'|.
% Not set automatically:
%
% * seti.expData : see <setData.html>
%
%% setInput: Output Arguments
%
% * seti.dirDatetime    : date and time (format: YYYYMMDDThhmmss)
% * seti.fileSuffix     : suffix name for filename
%
% * seti.inseti     :   name of function including input parameters in folder inseti.
% * seti.closed     :   is always 0 in public version 
%                       (value 1 would mean that closed code is available)
%                        (see also <init.html> for variable |closed|)

%%%%%

%% setInput:dirMake: Input Arguments
%
% seti : structural array
%
% _The following fields can be set by user (otherwise set default values):_
%
% * seti.gscale  : grid scaling on (1) or off (0), see <setGridScale.html>
% * seti.expData : e.g. 'fresnel' if data from Institute Fresnel are used, see <setData.html>
%
% See <setInput.html> for the following fields (they can be defined by user
% too):
%
% * seti.dirOutput 
% * seti.dirDatetime
% * seti.dirSuffix      
% * seti.dirSuffixAdd
% * seti.dirname
%
%% setInput:dirMake: Output Arguments
%
% Several fields in seti, if they was not set as input argument; see above.
%

%%%%%

%% setData: Input Arguments
%
% We only mention explictly the input arguments to deal with experimentally
% measured data from Institute Fresnel.
%
% * seti.expData    :   Set 'fresnel' to load real-world data
%                       (experimentally measured) from Institute Fresnel.
%
% *The following parameters can be set by user only in case of 
%  seti.expData = 'fresnel'*
% 
% For further details see <loadData.html> and <matchIncField.html>.
%
% * seti.fresnelFreq    :   frequency of Fresnel data set in Hz
%                           (default: 5e+09)
% * seti.fresnelFile    :   path to real-world data
%                           (default:
%                           'inexpdata/fresnel_opus_1/twodielTM_8f.exp')
%                           (Make sure to use data with |TM| in the filemname,
%                           which stands for transverse magnetic (TM) 
%                           polarization, because the Helmholtz equation
%                           only models electromagnetic waves in the TM
%                           case, see Section 2 in [1].)
% * seti.nuMax          :   match incident field parameter (default: 7)
% * seti.ampCalc        :   method to compute the coefficients c (1, 2 or 3),
%                           we recommend to use method 1.
%
%% setData: Output Arguments
%
% * seti    :   structure array
%
% For the following output arguments see <setGeomSim.html>:
%
% * seti.tol
%
%
% For the following output arguments see Subfunction |setFigureSettings| in
% <setGeomSim.html>:
%
% _Can be set by user (otherwise default is set)_:
%
% * seti.plotFreq       :   default: 1
% * seti.usecbarlim     :   default: 1
% * seti.cbarlim        :   default: [-0.2 1.4]
% * seti.plotPublish    :   default: 0
% * seti.pubFontSize    :   default: 20
% * seti.plotVisible    :   default: 'off'
% * seti.savepng        :   default: 1
% * seti.saveepsc       :   default: 0
% * seti.savefig        :   default: 0
% * seti.plotFreqiPda   :   default: 0
%
% For the following output arguments see <setGrid.html>:
%
% _Can be set by user (otherwise default is set)_:
%
% * seti.dim            :   default: 2
% * seti.rCD            :   default: 0.2
% * seti.nCD            :   default: 256
%
% _Are set automatically_:
%
% * seti.h              :   2*rCD/nCD
% * seti.dV
% * seti.grid           :   size: seti.dim x seti.nCD^seti.dim
% * seti.ballMask       :   size: seti.nCD x seti.nCD (logical)
% * seti.nROI
% * seti.gridROI        :   size: seti.dim x seti.nROI^seti.dim
% * seti.ROImask        :   size: nCD x nCD (logical)
% * seti.ballMaskROI    :   size: nROI x nROI (logical)
%
% For the following output arguments see <setReshapeVecMat.html>:
%
% _Are set automatically:_
%
% * seti.GROI
% * seti.GCD
% * seti.G
% * seti.iG
%
% For the following output arguments see <setGridScale.html>:
%
% _Can be set by user (otherwise default is set)_:
%
% * seti.gscale     : default: 0
% * seti.nCDinv     :
%
% _Are set automatically:_
%
% * seti.nInv       :
% * seti.hInv       :
% * seti.dVinv      :
% * seti.GInv       :
% * seti.GU         :
% * seti.GD         :
%
% For the following output arguments see <setIdImagReal.html>:
% 
% _Are set automatically:_
%
% * seti.S  :   
% * seti.R  :   
% * seti.I  :   
% * seti.T  :   
%
% For the following output arguments see <setKernel.html>:
%
% _Can be set by user (otherwise default is set)_:
%
% * seti.k      : default: 250
% * seti.model  : default: 'helmholtz2D'
%
% _Are set automatically:_
%
% * seti.kHat   : size nCD x nCD
%
% For the following output arguments see <expSetup.html>:
%
% _Can be set by user (otherwise default is set)_:
%
% * seti.incType        :   default: 'pointSource'
% * seti.measType       :   default: 'nearField'
% * seti.incNb          :   default: 35
% * seti.measNb         :   default: 35
% * seti.radSrc         :   default: 5
% * seti.radMeas        :   default: 5
% * seti.incPntsType    :   default: 'circle'
% * seti.measPntsType   :   default: 'circle'
%
% _Are set automatically:_
%
% * seti.incPnts        :   size seti.dim x seti.incNb
% * seti.dSInc          :   
% * seti.measPnts       :   size seti.dim x seti.measNb
% * seti.dSMeas         :   
% 
% * seti.incField       :   complex matrix of size 
%                           seti.nROI^seti.dim x seti.incNb
% * seti.measKer        :   complex matrix of size 
%                           seti.measNb x seti.nROI^seti.dim
%
% For the following output arguments see <setContrast.html>:
%
% _Can be set by user (otherwise default is set)_:
%
% * seti.contrast   :   default: 'cornerBallSparse2D'
%
% _Are set automatically:_
%
% * seti.qCDexact   :   size: seti.nCD^seti.dim x 1
% * seti.qROIexact  :   size: seti.nROI^seti.dim x 1
%
%
% For the following output argument see <setGeomSim.html>:
%
% Note that seti.mCD unequal 0 is not supported in public version.
%
% _Can be set by user (otherwise default is set)_:
%
% * seti.mCD    :   default: 0
% 
% For the following output arguments see <addNoise.html>:
% 
% _Can be set by user (otherwise default is set)_:
%
% * seti.delta      :   default: 0.01
% * seti.whichNoise :   default: 'normal'
% * seti.seed       :   default: 0
%
% The following output arguments are set in setData (this function):
%
% _Can be set by user (otherwise default is set)_:
%
% * seti.loadFmeas      :   path to mat-file containing variables 
%                           FmeasExact and FmeasDelta.
%                           (default: empty, i.e. '').
% * seti.useFmeasDelta  :   Set it to 1 to use FmeasDelta in loadFmeas
%                           (default: 1).
%
% _Are set automatically:_
%
% * seti.FmeasExact     :   scattered field evaluated on receivers positions 
%                           (complex matrix of size seti.measNb x seti.incNb),
%                           see also <mimo.html>.
% * seti.FmeasDelta     :   FmeasExact with noise (synthetic data), see <addNoise.html>
%                           (complex matrix of size seti.measNb x seti.incNb).
%

%%%%%

%% setData: checkConsisExpData: Input Arguments
%
% * seti    : structure array
%
% * seti.expData    : This field is not required. If it is not set, the
% structure |seti| is not changed. Possible inputs: |'fresnel'|. (Note that
% |'simonetti'| is not supported in the public version of this ode.)
%
% The following input arguments can be set by user, otherwise default values are
% set (in case of |seti.expData = 'fresnel'|):
%
% * |seti.rCD|  : Size of computational domain [-rCD,rCD)^dim
%                 (default: 0.2 m), see <setGrid.html>.
% * |seti.nCD|  : Number of discretization points for each dimension of CD
%                 (default: 256), see <setGrid.html>.
% * |seti.fresnelFreq|  : Frequency of the Fresnel data set (default: 5 GHz
% = |5*1E9|)
% * |seti.fresnelFile|  : path to the file with data from Institute Fresnel
%                         (default: 'inexpdata/fresnel_opus_1/twodielTM_8f.exp').
%
% * |seti.nuMax|    : match incident field using Hankel functions of first kind and orders
%                     $\nu = -\texttt{nuMax}, ..., -1, 0, 1, ...,
%                     \texttt{nuMax}$ (default: 7)
% * |seti.ampCalc|  : method to compute the coefficients c (1, 2 or 3),
%                     (default: 1), see <matchIncField.html>.
%
%
%% setData:checkConsisExpData: Output Arguments
%
% * seti    : structure array
%
% In case of |seti.expData = 'fresnel'| the output arguments of |seti| are
%
% * |seti.dim = 2|  : The dimension of the problem is 2.
% * |seti.incType =  'pointSource'| : The type of incident field is set to point sources.
% * |seti.measType = 'nearField'|   : The measurement type is set to near field data.
%
% Additional fields of |seti| may set, if they was not set by the user (see
% Input Arguments).

%%%%%

%% setData:loadData: Input Arguments
%
% * |seti|      : structure array
%
% The input arguments are the input and output arguments of
% |checkConsisExpData| in case of |seti.expData = 'fresnel'|, i.e.:
%
% * |seti.rCD|  : Size of computational domain [-rCD,rCD)^dim
%                 (default: 0.2 m), see <setGrid.html>.
% * |seti.nCD|  : Number of discretization points for each dimension of CD
%                 (default: 256), see <setGrid.html>.
% * |seti.fresnelFreq|  : Frequency of the Fresnel data set
%                         (default: 5 GHz = |5*1E9|)
% * |seti.fresnelFile|  : path to the file with data from Institute Fresnel
%                         (default: 'inexpdata/fresnel_opus_1/twodielTM_8f.exp').
%
% * |seti.nuMax|    : match incident field using Hankel functions of first kind and orders
%                     $\nu = -\texttt{nuMax}, ..., -1, 0, 1, ...,
%                     \texttt{nuMax}$ (default: 7)
% * |seti.ampCalc|  : method to compute the coefficients c (1, 2 or 3),
%                     (default: 1), see <matchIncField.html>.
%
% * |seti.dim = 2|  : The dimension of the problem is 2.
% * |seti.incType =  'pointSource'| : The type of incident field is set to point sources.
% * |seti.measType = 'nearField'|   : The measurement type is set to near field data.
%
% *Optional Input Arguments*
%
% * dispDepth   : depth of displayed messages (number between 0 and 5).
% * out         : depth of output: no figure (0), plot figure (1), plot and save figure (2).
%
%% setData:loadData: Output Arguments
%
% Most important output arguments, i.e. fields in structure array |seti|.
%
% * |seti.incNb|      :   number of transmitters (number of incident fields)
% * |seti.measNb|     :   number of receivers (number of measurements)
% * |seti.radSrc|     :   radius of circle transmitters are arranged on
% * |seti.radMeas|    :   radius of circle receivers are arranged on
%
% * |seti.k|          :   wave number ($k = 2 \pi f/c$ with frequency f and light velocity c)
% * |seti.FmeasDelta| :   scattered field at receivers' positions (i.e. 'the data') for each transmitter
%                         (uScaRX = uTotRX - uIncRX, i.e. total field minus incident field)
%                         (complex matrix of size seti.measNb x seti.incNb)
% * |seti.incField|   :   Incident field in the region of interest (ROI)
%                         for each transmitter
%                         (complex matrix of size seti.nROI^seti.dim x seti.incNb)

%%%%%

%% setData:loadData:matchIncField: Input Arguments
% 
% * seti.dim        :   dimension of the problem: 2 (3 not available)
% * seti.incNb      :   number of transmitters
% * seti.k          :   wave number
% * seti.incPnts    :   Positions of the transmitters, 
%                       (matrix of size seti.dim x seti.incNb), 
%                       seti.incPnts = [5 -2 3; 0 4 2] 
%                       describes coordinates (5,0), (-2,4), and (3,2).
% * seti.measPnts   :   Positions of the receivers
%                       (matrix of size seti.dim x seti.measNb),
%                       coordinates analogical to seti.incPnts.
% * seti.gridROI    :   grid of region of interest (ROI) 
%                       (in case of region = 'ROI')
%                       (matrix of size seti.dim x seti.nROI^seti.dim)
% * seti.grid       :   grid of computational domain (CD)
%                       (in case of region = 'CD')
%                       (seti.dim x seti.nCD^seti.dim)
%
% * seti.ampCalc    :   method to compute the coefficients c (1, 2 or 3),
%                       we recommend to use method 1 (default)
%                       because it is the most accurate and fast, as shown in [1].
%                       (1: best-approximation to V c = z via MATLAB
%                       function,
%                       2: $c = (\gamma I + V^\ast\ V)^{-1} (V^\ast\
%                       \texttt{uIncRX})$
%                           via linear Tikhonov regularization,
%                       3: Landweber iteration)
% * seti.nuMax      :   match incident field using Hankel functions of first kind and orders
%                       $\nu = -\texttt{nuMax}, ..., -1, 0, 1, ...,
%                       \texttt{nuMax}$ (default: 7)
%
% * uIncRX          :   incident field at receivers' positions for each
%                       transmitter
%                       (complex matrix of size seti.measNb x seti.incNb)
% * region          :   'ROI' or 'CD' (region of interest or computational domain)
%                       (usually we are interested in ROI)
%
%
%% setData:loadData:matchIncField: Output Arguments
%
% No fields of |seti|.
%

%%%%%

%% setData:setGeomSim: Input Arguments
%
% * seti    :   structure array, see below in "Output Arguments" and also <setData.html>.
%
%% setData:setGeomSim: Output Arguments
%
% * seti        :   structure array
%
% Following parameters can be set by user (otherwise default is set):
%
% * seti.tol    :   tolerance for GMRES in <solveLippmannSchwinger.html>
%                   (default: 1E-6)
% * seti.mCD    :   coarse grid size (default: 0). 
%                   If mCD = 0, then two-grid is disabled.
%                   Note that coarse gris is not supported in public version.
%
% * Fields of seti, that are directly processed in setGeomSim, are
% described in this file.
% * Other fields are explained in the corresponding functions
% (<setGrid.html>, <setReshapeVecMat.html>,
% <setGridScale.html>, <setIdImagReal.html>, <setKernel.html>,
% <expSetup.html>, <setContrast.html>).
% An assignment of the fields to the functions is given in <setData.html>.
% 
% *Subfunction: setFigureSettings*
%
% Following parameters can be set by user (otherwise default is set):
%
% * seti.plotFreq       :   (default: 1) 
%                           0: do not plot; 
%                           n > 0: plot each n-th outer iteration.
% * seti.usecbarlim     :   (default: 1) 
%                           0: colorbar limits are set automatically; 
%                           1: set the limits manually (for real and imag colorbars in 2D)
% * seti.cbarlim        :   (default: [-0.2 1.4]) vector [cbarmin,cbarmax].
% * seti.plotPublish    :   (default: 0) 
%                           0 or 1, save figures designed for publications,
%                           i.e. no title, no axis, bigger font size for colorbar.,
%                           see <plot2DstylePublish.html> and <plot3DstylePublish.html>.
% * seti.pubFontSize    :   (default: 20) font size for publishing figures.
% * seti.plotVisible    :   (default: 'off') 
%                           figure visibility by MATLAB figure property
%                           "Visible", see [1].
% * seti.savepng        :   (default: 1) 0 or 1, save figures as *.png.
% * seti.saveepsc       :   (default: 0) 0 or 1, save figures as colored *.eps.
% * seti.savefig        :   (default: 0) 0 or 1, save figures as *.fig.
% * seti.plotFreqiPda   :   (default: 0) Frequency of plots inside pda 
%                           A folder is made for every outer iteration.
%                           (This option is not available in public version.)
%

%%%%%

%% setData:setGeomSim: setGrid: Input Arguments
%
% * seti    :   structure array
%
% If input arguments are not set, default values will be used.
%
% * seti.dim     :  dimension of the problem (2 or 3) (default: 2)
% * seti.nCD     :  number of discretization points for each dimension
%                   of computational domain (CD) (in samples)
%                   (default: 256).
% * seti.rCD     :  Size of computational domain [-rCD,rCD)^dim
%                   (default: 0.2) (in meters)
%
%
%% setData:setGeomSim: setGrid: Output Arguments
%
% * seti    :   structure array
%
% * seti.h          :   length of the infinitesimal element of CD.
% * seti.dV         :   area/volume of the infinitesimal element (pixel/voxel) of CD
% * seti.grid       :   grid of computational domain (CD)
%                       (seti.dim x seti.nCD^seti.dim)
% * seti.ballMask   :   mask (logical matrix of size seti.nCD x seti.nCD)
%                       to restrict (later) the contrast in CD 
%                       to the mathematical sensible region.
% * seti.nROI       :   discretization points for each dimension
%                       of region of interest (ROI) (in samples)
% * seti.gridROI    :   grid of region of interest (ROI) 
%                       (matrix of size seti.dim x seti.nROI^seti.dim)
% * seti.ROImask    :   mask (logical matrix of size seti.nCD x seti.nCD)
%                       to restrict (later) the contrast in CD
%                       to the region of interest (ROI).
% * seti.ballMaskROI :   mask (logical matrix of size seti.nROI x seti.nROI)
%                       to restrict (later) the contrast in ROI
%                       to the mathematical sensible region.
%                       (This mask is currently useless, see "More About".)
%

%%%%%

%% setData:setGeomSim:setReshapeVecMat: Input Arguments
%
% * seti.dim    : see <setGrid.html>.
% * seti.nCD    : see <setGrid.html>.
% * seti.nROI   : see <setGrid.html>.
%
%% setData:setGeomSim:setReshapeVecMat: Output Arguments
%
% * seti.GROI   : reshapes a vector of size seti.nROI^seti.dim 
%                 into a matrix of size seti.nROI x seti.nROI in 2D
%                 and seti.nROI x seti.nROI x seti.nROI in 3D.
% * seti.GCD    : reshapes a vector of size seti.nCD^seti.dim 
%                 into a matrix of size seti.nCD x seti.nCD in 2D
%                 and seti.nCD x seti.nCD x seti.nCD in 3D.
% * seti.G      : same as seti.GROI.
% * seti.iG     : reshapes a matrix into a vector.

%%%%%

%% setData:setGeomSim:setGridScale: Input Arguments
%
% If the fields was not defined, default values are set.
%
% * seti.gscale     :   1: use a down scaled grid for reconstruction;
%                       0: do not use grid scaling (default)
% * seti.nCDinv     :   number of discretization points
%                       _of the downscaled grid_
%                       for each dimension of CD.
%                       (for nCD see <setGrid.html>).
%                       (default: |floor(seti.nCD/2)|).
%
%
%% setData:setGeomSim:setGridScale: Output Arguments
%
% * seti.nInv   :   The analogue to seti.nROI, see <setGrid.html>, for the downscaled grid.
% * seti.hInv   :   The analogue to seti.h, see <setGrid.html>, for the downscaled grid.
% * seti.dVinv  :   The analogoue to seti.dV, see <setGrid.html>, for the downscaled grid.
% * seti.GInv   :   The analogue to seti.G, see <setReshapeVecMat.html>, for the downscaled grid.
%
% * seti.GU     :   function to scale up the grid
%                   (input: down scaled contrast as a vector of size seti.nInv^seti.dim;
%                   output: up scaled contrast as a vector of size seti.nROI^seti.dim)
% * seti.GD     :   function to scale down the grid
%                   (input: up scaled contrast as a vector of size seti.nROI^seti.dim;
%                   output: down scaled contrast as a vector of size seti.nInv^seti.dim)

%%%%%

%% setData:setGeomSim:setIdImagReal: Input Arguments
%
% * seti    :   structure array (no fields are needed)
%
%% setData:setGeomSim:setIdImagReal: Output Arguments
%
% * seti.S  :   function to identify complex with real vectors/matrices
%               (input: complex vector/matrix; output: real vector/matrix)
% * seti.R  :   extracts the originally real (R) part of the output of seti.S
% * seti.I  :   extracts the originally imag (I) part of the output of seti.S
% * seti.T  :   function to identify real with complex vectors/matrices
%               (input: real vector/matrix (R x R); output: complex vector/matrix)

%%%%%

%% setData:setGeomSim:setKernel: Input Arguments
%
% _This arguments was set in rebis before setKernel is called_:
%
% * seti.dim    : see <setGrid.html>.
% * seti.nCD    : see <setGrid.html>.
% * seti.rCD    : see <setGrid.html>.
%
% _Can be set by user (otherwise default is set)_:
%
% * seti.k      : Wave number, default: 250
% * seti.model  : Model of the problem, default: 'helmholtz2D'
%
%% setData:setGeomSim:setKernel: Output Arguments
%
% * seti.kHat   : kernel, complex matrix of size nCD x nCD.
%

%%%%%

%% setData:setGeomSim:expSetup: Input Arguments
%
%% Input Arguments
%
% * |seti|  :   structure array
%
% Several fields in |seti| are required. Because this is an internal
% function we do not list them.
%
% *Optional Input Arguments to differ from default values*
%
% For details of the the following fields look inside subfunction 
% |expSetupCons| below and the functions  <setIncPnts.html>, 
% <setMeasPnts.html>, <pntsGeometry.html> and <pntsGeometry3D.html>:
%
% * seti.incType        :   type of incident field, default: 'pointSource'
%                           ('planeWave' or 'pointSource')
% * seti.measType       :   type of measurement, default: 'nearField'
%                           ('nearField' or 'farField')
% * seti.incNb          :   number of transmitters, default: 35
% * seti.measNb         :   number of receivers, default: 35
% * seti.radSrc         :   radius of circle for transmitters, default: 5
%                           (not necessary in case of incType='planeWave').
% * seti.radMeas        :   radius of circle for receivers, default: 5
%                           (not necessary in case of measType='farField')
% * seti.incPntsType    :   string with type of geometry for transmitters, default: 'circle'
% * seti.measPntsType   :   string with type of geometry for receivers, default: 'circle'
%
%% setData:setGeomSim:expSetup: Output Arguments
%
% * |seti|  :   structure array
%
% The following fields in |seti| are defined. Look in documentation of 
% corresponding functions and subfunctions (subfunctions are in the Section
% Code).
%
% For details of the the following fields see the functions <setIncPnts.html>, 
% <setMeasPnts.html>, <pntsGeometry.html>:
%
% * seti.incPnts        :   coordinates of transmitters, size seti.dim x seti.incNb
% * seti.dSInc          :   Approximation of the infinitesimal element of closed contour with control points.
% * seti.measPnts       :   coordinates of receivers, size seti.dim x seti.measNb
% * seti.dSMeas         :   Approximation of the infinitesimal element of closed contour with control points.
% 
% Further details of the following parameter are in <setIncField.html>:
%
% * seti.incField       :   incident fields, complex matrix of size 
%                           seti.nROI^seti.dim x seti.incNb
%
% Further details of the following parameter are in <seMeasKer.html>:
%
% * seti.measKer        :   measurement kernel on region of interest (ROI) 
%                           for each receiver 
%                           (complex matrix of size seti.measNb x seti.nROI^seti.dim)
%

%%%%%

%% setData:setGeomSim:expSetup:setIncPnts: Input Arguments
%
% * seti.dim            :   dimension of the problem (2 or 3)
% * seti.incType        :   Type of incident field: 'pointSource' (default) or 'planeWave'
%
% *Input Arguments in case of 2D (seti.dim = 2) and point sources (seti.incType = 'pointSource')*
%
% * seti.incPntsType    :   string with type of geometry:
%                           'manually', 'circle' (default), 'square', 'line', 'borehole'
%
% It follows a *list of type-depending input parameters* to describe the
% details of the geometry. The names are analog to the parameters in 
% <pntsGeometry.html> (mostly with the prefix inc and a big letter,
% exceptions are marked with emphasized).
% Examples are in <pntsGeometry.html>.
% If these parameters are not set, default values are set automatically
% (see inside the code).
%
% _varargin in case of seti.incPntsType = 'manually'_
%
% * seti.incPnts        :   coordinates of points (real matrix of size 2 x Nb).
%
% _varargin in case of seti.incPntsType = 'circle'_
%
% * seti.incNb             :   Number of points (transmitters)
% * _seti.radSrc_          :   radius of circle
%
% _varargin in case of seti.incPntsType = 'square'_
%
% * seti.incNbEdge      :   incNbEdge+1 points are on one edge
%                           (+1 because a point in a corner belongs to two corners).
%                           (Total number of points in square is |4*incNbEdge|.)
% * seti.incEdgeLength  :   Length of one edge.
%
% _varargin in case of seti.incPntsType = 'line'_
%
% * seti.incNbLine      :   Number of points on line.
% * seti.incLineLength  :   Length of line.
% * seti.incLinePos     :   Distance of line right to origin.
%
% _varargin in case of seti.incPntsType = 'borehole'_
%
% * _seti.boreNbLine_      :   Number of points on line.
% * _seti.boreLineLength_  :   Length of line.
% * _seti.boreLinePos_     :   Distance of line right to origin.
%
% *Input Arguments in case of 3D (seti.dim = 3)*
%
% * seti.incPntsType    :   string with type of geometry:
%                           'manually', 'sphereLatLon', 'sphereFibo' (default).
%
% It follows a *list of type-depending input parameters* to describe the
% details of the geometry. The names are analog to the parameters in 
% <pntsGeometry3D.html> (mostly with the prefix inc and a big letter,
% exceptions are marked with emphasized).
% Examples are in <pntsGeometry3D.html>.
% If these parameters are not set, default values are set automatically
% (see inside the code).
%
% _varargin in case of seti.incPntsType = 'manually'_
%
% * seti.incPnts        :   coordinates of points (real matrix of size 3 x Nb).
%
% _varargin in case of seti.incPntsType = 'sphereLatLon' or 'sphereFibo'_
%
% * seti.incNb             :   Number of points (transmitters)
% * _seti.radSrc_          :   radius of sphere
%
%% setData:setGeomSim:expSetup:setIncPnts: Output Arguments
%
% * seti.incPnts    :   Coordinates of points (real matrix of size seti.dim x Nb).
% * seti.incNb      :   Number of points.
% * seti.dSInc      :   Approximation of the infinitesimal element of closed 
%                       contour with control points.
%                       A closed contour does not make sense in the cases
%                       'manually', 'line', and 'borehole', then it is set to 1.
%
% For further information see the corresponding parameters 
% Pnts, Nb, and dS in <pntsGeometry.html> and <pntsGeometry3D.html>.
%

%%%%%

%% setData:setGeomSim:setMeasPnts: Input Arguments
%
% * seti.dim            :   dimension of the problem (2 or 3)
% * seti.measType       :   Type of measurement field: 'nearField' (default) or 'farField'
%
% *Input Arguments in case of 2D (seti.dim = 2) and near field (seti.incType = 'nearField')*
%
% * seti.measPntsType   :   string with type of geometry:
%                           'manually', 'circle' (default), 'square', 'line', 'borehole'
%
% It follows a *list of type-depending input parameters* to describe the
% details of the geometry. The names are analog to the parameters in 
% <pntsGeometry.html> (mostly with the prefix meas and a big letter,
% exceptions are marked with emphasized).
% Examples are in <pntsGeometry.html>.
% If these parameters are not set, default values are set automatically
% (see inside the code).
%
% _varargin in case of seti.measPntsType = 'manually'_
%
% * seti.measPnts        :   coordinates of points (real matrix of size 2 x Nb).
%
% _varargin in case of seti.measPntsType = 'circle'_
%
% * seti.measNb             :   Number of points (transmitters)
% * _seti.radMeas_          :   radius of circle
%
% _varargin in case of seti.measPntsType = 'square'_
%
% * seti.measNbEdge      :  measNbEdge+1 points are on one edge
%                           (+1 because a point in a corner belongs to two corners).
%                           (Total number of points in square is |4*measNbEdge|.)
% * seti.measEdgeLength  :  Length of one edge.
%
% _varargin in case of seti.measPntsType = 'line'_
%
% * seti.measNbLine      :   Number of points on line.
% * seti.measLineLength  :   Length of line.
% * seti.measLinePos     :   Distance of line right to origin.
%
% _varargin in case of seti.measPntsType = 'borehole'_
%
% Note: Option 'borehole' is only useful if seti.incPntsType is also 'borhole'.
%
% * _seti.boreNbLine_      :   Number of points on line.
% * _seti.boreLineLength_  :   Length of line.
% * _seti.boreLinePos_     :   Distance of line right to origin.
%
% *Input Arguments in case of 3D (seti.dim = 3)*
%
% * seti.incPntsType    :   string with type of geometry:
%                           'manually', 'sphereLatLon', 'sphereFibo' (default).
%
% It follows a *list of type-depending input parameters* to describe the
% details of the geometry. The names are analog to the parameters in 
% <pntsGeometry3D.html> (mostly with the prefix meas and a big letter,
% exceptions are marked with emphasized).
% Examples are in <pntsGeometry3D.html>.
% If these parameters are not set, default values are set automatically
% (see inside the code).
%
% _varargin in case of seti.measPntsType = 'manually'_
%
% * seti.measPnts        :   coordinates of points (real matrix of size 3 x Nb).
%
% _varargin in case of seti.measPntsType = 'sphereLatLon' or 'sphereFibo'_
%
% * seti.measNb             :   Number of points (receivers)
% * _seti.radMeas_          :   radius of sphere
%               
%% setData:setGeomSim:setMeasPnts: Output Arguments
%
% * seti.measPnts    :   Coordinates of points (real matrix of size seti.dim x Nb).
% * seti.measNb      :   Number of points.
% * seti.dSMeas      :   Approximation of the infinitesimal element of closed 
%                        contour with control points.
%                        A closed contour does not make sense in the cases
%                        'manually', 'line', and 'borehole', then it is set to 1.
%
% For further information see the corresponding parameters 
% Pnts, Nb, and dS in <pntsGeometry.html> and <pntsGeometry3D.html>.
%
%

%%%%%

%% setData:setGeomSim:setIncField: Input Arguments
%
% * seti.incType    :   Type of incident field: 'pointSource' or 'planeWave'
% * seti.incNb      :   number of transmitters
%
% * seti.k      :   wave number, see <setKernel.html>
% * seti.model  :   Model of problem 'helmholtz2D' or 'helmholtz3D',
%                   see <setKernel.html>
%
% * seti.nROI    : discretization points for each dimension
%                  of region of interest (ROI) (in samples),
%                  see <setGrid.html>.
% * seti.gridROI : grid of region of interest (ROI) 
%                  (matrix of size seti.dim x seti.nROI^seti.dim)
%                  see <setGrid.html>.
%
% * seti.incPnts    : coordinates of transmitters
%                     (real matrix of size 2 x seti.incNb), see <setIncPnts.html>.
%
%
%% setData:setGeomSim:setIncField: Output Arguments
%
% * |seti.incField|   :   incident field on region of interest (ROI)
%                         for each transmitter
%                         (complex matrix of size seti.nROI^seti.dim x seti.incNb)
%

%%%%%

%% setData:setGeomSim:setMeasKer: Input Arguments
%
% * seti.measType    :   Type of scattered field: 'nearField' or 'farField'
% * seti.measNb      :   number of receivers
%
% * seti.k      :   wave number, see <setKernel.html>
% * seti.model  :   Model of problem 'helmholtz2D' or 'helmholtz3D',
%                   see <setKernel.html>
%
% * seti.nROI    : discretization points for each dimension
%                  of region of interest (ROI) (in samples),
%                  see <setGrid.html>.
% * seti.gridROI : grid of region of interest (ROI) 
%                  (matrix of size seti.dim x seti.nROI^seti.dim)
%                  see <setGrid.html>.
%
% * seti.measPnts    : coordinates of receivers
%                      (real matrix of size seti.dim x seti.measNb), see <setMeasPnts.html>.
%
%
%% setData:setGeomSim:setMeasKer: Output Arguments
%
% * |seti.measKer|      :   measurement kernel on region of interest (ROI)
%                           for each receiver
%                           (complex matrix of size seti.measNb x seti.nROI^seti.dim)
%

%%%%%

%% setData:setGeomSim:setContrast: Input Arguments
%
% * seti    :   structure array
% 
% * |seti.contrast|   :   name of predefined contrast function
% * |seti.rotation|   :   mathematical positive rotation of the contrast in degrees (only in 2D).
%                         (If the field rotation does not exist, no rotation
%                         is done.)
%
%% setData:setGeomSim:setContrast: Output Arguments
%
% * |seti.qCDexact|     :   predefined contrast evalutated on CD
%                           (computational domain) 
%                           (as vector of size seti.nCD^seti.dim x 1).
% * |seti.qROIexact|    :   predefined contrast evalutated on ROI
%                           (region of interest) 
%                           (as vector of size seti.nROI^seti.dim x 1).

%%%%%

%% setData:mimo: Input Arguments
%
% * |seti|       :    struct, details see below.
%
% *struct |seti|*
%
% As in convenience functions 
% <adjOfDer.html>, <forward.html> and <derivative.html>
% all necessary fields (and more) are set by 
%
%   seti = setGeomSim(seti);
%
% A list of all necessary (and not more) fields is below.
%
% seti in <setGeomSim.html>:
%
% * |seti.mCD|      : internal parameter, set seti.mCD = 0 
%                     (no coarse grid is used)
% * |seti.tol|      : internal parameter, set 1E-6, is used in simo and solveLippmannSchwinger
%
% seti in <setGrid.html>:
%
% * |seti.dim|     : dimension of the problem (2 or 3)
% * |seti.nCD|     : number of discretization points for each dimension
%                    of computational domain (CD)
% * |seti.nROI|    : discretization points for each dimension
%                    of region of interest (ROI)
% * |seti.gridROI| : grid of region of interest (ROI) 
%                    (matrix of size seti.dim x seti.nROI^seti.dim)
% * |seti.ROImask| : biggest square in 2D (cube in 3D) in ball with radius rCD/2
%                    (logical array of size seti.nCD x seti.nCD)
% * |seti.dV|      : pixel/voxel area/volume (number)
% 
% seti in <setKernel.html>:
%
% * |seti.model|   : model (helmholtz2D or helmholtz3D)
% * |seti.k|       : wave number
% * |seti.kHat|    : Fourier coefficients of discretized integral operator
%                    (seti.nCD x seti.nCD)
%
% seti in <expSetup.html> (subfiles <pntsGeometry.html>,
% <setIncField.html>, <setMeasKer.html>):
%
% * |seti.measNb|   : number of receivers (number of measurements)
% * |seti.incNb|    : number of transmitters (number of incident fields)
% * |seti.dSInc|    : approximation of the infinitesimal element of closed contour with control points in case of transmitters
% * |seti.dSMeas|   : approximation of the infinitesimal element of closed contour with control points in case of receivers
% * |seti.incField| : incident field, <setIncField.html>
%                     (matrix of size seti.nROI^seti.dim x seti.incNb)
% * |seti.measKer|  : matrix to compute simulated measurement data from solution, <setMeasKer.html>
%                     (size seti.measNb x seti.nROI^seti.dim)
%
%
%% setData:mimo: Output Arguments
%
% No output fields of |seti|.

%%%%%

%% setData:addNoise: Input Arguments
%
% * seti        : structure array
%
% _The following field of the structure array is required:_
%
% * seti.dSMeas         : Approximation of the infinitesimal element of closed 
%                         contour with control points, see <setMeasPnts.html>.
%
% _The following fields of the structure array are optional (otherwise
% default values are set):_
%
% * seti.delta          : Relative (artificial) noise level of data 
%                         (default: 0.01)
% * seti.whichNoise     : Type of used probability density function to 
%                         noise the data:
%                         'laplace', 'uniform', 'normal' (default).
% * seti.seed           : Number to control the random number generator.
%                         Using a non-negative integer (default: 0).
%
%% setData:addNoise: Output Arguments
%
% * seti    :   structure array
%
% If the fields |delta|, |whichNoise|, and |seed| of |seti| was not set,
% default values are set.
%

%%%%%

%% setRecon: Input Arguments
%
% * seti    :   structure array
%
%% setRecon: Output Arguments
%
% * seti    :   structure array
%
% The added fields in |seti| can be found in the called functions
%
% * <setInvType.html>
% * <checkConsisRec.html>
% * <shrinkFuncs.html>
% * <setFuncsPda.html>

%%%%%

%% setRecon:setInvType: Input Arguments
%
% * |seti|        :   struct seti
%
% *Optional Input Arguments of structure |seti|*
%
% If the fields does not exist, default values are set in this function.
%
% * |seti.invNo|  : Number of reconstruction setting (default: 6)
%                   (invNo = 6 is the only one supported in public version)
% * |seti.alpha|  : Regularization parameter for sparsity penalty 
%                   (default: 500).
% * |seti.beta|   : Regularization parameter for total variation penalty
%                   (default: 1E-5).
% * |seti.tau|    : Discrepancy principle stops at parameter tau * delta
%                   (default: 2.5). (Note that delta is the relative noise
%                   level |seti.delta|.)
%
%% setRecon:setInvType: Output Arguments
%
% * |seti.inv|        : Type of reconstruction method: 'pda' or 'shrinkage'
% * |seti.useWavelet| : Using wavelets (1) or not (0)
%                       (Wavelets are not available in public version)
% * |seti.tF|     : Terms belonging to functional F
%                   (e.g. |seti.tF = {'fd','fg'}|; See table below.)
% * |seti.tG|     : Terms belonging to functional G
%                   (e.g. |seti.tG = {'fs','fp'}|; See table below.)
% * |seti.pNorm|  : Index p for p-Schatten-Norm of measurements to define
%                   discrepancy.
% * _More about pNorm:_   default: pNorm = 2, i.e. essentially Frobenius-Norm
% * _More about pNorm:_   in case of inv = 'pda' with invNo 3 to 6
%                         set pNorm = 2 (automatically) because it is required
% * |seti.qNorm|      : Index q for q-Norm of contrasts to define sparsity penalty
% * _More about qNorm_: Standard: qNorm = 1 -> l^1 minimization.
% * _More about qNorm_: in case of inv = 'pda' set qNorm = 1 (automatically)
%                       because it is required.
% * |seti.p|      : Exponent in discrepancy-term $1/p ||...||^p_2$ with $p = 1$ or $2$
%                   (used e.g. in <setFuncsPda.html>)
%                   (default: |seti.p = 2|).
%
% Note: *p ~= pNorm* in general!
%                   (but: in case of inv = 'shrinkage':
%                   pNorm and qNorm are used as exponents too.)
%

%%%%%

%% setRecon: checkConsisRec: Input Arguments
%
% * |seti|        :   struct seti
%
% *Optional Input Arguments of structure |seti|*
%
% If the fields does not exist, default values are set in this function.
%
% * |seti.useWavelet|   : Use wavelets for reconstruction (default: 0).
%                         Note that wavelets are not supported in the 
%                         public version of this code. Therefore the
%                         wavelet-specific fields |wavWeight|,
%                         |genWhiteNoiseNew|, |adaptWeightsMan|, |wavelet|,
%                         |extension|, |smin| and |samples| are not
%                         documented.
% * |seti.recname|      : What is reconstructed? A |'constrast'| (default) 
%                         or a |'source'|. Influences the title in
%                         <subplots.html>.
% * |seti.physBounds|   : Bounds for real/imaginary part of contrast: 
%                         [reMin, reMax, imMin, imMax] 
%                         (default: [-1,3,0,3])
%                         (consider also the penalty for physical bounds in
%                         <pda.html> Section "More About".)
% * |seti.tolDelta|     : Tolerance for physical bounds' delta-function
%                         (default: 1E-14) in <setFuncsPda.html>.
% * |seti.useDis|       : If it is 1 (default), the discrepancy principle
%                         is used to stop the outer iteration. (Otherwise 0).
% * |seti.nOut|         : Maximal number of outer iterations (default: 30).
%
% If the primal-dual algorithm is used (|seti.inv = 'pda')
% and the following fields does not exist, default values are set in this function.
%
% * |seti.pdaN|         : Number of inner iterations (PDA) (default: 50) (see <pda.html>).
% * |seti.pdaStepsize|  : Method to choose primal and dual stepsizes
%                         (|'fix'| (default) or |'adaptive'|)
%                         see <pdaChoosingStepsizes.html>.
% * |seti.vartheta|     : Parameter in (0,1) used in case of adaptive stepsizes,
%                         see <pdaChoosingStepsizes.html>.
% * |seti.useTolIn|     : If it is set to 1 (default: 0), the inner 
%                         tolerance principle is used to stop the inner 
%                         iterations (primal-dual algorithm), see 
%                         <minPda.html> and <minTolIn.html>.
% * |seti.useTolOut|    : If it is set to 1 (default: 0), the outer 
%                         tolerance principle is used to stop the inner 
%                         iterations, see <minPda.html>, <minTolOut.html>.
%
% In case of |seti.inv = 'pda'| and |seti.useTolIn = 1| and the following
% fields does not exist, default values are set in this function.
%
% * |seti.ThetaStart|   : (default: 0.925), see <minTolIn.html>.
% * |seti.ThetaMax|     : (default: 0.95), see <minTolIn.html>.
% * |seti.TolGamma|     : (default: 0.90), see <minTolIn.html>.
% * |seti.pdaNmax|      : Maximal iteration number, if |seti.useTolIn| or
%                         |seti.useTolOut| are 1 (default : 250).
%
% In case of |seti.inv = 'pda'| and |seti.useTolOut = 1| and the following
% fields does not exist, default values are set in this function.
%
% * |seti.relDisTol|    : Outer tolerance (default: 0.05), see <minTolOut.html>.
% * |seti.pdaNmax|      : Maximal iteration number, if |seti.useTolIn| or
%                         |seti.useTolOut| are 1 (default : 250).
%
% The following fields should have been set in <setInvType.html>:
%
% * |seti.inv|
% * |seti.alpha|
% * |seti.beta|
% * |seti.pNorm|
% * |seti.qNorm|
% * |seti.tau|
%
% See <recon.html> for the following fields of |seti|:
%
% * |seti.saveqROIcomp|
% * |seti.loadqROIcomp|
% * |seti.savedata|
%
% Currently unused fields:
%
% * |seti.lambda|   : Wavelength (default: $\lambda = 2\pi/k$ with 
%                     wave number $k = \texttt{seti.k}$) (currently not used anywhere).
%
%% setRecon:checkConsisRec: Output Argument
%
% * |seti|  : structure array, see "Optional Input Arguments of structure
% |seti|", because default values are set, if fields was not already
% defined.
%

%%%%%

%% setRecon:shrinkFuncs: Input Arguments
%
% * seti    :   structure array
%
% * seti.qNorm  :   in sparsity term $f_\mathrm{spa}$ a norm with index 
%                   |seti.qNorm = 1| is used 
%                   (other values are not supported in public version).
%                   (Index q = 1 does essentially (up to some factor) mean $l^1$ minimization)
% * seti.physBounds     :   contains the physical bounds (min and max)
%                           for real and imaginary part of the contrast as
%                           4-vector with structure 
%                           |[reMin reMax imMin imMax]|.
%
%% setRecon:shrinkFuncs: Output Arguments
%
% * seti.shrkRe = @(x,alpha)    :   extended soft-shrinkage function for real part
% * seti.shrkIm = @(x,alpha)    :   extended soft-shrinkage function for imaginary part

%%%%%

%% setRecon:setFuncsPda: Input Arguments
%
% * seti    :   structure array
%
%% setRecon:setFuncsPda: Output Arguments
%
% * seti    :   structure array
%
% For the fields of the structrual array |seti| see the section "More About".
%
% *REPLACE_WITH_DASH_DASH- More About REPLACE_WITH_DASH_DASH-*
%
% We only give a overview of the functions. See also <pda.html>.
% Detailed information are in Section 4.5 in [1].
%
% Note that grid scaling is respected in the code, but for 
% simplicitiy is not presented in the formulas.
%
% *Auxiliary quantities*
%
% For $\texttt{seti.S} = T_{\bf{C}\to\bf{R}^2}$ and $\texttt{seti.T} = T_{\bf{R}^2\to\bf{C}}$, see "More About" in <pda.html>.
%
% * $\texttt{seti.Kd} = K_\mathrm{dis} :=
%   T_{\bf{C}\to\bf{R}^2} [\mathcal{F}'(T_{\bf{R}^2\to\bf{C}}\ q)]T_{\bf{R}^2\to\bf{C}}$,
% * $\texttt{seti.vd} = v_\mathrm{dis} := 
%   T_{\bf{C}\to\bf{R}^2}(\mathcal{F}(T_{\bf{R}^2\to\bf{C}}\ q)-F_\mathrm{meas}^\delta)$,
% * $\texttt{seti.Kg} = K_\mathrm{tv}  := 
%   \beta\,T_{\bf{C}\to\bf{R}^2}\nabla T_{\bf{R}^2\to\bf{C}}$
% * $\texttt{seti.vg} = v_\mathrm{tv} :=
%   \beta\, T_{\bf{C}\to\bf{R}^2} \nabla T_{\bf{R}^2\to\bf{C}}\ q$.
%
% Note that the names |Kg| and |vg| were choosen because the appearance of the gradient.
%
% *Parts of functional to minimize*
%
% * $\texttt{seti.fd} = f_\mathrm{dis}(h) := 
%   \frac{1}{2} \|K_\mathrm{dis} h+  v_\mathrm{dis} \|_{\mathrm{dis},\bf{R}}^2$
%   $\quad$ is the discrepancy (linearized problem),
% * $\texttt{seti.fs} = f_\mathrm{spa}(h) := 
%   \alpha \| h + q\|_{\mathrm{spa}, \bf{R}}$
%   $\quad$ is the sparsity penalty,
% * $\texttt{seti.fg} = f_\mathrm{tv}(h) :=
%   \|K_\mathrm{tv} h + v_\mathrm{tv} \|_{\mathrm{tv},\bf{R}}$
%   $\quad$ is the TV-penalty,
% * $\texttt{seti.fp} = f_\mathrm{phy}(h) :=
%   \delta_{[a,b,c,d]}(h + q)$
%   $\quad$ is the penalty for physical bounds.
%
% Note that $\delta_{[a,b,c,d]}(x)$ is a indicator function, i.e. is 0, 
% if all entries of the vector $\mathrm{real}(x)$ are between $a$ and $b$
% and all entries of the vector $\mathrm{imag}(x)$ are between $c$ and $d$;
% and is $\infty$, otherwise.
%
% *Definition of parts of Tikhonov functional*
%
% The Tikhonov functional is |MT = M1 + M2|. 
% Function $F$ is $M_1$, function $G$ is $M_2$ (with $F$ and $G$ from PDA)
% This is done in function |minPda| (<minPda.html>) when function 
% |pda| (<pda.html>) is called.
%
% *Further comments (especially interesting in not public version)*
%
% * In case of inversion by pda, it is always (automatically) set 
%   |seti.pNorm = 2| and |seti.qNorm = 1| (except for invNo = 7), see
%   <setInvType.html>.
% * Exponent p of the discrepancy term, see <setInvType.html>, is usually
%   |seti.p = 2|.
%   In case of shrinkage or pda with wavelets it may differ, see
%   <setInvType.html>.
% * |vs| and |vp| in term $G$: If you choose |vs| and |vp| manually and 
%   |fs| and |fp| belong to term $G$, then |vs = vp| is required.
%

%%%%%

%% recon: Input Arguments
%
% * |seti|    :   structure array
%
% Because this is a internal function we do not explain all fields in seti.
%
% * |seti.loadqROIcomp| : Path to load a mat-file containing the reconstructed 
%                         contrast |qROIcomp| after |iOutStop| outer iterations 
%                         (default: empty, i.\,e. |''| or |[]|, then no data is loaded).
% * |seti.saveqROIcomp| : Optional: Path to save reconstructed contrast
%                         (default: same folder as figures, i.e. 
%                         |sprintf('%s/save_qROIcomp_iOutStop%s.mat',seti.dirname,seti.fileSuffix)|)
%
% * |seti.nOut|         : Maximal number of outer iterations.
%
% * |seti.useDis|       : Use discrepancy principle to stop outer iteration?
%                         (If yes set it to 1.)
% * |seti.tau|          : Tolerance parameter for discrepancy principle
%                         (seti.tau > 1).
%
% * |seti.plotFreq|     : Frequency to plot figures of outer iteration steps
%                         (0: no figures).
% * |seti.savedata|     : If it is set to 1,
%                         relative discrepancies, errors, and differences 
%                         of iterated contrasts are saved
%                         (as |save_dis.mat|, |save_err.mat| and |save_dif.mat|).
%
% * |seti.qROIexact|    : Predefined (exact) contrast
%                         (complex vector of |size seti.nROI|^|seti.dim| x 1).
%
% *Further specific input parameters* for primal-dual algorithm can be found in
% <minPda.html> and <pda.html>.
%
% *Optional Input Argument*
%
% * |dispDepth|     : depth of displayed text.
%                     (from 0 to 5, default sparse: 2; default details: 4; too much information: 5);
% * |out|           : output depth for figures and files: no figure (0), plot figure (1), 
%                     save figures and files (2).
%                     (This argument requires that argument |dispDepth| was
%                     defined.)
%
%% recon: Output Arguments
%
% * |seti|    :   structure array
%
% Because this is a internal function we do not explain all fields in seti.
%
% * |seti.qROIcomp|     : Reconstructed contrast
%                         (complex vector of size |seti.nROI|^|seti.dim| x 1).
% * |seti.iOutStop|     : Stop index of outer iterations.
%
%
% *Discrepancy, error, and difference*
%
% * |seti.dis|        : Relative discrepancy for each outer iteration
%                       (vector of size 1 x seti.nOut).
% * |seti.err|        : Relative error for each outer iteration
%                       (vector of size 1 x seti.nOut).
% * |seti.dif|        : Relative difference of iterated contrast qROI to previously qROI
%                       for each outer iteration
%                       (vector of size 1 x seti.nOut).
%
% Note that |seti.dis(iOut)| is the relative discrepancy 
% _after_ iteration |iOut|. (Analog seti.err(iOut) and seti.dif(iOut).)
%
% *Minimized Tikhonov functional*
%
% * |seti.MTv|        :   Result of minimized Tikhonov functional 
%                         for each outer iteration 
%                         (vector of size 1 x seti.nOut).
% * |seti.M1v|        :   Result of first part of min. functional
%                         for each outer iteration 
%                         (vector of size 1 x seti.nOut).
% * |seti.M2v|        :   Result of second part of min. functional 
%                         for each outer iteration 
%                         (vector of size 1 x seti.nOut).
%
% _More about M1v and M2v_
%
% * In case of primal-dual algorithm (i.e. |seti.inv = 'pda'|)
%   |M1v| is F and |M2| is G, see <pda.html> for F and G.
% * In case of shrinkage (i.e. |seti.inv = 'shrinkage'|)
%   (not available in public version) 
%   |M1| = discrepancy and |M2| = sparsity (setFuncsShrink.m)
%
% *structure array pdas*
%
% * |pdas|        : Structure array
%                   (only in case of pda, i.e. |seti.inv = 'pda'|).
%
% * |pdas.disLin| : Last relative discrepancy of linearized problem in inner iteration of pda
%                   for each outer iteration 
%                   (vector of size 1 x seti.nOut).
% * |pdas.relDis| : Quotient disLin/dis 
%                   for each outer iteration
%                   (rel. discrepancy of linearized problem / rel. discrepancy of the non-linearized problem)
%                   (vector of size 1 x seti.nOut).
% * |pdas.pdaNv|  : Number of inner iterations for each outer iteration
%                   (vector of size 1 x seti.nOut).
% * |pdas.ThetaiOutV| : Inner tolerance for each outer iteration
%                       (in case of inner tolerance principle, see
%                       <minTolIn.html>).
%
% *Further output arguments*
%
% * |seti.disIni|   : Relative discrepancy before 1st iteration.
% * |seti.errIni|   : Relative error before 1st iteration.
%

%%%%%

%% recon: subplots: Input Arguments
%
% * seti      : structural array
% * qROIexact : predefined (i.e. exact) contrast
%               (usually qROIexact = seti.qROIexact, but in other cases 
%               (e.g. 'source') you can put in something else to plot.)
% * qROIcomp  : reconstructed (i.e. computed) contrast
% * iOut      : number of outer iteration
%
% * seti.recname : reconstruction name, e.g. 'contrast' or 'source'.
%
% Specific fields in |seti| influencing the figures are described in 
% <setGeomSim.html> in the section "Subfunction: setFigureSettings".
%
%% recon: subplots: Output Arguments
%
% Output is figure 11 as described in description and in section 
% "Output: Figures" in <start.html>.

%%%%%

%% recon: plotAndSaveFigures: Input Arguments
%
% * seti      : structural array
% * qROIexact : predefined (i.e. exact) contrast
% * qROIcomp  : reconstructed (i.e. computed) contrast
% * iOut      : number of outer iteration
% * out       : Output depth: generate no plots (0),
%               generate plots (1), generate plots and save them (2).
%
% Specific fields in |seti| influencing the figures are described in 
% <setGeomSim.html> in the section "Subfunction: setFigureSettings".
%
% The most important fields for this function in |seti| are:
%
% * seti.dis : relative discrepancies
% * seti.err : relative errors
% * seti.MTv : result of Tikhonov funtional
% * seti.M1v : result of first part of Tikhonov functional
% * seti.M2v : result of second part of Tikhonov functional
%
% Further details of this fields are described in <recon.html>.
%
%% recon: plotAndSaveFigures: Output Arguments
%
% Plots, see <start.html>.
%
% Note that figure 11 is plotted in <subplots.html>, but saved in this
% file.
%

%%%%%

%% recon: pdaPlot: Input Arguments
%
% * iOut    : number of outer iteration
% * seti    : structural array
% * pdas    : structural array with specific results from primal-dual
%             algorithm, see <recon.html> for details.
% * out     : Output depth: generate plots (1), generate plots and save them (2).
%
% Specific fields in |seti| influencing the figures are described in 
% <setGeomSim.html> in the section "Subfunction: setFigureSettings".
%
%% recon: pdaPlot: Output Arguments
%
% Figures are plotted and saved, see <start.html>

%%%%%

%% recon: minPda: Input Arguments
%
% Specific input arguments for primal-dual algorithm are described in
% <pda.html>.
%
% * seti            :   structure array
% * seti.pdaNmax    :   maximal iteration number of inner iteration,
%                       if useTolIn or useTolOut (default : 250)
%
% * pdas        :   structure array for pda specific outputs, 
%                   see below and also <recon.html>.
%
% *structure array pdas*
%
% * pdas.pdaStopInd     :   stop index of inner iteration (i.e. primal-dual algorithm)
% * pdas.MTvN           :   result of minimized Tikhonov functional 
% * pdas.M1vN           :   result of first part of min. functional
% * pdas.M2vN           :   result of second part of min. functional
% * See also <recon.html>.
%
% * pdas.relLinDisInPda :   quotient: relLinDis = disLin / dis (vector of size seti.pdaN x 1)
% * pdas.disLinInPda    :   discrepancy of linearized problem for each inner iteration step (vector of size seti.pdaN x 1)
% * pdas.errInPda       :   relative error of the reconstructed contrast qROI (vector of size seti.pdaN x 1)
% * pdas.minf = minf    :   struct with parts of the minimization functional (Tikhonov functional)
% * See also <pda.html>.
%
% * pdas.disLin :   last relative discrepancy of linearized problem in inner iteration of pda
%                   for each outer iteration 
%                   (vector of size 1 x seti.nOut)
% * pdas.relDis :   quotient disLin/dis 
%                   for each outer iteration
%                   (rel. discrepancy of linearized problem / rel. discrepancy of the non-linearized problem)
%                   (vector of size 1 x seti.nOut)
% * pdas.pdaNv  :   number of inner iterations for each outer iteration
%                   (vector of size 1 x seti.nOut)
% * pdas.ThetaiOutV     :   inner tolerance for each outer iteration
%                           (in case of inner tolerance principle, see
%                           <minTolIn.html>.)
%
%% recon: minPda: Output Arguments
%
% * seti    :   structure array
% * seti.qROIcomp   :   new computed reconstruction of the contrast
%                       (complex vector of size seti.nROI^seti.dim x 1)
% * pdas    :   structure array for pda specific output, 
%               expanded for currently computed iteration step 
%               (see "Input Arguments" for a reference).
%

%%%%%

%% recon: minPda: minTolIn: Input Arguments
%
% Parameters for inner tolerance, see Section "More About".
% We give values of parameters, which worked fine.
%
% * seti.ThetaStart = 0.925
% * seti.ThetaMax = 0.95
% * seti.TolGamma = 0.90
%
% Other parameters in struct seti:
%
% * |seti.tau|    :   Discrepancy principle stops at parameter tau . delta.
% * |seti.delta|  :   relative noise level
% * |seti.FmeasDelta| :   scattered field at receivers positions (i.e. 'the data')
%                         (uScaRX = uTotRX - uIncRX, i.e. total field minus incident field)
%                         (complex matrix of size seti.measNb x seti.incNb)
%
%% recon: minPda: minTolIn: Output Arguments
%
% No fields of struct seti as output.

%%%%%

%% recon: minPda: minTolOut: Input Arguments
%
% * |seti.pdaNmax|      : Maximal iteration number, if |seti.useTolIn| or
%                         |seti.useTolOut| are 1 (default : 250).
% * |seti.relDisTol|    : Outer tolerance (default: 0.05).
%
%% recon: minPda: minTolOut: Output Arguments
%
% No fields of struct seti.
%

%%%%%

%% recon: minPda: pda: Input Arguments
%
% Most important input arguments (there are more...)
%
% * seti        :   struct seti
%
% *Some of the fields in struct seti*
%
% Note that several fields in struct seti are necessary to run pda.
%
% The routine |pda| is an internal one that needs the specific environment created in
% the package.
%
% * seti.dim    :   dimension of the problem (2 or 3)
% * seti.nROI   :   discretization points for each dimension
%                   of region of interest (ROI) (in samples)
%
% * seti.pdaN   :   number of inner iterations (PDA) (is called nPda)
% * seti.pdaStepsize    :   method to choose primal and dual stepsizes
%                           (|'fix'| (default) or |'adaptive'|), 
%                           see <pdaChoosingStepsizes.html>.
% * seti.vartheta       :   parameter in (0,1) used in case of adaptive stepsizes,
%                           see <pdaChoosingStepsizes.html>.
%
%
%% recon: minPda: pda: Output Arguments
%
% No fields of struct seti.

%%%%%



##### SOURCE END #####
--></body></html>