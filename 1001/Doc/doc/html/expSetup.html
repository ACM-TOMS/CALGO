
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>expSetup</title><meta name="generator" content="MATLAB 9.5"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2019-04-30"><meta name="DC.source" content="expSetup.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,sub,sup,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; } 

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><h1>expSetup</h1><!--introduction--><p>Set the experimental set-up as well as incident fields and measurements.</p><!--/introduction--><h2>Contents</h2><div><ul><li><a href="#1">Syntax</a></li><li><a href="#2">Description</a></li><li><a href="#3">Input Arguments</a></li><li><a href="#4">Output Arguments</a></li><li><a href="#5">More About</a></li><li><a href="#6">See Also</a></li><li><a href="#7">Code: expSetup</a></li><li><a href="#8">Code: subfunction: expSetupCons</a></li></ul></div><h2 id="1">Syntax</h2><pre class="language-matlab">seti = expSetup(seti)
seti = expSetup(seti,dispDepth)
seti = expSetup(seti,dispDepth,out)
</pre><h2 id="2">Description</h2><p><tt>seti = expSetup(seti)</tt> does the following</p><div><ol><li>Check consistency of input in struct <tt>seti</tt>   (otherwise default values are set) (subfunction <tt>expSetupCons</tt>)</li><li>Define incident and measurement points   (i.e. transmitters and receivers positions)   (functions <a href="setIncPnts.html">setIncPnts.html</a> and <a href="setMeasPnts.html">setMeasPnts.html</a>)   (If real-world data is loaded this is skipped).</li><li>Evalute incident fields on ROI (function <a href="setIncField.html">setIncField.html</a>)</li><li>Set up measurement kernels (such that measurement = k^2 * kernel * solution * voxelVolume)   (function <a href="setMeasKer.html">setMeasKer.html</a>)</li><li>Plot experimental set-up (function <tt>plotExpSetup</tt>) (in case of <tt>out</tt> is 1 or greater.</li></ol></div><p><tt>seti = expSetup(seti,dispDepth)</tt> does the same but allows to control the depth of displayed messages by <tt>dispDepth</tt>.</p><p><tt>seti = expSetup(seti,dispDepth,out)</tt> does the same but allows to plot and additionally save figures as well as files controlled by <tt>out</tt>.</p><h2 id="3">Input Arguments</h2><div><ul><li><tt>seti</tt>  :   structure array</li></ul></div><p>Several fields in <tt>seti</tt> are required. Because this is an internal function we do not list them.</p><p><b>Optional Input Arguments to differ from default values</b></p><p>For details of the the following fields look inside subfunction <tt>expSetupCons</tt> below and the functions  <a href="setIncPnts.html">setIncPnts.html</a>, <a href="setMeasPnts.html">setMeasPnts.html</a>, <a href="pntsGeometry.html">pntsGeometry.html</a> and <a href="pntsGeometry3D.html">pntsGeometry3D.html</a>:</p><div><ul><li>seti.incType        :   type of incident field, default: 'pointSource'                           ('planeWave' or 'pointSource')</li><li>seti.measType       :   type of measurement, default: 'nearField'                           ('nearField' or 'farField')</li><li>seti.incNb          :   number of transmitters, default: 35</li><li>seti.measNb         :   number of receivers, default: 35</li><li>seti.radSrc         :   radius of circle for transmitters, default: 5                           (not necessary in case of incType='planeWave').</li><li>seti.radMeas        :   radius of circle for receivers, default: 5                           (not necessary in case of measType='farField')</li><li>seti.incPntsType    :   string with type of geometry for transmitters, default: 'circle'</li><li>seti.measPntsType   :   string with type of geometry for receivers, default: 'circle'</li></ul></div><p><b>Optional Input Arguments</b></p><div><ul><li>dispDepth   : Depth of displayed messages (0: no, 1 or greater: yes).</li><li>out         : Output depth: generate no plots (0),                 generate plots (1), generate plots and save them (2).</li></ul></div><h2 id="4">Output Arguments</h2><div><ul><li><tt>seti</tt>  :   structure array</li></ul></div><p>The following fields in <tt>seti</tt> are defined. Look in documentation of corresponding functions and subfunctions (subfunctions are in the Section Code).</p><p>For details of the the following fields see the functions <a href="setIncPnts.html">setIncPnts.html</a>, <a href="setMeasPnts.html">setMeasPnts.html</a>, <a href="pntsGeometry.html">pntsGeometry.html</a>:</p><div><ul><li>seti.incPnts        :   coordinates of transmitters, size seti.dim x seti.incNb</li><li>seti.dSInc          :   Approximation of the infinitesimal element of closed contour with control points.</li><li>seti.measPnts       :   coordinates of receivers, size seti.dim x seti.measNb</li><li>seti.dSMeas         :   Approximation of the infinitesimal element of closed contour with control points.</li></ul></div><p>Further details of the following parameter are in <a href="setIncField.html">setIncField.html</a>:</p><div><ul><li>seti.incField       :   incident fields, complex matrix of size                           seti.nROI^seti.dim x seti.incNb</li></ul></div><p>Further details of the following parameter are in <a href="seMeasKer.html">seMeasKer.html</a>:</p><div><ul><li>seti.measKer        :   measurement kernel on region of interest (ROI)                           for each receiver                           (complex matrix of size seti.measNb x seti.nROI^seti.dim)</li></ul></div><h2 id="5">More About</h2><p>For a convenience function to plot the transmitters and receivers positions see <a href="plotExpSetup.html">plotExpSetup.html</a>.</p><h2 id="6">See Also</h2><div><ul><li><a href="setIncPnts.html">setIncPnts.html</a></li><li><a href="setMeasPnts.html">setMeasPnts.html</a></li><li><a href="plotExpSetup.html">plotExpSetup.html</a></li><li><a href="setIncField.html">setIncField.html</a></li><li><a href="setMeasKer.html">setMeasKer.html</a></li></ul></div><h2 id="7">Code: expSetup</h2><pre class="codeinput"><span class="keyword">function</span> seti = expSetup(seti,varargin)

<span class="keyword">if</span> nargin == 2
    dispDepth = varargin{1};
    out = 0;
<span class="keyword">elseif</span> nargin == 3
    dispDepth = varargin{1};
    out = varargin{2};
<span class="keyword">else</span>
    dispDepth = 0;
    out = 0;
<span class="keyword">end</span>

seti = expSetupCons(seti,dispDepth);

<span class="keyword">if</span> ~isfield(seti,<span class="string">'expData'</span>) || ( isfield(seti,<span class="string">'expData'</span>) &amp;&amp; strcmp(seti.expData,<span class="string">'fresnel'</span>) )
    <span class="comment">% Future work: implementation of incPnts and measPnts type 'manually' in 3D</span>
    seti = setIncPnts(seti,dispDepth);
    seti = setMeasPnts(seti,dispDepth);
<span class="keyword">end</span>

<span class="comment">% Evaluate incident fields on ROI</span>
seti = setIncField(seti);

<span class="comment">% and set up measurement kernels seti.measKer</span>
<span class="comment">% (such that measurement = k^2 * kernel * solution * voxelVolume, i.e.</span>
<span class="comment">%  measurement = uScattRX = FmeasDelta = seti.k^2*seti.measKer*qROI.*(uIncROI+uScattROI)*seti.dV)</span>
seti = setMeasKer(seti);

<span class="comment">% Plot experimental set-up (function |plotExpSetup|)</span>
<span class="keyword">if</span> out &gt;= 1
    plotExpSetup(seti,out);
<span class="keyword">end</span>

<span class="keyword">end</span>
</pre><h2 id="8">Code: subfunction: expSetupCons</h2><p>Check consistency of input (or set default values)</p><p><b>Syntax</b></p><pre class="language-matlab">seti = expSetupCons(seti,dispDepth)
</pre><p><b>Output Arguments</b></p><div><ul><li>seti.incType    :   type of incident wave                       ('planeWave' or 'pointSource')</li><li>seti.measType   :   type of measurement data ('nearField' or 'farField')</li><li>seti.incNb      :   number of transmitters</li><li>seti.measNb     :   number of receivers</li><li>seti.radSrc     :   radius of sphere transmitters are arranged on                       (useless in case of 'planeWave')                       Must be <b>&gt; rCD/2</b> (is checked and adapted).</li><li>seti.radMeas    :   radius of sphere receivers are arranged on                       (useless in case of farField)                       Must be <b>&gt; rCD/2</b> (is checked and adapted.)</li></ul></div><p><b>More About</b></p><div><ul><li>radSrc  :   useless in case of planeWave</li><li>radMeas :   useless in case of farField</li></ul></div><p><i>A stricter restriction than necessary for transmitters' and receivers' positions</i></p><p>In the source code we use a stricter restriction for the transmitters' and receivers' positions than necessary.</p><p>Transmitters:</p><p>In fact, the singularity of the fundamental solution requires the absence of point sources inside the region of interest ROI. This restriction in the continuous formulation of the single-layer potential drops in the discretized version until the transmitter is not nearby a grid point.</p><p>In the code we simply require <tt>seti.radSrc &gt; rCD/2</tt> to omit the implementation of a nearby condition. Remember that we have chosen ROI as biggest square inside the mathematical sensible region, that is the open ball with radius rCD/2. Hence, for the current choice of ROI it would be sufficient to check if the receivers' points are outside this square, but in case of an adapted ROI it is safer to omit the hole mathematical sensible region.</p><p>Receivers:</p><p>Actually, there is no restriction for receivers' positions until they are not inside the support of the contrast <tt>q</tt>.</p><p>In the code we simply require <tt>seti.radMeas &gt; rCD/2</tt>, because actually the true contrast is unknown.</p><p><b>Code</b></p><pre class="codeinput"><span class="keyword">function</span> seti = expSetupCons(seti,dispDepth)

seti = checkfield(seti,<span class="string">'incType'</span>,<span class="string">'pointSource'</span>,dispDepth); <span class="comment">% incType: planeWave or pointSource</span>
seti = checkfield(seti,<span class="string">'measType'</span>,<span class="string">'nearField'</span>,dispDepth); <span class="comment">% measType: nearField or farField</span>

seti = checkfield(seti,<span class="string">'incNb'</span>,35,dispDepth);
seti = checkfield(seti,<span class="string">'measNb'</span>,35,dispDepth);

seti = checkfield(seti,<span class="string">'radSrc'</span>,5,dispDepth);  <span class="comment">% (useless in case of planeWave)</span>
seti = checkfield(seti,<span class="string">'radMeas'</span>,5,dispDepth); <span class="comment">% (useless in case of farField)</span>

<span class="comment">% Check: Is incNb an integer?</span>
<span class="keyword">if</span> round(seti.incNb)~=seti.incNb || seti.incNb&lt;1
   seti.incNb = round(seti.incNb);
   <span class="keyword">if</span> seti.incNb&lt;1; seti.incNb = 1; <span class="keyword">end</span>
   disp(<span class="string">'Parameter "incNb" was either non-integer or negative - corrected.'</span>)
<span class="keyword">end</span>

<span class="comment">% Check: Is measNb an integer?</span>
<span class="keyword">if</span> round(seti.measNb)~=seti.measNb || seti.measNb&lt;1
   seti.measNb = round(seti.measNb);
   <span class="keyword">if</span> seti.measNb&lt;1; seti.measNb = 1; <span class="keyword">end</span>
   disp(<span class="string">'Parameter "measNb" was either non-integer or negative - corrected.'</span>)
<span class="keyword">end</span>

<span class="comment">% Check: Is radMeas &gt; rCD/2? (This is required before setting fields!)</span>
<span class="keyword">if</span> strcmp(seti.measType,<span class="string">'nearField'</span>) &amp;&amp; isfield(seti,<span class="string">'radMeas'</span>)
    <span class="keyword">if</span> seti.radMeas &lt;= seti.rCD/2
        seti.radMeas = seti.rCD/2;
        disp(<span class="string">'Parameter "radMeas" was &lt;= rCD/2. Set radMeas = rCD'</span>);
    <span class="keyword">end</span>
<span class="keyword">elseif</span> strcmp(seti.measType,<span class="string">'nearField'</span>) &amp;&amp; ~isfield(seti,<span class="string">'radMeas'</span>)
    seti.radMeas = 2*seti.rCD;
    disp(<span class="string">'Parameter "radMeas" was not set. Set radMeas = 2*rCD'</span>);
<span class="keyword">end</span>

<span class="comment">% Check: Is radSrc &gt; rCD/2? (This is required before setting fields!)</span>
<span class="keyword">if</span> strcmp(seti.incType,<span class="string">'pointSource'</span>) &amp;&amp; isfield(seti,<span class="string">'radSrc'</span>)
    <span class="keyword">if</span> seti.radSrc &lt;= seti.rCD/2
        seti.radSrc = seti.rCD/2;
        disp(<span class="string">'Parameter "radSrc" was &lt;= rCD/2. Set radSrc = rCD'</span>);
    <span class="keyword">end</span>
<span class="keyword">elseif</span> strcmp(seti.incType,<span class="string">'pointSource'</span>) &amp;&amp; (~isfield(<span class="string">'radSrc'</span>,seti))
    seti.radSrc = 2*seti.rCD;
    disp(<span class="string">'Parameter "radSrc" was not set. Set radSrc = 2*rCD'</span>);
<span class="keyword">end</span>

<span class="keyword">end</span>
</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLAB&reg; R2018b</a><br></p></div><!--
##### SOURCE BEGIN #####
%% expSetup
% Set the experimental set-up as well as incident fields and measurements.
%
%% Syntax
%
%   seti = expSetup(seti)
%   seti = expSetup(seti,dispDepth)
%   seti = expSetup(seti,dispDepth,out)
%
%% Description
%
% |seti = expSetup(seti)| does the following
%
% # Check consistency of input in struct |seti|
%   (otherwise default values are set) (subfunction |expSetupCons|)
% # Define incident and measurement points
%   (i.e. transmitters and receivers positions)
%   (functions <setIncPnts.html> and <setMeasPnts.html>)
%   (If real-world data is loaded this is skipped).
% # Evalute incident fields on ROI (function <setIncField.html>)
% # Set up measurement kernels (such that measurement = k^2 * kernel * solution * voxelVolume)
%   (function <setMeasKer.html>)
% # Plot experimental set-up (function |plotExpSetup|) (in case of |out| is
% 1 or greater.
%
% |seti = expSetup(seti,dispDepth)| does the same but allows to control the
% depth of displayed messages by |dispDepth|.
%
% |seti = expSetup(seti,dispDepth,out)| does the same but allows to plot
% and additionally save figures as well as files controlled by |out|.
%
%% Input Arguments
%
% * |seti|  :   structure array
%
% Several fields in |seti| are required. Because this is an internal
% function we do not list them.
%
% *Optional Input Arguments to differ from default values*
%
% For details of the the following fields look inside subfunction 
% |expSetupCons| below and the functions  <setIncPnts.html>, 
% <setMeasPnts.html>, <pntsGeometry.html> and <pntsGeometry3D.html>:
%
% * seti.incType        :   type of incident field, default: 'pointSource'
%                           ('planeWave' or 'pointSource')
% * seti.measType       :   type of measurement, default: 'nearField'
%                           ('nearField' or 'farField')
% * seti.incNb          :   number of transmitters, default: 35
% * seti.measNb         :   number of receivers, default: 35
% * seti.radSrc         :   radius of circle for transmitters, default: 5
%                           (not necessary in case of incType='planeWave').
% * seti.radMeas        :   radius of circle for receivers, default: 5
%                           (not necessary in case of measType='farField')
% * seti.incPntsType    :   string with type of geometry for transmitters, default: 'circle'
% * seti.measPntsType   :   string with type of geometry for receivers, default: 'circle'
%
% *Optional Input Arguments*
%
% * dispDepth   : Depth of displayed messages (0: no, 1 or greater: yes).
% * out         : Output depth: generate no plots (0),
%                 generate plots (1), generate plots and save them (2).
%
%% Output Arguments
%
% * |seti|  :   structure array
%
% The following fields in |seti| are defined. Look in documentation of 
% corresponding functions and subfunctions (subfunctions are in the Section
% Code).
%
% For details of the the following fields see the functions <setIncPnts.html>, 
% <setMeasPnts.html>, <pntsGeometry.html>:
%
% * seti.incPnts        :   coordinates of transmitters, size seti.dim x seti.incNb
% * seti.dSInc          :   Approximation of the infinitesimal element of closed contour with control points.
% * seti.measPnts       :   coordinates of receivers, size seti.dim x seti.measNb
% * seti.dSMeas         :   Approximation of the infinitesimal element of closed contour with control points.
% 
% Further details of the following parameter are in <setIncField.html>:
%
% * seti.incField       :   incident fields, complex matrix of size 
%                           seti.nROI^seti.dim x seti.incNb
%
% Further details of the following parameter are in <seMeasKer.html>:
%
% * seti.measKer        :   measurement kernel on region of interest (ROI) 
%                           for each receiver 
%                           (complex matrix of size seti.measNb x seti.nROI^seti.dim)
%
%% More About
%
% For a convenience function to plot the transmitters and receivers
% positions see <plotExpSetup.html>.
%
%% See Also
% * <setIncPnts.html>
% * <setMeasPnts.html>
% * <plotExpSetup.html>
% * <setIncField.html>
% * <setMeasKer.html>
%
%% Code: expSetup
%
function seti = expSetup(seti,varargin)

if nargin == 2
    dispDepth = varargin{1};
    out = 0;
elseif nargin == 3
    dispDepth = varargin{1};
    out = varargin{2};
else
    dispDepth = 0;
    out = 0;
end

seti = expSetupCons(seti,dispDepth);

if ~isfield(seti,'expData') || ( isfield(seti,'expData') && strcmp(seti.expData,'fresnel') )
    % Future work: implementation of incPnts and measPnts type 'manually' in 3D
    seti = setIncPnts(seti,dispDepth);
    seti = setMeasPnts(seti,dispDepth);
end

% Evaluate incident fields on ROI
seti = setIncField(seti);

% and set up measurement kernels seti.measKer
% (such that measurement = k^2 * kernel * solution * voxelVolume, i.e.
%  measurement = uScattRX = FmeasDelta = seti.k^2*seti.measKer*qROI.*(uIncROI+uScattROI)*seti.dV)
seti = setMeasKer(seti);

% Plot experimental set-up (function |plotExpSetup|)
if out >= 1
    plotExpSetup(seti,out);
end

end

%% Code: subfunction: expSetupCons
% Check consistency of input (or set default values)
%
% *Syntax*
%
%   seti = expSetupCons(seti,dispDepth)
%
% *Output Arguments*
%
% * seti.incType    :   type of incident wave
%                       ('planeWave' or 'pointSource')
% * seti.measType   :   type of measurement data ('nearField' or 'farField')
% * seti.incNb      :   number of transmitters
% * seti.measNb     :   number of receivers
% * seti.radSrc     :   radius of sphere transmitters are arranged on
%                       (useless in case of 'planeWave')
%                       Must be *> rCD/2* (is checked and adapted).
% * seti.radMeas    :   radius of sphere receivers are arranged on
%                       (useless in case of farField)
%                       Must be *> rCD/2* (is checked and adapted.)
%
%
% *More About*
%
% * radSrc  :   useless in case of planeWave
% * radMeas :   useless in case of farField
%
% _A stricter restriction than necessary for transmitters' and receivers' positions_
% 
% In the source code we use a stricter restriction for the transmitters' 
% and receivers' positions than necessary.
%
% Transmitters:
% 
% In fact, the singularity of the fundamental solution requires the absence
% of point sources inside the region of interest ROI. This restriction in 
% the continuous formulation of the single-layer potential drops in the 
% discretized version until the transmitter is not nearby a grid point.
%
% In the code we simply require |seti.radSrc > rCD/2| to omit the
% implementation of a nearby condition. Remember that we have chosen ROI as
% biggest square inside the mathematical sensible region, that is the open
% ball with radius rCD/2. Hence, for the current choice of ROI it would 
% be sufficient to check if the
% receivers' points are outside this square, but in case of an adapted ROI
% it is safer to omit the hole mathematical sensible region.
%
% Receivers:
%
% Actually, there is no restriction for receivers' positions until they are 
% not inside the support of the contrast |q|.
%
% In the code we simply require |seti.radMeas > rCD/2|, because actually the true
% contrast is unknown.
%
% *Code*
%
function seti = expSetupCons(seti,dispDepth)

seti = checkfield(seti,'incType','pointSource',dispDepth); % incType: planeWave or pointSource
seti = checkfield(seti,'measType','nearField',dispDepth); % measType: nearField or farField

seti = checkfield(seti,'incNb',35,dispDepth);
seti = checkfield(seti,'measNb',35,dispDepth);

seti = checkfield(seti,'radSrc',5,dispDepth);  % (useless in case of planeWave)
seti = checkfield(seti,'radMeas',5,dispDepth); % (useless in case of farField)

% Check: Is incNb an integer?
if round(seti.incNb)~=seti.incNb || seti.incNb<1
   seti.incNb = round(seti.incNb);
   if seti.incNb<1; seti.incNb = 1; end
   disp('Parameter "incNb" was either non-integer or negative - corrected.')
end

% Check: Is measNb an integer?
if round(seti.measNb)~=seti.measNb || seti.measNb<1
   seti.measNb = round(seti.measNb);
   if seti.measNb<1; seti.measNb = 1; end
   disp('Parameter "measNb" was either non-integer or negative - corrected.')
end

% Check: Is radMeas > rCD/2? (This is required before setting fields!)
if strcmp(seti.measType,'nearField') && isfield(seti,'radMeas')
    if seti.radMeas <= seti.rCD/2
        seti.radMeas = seti.rCD/2;
        disp('Parameter "radMeas" was <= rCD/2. Set radMeas = rCD');
    end
elseif strcmp(seti.measType,'nearField') && ~isfield(seti,'radMeas')
    seti.radMeas = 2*seti.rCD;
    disp('Parameter "radMeas" was not set. Set radMeas = 2*rCD');
end

% Check: Is radSrc > rCD/2? (This is required before setting fields!)
if strcmp(seti.incType,'pointSource') && isfield(seti,'radSrc')
    if seti.radSrc <= seti.rCD/2
        seti.radSrc = seti.rCD/2;
        disp('Parameter "radSrc" was <= rCD/2. Set radSrc = rCD');
    end
elseif strcmp(seti.incType,'pointSource') && (~isfield('radSrc',seti))
    seti.radSrc = 2*seti.rCD;
    disp('Parameter "radSrc" was not set. Set radSrc = 2*rCD');
end

end

##### SOURCE END #####
--></body></html>