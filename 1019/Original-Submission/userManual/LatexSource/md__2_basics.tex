\doxysection*{Header files}

The principal interface functions can be found from the \mbox{\hyperlink{node_8h}{starneig/node.\+h}} header file. The library provides separate header files for shared memory (\mbox{\hyperlink{sep__sm_8h}{starneig/sep\+\_\+sm.\+h}}, \mbox{\hyperlink{gep__sm_8h}{starneig/gep\+\_\+sm.\+h}}) and distributed memory (\mbox{\hyperlink{sep__dm_8h}{starneig/sep\+\_\+dm.\+h}}, \mbox{\hyperlink{gep__dm_8h}{starneig/gep\+\_\+dm.\+h}}). In most cases, a user can simply include all header files as follows\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <\mbox{\hyperlink{starneig_8h}{starneig/starneig.h}}>}}
\end{DoxyCode}


Certain header files and interface functions exist only when the library is compiled with M\+PI and Sca\+L\+A\+P\+A\+CK / B\+L\+A\+CS support. The configuration of the installed library can be found from the \mbox{\hyperlink{configuration_8h}{starneig/configuration.\+h}} header file. See module \mbox{\hyperlink{group__starneig__conf}{Library configuration}} for further information.

\doxysection*{Library initialization}

Each node must call the \mbox{\hyperlink{group__starneig__node_ga4d6386652685ba5c5706e72ebbb7cb3a}{starneig\+\_\+node\+\_\+init()}} interface function to initialize the library and the \mbox{\hyperlink{group__starneig__node_gad4c8101c0864588743c486cbd8e75dea}{starneig\+\_\+node\+\_\+finalize()}} interface function to shutdown the library\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{group__starneig__node_ga4d6386652685ba5c5706e72ebbb7cb3a}{starneig\_node\_init}}(cores, gpus, flags);}
\DoxyCodeLine{}
\DoxyCodeLine{...}
\DoxyCodeLine{}
\DoxyCodeLine{starneig\_node\_finalize();}
\end{DoxyCode}


The \mbox{\hyperlink{group__starneig__node_ga4d6386652685ba5c5706e72ebbb7cb3a}{starneig\+\_\+node\+\_\+init()}} interface function initializes Star\+PU (and cu\+B\+L\+AS) and pauses all worker threads. The {\ttfamily cores} argument specifies the total number of used C\+PU cores. In distributed memory mode, one of these C\+PU cores is automatically allocated for the Star\+P\+U-\/\+M\+PI communication thread. The {\ttfamily gpus} argument specifies the total number of used G\+P\+Us. One or more C\+PU cores are automatically allocated for G\+PU devices. The {\ttfamily flags} (\mbox{\hyperlink{group__starneig__node_gaa5d6a2a74203916ba3f5ffc26e45df1e}{starneig\+\_\+flag\+\_\+t}}) argument can provide additional configuration information.

A node can also be configured with default values\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\mbox{\hyperlink{group__starneig__node_ga4d6386652685ba5c5706e72ebbb7cb3a}{starneig\_node\_init}}(\mbox{\hyperlink{group__starneig__node_gab90bed6cebfd3e80b0cdd89a3d5465eb}{STARNEIG\_USE\_ALL}}, \mbox{\hyperlink{group__starneig__node_gab90bed6cebfd3e80b0cdd89a3d5465eb}{STARNEIG\_USE\_ALL}}, \mbox{\hyperlink{group__starneig__node_ga996dca874100130dfb4f748cdb52cb75}{STARNEIG\_DEFAULT}});}
\end{DoxyCode}
 This tells the library to use all available C\+PU cores and G\+P\+Us.

See module \mbox{\hyperlink{group__starneig__node}{Intra-\/node execution environment}} for further information.

\doxysection*{Error handling}

Most interface functions return one of the following values\+:


\begin{DoxyItemize}
\item \mbox{\hyperlink{group__starneig__error_ga673a79086fcaea2df7a986818ca849fc}{S\+T\+A\+R\+N\+E\+I\+G\+\_\+\+S\+U\+C\+C\+E\+SS}} (0)\+: The interface function was executed successfully.
\item A negative number {\ttfamily -\/i}\+: The {\ttfamily i}\textquotesingle{}th interface function argument was invalid.
\item A positive number {\ttfamily i}\+: The interface function encountered an error or a warning was raised. See module \mbox{\hyperlink{group__starneig__error}{Error codes}} for further information.
\end{DoxyItemize}

All return values (\mbox{\hyperlink{group__starneig__error_ga6a2d8e032371643e1d64bb17612317db}{starneig\+\_\+error\+\_\+t}}) are defined in the \mbox{\hyperlink{error_8h}{starneig/error.\+h}} header file.

\begin{DoxyRemark}{Remarks}
The library may call the {\ttfamily exit()} and {\ttfamily abort()} functions if an interface function encounters a fatal error from which it cannot recover.
\end{DoxyRemark}
\doxysection*{Performance models}

The Star\+PU performance models must be calibrated before the software can function efficiently on heterogeneous platforms (C\+P\+Us + G\+P\+Us). The calibration is triggered automatically if the models are not calibrated well enough for a given problem size. This may impact the execution time negatively during the first run. Please see the Star\+PU handbook for further information\+: \href{http://starpu.gforge.inria.fr/doc/html/Scheduling.html}{\texttt{ http\+://starpu.\+gforge.\+inria.\+fr/doc/html/\+Scheduling.\+html}}

\doxysection*{Compilation and linking}

During compilation, the {\ttfamily starneig} library library must be linked with the user\textquotesingle{}s software\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\$ gcc -\/o my\_program my\_program.c -\/lstarneig}
\end{DoxyCode}


Star\+N\+Eig provides a pkg-\/config file for easing the compilation. A user may integrate it to their {\ttfamily Makefile}\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{CFLAGS  += \$\$(pkg-\/config -\/-\/cflags starneig)}
\DoxyCodeLine{LDLIBS  += \$\$(pkg-\/config -\/-\/libs starneig)}
\DoxyCodeLine{}
\DoxyCodeLine{\%.o: \%.c}
\DoxyCodeLine{    \$(CC) -\/c -\/o \$@ \$< \$(CFLAGS)}
\DoxyCodeLine{}
\DoxyCodeLine{my\_program: my\_program.c}
\DoxyCodeLine{    \$(CC) -\/o \$@ \$\string^ \$(LDLIBS)}
\end{DoxyCode}


Or their {\ttfamily C\+Make\+Lists.\+txt} file\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{find\_package(PkgConfig REQUIRED)}
\DoxyCodeLine{pkg\_search\_module(STARNEIG REQUIRED starneig)}
\DoxyCodeLine{}
\DoxyCodeLine{include\_directories (\$\{STARNEIG\_INCLUDE\_DIRS\})}
\DoxyCodeLine{link\_directories (\$\{STARNEIG\_LIBRARY\_DIRS\})}
\DoxyCodeLine{set (CMAKE\_C\_FLAGS "\$\{STARNEIG\_C\_FLAGS\} \$\{CMAKE\_C\_FLAGS\}")}
\DoxyCodeLine{}
\DoxyCodeLine{add\_executable (my\_program my\_program.c)}
\DoxyCodeLine{target\_link\_libraries (my\_program \$\{STARNEIG\_LIBRARIES\})}
\end{DoxyCode}
 