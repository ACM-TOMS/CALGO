Given a matrix pair $(A, B)$, where $A, B \in \mathbb{R}^{n \times n}$, the {\itshape generalized eigenvalue problem} (G\+EP) consists of finding {\itshape generalized eigenvalues} $\lambda_i \in \mathbb C$ and associated {\itshape generalized eigenvectors} $0 \neq v_i \in \mathbb C^{n}$ such that \[ A v_{i} = \lambda_{i} B v_{i}, \text{ for } i = 1, 2, \dots, n. \] The eigenvalues are the $n$ (potentially complex) roots of the polynomial $\text{det}(A - \lambda B) = 0$ of degree $n$. There is often a full set of $n$ linearly independent generalized eigenvectors, but if there are {\itshape multiple eigenvalues} (i.\+e., if $\lambda_{i} = \lambda_{j}$ for some $i \neq j$) then there might not be a full set of independent eigenvectors.

At least in principle, a G\+EP can be transformed into a S\+EP provided that $B$ is invertible, since \[ A v = \lambda B v \Leftrightarrow (B^{-1} A) v = \lambda v. \] However, in finite precision arithmetic this practice is not recommended.

The library provides 12 interface functions for the generalized case.

\doxysection*{Hessenberg-\/triangular reduction}

Given a general matrix pair $(A,B)$, the \mbox{\hyperlink{group__starneig__sm__gep_ga5eb861dd4c09a92cb0c2bab0e4c6f165}{starneig\+\_\+\+G\+E\+P\+\_\+\+S\+M\+\_\+\+Hessenberg\+Triangular()}} and \mbox{\hyperlink{group__starneig__dm__gep_ga864e04d38e72ebbb06bc4a7558a7a3e1}{starneig\+\_\+\+G\+E\+P\+\_\+\+D\+M\+\_\+\+Hessenberg\+Triangular()}} interface functions compute a Hessenberg-\/triangular decomposition \[ (A,B) = U_1 * (H,R) * U_2^T, \] where $H$ is upper Hessenberg, $R$ is upper triangular, and $U_1$ and $U_2$ are orthogonal. On exit, $A$ is overwritten by $H$, $B$ is overwritten by $R$, and $Q$ and $Z$ (which are orthogonal matrices on entry) are overwritten by \[ Q \gets Q * U_1 \text{ and } Z \gets Z * U_2. \]

This is done in order to greatly accelerate the subsequent computation of a generalized Schur decomposition.

\doxysection*{Generalized Schur reduction}

Given a Hessenberg-\/triangular decomposition \[ (A,B) = Q * (H,R) * Z^T \] of a general matrix pair $(A,B)$, the \mbox{\hyperlink{group__starneig__sm__gep_gaaf1e3ec2fc5d8cfb7a7a5464d23a25ed}{starneig\+\_\+\+G\+E\+P\+\_\+\+S\+M\+\_\+\+Schur()}} and \mbox{\hyperlink{group__starneig__dm__gep_ga3ffea6beaaec769b16b8f49cb8809a4d}{starneig\+\_\+\+G\+E\+P\+\_\+\+D\+M\+\_\+\+Schur()}} interface functions function compute a generalized Schur decomposition \[ (A,B) = Q * ( U_1 * (S,T) * U_2^T ) * Z^T, \] where $S$ is upper quasi-\/triangular with $1 \times 1$ and $2 \times 2$ blocks on the diagonal, $T$ is a upper triangular matrix, and $U_1$ and $U_2$ are orthogonal. The $1 \times 1$ blocks on the diagonal of $(S,T)$ correspond to the real generalized eigenvalues and each $2 \times 2$ block corresponds to a pair of complex conjugate generalized eigenvalues.

On exit, $H$ is overwritten by $S$, $R$ is overwritten by $T$, and $Q$ and $Z$ are overwritten by \[ Q \gets Q * U_1 \text{ and } Z \gets Z * U_2. \]

The computed generalized eigenvalues are returned as a pair of values $(\alpha,\beta)$ such that $\alpha/\beta$ gives the actual generalized eigenvalue. The quantity $\alpha/\beta$ may overflow.

\doxysection*{Generalized eigenvalue reordering}

Given a generalized Schur decomposition \[ (A,B) = Q * (S,T) * Z^T \] of a general matrix pair $(A,B)$ and a selection of generalized eigenvalues, the \mbox{\hyperlink{group__starneig__sm__gep_ga7c1fbce46109c1387c7f78d9c8b188e2}{starneig\+\_\+\+G\+E\+P\+\_\+\+S\+M\+\_\+\+Reorder\+Schur()}} and \mbox{\hyperlink{group__starneig__dm__gep_ga07846331814c7b440c33b721410ad62e}{starneig\+\_\+\+G\+E\+P\+\_\+\+D\+M\+\_\+\+Reorder\+Schur()}} interface functions attempt to compute an updated generalized Schur decomposition \[ (A,B) = Q * \left( U_1 * \left ( \begin{bmatrix} \hat S_{11} & \hat S_{12} \\ 0 & \hat S_{22} \end{bmatrix}, \begin{bmatrix} \hat T_{11} & \hat T_{12} \\ 0 & \hat T_{22} \end{bmatrix} \right) * U_2^T \right) * Z^T. \] where the selected generalized eigenvalues appear in $(\hat S_{11},\hat T_{11})$.

On exit, $S$ is overwritten by $\hat{S}$, $T$ is overwritten by $\hat{T}$, and $Q$ and $Z$ are overwritten by \[ Q \gets Q * U_1 \text{ and } Z \gets Z * U_2. \]

Reordering may in rare cases fail. In such cases the output is guaranteed to be a Schur decomposition and all (if any) selected generalized eigenvalues that are correctly placed are marked in the selection array on exit.

Reordering may perturb the generalized eigenvalues and the generalized eigenvalues after reordering are returned. The computed generalized eigenvalues are returned as a pair of values $(\alpha,\beta)$ such that $\alpha/\beta$ gives the actual generalized eigenvalue. The quantity $\alpha/\beta$ may overflow.

\doxysection*{Combined reduction to generalized Schur form and eigenvalue reordering}

Given a general matrix pair $(A,B)$, the \mbox{\hyperlink{group__starneig__sm__gep_ga9e27e175a8cc654ba64832ff2fb9d342}{starneig\+\_\+\+G\+E\+P\+\_\+\+S\+M\+\_\+\+Reduce()}} and \mbox{\hyperlink{group__starneig__dm__gep_ga56de8627462e69a926d2746a657ece65}{starneig\+\_\+\+G\+E\+P\+\_\+\+D\+M\+\_\+\+Reduce()}} interface functions compute a (reordered) generalized Schur decomposition \[ (A,B) = U_1 * (S,T) * U_2^T. \] Optionally, the interface functions attempt to reorder selected generalized eigenvalues to the top left corner of the generalized Schur decomposition.

On exit, $A$ is overwritten by $S$, $B$ is overwritten by $T$, and $Q$ and $Z$ (which are orthogonal matrices on entry) are overwritten by \[ Q \gets Q * U_1 \text{ and } Z \gets Z * U_2. \]

The computed generalized eigenvalues are returned as a pair of values $(\alpha,\beta)$ such that $\alpha/\beta$ gives the actual generalized eigenvalue. The quantity $\alpha/\beta$ may overflow.

Reordering may in rare cases fail. In such cases the output is guaranteed to be a Schur-\/triangular decomposition and all (if any) selected generalized eigenvalues that are correctly placed are marked in the selection array on exit.

\doxysection*{Generalized eigenvectors}

Given a subset consisting of $m \leq n$ of the eigenvalues $\lambda_{i}$ for $i = 1, 2, \ldots, m$ and a generalized Schur decomposition $(A, B) = Q (S, T) Z^{H}$, we can compute for each $\lambda_{i}$ a {\itshape generalized eigenvector} $v_{i} \neq 0$ such that $A v_{i} = \lambda_{i} B v_{i}$ by first computing a generalized eigenvector $w_{i}$ of $S - \lambda_{i} T$ and then transform it back to the original basis by pre-\/multiplication with $Z$.

Given a generalized Schur decomposition \[ (A,B) = Q * (S,T) * Z^T \] of a general matrix pair $(A,B)$ and a selection of generalized eigenvalues, the \mbox{\hyperlink{group__starneig__sm__gep_ga74739cbe0c292aaaf7c28c9fd383ddcb}{starneig\+\_\+\+G\+E\+P\+\_\+\+S\+M\+\_\+\+Eigenvectors()}} and \mbox{\hyperlink{group__starneig__dm__gep_ga6c485cd39a58f9b193d7ea6c6b12c1e4}{starneig\+\_\+\+G\+E\+P\+\_\+\+D\+M\+\_\+\+Eigenvectors()}} interface functions compute and return a generalized eigenvector for each of the selected generalized eigenvalues.

The generalized eigenvectors are stored as columns in the output matrix $X$ in the same order as their corresponding generalized eigenvalues appear in the selection array. A real generalized eigenvector is stored as a single column. The real and imaginary parts of a complex generalized eigenvector are stored as consecutive columns.

For a selected pair of complex conjugate generalized eigenvalues, a generalized eigenvector is computed only for the generalized eigenvalue with positive imaginary part. Thus, every selected generalized eigenvalue contributes one column to the output matrix and thus the number of selected generalized eigenvalues is equal to the number of columns of $X$.

\doxysection*{Eigenvalue selection helper}

Given a Schur-\/triangular matrix pair $(S,T)$ and a predicate function, the \mbox{\hyperlink{group__starneig__sm__gep_gad65f66b44595f836ca67969f974af568}{starneig\+\_\+\+G\+E\+P\+\_\+\+S\+M\+\_\+\+Select()}} and \mbox{\hyperlink{group__starneig__dm__gep_ga682740e323e6baf2c4c40f7c38669fe6}{starneig\+\_\+\+G\+E\+P\+\_\+\+D\+M\+\_\+\+Select()}} interface functions conveniently generate a correct selection array and count the number of selected generalized eigenvalues. The count is useful when allocating storage for the generalized eigenvector matrix computed by \mbox{\hyperlink{group__starneig__dm__gep_ga6c485cd39a58f9b193d7ea6c6b12c1e4}{starneig\+\_\+\+G\+E\+P\+\_\+\+D\+M\+\_\+\+Eigenvectors()}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{comment}{// a predicate function that selects all finite generalized eigenvalues that}}
\DoxyCodeLine{\textcolor{comment}{// have a real part that is larger than a given value}}
\DoxyCodeLine{\textcolor{keyword}{static} \textcolor{keywordtype}{int} predicate(\textcolor{keywordtype}{double} real, \textcolor{keywordtype}{double} imag, \textcolor{keywordtype}{double} beta, \textcolor{keywordtype}{void} *arg)}
\DoxyCodeLine{\{}
\DoxyCodeLine{    \textcolor{keywordtype}{double} value = * (\textcolor{keywordtype}{double} *) arg;}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{if} (beta != 0.0 \&\& value < real/beta)}
\DoxyCodeLine{        \textcolor{keywordflow}{return} 1;}
\DoxyCodeLine{    \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{void} func(...)}
\DoxyCodeLine{\{}
\DoxyCodeLine{    ...}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordtype}{double} value = 0.5;}
\DoxyCodeLine{    \textcolor{keywordtype}{int} num\_selected, *selected = malloc(n*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));}
\DoxyCodeLine{    \mbox{\hyperlink{group__starneig__sm__gep_gad65f66b44595f836ca67969f974af568}{starneig\_GEP\_SM\_Select}}(}
\DoxyCodeLine{        n, S, ldS, T, ldT, \&predicate, \&value, selected, \&num\_selected);}
\DoxyCodeLine{}
\DoxyCodeLine{    ...}
\DoxyCodeLine{\}}
\end{DoxyCode}


See modules \mbox{\hyperlink{group__starneig__sm__gep}{Shared Memory / Generalized E\+VP}} and \mbox{\hyperlink{group__starneig__dm__gep}{Distributed Memory / Generalized E\+VP}} for further information. See also examples \mbox{\hyperlink{gep_sm_full_chain_8c-example}{gep\+\_\+sm\+\_\+full\+\_\+chain.\+c}}, \mbox{\hyperlink{gep_dm_full_chain_8c-example}{gep\+\_\+dm\+\_\+full\+\_\+chain.\+c}} and \mbox{\hyperlink{gep_sm_eigenvectors_8c-example}{gep\+\_\+sm\+\_\+eigenvectors.\+c}}. 