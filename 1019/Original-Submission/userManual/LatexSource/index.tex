Star\+N\+Eig library aims to provide a complete task-\/based software stack for solving {\bfseries{dense}} {\bfseries{nonsymmetric}} (generalized) eigenvalue problems. The library is built on top of the \href{http://starpu.gforge.inria.fr/}{\texttt{ Star\+PU}} runtime system and targets both {\bfseries{shared memory}} and {\bfseries{distributed memory}} machines. Some components of the library support {\bfseries{G\+P\+Us}}.

The four main components of the library are\+:


\begin{DoxyItemize}
\item {\bfseries{Hessenberg(-\/triangular) reduction}}\+: A dense matrix (or a dense matrix pair) is reduced to upper Hessenberg (or Hessenberg-\/triangular) form.
\item {\bfseries{Schur reduction (Q\+R/\+QZ algorithm)}}\+: A upper Hessenberg matrix (or a Hessenberg-\/triangular matrix pair) is reduced to (generalized) Schur form. The (generalized) eigenvalues can be determined from the diagonal blocks.
\item {\bfseries{Eigenvalue reordering and deflating subspaces}}\+: Reorders a user-\/selected set of (generalized) eigenvalues to the upper left corner of an updated (generalized) Schur form.
\item {\bfseries{Computation of eigenvectors}}\+: Computes (generalized) eigenvectors for a user-\/selected set of (generalized) eigenvalues.
\end{DoxyItemize}

The library has been developed as a part of the \href{https://www.nlafet.eu/}{\texttt{ N\+L\+A\+F\+ET}} project. The project has received funding from the European Union’s Horizon 2020 research and innovation programme under grant agreement No. 671633. Support has also been received from e\+S\+S\+E\+N\+CE, a collaborative e-\/\+Science programme funded by the Swedish Government via the Swedish Research Council (VR), and VR Grant E0485301. The development and performance evaluations were performed on resources provided by the Swedish National Infrastructure for Computing (S\+N\+IC) at H\+P\+C2N partially funded by VR through grant agreement No. 2016-\/07213. The library is published under open-\/source B\+SD 3-\/\+Clause license.

Please cite the following article when referring to Star\+N\+Eig\+: \begin{quote}
Mirko Myllykoski, Carl Christian Kjelgaard Mikkelsen\+: {\itshape Task-\/based, G\+P\+U-\/accelerated and Robust Library for Solving Dense Nonsymmetric Eigenvalue Problems}, Concurrency and Computation\+: Practice and Experience, 33 (11), 2021 (online since 2020; e5915), doi\+: \href{https://doi.org/10.1002/cpe.5915}{\texttt{ 10.\+1002/cpe.5915}} \end{quote}


Please see publications and authors.

\doxysection*{Performance}

Performance \href{https://doi.org/10.13140/RG.2.2.14812.92801}{\texttt{ comparison}} against L\+A\+P\+A\+CK (with parallel B\+L\+AS) using 25 C\+PU cores and a Nvidia V100 G\+PU\+:

 
\begin{DoxyImageNoCaption}
  \mbox{\includegraphics[width=\textwidth,height=\textheight/2,keepaspectratio=true]{performance_lapack.png}}
\end{DoxyImageNoCaption}
  

Performance comparisons against M\+A\+G\+MA (Nvidia V100 G\+PU) and Sca\+L\+A\+P\+A\+CK (distributed memory), and strong scalability on shared and distributed memory machines\+:

 
\begin{DoxyImageNoCaption}
  \mbox{\includegraphics[width=\textwidth,height=\textheight/2,keepaspectratio=true]{performance.png}}
\end{DoxyImageNoCaption}
  

Also, see following publications\+:


\begin{DoxyItemize}
\item Mirko Myllykoski\+: {\itshape Algorithm 1019\+: A Task-\/based Multi-\/shift Q\+R/\+QZ Algorithm with Aggressive Early Deflation}, A\+CM Transactions on Mathematical Software, 48 (1), Article 11, pp. 1-\/36, 2022 (online since 2021), doi\+: \href{https://doi.org/10.1145/3495005}{\texttt{ 10.\+1145/3495005}}
\item Mirko Myllykoski, Carl Christian Kjelgaard Mikkelsen\+: {\itshape Task-\/based, G\+P\+U-\/accelerated and Robust Library for Solving Dense Nonsymmetric Eigenvalue Problems}, Concurrency and Computation\+: Practice and Experience, 33 (11), 2021 (online since 2020; e5915), doi\+: \href{https://doi.org/10.1002/cpe.5915}{\texttt{ 10.\+1002/cpe.5915}}
\item Mirko Myllykoski, Carl Christian Kjelgaard Mikkelsen, Angelika Schwarz, Bo Kågström\+: {\itshape D2.\+7 Eigenvalue solvers for nonsymmetric problems}, public N\+L\+A\+F\+ET deliverable, 2019 (\href{http://www.nlafet.eu/wp-content/uploads/2019/04/D2.7-EVP-solvers-evaluation-final.pdf}{\texttt{ download}})
\end{DoxyItemize}

\doxysection*{Current status (stable series)}

The library currently supports only real arithmetic (real input and output matrices but {\bfseries{real and/or complex}} eigenvalues and eigenvectors). In addition, some interface functions are implemented as L\+A\+P\+A\+CK and Sca\+L\+A\+P\+A\+CK wrapper functions.

Standard eigenvalue problems\+:

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{4}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Component }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Shared memory }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Distributed memory }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ C\+U\+DA  }\\\cline{1-4}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Component }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Shared memory }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Distributed memory }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ C\+U\+DA  }\\\cline{1-4}
\endhead
Hessenberg reduction &\PBS\centering {\bfseries{Complete}} &\PBS\centering Sca\+L\+A\+P\+A\+CK &\PBS\centering {\bfseries{Single G\+PU}}  \\\cline{1-4}
Schur reduction &\PBS\centering {\bfseries{Complete}} &\PBS\centering {\bfseries{Complete}} &\PBS\centering {\itshape Experimental}  \\\cline{1-4}
Eigenvalue reordering &\PBS\centering {\bfseries{Complete}} &\PBS\centering {\bfseries{Complete}} &\PBS\centering {\itshape Experimental}  \\\cline{1-4}
Eigenvectors &\PBS\centering {\bfseries{Complete}} &\PBS\centering --- &\PBS\centering ---  \\\cline{1-4}
\end{longtabu}


Generalized eigenvalue problems\+:

\tabulinesep=1mm
\begin{longtabu}spread 0pt [c]{*{4}{|X[-1]}|}
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Component }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Shared memory }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Distributed memory }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ C\+U\+DA  }\\\cline{1-4}
\endfirsthead
\hline
\endfoot
\hline
\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Component }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Shared memory }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ Distributed memory }&\PBS\centering \cellcolor{\tableheadbgcolor}\textbf{ C\+U\+DA  }\\\cline{1-4}
\endhead
HT reduction &\PBS\centering L\+A\+P\+A\+CK &\PBS\centering 3rd party &\PBS\centering ---  \\\cline{1-4}
Schur reduction &\PBS\centering {\bfseries{Complete}} &\PBS\centering {\bfseries{Complete}} &\PBS\centering {\itshape Experimental}  \\\cline{1-4}
Eigenvalue reordering &\PBS\centering {\bfseries{Complete}} &\PBS\centering {\bfseries{Complete}} &\PBS\centering {\itshape Experimental}  \\\cline{1-4}
Eigenvectors &\PBS\centering {\bfseries{Complete}} &\PBS\centering --- &\PBS\centering ---  \\\cline{1-4}
\end{longtabu}


Please see changelog and known problems.

\doxysection*{Documentation}

The Star\+N\+Eig User\textquotesingle{}s Guide is available in both H\+T\+ML and P\+DF formats at \href{https://nlafet.github.io/StarNEig}{\texttt{ https\+://nlafet.\+github.\+io/\+Star\+N\+Eig}}. The P\+DF version is also available under \href{https://github.com/NLAFET/StarNEig/releases}{\texttt{ releases}}.

\doxysection*{Quickstart guide}

\doxysubsection*{Installation}

Prebuild binary packages (Ubuntu 18.\+04 and Ubuntu 20.\+04) are available under \href{https://github.com/NLAFET/StarNEig/releases}{\texttt{ releases}} and can be installed with the following command\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\$ sudo apt install ./StarNEig-\/v0.xx.yy-\/ubuntu-\/vv.uu.deb}
\end{DoxyCode}


The binary packages rely on mainstream Star\+PU packages and do not necessary provide full functionality.

For full functionality, it is recommended that Star\+N\+Eig (and Star\+PU) are compiled from the source code, see below and/or the Star\+N\+Eig User\textquotesingle{}s Guide. Please consider using one of the tested \href{https://github.com/NLAFET/StarNEig/releases}{\texttt{ release}} versions.

\doxysubsubsection*{Dependencies}

Library dependencies\+:


\begin{DoxyItemize}
\item Linux
\item C\+Make 3.\+3 or newer
\item Portable Hardware Locality (hwloc)
\item Starpu 1.\+2 or 1.\+3
\begin{DoxyItemize}
\item Newer versions require the user set the {\ttfamily S\+T\+A\+R\+P\+U\+\_\+\+L\+I\+B\+R\+A\+R\+I\+ES}, {\ttfamily S\+T\+A\+R\+P\+U\+\_\+\+M\+P\+I\+\_\+\+L\+I\+B\+R\+A\+R\+I\+ES} and {\ttfamily S\+T\+A\+R\+P\+U\+\_\+\+I\+N\+C\+L\+U\+D\+E\+\_\+\+P\+A\+TH} environmental variables.
\end{DoxyItemize}
\item Open\+B\+L\+AS, M\+KL, Goto\+B\+L\+AS or single-\/threaded B\+L\+AS library
\item L\+A\+P\+A\+CK
\item M\+PI (optional)
\item C\+U\+DA + cu\+B\+L\+AS (optional)
\item Sca\+L\+A\+P\+A\+CK + B\+L\+A\+CS (optional)
\end{DoxyItemize}

Test program and example code dependencies\+:


\begin{DoxyItemize}
\item pkg-\/config
\item G\+NU Scientific Library (optional)
\item M\+A\+G\+MA (optional)
\end{DoxyItemize}

\doxysubsubsection*{Configure, build and install}

To compile, validate and install Star\+N\+Eig, execute in the same directory as this {\ttfamily R\+E\+A\+D\+M\+E.\+md} file\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\$ mkdir build}
\DoxyCodeLine{\$ cd build/}
\DoxyCodeLine{\$ cmake ../}
\DoxyCodeLine{\$ make}
\DoxyCodeLine{\$ make test}
\DoxyCodeLine{\$ sudo make install}
\end{DoxyCode}


\doxysubsection*{Example}

The following example demonstrates how a dense matrix {\ttfamily A} is reduced to real Schur form\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{comment}{// my\_program.c}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <\mbox{\hyperlink{starneig_8h}{starneig/starneig.h}}>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <stdlib.h>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <time.h>}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{int} main()}
\DoxyCodeLine{\{}
\DoxyCodeLine{    \textcolor{keywordtype}{int} n = 3000;}
\DoxyCodeLine{    srand((\textcolor{keywordtype}{unsigned}) time(NULL));}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{// generate a random matrix A}}
\DoxyCodeLine{    \textcolor{keywordtype}{int} ldA = ((n/8)+1)*8;}
\DoxyCodeLine{    \textcolor{keywordtype}{double} *A = malloc(n*ldA*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < n; j++)}
\DoxyCodeLine{        \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < n; i++)}
\DoxyCodeLine{            A[j*ldA+i] = 2.0*rand()/RAND\_MAX -\/ 1.0;}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{// generate an identity matrix Q}}
\DoxyCodeLine{    \textcolor{keywordtype}{int} ldQ = ((n/8)+1)*8;}
\DoxyCodeLine{    \textcolor{keywordtype}{double} *Q = malloc(n*ldA*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{    \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < n; j++)}
\DoxyCodeLine{        \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < n; i++)}
\DoxyCodeLine{            Q[j*ldQ+i] = i == j ? 1.0 : 0.0;}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{// allocate space for the eigenvalues}}
\DoxyCodeLine{    \textcolor{keywordtype}{double} *real = malloc(n*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{    \textcolor{keywordtype}{double} *imag = malloc(n*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{double}));}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{// initialize the StarNEig library}}
\DoxyCodeLine{    \mbox{\hyperlink{group__starneig__node_ga4d6386652685ba5c5706e72ebbb7cb3a}{starneig\_node\_init}}(\mbox{\hyperlink{group__starneig__node_gab90bed6cebfd3e80b0cdd89a3d5465eb}{STARNEIG\_USE\_ALL}}, \mbox{\hyperlink{group__starneig__node_gab90bed6cebfd3e80b0cdd89a3d5465eb}{STARNEIG\_USE\_ALL}}, \mbox{\hyperlink{group__starneig__node_ga696b10750293e8b49bda0c205ed0882e}{STARNEIG\_HINT\_SM}});}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{// reduce matrix A to real Schur form S = Q\string^T A Q}}
\DoxyCodeLine{    \mbox{\hyperlink{group__starneig__sm__sep_ga8e038624fecd9f1abb604bef3eb56d3b}{starneig\_SEP\_SM\_Reduce}}(}
\DoxyCodeLine{        n, A, ldA, Q, ldQ, real, imag, NULL, NULL, NULL, NULL);}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{comment}{// de-\/initialize the StarNEig library}}
\DoxyCodeLine{    \mbox{\hyperlink{group__starneig__node_gad4c8101c0864588743c486cbd8e75dea}{starneig\_node\_finalize}}();}
\DoxyCodeLine{}
\DoxyCodeLine{    free(A); free(Q); free(real); free(imag);}
\DoxyCodeLine{}
\DoxyCodeLine{    \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\}}
\end{DoxyCode}


Compile\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\$ gcc -\/o my\_program my\_program.c -\/lstarneig}
\end{DoxyCode}


or\+: 
\begin{DoxyCode}{0}
\DoxyCodeLine{\$ gcc -\/o my\_program my\_program.c \$(pkg-\/config -\/-\/cflags starneig) \$(pkg-\/config -\/-\/libs starneig)}
\end{DoxyCode}
 