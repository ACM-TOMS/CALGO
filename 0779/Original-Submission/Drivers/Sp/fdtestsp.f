      PROGRAM TESTFD
C
C   This program runs a very simple test procedure to assess
C   the accuracy of the 4 Fermi-Dirac functions, in single
C   precision form.
C 
C   To run the test program load the 4 Fermi-Dirac functions
C   FDM0P5, FDP0P5, FDP1P5, FDP2P5, and the Chebyshev series
C   evaluation function CHEVAL. These should have been put
C   into single-precision form according to the instructions
C   in the codes.
C
C   The INTEGER variable IOUT defines the output stream for the
C   results. It is currently set to 6, but can be easily changed.
C
C   The complete program can then be compiled and run.
C 
      INTEGER IOUT,NTEST,NUMFUN, N1, N2, N3
      REAL ARMP5M(45),ARMP5P(45),AR0P5M(45),AR0P5P(45),
     1     AR1P5M(45),AR1P5P(45),AR2P5M(45),AR2P5P(45),
     2     EXVAL,FDM0P5,FDP0P5,FDP1P5,FDP2P5,FDVAL,RELERR,XVAL
C
C   Define the arguments and exact function values.
C
      DATA ARMP5M/-70.0 E 0,  1.0 E 0,  0.3975 4497 3590 8647 E -30,
     &            -50.0 E 0,  1.0 E 0,  0.1928 7498 4796 3918 E -21,
     &            -25.0 E 0,  1.0 E 0,  0.1388 7943 8648 2764 E -10,
     &            -16.0 E 0,  1.0 E 0,  0.1125 3516 5764 3426 E  -6,
     &            -10.0 E 0,  1.0 E 0,  0.4539 8472 3608 0550 E  -4,
     &            -15.0 E 0,  2.0 E 0,  0.5528 6816 2177 6332 E  -3,
     &             -5.0 E 0,  1.0 E 0,  0.6706 0199 8926 8209 E  -2,
     &             -4.0 E 0,  1.0 E 0,  0.1808 1922 9913 9939 E  -1,
     &             -3.0 E 0,  1.0 E 0,  0.4810 2635 3322 0408 E  -1,
     &             -5.0 E 0,  2.0 E 0,  0.7761 8724 5948 2337 E  -1,
     &             -2.0 E 0,  1.0 E 0,  0.1236 6562 1801 2099 E   0,
     &             -3.0 E 0,  2.0 E 0,  0.1933 0537 0255 0534 E   0,
     &             -1.0 E 0,  1.0 E 0,  0.2940 2761 7611 4512 E   0,
     &             -1.0 E 0,  2.0 E 0,  0.4312 3144 1926 3971 E   0,
     &             -1.0 E 0,  4.0 E 0,  0.5137 9331 0787 9051 E   0/
      DATA ARMP5P/0.0 E 0,  1.0 E 0,  0.6048 9864 3421 6304 E   0,
     &            1.0 E 0,  4.0 E 0,  0.7033 9042 6255 4945 E   0,
     &            3.0 E 0,  4.0 E 0,  0.9162 2808 8973 4550 E   0,
     &            5.0 E 0,  4.0 E 0,  0.1138 5676 6277 3306 E   1,
     &            3.0 E 0,  2.0 E 0,  0.1249 3233 4785 2712 E   1,
     &            2.0 E 0,  1.0 E 0,  0.1464 2945 8908 7629 E   1,
     &            5.0 E 0,  2.0 E 0,  0.1666 3128 8343 5831 E   1,
     &            3.0 E 0,  1.0 E 0,  0.1853 4850 8860 1518 E   1,
     &            4.0 E 0,  1.0 E 0,  0.2185 8696 9062 3812 E   1,
     &            5.0 E 0,  1.0 E 0,  0.2472 9876 2248 2944 E   1,
     &           15.0 E 0,  2.0 E 0,  0.3065 1707 1013 6853 E   1,
     &           10.0 E 0,  1.0 E 0,  0.3552 7792 3953 6617 E   1,
     &           20.0 E 0,  1.0 E 0,  0.5041 0185 0753 5329 E   1,
     &           50.0 E 0,  1.0 E 0,  0.7977 5308 5858 1870 E   1,
     &          100.0 E 0,  1.0 E 0,  0.1128 3327 4429 2768 E   2/
      DATA AR0P5M/-70.0 E 0,  1.0 E 0,  0.3975 4497 3590 8647 E -30,
     &            -50.0 E 0,  1.0 E 0,  0.1928 7498 4796 3918 E -21,
     &            -25.0 E 0,  1.0 E 0,  0.1388 7943 8648 9583 E -10,
     &            -16.0 E 0,  1.0 E 0,  0.1125 3517 0241 8007 E  -6,
     &            -10.0 E 0,  1.0 E 0,  0.4539 9201 0526 4133 E  -4,
     &            -15.0 E 0,  2.0 E 0,  0.5529 7624 9894 1281 E  -3,
     &             -5.0 E 0,  1.0 E 0,  0.6721 9543 1450 5913 E  -2,
     &             -4.0 E 0,  1.0 E 0,  0.1819 8203 5083 6711 E  -1,
     &             -3.0 E 0,  1.0 E 0,  0.4893 3705 6964 9578 E  -1,
     &             -5.0 E 0,  2.0 E 0,  0.7980 3854 5407 3086 E  -1,
     &             -2.0 E 0,  1.0 E 0,  0.1292 9851 3320 0756 E   0,
     &             -3.0 E 0,  2.0 E 0,  0.2073 9818 7032 0298 E   0,
     &             -1.0 E 0,  1.0 E 0,  0.3277 9515 9260 7115 E   0,
     &             -1.0 E 0,  2.0 E 0,  0.5075 3710 3554 6378 E   0,
     &             -1.0 E 0,  4.0 E 0,  0.6254 7810 2300 7525 E   0/
      DATA AR0P5P/0.0 E 0,  1.0 E 0,  0.7651 4702 4625 4079 E   0,
     &            1.0 E 0,  4.0 E 0,  0.9285 4399 6038 6521 E   0,
     &            3.0 E 0,  4.0 E 0,  0.1332 7609 7454 5192 E   1,
     &            5.0 E 0,  4.0 E 0,  0.1846 3456 7453 9936 E   1,
     &            3.0 E 0,  2.0 E 0,  0.2144 8608 7758 3114 E   1,
     &            2.0 E 0,  1.0 E 0,  0.2823 7212 7740 1584 E   1,
     &            5.0 E 0,  2.0 E 0,  0.3606 9753 7795 0373 E   1,
     &            3.0 E 0,  1.0 E 0,  0.4487 5474 2135 1709 E   1,
     &            4.0 E 0,  1.0 E 0,  0.6511 5675 9275 4791 E   1,
     &            5.0 E 0,  1.0 E 0,  0.8844 2088 9524 2954 E   1,
     &           15.0 E 0,  2.0 E 0,  0.1579 6289 9021 8740 E   2,
     &           10.0 E 0,  1.0 E 0,  0.2408 4656 9646 3765 E   2,
     &           20.0 E 0,  1.0 E 0,  0.6749 1512 2216 5892 E   2,
     &           50.0 E 0,  1.0 E 0,  0.2660 9281 2521 3626 E   3,
     &          100.0 E 0,  1.0 E 0,  0.7523 4559 1552 1961 E   3/
      DATA AR1P5M/-70.0 E 0,  1.0 E 0,  0.3975 4497 3590 8647 E -30,
     &            -50.0 E 0,  1.0 E 0,  0.1928 7498 4796 3918 E -21,
     &            -25.0 E 0,  1.0 E 0,  0.1388 7943 8649 2992 E -10,
     &            -16.0 E 0,  1.0 E 0,  0.1125 3517 2480 5299 E  -6,
     &            -10.0 E 0,  1.0 E 0,  0.4539 9565 4045 6176 E  -4,
     &            -15.0 E 0,  2.0 E 0,  0.5530 3030 4597 1386 E  -3,
     &             -5.0 E 0,  1.0 E 0,  0.6729 9409 0901 4693 E  -2,
     &             -4.0 E 0,  1.0 E 0,  0.1825 6727 5851 0827 E  -1,
     &             -3.0 E 0,  1.0 E 0,  0.4935 6612 7906 8416 E  -1,
     &             -5.0 E 0,  2.0 E 0,  0.8092 8011 6297 5109 E  -1,
     &             -2.0 E 0,  1.0 E 0,  0.1322 4678 2251 7724 E   0,
     &             -3.0 E 0,  2.0 E 0,  0.2149 7282 5847 4116 E   0,
     &             -1.0 E 0,  1.0 E 0,  0.3466 7479 4799 0574 E   0,
     &             -1.0 E 0,  2.0 E 0,  0.5526 4952 5947 3541 E   0,
     &             -1.0 E 0,  4.0 E 0,  0.6938 4635 6450 9715 E   0/
      DATA AR1P5P/0.0 E 0,  1.0 E 0,  0.8671 9988 9012 1841 E   0,
     &            1.0 E 0,  4.0 E 0,  0.1078 3981 5492 7105 E   1,
     &            3.0 E 0,  4.0 E 0,  0.1639 2853 1015 5971 E   1,
     &            5.0 E 0,  4.0 E 0,  0.2429 4255 4581 1454 E   1,
     &            3.0 E 0,  2.0 E 0,  0.2927 7494 1279 3217 E   1,
     &            2.0 E 0,  1.0 E 0,  0.4165 4144 5986 8322 E   1,
     &            5.0 E 0,  2.0 E 0,  0.5768 8793 1221 0517 E   1,
     &            3.0 E 0,  1.0 E 0,  0.7788 6107 7029 5970 E   1,
     &            4.0 E 0,  1.0 E 0,  0.1326 0488 1772 9107 E   2,
     &            5.0 E 0,  1.0 E 0,  0.2091 4467 4027 6263 E   2,
     &           15.0 E 0,  2.0 E 0,  0.5140 7547 0579 3215 E   2,
     &           10.0 E 0,  1.0 E 0,  0.1010 0510 0843 3260 E   3,
     &           20.0 E 0,  1.0 E 0,  0.5465 6301 0065 7602 E   3,
     &           50.0 E 0,  1.0 E 0,  0.5332 3535 6668 7146 E   4,
     &          100.0 E 0,  1.0 E 0,  0.3010 8671 6813 5487 E   5/
      DATA AR2P5M/-70.0 E 0,  1.0 E 0,  0.3975 4497 3590 8647 E -30,
     &            -50.0 E 0,  1.0 E 0,  0.1928 7498 4796 3918 E -21,
     &            -25.0 E 0,  1.0 E 0,  0.1388 7943 8649 4697 E -10,
     &            -16.0 E 0,  1.0 E 0,  0.1125 3517 3599 8945 E  -6,
     &            -10.0 E 0,  1.0 E 0,  0.4539 9747 5825 2285 E  -4,
     &            -15.0 E 0,  2.0 E 0,  0.5530 5733 5564 2952 E  -3,
     &             -5.0 E 0,  1.0 E 0,  0.6733 9406 9947 1496 E  -2,
     &             -4.0 E 0,  1.0 E 0,  0.1828 6118 4132 8075 E  -1,
     &             -3.0 E 0,  1.0 E 0,  0.4957 0567 5377 4198 E  -1,
     &             -5.0 E 0,  2.0 E 0,  0.8150 0927 5091 5113 E  -1,
     &             -2.0 E 0,  1.0 E 0,  0.1337 6692 9045 9733 E   0,
     &             -3.0 E 0,  2.0 E 0,  0.2189 4951 7846 0930 E   0,
     &             -1.0 E 0,  1.0 E 0,  0.3568 5914 1868 9825 E   0,
     &             -1.0 E 0,  2.0 E 0,  0.5779 5216 0541 0087 E   0,
     &             -1.0 E 0,  4.0 E 0,  0.7331 5006 4773 5718 E   0/
      DATA AR2P5P/0.0 E 0,  1.0 E 0,  0.9275 5357 7773 9480 E   0,
     &            1.0 E 0,  4.0 E 0,  0.1169 9024 5238 0993 E   1,
     &            3.0 E 0,  4.0 E 0,  0.1840 9049 9761 4609 E   1,
     &            5.0 E 0,  4.0 E 0,  0.2847 3835 0168 1993 E   1,
     &            3.0 E 0,  2.0 E 0,  0.3515 4755 7474 9159 E   1,
     &            2.0 E 0,  1.0 E 0,  0.5274 6217 1262 1000 E   1,
     &            5.0 E 0,  2.0 E 0,  0.7741 8748 4883 8761 E   1,
     &            3.0 E 0,  1.0 E 0,  0.1111 2899 5227 1169 E   2,
     &            4.0 E 0,  1.0 E 0,  0.2146 8708 2280 1143 E   2,
     &            5.0 E 0,  1.0 E 0,  0.3836 1745 7340 1834 E   2,
     &           15.0 E 0,  2.0 E 0,  0.1251 4034 4040 0588 E   3,
     &           10.0 E 0,  1.0 E 0,  0.3113 3764 1850 7202 E   3,
     &           20.0 E 0,  1.0 E 0,  0.3186 7350 9683 1266 E   4,
     &           50.0 E 0,  1.0 E 0,  0.7642 6646 1278 3266 E   5,
     &          100.0 E 0,  1.0 E 0,  0.8609 5497 3735 2777 E   6/
C
C   Define the DATA output stream.
C
      DATA IOUT/6/
C
C   Run the tests
C
      DO 200 NUMFUN = 1 , 8
         IF ( NUMFUN .EQ. 1 ) THEN
            WRITE(IOUT,1000)
            WRITE(IOUT,1040)
         ENDIF
         IF ( NUMFUN .EQ. 3 ) THEN
            WRITE(IOUT,1010)
            WRITE(IOUT,1040)
         ENDIF
         IF ( NUMFUN .EQ. 5 ) THEN
            WRITE(IOUT,1020)
            WRITE(IOUT,1040)
         ENDIF
         IF ( NUMFUN .EQ. 7 ) THEN
            WRITE(IOUT,1030)
            WRITE(IOUT,1040)
         ENDIF
         DO 100 NTEST = 1 , 15
            N1 = 3 * NTEST - 2
            N2 = N1 + 1
            N3 = N2 + 1
            IF ( NUMFUN .EQ. 1 ) THEN
               XVAL = ARMP5M(N1) / ARMP5M(N2)
               EXVAL = ARMP5M(N3)
               FDVAL = FDM0P5 ( XVAL )
            ENDIF
            IF ( NUMFUN .EQ. 2 ) THEN
               XVAL = ARMP5P(N1) / ARMP5P(N2)
               EXVAL = ARMP5P(N3)
               FDVAL = FDM0P5 ( XVAL )
            ENDIF
            IF ( NUMFUN .EQ. 3 ) THEN
               XVAL = AR0P5M(N1) / AR0P5M(N2)
               EXVAL = AR0P5M(N3)
               FDVAL = FDP0P5 ( XVAL )
            ENDIF
            IF ( NUMFUN .EQ. 4 ) THEN
               XVAL = AR0P5P(N1) / AR0P5P(N2)
               EXVAL = AR0P5P(N3)
               FDVAL = FDP0P5 ( XVAL )
            ENDIF
            IF ( NUMFUN .EQ. 5 ) THEN
               XVAL = AR1P5M(N1) / AR1P5M(N2)
               EXVAL = AR1P5M(N3)
               FDVAL = FDP1P5 ( XVAL )
            ENDIF
            IF ( NUMFUN .EQ. 6 ) THEN
               XVAL = AR1P5P(N1) / AR1P5P(N2)
               EXVAL = AR1P5P(N3)
               FDVAL = FDP1P5 ( XVAL )
            ENDIF
            IF ( NUMFUN .EQ. 7 ) THEN
               XVAL = AR2P5M(N1) / AR2P5M(N2)
               EXVAL = AR2P5M(N3)
               FDVAL = FDP2P5 ( XVAL )
            ENDIF
            IF ( NUMFUN .EQ. 8 ) THEN
               XVAL = AR2P5P(N1) / AR2P5P(N2)
               EXVAL = AR2P5P(N3)
               FDVAL = FDP2P5 ( XVAL )
            ENDIF
            RELERR = ABS ( ( FDVAL - EXVAL ) /EXVAL )
            WRITE(IOUT,1100)XVAL,EXVAL,FDVAL,RELERR
 100     CONTINUE
 200  CONTINUE
 1000 FORMAT(///25X,'TESTING FDM0P5')
 1010 FORMAT(///25X,'TESTING FDP0P5')
 1020 FORMAT(///25X,'TESTING FDP1P5')
 1030 FORMAT(///25X,'TESTING FDP2P5')
 1040 FORMAT(/5X,'X-VALUE',7X,'EXACT VALUE',8X,'COMP. VALUE',
     1       9X,'REL. ERROR')
 1100 FORMAT(2X,F10.4,3X,E16.7,3X,E16.7,3X,E16.7)
      END
