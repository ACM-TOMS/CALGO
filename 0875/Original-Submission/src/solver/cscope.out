cscope 15 /nfs/mcs-homes64/benson/dsdp/DSDP5.8/src/solver               0000224294
	@dsdp.h

1 #ide
__DSDP_H


2 
	#__DSDP_H


	)

4 
	~"dsdpbasiys.h
"

5 
	~"dsdpvec.h
"

6 
	~"dsdpschurm.h
"

7 
	~"dsdpce.h
"

8 
	~"dsdpcvge.h
"

14 
_P_LUBounds
* 
	tYBoundCe
;

15 
RDCe
* 
	tRRCe
;

18 
	#MAX_DSDP_MONITORS
 5

	)

19 
	#MAX_XMAKERS
 4

	)

22 
DSDPVec
 
	my
;

23 
DSDPVec
 
	mdy
;

24 
	mmu
;

25 
	mp
;

26 
DSDPVec
 
	mrhs
;

27 } 
	tXMak
;

30 
DSDPVec
 
	my
;

31 
	mzb
;

32 
	mmurg
;

33 
	mlogd
;

34 } 
	tDSDPS
;

43 
	s_PD_DSDP
{

45 
DSDPCG
 *
	mes
;

46 
	mey
;

48 
	mschurmu
;

49 
DSDPSchurM
 
	mM
;

50 
	mMshi
;

51 
	mmaxschurshi
;

53 
	mnces
,
	mmaxces
;

54 
DSDPCe
 *
	mce
;

55 *
	mceid
;

56 
	mkeyid
;

58 
	msvime
,
	mcgtime
,
	mime
,
	mdtime
,
	mime
;

59 
	muM
;

60 
DSDPTruth
 
	mgy0
;

61 
DSDPTruth
 
	mtuped
;

63 
	mm
;

64 
	m
;

66 
	mnow
;

67 
	mmax
;

68 
	mpobj
;

69 
	mobj
;

70 
	mdobj
,
	mddobj
;

71 
	mp
,
	md
;

72 
	mduyg
;

73 
	mmurg
;

74 
	mmu
,
	mmud
,
	mmu0
;

75 
	mrho
,
	mpْtl
,
	mlogd
,
	mrh
;

76 
	mm
;

77 
	mmaxudius
;

78 
	mm
,
	mm
,
	mbnm
;

79 
	max
,
	maxs
;

80 
	mrg
;

81 
	mpd
;

83 
DSDPVec
 
	my
;

84 
DSDPVec
 
	my0
;

85 
DSDPVec
 
	mymp
;

86 
DSDPVec
 
	mdy1
;

87 
DSDPVec
 
	mdy2
;

88 
DSDPVec
 
	mdy
;

89 
DSDPVec
 
	mrhs1
;

90 
DSDPVec
 
	mrhs2
;

91 
DSDPVec
 
	mrhs
;

92 
DSDPVec
 
	mrhemp
;

93 
DSDPVec
 
	mb
;

96 
	mr
;

97 
	mrag
;

98 
DSDPPty
 
	mUPty
;

99 
RRCe
 
	mrce
;

101 
DSDPTruth
 
	mufixedrho
;

103 
XMak
 
	mxmak
[
MAX_XMAKERS
];

104 
DSDPVec
 
	mxmakrhs
;

106 
YBoundCe
 
	mybce
;

107 
	mpas
;

108 
	m
;

110 
DSDPSutiTy
 
	mpdasib
;

111 
	mda
;

112 
	mpa
;

114 
CvgMڙ
 
	mcv
;

115 
DSDPTmiRs
 
	mas
;

117 (*
	mmڙ
[
MAX_DSDP_MONITORS
])(
	m_PD_DSDP
 *, *);

118 *
	mmڙx
[
MAX_DSDP_MONITORS
];

119 
	mnmڙs
;

122 
_PD_DSDP
 
	tPD_DSDP
;

124 
	#DSDPKEY
 5432

	)

126 
	#DSDPVid
(
a
{i(!)||()->
keyid
!=
DSDPKEY
)){ 
	`DSDPSETERR
(101,"DSDPERROR: Invid DSDP obje\n");}}

	)

128 
	~"dsdpbasiys.h
"

130 
DSDPCeLUBoundsCe
(
DSDP
, 
YBoundCe
*);

131 
BoundYCeSBounds
(
YBoundCe
, , );

132 
BoundYCeGBounds
(
YBoundCe
, *, *);

133 
BoundYCeAddX
(
YBoundCe
,,
DSDPVec
,DSDPVec,DSDPVec,*);

134 
BoundYCeAddS
(
YBoundCe
,
DSDPVec
,DSDPVec);

136 
DSDPCompuObjeive
(
DSDP
, 
DSDPVec
, *);

137 
DSDPCompuDY
(
DSDP
, , 
DSDPVec
, *);

138 
DSDPCompuNewY
(
DSDP
, , 
DSDPVec
);

139 
DSDPCompuRHS
(
DSDP
, , 
DSDPVec
);

140 
DSDPCompuPDY1
(
DSDP
,,
DSDPVec
);

141 
DSDPCompuPDY
(
DSDP
, , 
DSDPVec
, *);

142 
DSDPCompuPY
(
DSDP
,,
DSDPVec
);

143 
DSDPCompuG
(
DSDP
, 
DSDPVec
,DSDPVec,DSDPVec);

144 
DSDPCompuPNm
(
DSDP
, ,
DSDPVec
,*);

145 
DSDPCompuDuyG
(
DSDP
, , *);

146 
DSDPSaveYFX
(
DSDP
, , );

147 
DSDPSY
(
DSDP
,,,
DSDPVec
);

148 
DSDPCompuPْtl
(
DSDP
, 
DSDPVec
, ,*);

149 
DSDPCompuPْtl2
(
DSDP
, 
DSDPVec
, , , *);

150 
DSDPSRR
(
DSDP
,);

151 
DSDPGRR
(
DSDP
,*);

152 
DSDPGMaxYEmt
(
DSDP
,*);

153 
DSDPSveDymicRho
(
DSDP
);

154 
DSDPRefeSpDei
(
DSDP
,
DSDPVec
, DSDPVec);

157 
DSDPSUpCes
(
DSDP
);

158 
DSDPSUpCes2
(
DSDP
, 
DSDPVec
, 
DSDPSchurM
);

159 
DSDPSchurSrsiy
(
DSDP
, , [], );

160 
DSDPCompuSS
(
DSDP
, 
DSDPVec
, 
DSDPDuFaMrix
, 
DSDPTruth
*);

161 
DSDPInvtS
(
DSDP
);

162 
DSDPCompuHessn

DSDP
, 
DSDPSchurM
, 
DSDPVec
, DSDPVec);

163 
DSDPHessnMuɝlyAdd

DSDP
, 
DSDPVec
, DSDPVec);

164 
DSDPCompuMaxSpLgth
(
DSDP
, 
DSDPVec
, 
DSDPDuFaMrix
, *);

165 
DSDPCompuLogSDmt
(
DSDP
, *);

166 
DSDPCompuANm2
(
DSDP
,
DSDPVec
);

167 
DSDPVwCes
(
DSDP
);

168 
DSDPMڙCes
(
DSDP
,);

169 
DSDPDeroyCes
(
DSDP
);

170 
DSDPPassXVes
(
DSDP
,,
DSDPVec
,DSDPVec);

171 
DSDPCompuXVbs
(
DSDP
,,
DSDPVec
,DSDPVec,DSDPVec,*);

172 
DSDPGCicDimsi
(
DSDP
,*);

173 
DSDPSchurSrsy
(
DSDP
, , [], );

175 
DSDPCGSve
(
DSDP
,
DSDPSchurM
,
DSDPVec
,DSDPVec,,
DSDPTruth
*);

176 
DSDPCompuDuSpDei
(
DSDP
, , 
DSDPVec
);

177 
DSDPCompuDuSpDeis
(
DSDP
);

179 
DSDPAddBCe
(
DSDP
,
DSDPVec
,);

180 
DSDPAddICe
(
DSDP
,, );

181 
DSDPAddRCe
(
DSDP
,
RRCe
*);

182 
DSDPSCe
(
DSDP
,
DSDPCe
);

183 
RCeSTy
(
RRCe
, 
DSDPPty
);

185 
DSDPSDa
(
DSDP
);

186 
DSDPCompuDaNms
(
DSDP
);

188 
DSDPTakeDown
(
DSDP
);

189 
DSDPSDeuStiics
(
DSDP
);

190 
DSDPSDeuPams
(
DSDP
);

191 
DSDPSDeuMڙs
(
DSDP
);

194 
DSDPInlizeVbs
(
DSDP
);

195 
DSDPObjeiveGH

DSDP
, 
DSDPSchurM
, 
DSDPVec
);

196 
DSDPCheckFUnboundedObjeive
(
DSDP
, 
DSDPTruth
*);

198 
DSDPCheckCvg
(
DSDP
,
DSDPTmiRs
 *);

199 
DSDPMڙ
(
DSDP
);

200 
DSDPDeuCvg
(
DSDP
,*);

201 
DSDPPrtSts
(
DSDP
, *);

202 
DSDPPrtStsFe
(
DSDP
, *);

204 
DSDPGSchurMrix
(
DSDP
,
DSDPSchurM
*);

205 
DSDPFixedVbsNm
(
DSDPSchurM
,
DSDPVec
);

206 
DSDPCompuFixedYX
(
DSDPSchurM
,
DSDPVec
);

210 
DSDPLAPACKSchurCe
(,
DSDPSchurM
*);

211 
DSDPSSchurMrixSuu
(
DSDP
,(*)(
DSDPSchurM
 *, , *), *);

212 
	`DSDPSDeuSchurMrixSuu
(
DSDP
);

213 
	`DSDPSchurSve
(
DSDP
,
DSDPVec
,DSDPVec);

214 
	`DSDPGCvgMڙ
(
DSDP
, 
CvgMڙ
**);

215 
	`DSDPSDeuCvgMڙ
(
DSDP
);

	@dsdpcg.c

1 
	~"dsdpcg.h
"

2 
	~"dsdpschurm.h
"

3 
	~"dsdpvec.h
"

4 
	~"dsdpsys.h
"

5 
	~"dsdp.h
"

12 um { 
	mDSDPNoMrix
=1, 
	mDSDPUnedMrix
=2, 
	mDSDPFaedMrix
=3} 
	tDSDPCGTy
;

15 
DSDPCGTy
 
	mty
;

16 
DSDPSchurM
 
	mM
;

17 
DSDPVec
 
	mDg
;

18 
DSDP
 
	mdsdp
;

19 } 
	tDSDPCGM
;

21 #unde
__FUNCT__


22 
	#__FUNCT__
 "DSDPCGMMu"

	)

23 
	$DSDPCGMMu
(
DSDPCGM
 
M
, 
DSDPVec
 
X
, DSDPVe
Y
){

24 
fo
;

25 
DSDPFuniBeg
;

26 
fo
=
	`DSDPVecZo
(
Y
); 
	`DSDPCHKERR
(info);

27 i(
M
.
ty
==
DSDPUnedMrix
){

28 
fo
=
	`DSDPSchurMMuɝly
(
M
.M,
X
,
Y
); 
	`DSDPCHKERR
(info);

29 } i(
M
.
ty
==
DSDPFaedMrix
){

30 
fo
=
	`DSDPSchurMMuR
(
M
.M,
X
,
Y
); 
	`DSDPCHKERR
(info);

31 
fo
=
	`DSDPVecAXPY
(-0*
M
.
dsdp
->
Mshi
,
X
,
Y
); 
	`DSDPCHKERR
(info);

32 } i(
M
.
ty
==
DSDPNoMrix
){

33 
fo
=
	`DSDPHessnMuɝlyAdd
(
M
.
dsdp
,
X
,
Y
);
	`DSDPCHKERR
(info);

35 
	`DSDPFuniRu
(0);

36 
	}
}

38 #unde
__FUNCT__


39 
	#__FUNCT__
 "DSDPCGMP"

	)

40 
	$DSDPCGMP
(
DSDPCGM
 
M
, 
DSDPVec
 
X
, DSDPVe
Y
){

41 
fo
;

42 
DSDPFuniBeg
;

43 
fo
=
	`DSDPVecZo
(
Y
); 
	`DSDPCHKERR
(info);

44 i(
M
.
ty
==
DSDPUnedMrix
){

45 
fo
=
	`DSDPVecPotwiMu
(
X
,
M
.
Dg
,
Y
);
	`DSDPCHKERR
(info);

46 
fo
=
	`DSDPVecPotwiMu
(
Y
,
M
.
Dg
,Y);
	`DSDPCHKERR
(info);

47 } i(
M
.
ty
==
DSDPFaedMrix
){

48 
fo
=
	`DSDPSchurMSve
(
M
.M,
X
,
Y
);
	`DSDPCHKERR
(info);

49 } i(
M
.
ty
==
DSDPNoMrix
){

50 
fo
=
	`DSDPVecCy
(
X
,
Y
);
	`DSDPCHKERR
(info);

52 
	`DSDPFuniRu
(0);

53 
	}
}

55 #unde
__FUNCT__


56 
	#__FUNCT__
 "DSDPCGMPLe"

	)

57 
	$DSDPCGMPLe
(
DSDPCGM
 
M
, 
DSDPVec
 
X
, DSDPVe
Y
){

58 
fo
;

59 
DSDPFuniBeg
;

60 
fo
=
	`DSDPVecZo
(
Y
); 
	`DSDPCHKERR
(info);

61 i(
M
.
ty
==
DSDPUnedMrix
){

62 
fo
=
	`DSDPVecPotwiMu
(
X
,
M
.
Dg
,
Y
);
	`DSDPCHKERR
(info);

63 } i(
M
.
ty
==
DSDPFaedMrix
){

64 
fo
=
	`DSDPSchurMSve
(
M
.M,
X
,
Y
);
	`DSDPCHKERR
(info);

65 } i(
M
.
ty
==
DSDPNoMrix
){

66 
fo
=
	`DSDPVecCy
(
X
,
Y
);
	`DSDPCHKERR
(info);

68 
	`DSDPFuniRu
(0);

69 
	}
}

71 #unde
__FUNCT__


72 
	#__FUNCT__
 "DSDPCGMPRight"

	)

73 
	$DSDPCGMPRight
(
DSDPCGM
 
M
, 
DSDPVec
 
X
, DSDPVe
Y
){

74 
fo
;

75 
DSDPFuniBeg
;

76 
fo
=
	`DSDPVecZo
(
Y
); 
	`DSDPCHKERR
(info);

77 i(
M
.
ty
==
DSDPNoMrix
){

78 
fo
=
	`DSDPVecPotwiMu
(
X
,
M
.
Dg
,
Y
);
	`DSDPCHKERR
(info);

79 } i(
M
.
ty
==
DSDPFaedMrix
){

80 
fo
=
	`DSDPVecCy
(
X
,
Y
);
	`DSDPCHKERR
(info);

81 } i(
M
.
ty
==
DSDPUnedMrix
){

82 
fo
=
	`DSDPVecCy
(
X
,
Y
);
	`DSDPCHKERR
(info);

84 
	`DSDPFuniRu
(0);

85 
	}
}

88 #unde
__FUNCT__


89 
	#__FUNCT__
 "DSDPCjugeResidu"

	)

90 
	$DSDPCjugeResidu
(
DSDPCGM
 
B
, 
DSDPVec
 
X
, DSDPVe
D
, DSDPVe
R
, DSDPVe
BR
, DSDPVe
P
, DSDPVe
BP
, DSDPVe
TT3
, 
maxs
, *

){

92 
i
,
n
,
fo
;

93 
zo
=0.0,
mus_e
=-1.0;

94 
pha
,
ba
,
bpbp
,
rBr
,
rBrOld
;

95 
r0
,

=1.0e20;

97 
DSDPFuniBeg
;

98 
fo
=
	`DSDPVecNm2
(
X
,&
rBr
); 
	`DSDPCHKERR
(info);

99 i(
rBr
>0){

100 
fo
=
	`DSDPVecCy
(
X
,
P
); 
	`DSDPCHKERR
(info);

101 
fo
=
	`DSDPCGMPRight
(
B
,
P
,
X
);
	`DSDPCHKERR
(info);

102 
fo
=
	`DSDPCGMMu
(
B
,
X
,
R
); 
	`DSDPCHKERR
(info);

104 
fo
=
	`DSDPVecS
(
zo
,
R
); 
	`DSDPCHKERR
(info);

106 
fo
=
	`DSDPVecAYPX
(
mus_e
,
D
,
R
); 
	`DSDPCHKERR
(info);

108 
fo
=
	`DSDPCGMPLe
(
B
,
D
,
R
);
	`DSDPCHKERR
(info);

109 
fo
=
	`DSDPVecCy
(
R
,
P
); 
	`DSDPCHKERR
(info);

111 
fo
=
	`DSDPCGMPRight
(
B
,
R
,
BR
);
	`DSDPCHKERR
(info);

112 
fo
=
	`DSDPCGMMu
(
B
,
BR
,
TT3
); 
	`DSDPCHKERR
(info);

113 
fo
=
	`DSDPCGMPRight
(
B
,
TT3
,
BR
);
	`DSDPCHKERR
(info);

115 
fo
=
	`DSDPVecCy
(
BR
,
BP
); 
	`DSDPCHKERR
(info);

116 
fo
=
	`DSDPVecD
(
BR
,
R
,&
rBr
); 
	`DSDPCHKERR
(info);

117 
fo
=
	`DSDPVecGSize
(
X
,&
n
); 
	`DSDPCHKERR
(info);

118 
r0
=
rBr
;

120 
i
=0;i<
maxs
;i++){

122 i(

/
n
 < 1.0e-30 || 
rBr
/<1.0e-30 ||Br< 1.0e-12 * 
r0
 ) ;

124 
fo
=
	`DSDPVecD
(
BP
,BP,&
bpbp
); 
	`DSDPCHKERR
(info);

125 
pha
 = 
rBr
 / 
bpbp
;

126 
fo

	`DSDPVecAXPY
(
pha
,
P
,
X
); 
	`DSDPCHKERR
(info);

127 
pha
 = -alpha;

128 
fo
=
	`DSDPVecAXPY
(
pha
,
BP
,
R
); 
	`DSDPCHKERR
(info);

130 
fo
=
	`DSDPCGMPRight
(
B
,
R
,
BR
);
	`DSDPCHKERR
(info);

131 
fo
=
	`DSDPCGMMu
(
B
,
BR
,
TT3
); 
	`DSDPCHKERR
(info);

132 
fo
=
	`DSDPCGMPLe
(
B
,
TT3
,
BR
);
	`DSDPCHKERR
(info);

134 
rBrOld
=
rBr
;

135 
fo
=
	`DSDPVecNm2
(
R
,&

); 
	`DSDPCHKERR
(info);

136 
fo
=
	`DSDPVecD
(
BR
,
R
,&
rBr
); 
	`DSDPCHKERR
(info);

138 
	`DSDPLogInfo
(0,11,"CG:r: %4.4e,Br: %4.4\n",

,
rBr
);

140 
ba
 = 
rBr
/
rBrOld
;

141 
fo
=
	`DSDPVecAYPX
(
ba
,
R
,
P
); 
	`DSDPCHKERR
(info);

142 
fo
=
	`DSDPVecAYPX
(
ba
,
BR
,
BP
); 
	`DSDPCHKERR
(info);

145 
fo
=
	`DSDPVecCy
(
X
,
BR
);
	`DSDPCHKERR
(info);

146 
fo
=
	`DSDPCGMPRight
(
B
,
BR
,
X
);
	`DSDPCHKERR
(info);

148 
	`DSDPLogInfo
(0,2,"CjugResidu, InrMr, %4.2e, FMr: %4.2e, Is: %d\n",
r0
,
rBr
,
i
);

150 *

=
i
;

152 
	`DSDPFuniRu
(0);

153 
	}
}

155 #unde
__FUNCT__


156 
	#__FUNCT__
 "DSDPCjugeGd"

	)

157 
	$DSDPCjugeGd
(
DSDPCGM
 
B
, 
DSDPVec
 
X
, DSDPVe
D
, DSDPVe
R
, DSDPVe
BR
, DSDPVe
P
, DSDPVe
BP
, DSDPVe
Z
, 
cgt
, 
maxs
, *

){

159 
i
,
n
,
fo
;

160 
pha
,
ba
=0,
bpbp
;

161 
r0
,

=1.0e20;

162 
rz
,
rzd
,
rz0
;

164 
DSDPFuniBeg
;

165 i(
maxs
<=0){

166 *

=0;

167 
	`DSDPFuniRu
(0);

169 
fo
=
	`DSDPVecGSize
(
X
,&
n
); 
	`DSDPCHKERR
(info);

170 
fo
=
	`DSDPVecNm2
(
X
,&

); 
	`DSDPCHKERR
(info);

171 
fo
=
	`DSDPVecZo
(
R
); 
	`DSDPCHKERR
(info);

172 i(

>0){

173 
fo
=
	`DSDPCGMMu
(
B
,
X
,
R
);
	`DSDPCHKERR
(info);

175 
pha
=-1.0;

176 
fo
=
	`DSDPVecAYPX
(
pha
,
D
,
R
); 
	`DSDPCHKERR
(info);

177 
fo
=
	`DSDPVecNm2
(
R
,&

); 
	`DSDPCHKERR
(info);

178 i(

*
	`sq
(1.0*
n
)<1e-11 +0*
cgt
*cgtol){

179 *

=1;

180 
	`DSDPFuniRu
(0);

183 i(

>0){

184 
fo
=
	`DSDPVecCy
(
R
,
P
); 
	`DSDPCHKERR
(info);

185 
fo
=
	`DSDPVecSR
(
P
,0);
	`DSDPCHKERR
(info);

186 
fo
=
	`DSDPVecNm2
(
P
,&

); 
	`DSDPCHKERR
(info);

187 
fo
=
	`DSDPCGMP
(
B
,
R
,
Z
);
	`DSDPCHKERR
(info);

190 
fo
=
	`DSDPVecCy
(
Z
,
P
); 
	`DSDPCHKERR
(info);

191 
fo
=
	`DSDPVecD
(
R
,
Z
,&
rz
); 
	`DSDPCHKERR
(info);

192 
r0
=

;
rz0
=
rz
;

194 
i
=0;i<
maxs
;i++){

196 
fo
=
	`DSDPCGMMu
(
B
,
P
,
BP
);
	`DSDPCHKERR
(info);

197 
fo
=
	`DSDPVecD
(
BP
,
P
,&
bpbp
); 
	`DSDPCHKERR
(info);

198 i(
bpbp
==0) ;

199 
pha
 = 
rz
/
bpbp
;

200 
fo
=
	`DSDPVecAXPY
(
pha
,
P
,
X
); 
	`DSDPCHKERR
(info);

201 
fo
=
	`DSDPVecAXPY
(-
pha
,
BP
,
R
); 
	`DSDPCHKERR
(info);

202 
fo
=
	`DSDPVecNm2
(
R
,&

); 
	`DSDPCHKERR
(info);

204 
	`DSDPLogInfo
(0,15,"CG: ir: %d,r: %4.4e,ha: %4.4e, ba=%4.4e,z: %4.4\n",
i
,

,
pha
,
ba
,
rz
);

205 i(
i
>1){

206 i(

*
	`sq
(1.0*
n
< 
cgt
){ ;}

207 i(
rz
*
n
 < 
cgt
*cgtol){ ;}

208 i(

/
r0
 < 
cgt
){ ;}

210 i(

<=0){ ;}

211 
fo
=
	`DSDPCGMP
(
B
,
R
,
Z
);
	`DSDPCHKERR
(info);

212 
rzd
=
rz
;

213 
fo
=
	`DSDPVecD
(
R
,
Z
,&
rz
); 
	`DSDPCHKERR
(info);

214 
ba
=
rz
/
rzd
;

215 
fo

	`DSDPVecAYPX
(
ba
,
Z
,
P
); 
	`DSDPCHKERR
(info);

217 
	`DSDPLogInfo
(0,2,"CjugGd, In||r||: %4.2e, F ||r||: %4.2e, In||rz||: %4.4e, ||rz||: %4.4e, Is: %d\n",
r0
,

,
rz0
,
rz
,
i
+1);

219 *

=
i
+1;

221 
	`DSDPFuniRu
(0);

222 
	}
}

238 #unde
__FUNCT__


239 
	#__FUNCT__
 "DSDPCGSve"

	)

240 
	$DSDPCGSve
(
DSDP
 
dsdp
, 
DSDPSchurM
 
MM
, 
DSDPVec
 
RHS
, DSDPVe
X
,
cgt
, 
DSDPTruth
 *
sucss
){

241 

=0,
n
,
fo
,
max
=10;

242 
dd
,
ymax
;

243 
DSDPCG
 *
es
=
dsdp
->sles;

244 
DSDPCGM
 
CGM
;

245 
DSDPFuniBeg
;

247 
fo
=
	`DSDPEvtLogBeg
(
dsdp
->
cgtime
);

248 
fo
=
	`DSDPVecZo
(
X
);
	`DSDPCHKERR
(info);

249 
fo
=
	`DSDPVecGSize
(
X
,&
n
); 
	`DSDPCHKERR
(info);

250 *
sucss
=
DSDP_TRUE
;

252 
max
=0;

253 } i(
dsdp
->
ey
==1){

255 
CGM
.
ty
=
DSDPNoMrix
;

256 
CGM
.
M
=
MM
;

257 
CGM
.
dsdp
=dsdp;

258 
cgt
*=1000;

259 
max
=5;

261 } i(
dsdp
->
ey
==2){

262 
CGM
.
ty
=
DSDPUnedMrix
;

263 
CGM
.
M
=
MM
;

264 
CGM
.
Dg
=
es
->Diag;

265 
CGM
.
dsdp
=dsdp;

266 
cgt
*=100;

267 
max
=()
	`sq
(1.0*
n
)+10;

268 i(
max
>20) maxit=20;

269 
fo
=
	`DSDPVecS
(1.0,
es
->
Dg
);
	`DSDPCHKERR
(info);

275 } i(
dsdp
->
ey
==3){

276 
CGM
.
ty
=
DSDPFaedMrix
;

277 
CGM
.
M
=
MM
;

278 
CGM
.
dsdp
=dsdp;

279 
max
=0;

280 
fo
=
	`DSDPGMaxYEmt
(
dsdp
,&
ymax
);
	`DSDPCHKERR
(info);

281 i(
ymax
 > 1e5 && 
dsdp
->
rg
<1e-1
max
=3;

282 i(0 && 
ymax
 > 1e5 && 
dsdp
->
rg
<1e-2){

283 
max
=6;

284 } i(
dsdp
->
rg
<1e-5){

285 
max
=3;

288 
fo
=
	`DSDPSchurMSve
(
MM
,
RHS
,
X
);
	`DSDPCHKERR
(info);

290 } i(
dsdp
->
ey
==4){

291 
CGM
.
ty
=
DSDPFaedMrix
;

292 
CGM
.
M
=
MM
;

293 
CGM
.
dsdp
=dsdp;

294 
max
=3;

295 
fo
=
	`DSDPSchurMSve
(
MM
,
RHS
,
X
);
	`DSDPCHKERR
(info);

297 i(
n
<
max
) maxit=n;

299 
fo
=
	`DSDPCjugeGd
(
CGM
,
X
,
RHS
,

300 
es
->
R
,es->
BR
,es->
P
,es->
BP
,

301 
es
->
TTT
,
cgt
,
max
,&

);
	`DSDPCHKERR
(
fo
);

303 i(

>=
max
*
sucss
=
DSDP_FALSE
;

304 
fo
=
	`DSDPVecD
(
RHS
,
X
,&
dd
);
	`DSDPCHKERR
(info);

305 i(
dd
<0*
sucss
=
DSDP_FALSE
;

306 
fo
=
	`DSDPEvtLogEnd
(
dsdp
->
cgtime
);

307 
	`DSDPFuniRu
(0);

308 
	}
}

311 #unde
__FUNCT__


312 
	#__FUNCT__
 "DSDPCGInlize"

	)

313 
	$DSDPCGInlize
(
DSDPCG
 **
es
){

314 
DSDPCG
 *
ses
;

315 
fo
;

316 
DSDPFuniBeg
;

317 
	`DSDPCALLOC1
(&
ses
,
DSDPCG
,&
fo
);
	`DSDPCHKERR
(info);

318 
ses
->
tup2
=0;

319 *
es
=
ses
;

320 
	`DSDPFuniRu
(0);

321 
	}
}

323 #unde
__FUNCT__


324 
	#__FUNCT__
 "DSDPCGSup"

	)

325 
	$DSDPCGSup
(
DSDPCG
 *
es
,
DSDPVec
 
X
){

326 
fo
;

327 
DSDPFuniBeg
;

328 
fo
=
	`DSDPVecGSize
(
X
,&
es
->
m
);
	`DSDPCHKERR
(info);

329 i(
es
->
tup2
==0){

330 
fo
 = 
	`DSDPVecDui
(
X
,&
es
->
R
); 
	`DSDPCHKERR
(info);

331 
fo
 = 
	`DSDPVecDui
(
X
,&
es
->
P
); 
	`DSDPCHKERR
(info);

332 
fo
 = 
	`DSDPVecDui
(
X
,&
es
->
BP
); 
	`DSDPCHKERR
(info);

333 
fo
 = 
	`DSDPVecDui
(
X
,&
es
->
BR
); 
	`DSDPCHKERR
(info);

334 
fo
 = 
	`DSDPVecDui
(
X
,&
es
->
Dg
); 
	`DSDPCHKERR
(info);

335 
fo
 = 
	`DSDPVecDui
(
X
,&
es
->
TTT
); 
	`DSDPCHKERR
(info);

337 
es
->
tup2
=1;

338 
	`DSDPFuniRu
(0);

339 
	}
}

341 #unde
__FUNCT__


342 
	#__FUNCT__
 "DSDPCGDeroy"

	)

343 
	$DSDPCGDeroy
(
DSDPCG
 **
ses
){

344 
fo
;

345 
DSDPCG
 *
es
=*
ses
;

346 
DSDPFuniBeg
;

347 i(
ses
==0 || 
es
==0){
	`DSDPFuniRu
(0);}

348 i(
es
->
tup2
==1){

349 
fo
 = 
	`DSDPVecDeroy
(&
es
->
R
); 
	`DSDPCHKERR
(info);

350 
fo
 = 
	`DSDPVecDeroy
(&
es
->
P
); 
	`DSDPCHKERR
(info);

351 
fo
 = 
	`DSDPVecDeroy
(&
es
->
BP
); 
	`DSDPCHKERR
(info);

352 
fo
 = 
	`DSDPVecDeroy
(&
es
->
BR
); 
	`DSDPCHKERR
(info);

353 
fo
 = 
	`DSDPVecDeroy
(&
es
->
Dg
); 
	`DSDPCHKERR
(info);

354 
fo
 = 
	`DSDPVecDeroy
(&
es
->
TTT
); 
	`DSDPCHKERR
(info);

356 
	`DSDPFREE
(
ses
,&
fo
);
	`DSDPCHKERR
(info);

357 
	`DSDPFuniRu
(0);

358 
	}
}

	@dsdpcg.h

1 
	~"dsdpvec.h
"

2 #i!
defed
(
__DSDP_CG_H
)

3 
	#__DSDP_CG_H


	)

10 
	mtup2
;

11 
	mm
;

13 
DSDPVec
 
	mDg
;

14 
DSDPVec
 
	mRHS2
;

15 
DSDPVec
 
	mR
;

16 
DSDPVec
 
	mBR
;

17 
DSDPVec
 
	mP
;

19 
DSDPVec
 
	mBP
;

20 
DSDPVec
 
	mTTT
;

22 } 
	tDSDPCG
;

25 
DSDPCGSup
(
DSDPCG
*, 
DSDPVec
);

26 
DSDPCGDeroy
(
DSDPCG
**);

27 
DSDPCGInlize
(
DSDPCG
 **);

	@dsdpcone.c

1 
	~"dsdpce_im.h
"

2 
	~"dsdpce.h
"

3 
	~"dsdpsys.h
"

10 
	#DSDPNoOtiE
(
a
); { 
	`DSDPSETERR1
(10,"Cڐty: %s, Otiڂ defed\n",).
dsdps
->
me
); }

	)

11 
	#DSDPChkCeE
(
a
,
b
); { i(b){
	`DSDPSETERR1
(b,"Cڐty: %s,\n",).
dsdps
->
me
); } }

	)

13 #unde
__FUNCT__


14 
	#__FUNCT__
 "DSDPCeSUp"

	)

15 
	$DSDPCeSUp
(
DSDPCe
 
K
,
DSDPVec
 
y
){

16 
fo
;

17 
DSDPFuniBeg
;

18 i(
K
.
dsdps
->
cetup
){

19 
fo
=
K
.
dsdps
->
	`cetup
(K.
ceda
,
y
);
	`DSDPChkCeE
(K,info);

21 
	`DSDPNoOtiE
(
K
);

23 
	`DSDPFuniRu
(0);

24 
	}
}

26 #unde
__FUNCT__


27 
	#__FUNCT__
 "DSDPCeSUp2"

	)

28 
	$DSDPCeSUp2
(
DSDPCe
 
K
, 
DSDPVec
 
yy0
, 
DSDPSchurM
 
M
){

29 
fo
;

30 
DSDPFuniBeg
;

31 i(
K
.
dsdps
->
cetup2
){

32 
fo
=
K
.
dsdps
->
	`cetup2
(K.
ceda
,
yy0
,
M
);
	`DSDPChkCeE
(K,info);

34 
	`DSDPNoOtiE
(
K
);

36 
	`DSDPFuniRu
(0);

37 
	}
}

40 #unde
__FUNCT__


41 
	#__FUNCT__
 "DSDPCeDeroy"

	)

42 
	$DSDPCeDeroy
(
DSDPCe
 *
K
){

43 
fo
;

44 
DSDPFuniBeg
;

45 i((*
K
).
dsdps
->
cederoy
){

46 
fo
=(*
K
).
dsdps
->
	`cederoy
((*K).
ceda
);
	`DSDPChkCeE
(*K,info);

47 
fo
=
	`DSDPCeInlize
(
K
); 
	`DSDPCHKERR
(info);

49 
	`DSDPNoOtiE
(*
K
);

51 
	`DSDPFuniRu
(0);

52 
	}
}

55 #unde
__FUNCT__


56 
	#__FUNCT__
 "DSDPCeCompuHessn"

	)

57 
	$DSDPCeCompuHessn

DSDPCe
 
K
 , 
mu
, 
DSDPSchurM
 
M
, 
DSDPVec
 
vrhs1
, DSDPVe
vrhs2
){

58 
fo
;

59 
DSDPFuniBeg
;

60 i(
K
.
dsdps
->
cehessn
){

61 
fo
=
K
.
dsdps
->
	`cehessn
(K.
ceda
,
mu
,
M
,
vrhs1
,
vrhs2
);
	`DSDPChkCeE
(K,info);

63 
	`DSDPNoOtiE
(
K
);

65 
	`DSDPFuniRu
(0);

66 
	}
}

69 #unde
__FUNCT__


70 
	#__FUNCT__
 "DSDPCeMuɝlyAdd"

	)

71 
	$DSDPCeMuɝlyAdd

DSDPCe
 
K
 , 
mu
, 
DSDPVec
 
vrow
, DSDPVe
v
, DSDPVe
vv
){

72 
fo
;

73 
DSDPFuniBeg
;

74 i(
K
.
dsdps
->
cehmuɝlyadd
){

75 
fo
=
K
.
dsdps
->
	`cehmuɝlyadd
(K.
ceda
,
mu
,
vrow
,
v
,
vv
);
	`DSDPChkCeE
(K,info);

77 
	`DSDPNoOtiE
(
K
);

79 
	`DSDPFuniRu
(0);

80 
	}
}

83 #unde
__FUNCT__


84 
	#__FUNCT__
 "DSDPCeCompuRHS"

	)

85 
	$DSDPCeCompuRHS

DSDPCe
 
K
 , 
mu
, 
DSDPVec
 
vrow
,DSDPVe
rhs1
,DSDPVe
rhs2
){

86 
fo
;

87 
DSDPFuniBeg
;

88 i(
K
.
dsdps
->
cڔhs
){

89 
fo
=
K
.
dsdps
->
	`cڔhs
(K.
ceda
,
mu
,
vrow
,
rhs1
,
rhs2
);
	`DSDPChkCeE
(K,info);

91 
	`DSDPNoOtiE
(
K
);

93 
	`DSDPFuniRu
(0);

94 
	}
}

96 #unde
__FUNCT__


97 
	#__FUNCT__
 "DSDPCeANm2"

	)

98 
	$DSDPCeANm2

DSDPCe
 
K
 , 
DSDPVec
 
m2
){

99 
fo
;

100 
DSDPFuniBeg
;

101 i(
K
.
dsdps
->
cڗnm2
){

102 
fo
=
K
.
dsdps
->
	`cڗnm2
(K.
ceda
,
m2
);
	`DSDPChkCeE
(K,info);

104 
	`DSDPNoOtiE
(
K
);

106 
	`DSDPFuniRu
(0);

107 
	}
}

109 #unde
__FUNCT__


110 
	#__FUNCT__
 "DSDPCeSXMak"

	)

111 
	$DSDPCeSXMak

DSDPCe
 
K
, 
mu
, 
DSDPVec
 
y
, DSDPVe
dy
){

112 
fo
;

113 
DSDPFuniBeg
;

114 i(
K
.
dsdps
->
cetxmak
){

115 
fo
=
K
.
dsdps
->
	`cetxmak
(K.
ceda
,
mu
,
y
,
dy
);
	`DSDPChkCeE
(K,info);

117 
	`DSDPNoOtiE
(
K
);

119 
	`DSDPFuniRu
(0);

120 
	}
}

122 #unde
__FUNCT__


123 
	#__FUNCT__
 "DSDPCeCompuX"

	)

124 
	$DSDPCeCompuX

DSDPCe
 
K
, 
mu
, 
DSDPVec
 
y
, DSDPVe
dy
, DSDPVe
AX
, *
axs
){

125 
fo
;

126 
xs
;

127 
DSDPFuniBeg
;

128 i(
K
.
dsdps
->
cecompux
){

129 
xs
=0;

130 
fo
=
K
.
dsdps
->
	`cecompux
(K.
ceda
,
mu
,
y
,
dy
,
AX
,&
xs
);
	`DSDPChkCeE
(K,info);

131 *
axs
+=
xs
;

133 
	`DSDPNoOtiE
(
K
);

135 
	`DSDPFuniRu
(0);

136 
	}
}

138 #unde
__FUNCT__


139 
	#__FUNCT__
 "DSDPCeCompuS"

	)

140 
	$DSDPCeCompuS
(
DSDPCe
 
K
, 
DSDPVec
 
Y
, 
DSDPDuFaMrix
 
ag
, 
DSDPTruth
 *
isdefe
){

141 
fo
;

142 
DSDPFuniBeg
;

143 i(
K
.
dsdps
->
cecompus
){

144 
fo
=
K
.
dsdps
->
	`cecompus
(K.
ceda
,
Y
,
ag
,
isdefe
);
	`DSDPChkCeE
(K,info);

146 
	`DSDPNoOtiE
(
K
);

148 
	`DSDPFuniRu
(0);

149 
	}
}

151 #unde
__FUNCT__


152 
	#__FUNCT__
 "DSDPCeInvtS"

	)

153 
	$DSDPCeInvtS
(
DSDPCe
 
K
){

154 
fo
;

155 
DSDPFuniBeg
;

156 i(
K
.
dsdps
->
cevts
){

157 
fo
=
K
.
dsdps
->
	`cevts
(K.
ceda
);
	`DSDPChkCeE
(K,info);

159 
	`DSDPNoOtiE
(
K
);

161 
	`DSDPFuniRu
(0);

162 
	}
}

164 #unde
__FUNCT__


165 
	#__FUNCT__
 "DSDPCeCompuMaxSpLgth"

	)

166 
	$DSDPCeCompuMaxSpLgth
(
DSDPCe
 
K
, 
DSDPVec
 
DY
, 
DSDPDuFaMrix
 
ag
, *
maxngth
){

167 
fo
;

168 
cength
=1.0e20;

169 
DSDPFuniBeg
;

170 
cength
=1.0e30;

171 i(
K
.
dsdps
->
cemaxngth
){

172 
fo
=
K
.
dsdps
->
	`cemaxngth
(K.
ceda
,
DY
,
ag
,&
cength
);
	`DSDPChkCeE
(K,info);

174 
	`DSDPNoOtiE
(
K
);

176 *
maxngth
=
cength
;

177 
	`DSDPFuniRu
(0);

178 
	}
}

180 #unde
__FUNCT__


181 
	#__FUNCT__
 "DSDPCeGDimsi"

	)

182 
	$DSDPCeGDimsi
(
DSDPCe
 
K
, *
n
){

183 
fo
;

184 

=0;

185 
DSDPFuniBeg
;

186 i(
K
.
dsdps
->
cesize
){

187 
fo
=
K
.
dsdps
->
	`cesize
(K.
ceda
,&

);
	`DSDPChkCeE
(K,info);

189 
	`DSDPNoOtiE
(
K
);

191 *
n
=

;

192 
	`DSDPFuniRu
(0);

193 
	}
}

195 #unde
__FUNCT__


196 
	#__FUNCT__
 "DSDPSrsyInSchurM"

	)

197 
	$DSDPCeSrsyInSchurM
(
DSDPCe
 
K
, 
row
, 
nz
[], 
m
){

198 
fo
,

;

199 
DSDPFuniBeg
;

200 i(
K
.
dsdps
->
cesy
){

201 
fo
=
K
.
dsdps
->
	`cesy
(K.
ceda
,
row
,&

,
nz
,
m
);
	`DSDPChkCeE
(K,info);

203 
	`DSDPNoOtiE
(
K
);

205 
	`DSDPFuniRu
(0);

206 
	}
}

208 #unde
__FUNCT__


209 
	#__FUNCT__
 "DSDPCeVw"

	)

210 
	$DSDPCeVw
(
DSDPCe
 
K
){

211 
fo
;

212 
DSDPFuniBeg
;

213 i(
K
.
dsdps
->
cevw
){

214 
fo
=
K
.
dsdps
->
	`cevw
(K.
ceda
);
	`DSDPChkCeE
(K,info);

216 
	`DSDPNoOtiE
(
K
);

218 
	`DSDPFuniRu
(0);

219 
	}
}

221 #unde
__FUNCT__


222 
	#__FUNCT__
 "DSDPCeMڙ"

	)

223 
	$DSDPCeMڙ
(
DSDPCe
 
K
, 
g
){

224 
fo
;

225 
DSDPFuniBeg
;

226 i(
K
.
dsdps
->
cemڙ
){

227 
fo
=
K
.
dsdps
->
	`cemڙ
(K.
ceda
,
g
);
	`DSDPChkCeE
(K,info);

229 
	`DSDPNoOtiE
(
K
);

231 
	`DSDPFuniRu
(0);

232 
	}
}

235 #unde
__FUNCT__


236 
	#__FUNCT__
 "DSDPCeCompuLogSDmt"

	)

237 
	$DSDPCeCompuLogSDmt
(
DSDPCe
 
K
, *
logdobj
, *
logd
){

238 
fo
;

239 
cڕْtl1
=0,
cڕْtl2
=0;

240 
DSDPFuniBeg
;

241 i(
K
.
dsdps
->
cږogpْtl
){

242 
fo
=
K
.
dsdps
->
	`cږogpْtl
(K.
ceda
,&
cڕْtl1
,&
cڕْtl2
);
	`DSDPChkCeE
(K,info);

244 
	`DSDPNoOtiE
(
K
);

246 *
logdobj
=
cڕْtl1
;

247 *
logd
=
cڕْtl2
;

248 
	`DSDPFuniRu
(0);

249 
	}
}

251 #unde
__FUNCT__


252 
	#__FUNCT__
 "DSDPGCeName"

	)

253 
	$DSDPGCeName
(
DSDPCe
 
K
, *
ame
, 
maxngth
){

254 
DSDPFuniBeg
;

255 
	`y
(
ame
,
K
.
dsdps
->
me
,
maxngth
);

256 
	`DSDPFuniRu
(0);

257 
	}
}

261 #unde
__FUNCT__


262 
	#__FUNCT__
 "DSDPCeOpsInlize"

	)

263 
	$DSDPCeOpsInlize
(
_P_DSDPCe_Ops
* 
ds
){

264 
DSDPFuniBeg
;

265 i(
ds
==
NULL
)  0;

267 
ds
->
cetup
=0;

268 
ds
->
cetup2
=0;

269 
ds
->
cederoy
=0;

270 
ds
->
cڗnm2
=0;

271 
ds
->
cehessn
=0;

272 
ds
->
cehmuɝlyadd
=0;

273 
ds
->
cڔhs
=0;

274 
ds
->
cetxmak
=0;

275 
ds
->
cecompux
=0;

276 
ds
->
cecompus
=0;

277 
ds
->
cevts
=0;

278 
ds
->
cemaxngth
=0;

279 
ds
->
cesy
=0;

280 
ds
->
cږogpْtl
=0;

281 
ds
->
cemڙ
=0;

282 
ds
->
cevw
=0;

283 
ds
->
id
=0;

284 
	`DSDPFuniRu
(0);

285 
	}
}

287 #unde
__FUNCT__


288 
	#__FUNCT__
 "DSDPCeSDa"

	)

289 
	$DSDPCeSDa
(
DSDPCe
 *
K
, 
_P_DSDPCe_Ops
* 
s
, *
da
){

290 
DSDPFuniBeg
;

291 (*
K
).
dsdps
=
s
;

292 (*
K
).
ceda
=
da
;

293 
	`DSDPFuniRu
(0);

294 
	}
}

297 
_P_DSDPCe_Ops
 
	gdsdpcs
;

298 #unde
__FUNCT__


299 
	#__FUNCT__
 "DSDPCeOpsInlize"

	)

300 
	$DSDPCeInlize
(
DSDPCe
 *
K
){

301 
fo
;

302 
DSDPFuniBeg
;

303 
fo
=
	`DSDPCeOpsInlize
(&
dsdpcs
); 
	`DSDPCHKERR
(info);

304 
fo
=
	`DSDPCeSDa
(
K
,&
dsdpcs
,0); 
	`DSDPCHKERR
(info);

305 
	`DSDPFuniRu
(0);

306 
	}
}

	@dsdpcone.h

1 #ide
__DSDPCONEOPERATIONS_H


2 
	#__DSDPCONEOPERATIONS_H


	)

9 
	~"dsdpbasiys.h
"

10 
	~"dsdpvec.h
"

11 
	~"dsdpschurm.h
"

14 
	s_P_DSDPCe
{

15 * 
	mceda
;

16 
_P_DSDPCe_Ops
* 
	mdsdps
;

19 
_P_DSDPCe
 
	tDSDPCe
;

21 
DSDPCeSUp
(
DSDPCe
,
DSDPVec
);

22 
DSDPCeSUp2
(
DSDPCe
, 
DSDPVec
, 
DSDPSchurM
);

23 
DSDPCeGDimsi
(
DSDPCe
,*);

24 
DSDPCeSrsyInSchurM
(
DSDPCe
, ,[],);

25 
DSDPCeCompuS
(
DSDPCe
,
DSDPVec
,
DSDPDuFaMrix
,
DSDPTruth
 *);

26 
DSDPCeInvtS
(
DSDPCe
);

27 
DSDPCeCompuHessn
(
DSDPCe
,,
DSDPSchurM
,
DSDPVec
,DSDPVec);

28 
DSDPCeMuɝlyAdd
(
DSDPCe
,,
DSDPVec
,DSDPVec,DSDPVec);

29 
DSDPCeCompuRHS
(
DSDPCe
,,
DSDPVec
,DSDPVec,DSDPVec);

30 
DSDPCeCompuMaxSpLgth
(
DSDPCe
,
DSDPVec
,
DSDPDuFaMrix
,*);

31 
DSDPCeCompuLogSDmt
(
DSDPCe
,*,*);

32 
DSDPCeCompuX
(
DSDPCe
,,
DSDPVec
,DSDPVec,DSDPVec,*);

33 
DSDPCeSXMak
(
DSDPCe
,,
DSDPVec
,DSDPVec);

34 
DSDPCeVw
(
DSDPCe
);

35 
DSDPCeMڙ
(
DSDPCe
,);

36 
DSDPCeDeroy
(
DSDPCe
*);

37 
DSDPCeANm2
(
DSDPCe
,
DSDPVec
);

38 
DSDPGCeName
(
DSDPCe
,*,);

40 
DSDPCeSDa
(
DSDPCe
*,
_P_DSDPCe_Ops
*,*);

41 
DSDPCeInlize
(
DSDPCe
*);

42 
DSDPSCe
(
DSDP
,
DSDPCe
);

	@dsdpcone_impl.h

1 #ide
__DSDPCONE_H


2 
	#__DSDPCONE_H


	)

9 
	~"dsdpbasiys.h
"

10 
	~"dsdpvec.h
"

11 
	~"dsdpschurm.h
"

13 
	s_P_DSDPCe_Ops
{

14 
	mid
;

15 (*
	mcesize
)(*,*);

16 (*
	mcetup
)(*,
	mDSDPVec
);

17 (*
	mcetup2
)(*,
	mDSDPVec
,
	mDSDPSchurM
);

18 (*
	mcecompus
)(*,
	mDSDPVec
,
	mDSDPDuFaMrix
,
	mDSDPTruth
*);

19 (*
	mcevts
)(*);

20 (*
	mcږogpْtl
)(*,*,*);

21 (*
	mcetxmak
)(*,,
	mDSDPVec
,DSDPVec);

22 (*
	mcecompux
)(*,,
	mDSDPVec
,DSDPVec,DSDPVec,*);

23 (*
	mcehessn
)(*,,
	mDSDPSchurM
,
	mDSDPVec
,DSDPVec);

24 (*
	mcehmuɝlyadd
)(*,,
	mDSDPVec
,DSDPVec,DSDPVec);

25 (*
	mcڔhs
)(*,,
	mDSDPVec
,DSDPVec,DSDPVec);

26 (*
	mcemaxngth
)(*,
	mDSDPVec
,
	mDSDPDuFaMrix
,*);

27 (*
	mcڗnm2
)(*,
	mDSDPVec
);

28 (*
	mcesy
)(*,,*,[],);

29 (*
	mcemڙ
)(*,);

30 (*
	mcederoy
)(*);

31 (*
	mcevw
)(*);

32 cڡ *
	mme
;

35 
DSDPAddCe
(
DSDP
,
_P_DSDPCe_Ops
*, *);

36 
DSDPCeOpsInlize
(
_P_DSDPCe_Ops
*);

	@dsdpconverge.c

1 
	~"dsdp5.h
"

2 
	~"dsdpcvge.h
"

9 
DSDPGCvgMڙ
(
DSDP
, 
CvgMڙ
**);

24 #unde
__FUNCT__


25 
	#__FUNCT__
 "DSDPCheckCvg"

	)

26 
	$DSDPDeuCvg
(
DSDP
 
dsdp
,*
x
){

28 
CvgMڙ
 *
cv
=(CvgMڙ*)
x
;

29 
fo
,
i
,

;

30 
mu
,
mu2
;

31 
rg
,
rg2
,
rgt
=
cv
->rgaptol;

32 
a
=0;

33 
m
,
d
,
p
,
t
=
cv
->t,
mt
=conv->pnormtol;

34 
obj
,
ddobj
, 
g
, 
dubound
=
cv
->dualbound;

35 
s
,

;

36 
DSDPTmiRs
 
as
;

38 
DSDPFuniBeg
;

39 
fo
 = 
	`DSDPGSpLgths
(
dsdp
,&
p
,&
d
); 
	`DSDPCHKERR
(info);

40 
fo
 = 
	`DSDPGPnm
(
dsdp
,&
m
); 
	`DSDPCHKERR
(info);

41 
fo
 = 
	`DSDPGIts
(
dsdp
,&

); 
	`DSDPCHKERR
(info);

42 
fo
 = 
	`DSDPGDDObjeive
(
dsdp
,&
ddobj
); 
	`DSDPCHKERR
(info);

43 
fo
 = 
	`DSDPGPPObjeive
(
dsdp
,&
obj
); 
	`DSDPCHKERR
(info);

44 
fo
 = 
	`DSDPGR
(
dsdp
,&
s
); 
	`DSDPCHKERR
(info);

45 
fo
 = 
	`DSDPGBrrPam
(
dsdp
,&
mu
); 
	`DSDPCHKERR
(info);

46 
fo
 = 
	`DSDPGDimsi
(
dsdp
,&

); 
	`DSDPCHKERR
(info);

47 
fo
 = 
	`DSDPStRs
(
dsdp
,&
as
); 
	`DSDPCHKERR
(info);

48 
fo
 = 
	`DSDPGRTޔ
(
dsdp
,&
a
); 
	`DSDPCHKERR
(info);

49 
fo
 = 
	`DSDPGDuyG
(
dsdp
,&
g
); 
	`DSDPCHKERR
(info);

50 
rg
=(
g
)/(1.0+
	`bs
(
ddobj
)/2+bs(
obj
)/2);

51 
rg2
=(
mu
*

)/(1.0+
	`bs
(
ddobj
)/2+bs(
obj
)/2);

52 i(

==0){

53 
cv
->
hiy
 = 
DSDPHiy
;

54 
i
=0; i<
DSDPHiy
; i++){

55 
cv
->
pha
[
i
] = 0.0;

56 
cv
->
ghi
[
i
] = 0.0;

57 
cv
->
fhi
[
i
] = 0.0;

60 i(

<
cv
->
hiy
 && iter>0){

61 
cv
->
ghi
[

-1]=(
obj
-
ddobj
);

62 
cv
->
fhi
[

-1]=
s
;

67 } i
ddobj
!=ddobj || 
m
 < 0){

68 
as
 = 
DSDP_NUMERICAL_ERROR
;

69 
	`DSDPLogInfo
(0,2,"Stop dueo Numerical Error\n");

70 } i
rg
 <=
rgt
/1.01 && 
s
<=
a
 ){

71 i(
m
>
mt
){

72 
mu2
=
g
/

;

73 
fo
 = 
	`DSDPSBrrPam
(
dsdp
,
mu2
); 
	`DSDPCHKERR
(info);

75 
as
 = 
DSDP_CONVERGED
;

76 
	`DSDPLogInfo
(0,2,"DSDP Cvged: RivDuy G %4.2< %4.2e, Prim Fsib, Du Inasibly %4.2< %4.2\n",
rg
,
rgt
,
s
,
a
);

78 } i
rg2
 <=
rgt
/100 && 
rg
<0.01){

79 
as
 = 
DSDP_CONVERGED
;

80 
	`DSDPLogInfo
(0,2,"DSDP Cvged: RivDuy G %4.2< %4.2e. Check Fsibly \n",
rg
,
rgt
);

81 } i
ddobj
 > 
dubound
 && 
s
<=
a
){

82 
as
 = 
DSDP_UPPERBOUND
;

83 
	`DSDPLogInfo
(0,2,"DSDP Cvged: Du Objeive: %4.2> u bound %4.2e\n",
m
,
dubound
);

84 } i

 > 5 && 
d
<
t
 && d*
m
< s && 
rg
 <= 1.0e-3 ) {

85 
as
 = 
DSDP_SMALL_STEPS
;

86 
	`DSDPLogInfo
(0,2,"DSDP Terminated: Smallelative gapnd small steps detected (3)\n");

89 
fo
=
	`DSDPSCvgFg
(
dsdp
,
as
); 
	`DSDPCHKERR
(info);

91 
	`DSDPFuniRu
(0);

92 
	}
}

108 #unde
__FUNCT__


109 
	#__FUNCT__
 "DSDPSGTޔ"

	)

110 
	$DSDPSGTޔ
(
DSDP
 
dsdp
,
gt
){

111 
fo
;

112 
CvgMڙ
 *
cv
;

113 
DSDPFuniBeg
;

114 
fo
=
	`DSDPGCvgMڙ
(
dsdp
,&
cv
); 
	`DSDPCHKERR
(info);

115 i(
gt
 > 0
cv
->
rgt
 = gaptol;

116 
	`DSDPLogInfo
(0,2,"S RivG Tޔ: %4.4e\n",
gt
);

117 
	`DSDPFuniRu
(0);

118 
	}
}

130 #unde
__FUNCT__


131 
	#__FUNCT__
 "DSDPGGTޔ"

	)

132 
	$DSDPGGTޔ
(
DSDP
 
dsdp
,*
gt
){

133 
fo
;

134 
CvgMڙ
 *
cv
;

135 
DSDPFuniBeg
;

136 
fo
=
	`DSDPGCvgMڙ
(
dsdp
,&
cv
); 
	`DSDPCHKERR
(info);

137 
DSDPFuniBeg
;

138 *
gt
=
cv
->
rgt
;

139 
	`DSDPFuniRu
(0);

140 
	}
}

156 #unde
__FUNCT__


157 
	#__FUNCT__
 "DSDPSPNmTޔ"

	)

158 
	$DSDPSPNmTޔ
(
DSDP
 
dsdp
,

){

159 
fo
;

160 
CvgMڙ
 *
cv
;

161 
DSDPFuniBeg
;

162 
fo
=
	`DSDPGCvgMڙ
(
dsdp
,&
cv
); 
	`DSDPCHKERR
(info);

163 i(

 > 0
cv
->
mt
 =tol;

164 
	`DSDPLogInfo
(0,2,"S RivPNm Tޔ: %4.4e\n",

);

165 
	`DSDPFuniRu
(0);

166 
	}
}

178 #unde
__FUNCT__


179 
	#__FUNCT__
 "DSDPGPNmTޔ"

	)

180 
	$DSDPGPNmTޔ
(
DSDP
 
dsdp
,*

){

181 
fo
;

182 
CvgMڙ
 *
cv
;

183 
DSDPFuniBeg
;

184 
fo
=
	`DSDPGCvgMڙ
(
dsdp
,&
cv
); 
	`DSDPCHKERR
(info);

185 
DSDPFuniBeg
;

186 *

=
cv
->
mt
;

187 
	`DSDPFuniRu
(0);

188 
	}
}

203 #unde
__FUNCT__


204 
	#__FUNCT__
 "DSDPSDuBound"

	)

205 
	$DSDPSDuBound
(
DSDP
 
dsdp
,
dbound
){

206 
fo
;

207 
CvgMڙ
 *
cv
;

208 
DSDPFuniBeg
;

209 
fo
=
	`DSDPGCvgMڙ
(
dsdp
,&
cv
); 
	`DSDPCHKERR
(info);

210 
cv
->
dubound
=
dbound
;

211 
	`DSDPLogInfo
(0,2,"S DuBound o%4.4\n",
dbound
);

212 
	`DSDPFuniRu
(0);

213 
	}
}

225 #unde
__FUNCT__


226 
	#__FUNCT__
 "DSDPGDuBound"

	)

227 
	$DSDPGDuBound
(
DSDP
 
dsdp
,*
dbound
){

228 
fo
;

229 
CvgMڙ
 *
cv
;

230 
DSDPFuniBeg
;

231 
fo
=
	`DSDPGCvgMڙ
(
dsdp
,&
cv
); 
	`DSDPCHKERR
(info);

232 *
dbound
=
cv
->
dubound
;

233 
	`DSDPFuniRu
(0);

234 
	}
}

250 #unde
__FUNCT__


251 
	#__FUNCT__
 "DSDPSSpTޔ"

	)

252 
	$DSDPSSpTޔ
(
DSDP
 
dsdp
,
t
){

253 
fo
;

254 
CvgMڙ
 *
cv
;

255 
DSDPFuniBeg
;

256 
fo
=
	`DSDPGCvgMڙ
(
dsdp
,&
cv
); 
	`DSDPCHKERR
(info);

257 i(
t
 > 0
cv
->steptol = steptol;

258 
	`DSDPFuniRu
(0);

259 
	}
}

271 #unde
__FUNCT__


272 
	#__FUNCT__
 "DSDPGSpTޔ"

	)

273 
	$DSDPGSpTޔ
(
DSDP
 
dsdp
,*
t
){

274 
fo
;

275 
CvgMڙ
 *
cv
;

276 
DSDPFuniBeg
;

277 
fo
=
	`DSDPGCvgMڙ
(
dsdp
,&
cv
); 
	`DSDPCHKERR
(info);

278 *
t
=
cv
->steptol;

279 
	`DSDPFuniRu
(0);

280 
	}
}

296 #unde
__FUNCT__


297 
	#__FUNCT__
 "DSDPGRHiy"

	)

298 
	$DSDPGRHiy
(
DSDP
 
dsdp
, 
hi
[], 
ngth
){

299 
i
,
fo
;

300 
CvgMڙ
 *
cv
;

301 
DSDPFuniBeg
;

302 
fo
=
	`DSDPGCvgMڙ
(
dsdp
,&
cv
); 
	`DSDPCHKERR
(info);

303 
i
=0;i<
ngth
;i++
hi
[i]=0.0;

304 
i
=0;i<
	`DSDPM
(
ngth
,
DSDPHiy
);i++
hi
[i]=
cv
->
fhi
[i];

305 
	`DSDPFuniRu
(0);

306 
	}
}

319 #unde
__FUNCT__


320 
	#__FUNCT__
 "DSDPGGHiy"

	)

321 
	$DSDPGGHiy
(
DSDP
 
dsdp
, 
hi
[], 
ngth
){

322 
i
,
fo
;

323 
CvgMڙ
 *
cv
;

324 
DSDPFuniBeg
;

325 
fo
=
	`DSDPGCvgMڙ
(
dsdp
,&
cv
); 
	`DSDPCHKERR
(info);

326 
i
=0;i<
ngth
;i++
hi
[i]=0.0;

327 
i
=0;i<
	`DSDPM
(
ngth
,
DSDPHiy
);i++
hi
[i]=
cv
->
ghi
[i];

328 
	`DSDPFuniRu
(0);

329 
	}
}

	@dsdpconverge.h

1 #ide
__DSDP_CONVERGE_H


2 
	#__DSDP_CONVERGE_H


	)

7 
	#DSDPHiy
 200

	)

9 
	mhiy
;

10 
	mpha
[
DSDPHiy
];

11 
	mghi
[
DSDPHiy
];

12 
	mfhi
[
DSDPHiy
];

14 
	mt
;

15 
	mrgt
;

16 
	mmt
;

17 
	mdubound
;

18 } 
	tCvgMڙ
;

	@dsdpcops.c

1 
	~"dsdp.h
"

2 
	~"dsdpsys.h
"

8 
	#DSDPCHKCONEERR
(
a
,
b
); { i(b){ 
	`DSDPSETERR1
(b,"CڐNumb: %d,\n",a);} }

	)

10 
	gCeSup
=0,
	gCeCompuS
=0,
	gCeCompuSS
=0,
	gCeCompuH
=0,
	gCeHMuɝlyAdd
=0,
	gCeMaxPSp
=0,
	gCeMaxDSp
=0,
	gCePْtl
=0,
	gCeCompuX
=0,
	gCeVw
=0,
	gCeDeroy
=0,
	gCeXEigs
=0,
	gCeRHS
=0,
	gCeInvtS
=0;

11 
DSDPRegiCeEvts
();

12 
DSDPSSchurMOps
(
DSDP
,
_P_DSDPSchurM_Ops
*, *);

13 
DSDPAddSchurRow
(
DSDP
,, 
DSDPVec
);

18 #unde
__FUNCT__


19 
	#__FUNCT__
 "DSDPZoCeEvts"

	)

20 
	$DSDPZoCeEvts
(){

21 
DSDPFuniBeg
;

22 
CeSup
=0;
CeCompuS
=0;
CeCompuSS
=0;
CeCompuH
=0;
CeHMuɝlyAdd
=0;
CeMaxPSp
=0;
CeMaxDSp
=0;
CePْtl
=0;
CeCompuX
=0;
CeVw
=0;
CeDeroy
=0;
CeXEigs
=0;
CeRHS
=0;
CeInvtS
=0;

23 
	`DSDPFuniRu
(0);

24 
	}
}

26 #unde
__FUNCT__


27 
	#__FUNCT__
 "DSDPRegiCeEvts"

	)

28 
	$DSDPRegiCeEvts
(){

30 
DSDPFuniBeg
;

31 
	`DSDPEvtLogRegi
("CڐSu1&2",&
CeSup
);

32 
	`DSDPEvtLogRegi
("CڐInvS",&
CeInvtS
);

33 
	`DSDPEvtLogRegi
("CڐRHS",&
CeRHS
);

34 
	`DSDPEvtLogRegi
("CڐCompu Newt Eq.",&
CeCompuH
);

35 
	`DSDPEvtLogRegi
("CڐNewt Muɝly-Add",&
CeHMuɝlyAdd
);

36 
	`DSDPEvtLogRegi
("CڐMax P SLgth",&
CeMaxPSp
);

37 
	`DSDPEvtLogRegi
("CڐCompund Fa SP",&
CeCompuSS
);

38 
	`DSDPEvtLogRegi
("CڐMax D SLgth",&
CeMaxDSp
);

39 
	`DSDPEvtLogRegi
("CڐCompund Fa S",&
CeCompuS
);

40 
	`DSDPEvtLogRegi
("CڐPْtl",&
CePْtl
);

41 
	`DSDPEvtLogRegi
("CڐVw",&
CeVw
);

42 
	`DSDPEvtLogRegi
("CڐCompu X",&
CeCompuX
);

43 
	`DSDPEvtLogRegi
("CڐX Residus",&
CeXEigs
);

44 
	`DSDPEvtLogRegi
("CڐDeroy",&
CeDeroy
);

46 
	`DSDPFuniRu
(0);

47 
	}
}

49 #unde
__FUNCT__


50 
	#__FUNCT__
 "DSDPSUpCes"

	)

51 
	$DSDPSUpCes
(
DSDP
 
dsdp
){

52 
fo
,
kk
;

53 
DSDPVec
 
yy0
=
dsdp
->
y
;

54 
DSDPFuniBeg
;

55 
fo
=
	`DSDPRegiCeEvts
();

56 
	`DSDPEvtLogBeg
(
CeSup
);

57 
kk
=0;kk<
dsdp
->
nces
;kk++){

58 
	`DSDPEvtLogBeg
(
dsdp
->
ceid
[
kk
]);

59 
fo
=
	`DSDPCeSUp
(
dsdp
->
ce
[
kk
],
yy0
);
	`DSDPCHKCONEERR
(kk,info);

60 
	`DSDPEvtLogEnd
(
dsdp
->
ceid
[
kk
]);

62 
	`DSDPEvtLogEnd
(
CeSup
);

63 
	`DSDPFuniRu
(0);

64 
	}
}

66 #unde
__FUNCT__


67 
	#__FUNCT__
 "DSDPSUpCes2"

	)

68 
	$DSDPSUpCes2
(
DSDP
 
dsdp
, 
DSDPVec
 
yy0
, 
DSDPSchurM
 
M
){

69 
fo
,
kk
;

70 
DSDPFuniBeg
;

71 
	`DSDPEvtLogBeg
(
CeSup
);

72 
kk
=0;kk<
dsdp
->
nces
;kk++){

73 
	`DSDPEvtLogBeg
(
dsdp
->
ceid
[
kk
]);

74 
fo
=
	`DSDPCeSUp2
(
dsdp
->
ce
[
kk
],
yy0
,
M
);
	`DSDPCHKCONEERR
(kk,info);

75 
	`DSDPEvtLogEnd
(
dsdp
->
ceid
[
kk
]);

77 
	`DSDPEvtLogEnd
(
CeSup
);

78 
	`DSDPFuniRu
(0);

79 
	}
}

82 #unde
__FUNCT__


83 
	#__FUNCT__
 "DSDPDeroyCes"

	)

84 
	$DSDPDeroyCes
(
DSDP
 
dsdp
){

85 
fo
,
kk
,
nces
=
dsdp
->ncones;

86 
DSDPFuniBeg
;

87 
	`DSDPEvtLogBeg
(
CeDeroy
);

88 
kk
=
nces
-1;kk>=0; kk--){

89 
	`DSDPEvtLogBeg
(
dsdp
->
ceid
[
kk
]);

90 
fo
=
	`DSDPCeDeroy
(&
dsdp
->
ce
[
kk
]);
	`DSDPCHKCONEERR
(kk,info);

91 
	`DSDPEvtLogEnd
(
dsdp
->
ceid
[
kk
]);

92 
fo
=
	`DSDPCeInlize
(&
dsdp
->
ce
[
kk
]);
	`DSDPCHKCONEERR
(kk,info);

93 
dsdp
->
nces
--;

95 i(
dsdp
->
maxces
>0){

96 
	`DSDPFREE
(&
dsdp
->
ce
,&
fo
);
	`DSDPCHKERR
(info);

97 
	`DSDPFREE
(&
dsdp
->
ceid
,&
fo
);
	`DSDPCHKERR
(info);

98 
dsdp
->
ce
=0;

99 
dsdp
->
maxces
=0;

101 
	`DSDPEvtLogEnd
(
CeDeroy
);

102 
fo
=
	`DSDPZoCeEvts
();
	`DSDPCHKERR
(info);

103 
	`DSDPFuniRu
(0);

104 
	}
}

118 #unde
__FUNCT__


119 
	#__FUNCT__
 "DSDPCompuHessn"

	)

120 
	$DSDPCompuHessn

DSDP
 
dsdp
 , 
DSDPSchurM
 
M
, 
DSDPVec
 
vrhs1
, DSDPVe
vrhs2
){

121 
fo
,
kk
; 
r
;

122 
DSDPFuniBeg
;

123 
	`DSDPEvtLogBeg
(
CeCompuH
);

124 
dsdp
->
schurmu
=dsdp->
murg
;

125 
fo
=
	`DSDPVecGR
(
dsdp
->
y
,&
r
);
	`DSDPCHKERR
(info);

126 
fo
=
	`DSDPSchurMSR
(
dsdp
->
M
,
r
);
	`DSDPCHKERR
(info);

127 
fo
=
	`DSDPSchurMZoErs
(
M
);
	`DSDPCHKERR
(info);

128 
fo
=
	`DSDPVecZo
(
vrhs1
);
	`DSDPCHKERR
(info);

129 
fo
=
	`DSDPVecZo
(
vrhs2
);
	`DSDPCHKERR
(info);

130 
fo
=
	`DSDPVecZo
(
M
.
schur
->
rhs3
);
	`DSDPCHKERR
(info);

131 
fo
=
	`DSDPObjeiveGH
(
dsdp
,
M
,
vrhs1
); 
	`DSDPCHKERR
(info);

132 
kk
=
dsdp
->
nces
-1;kk>=0;kk--){

133 
	`DSDPEvtLogBeg
(
dsdp
->
ceid
[
kk
]);

134 
fo
=
	`DSDPCeCompuHessn
(
dsdp
->
ce
[
kk
],dsdp->
schurmu
,
M
,
vrhs1
,
vrhs2
);
	`DSDPCHKCONEERR
(kk,info);

135 
	`DSDPEvtLogEnd
(
dsdp
->
ceid
[
kk
]);

137 
fo
=
	`DSDPSchurMAsmb
(
M
);
	`DSDPCHKERR
(info);

139 
fo
=
	`DSDPSchurMReduPVec
(
M
,
vrhs1
);
	`DSDPCHKERR
(info);

140 
fo
=
	`DSDPSchurMReduPVec
(
M
,
vrhs2
);
	`DSDPCHKERR
(info);

141 
fo
=
	`DSDPSchurMReduPVec
(
M
,M.
schur
->
rhs3
);
	`DSDPCHKERR
(info);

142 i(0 && 
dsdp
->
UPty
==
DSDPNev
){

143 
fo
=
	`DSDPVecAXPY
(1.0,
M
.
schur
->
rhs3
,
vrhs2
);
	`DSDPCHKERR
(info);

144 
fo
=
	`DSDPVecZo
(
M
.
schur
->
rhs3
);
	`DSDPCHKERR
(info);

145 
fo
=
	`DSDPVecZo
(
M
.
schur
->
dy3
);
	`DSDPCHKERR
(info);

146 
fo
=
	`DSDPVecSR
(
vrhs1
,0);
	`DSDPCHKERR
(info);

147 
fo
=
	`DSDPVecSR
(
vrhs2
,
r
);
	`DSDPCHKERR
(info);

149 
	`DSDPEvtLogEnd
(
CeCompuH
);

150 
	`DSDPFuniRu
(0);

151 
	}
}

154 #unde
__FUNCT__


155 
	#__FUNCT__
 "DSDPHessnMuɝlyAdd"

	)

156 
	$DSDPHessnMuɝlyAdd

DSDP
 
dsdp
 , 
DSDPVec
 
v
, DSDPVe
vv
){

157 
fo
,
kk
;

158 
DSDPVec
 
vrow
=
dsdp
->
es
->
BR
;

159 
DSDPFuniBeg
;

160 
	`DSDPEvtLogBeg
(
CeHMuɝlyAdd
);

162 
fo
=
	`DSDPSchurMRowSlg
(
dsdp
->
M
,
vrow
);
	`DSDPCHKERR
(info);

163 
kk
=0;kk<
dsdp
->
nces
;kk++){

164 
	`DSDPEvtLogBeg
(
dsdp
->
ceid
[
kk
]);

165 
fo
=
	`DSDPCeMuɝlyAdd
(
dsdp
->
ce
[
kk
],dsdp->
schurmu
,
vrow
,
v
,
vv
);
	`DSDPCHKCONEERR
(kk,info);

166 
	`DSDPEvtLogEnd
(
dsdp
->
ceid
[
kk
]);

168 
fo
=
	`DSDPSchurMReduPVec
(
dsdp
->
M
,
vv
);
	`DSDPCHKERR
(info);

169 
	`DSDPEvtLogEnd
(
CeHMuɝlyAdd
);

170 
	`DSDPFuniRu
(0);

171 
	}
}

173 #unde
__FUNCT__


174 
	#__FUNCT__
 "DSDPCompuG"

	)

183 
	$DSDPCompuG

DSDP
 
dsdp
 , 
DSDPVec
 
vt
, DSDPVe
vrhs1
, DSDPVe
vrhs2
){

184 
fo
,
kk
; 
r
;

185 
DSDPFuniBeg
;

186 
	`DSDPEvtLogBeg
(
CeRHS
);

187 
fo
=
	`DSDPVecZo
(
vrhs1
);
	`DSDPCHKERR
(info);

188 
fo
=
	`DSDPVecZo
(
vrhs2
);
	`DSDPCHKERR
(info);

189 
fo
=
	`DSDPVecGR
(
dsdp
->
y
,&
r
);
	`DSDPCHKERR
(info);

190 
fo
=
	`DSDPSchurMSR
(
dsdp
->
M
,
r
);
	`DSDPCHKERR
(info);

191 
fo
=
	`DSDPSchurMRowSlg
(
dsdp
->
M
,
vt
);
	`DSDPCHKERR
(info);

192 
fo
=
	`DSDPObjeiveGH
(
dsdp
,dsdp->
M
,
vrhs1
); 
	`DSDPCHKERR
(info);

193 i(0 && 
r
==0){
fo
=
	`DSDPVecSR
(
vrhs1
,0);fo=DSDPVecSR(
vrhs2
,0);}

195 
kk
=0;kk<
dsdp
->
nces
;kk++){

196 
	`DSDPEvtLogBeg
(
dsdp
->
ceid
[
kk
]);

197 
fo
=
	`DSDPCeCompuRHS
(
dsdp
->
ce
[
kk
],dsdp->
schurmu
,
vt
,
vrhs1
,
vrhs2
);
	`DSDPCHKCONEERR
(kk,info);

198 
	`DSDPEvtLogEnd
(
dsdp
->
ceid
[
kk
]);

200 
	`DSDPEvtLogEnd
(
CeRHS
);

201 
fo
=
	`DSDPSchurMReduPVec
(
dsdp
->
M
,
vrhs1
);
	`DSDPCHKERR
(info);

202 
fo
=
	`DSDPSchurMReduPVec
(
dsdp
->
M
,
vrhs2
);
	`DSDPCHKERR
(info);

203 
	`DSDPFuniRu
(0);

204 
	}
}

206 #unde
__FUNCT__


207 
	#__FUNCT__
 "DSDPCompuANm2"

	)

208 
	$DSDPCompuANm2

DSDP
 
dsdp
 , 
DSDPVec
 
Anm2
){

209 
fo
,
kk
;

210 
DSDPFuniBeg
;

211 
kk
=0;kk<
dsdp
->
nces
;kk++){

212 
	`DSDPEvtLogBeg
(
dsdp
->
ceid
[
kk
]);

213 
fo
=
	`DSDPCeANm2
(
dsdp
->
ce
[
kk
],
Anm2
);
	`DSDPCHKCONEERR
(kk,info);

214 
	`DSDPEvtLogEnd
(
dsdp
->
ceid
[
kk
]);

216 
	`DSDPFuniRu
(0);

217 
	}
}

232 #unde
__FUNCT__


233 
	#__FUNCT__
 "DSDPCompuSS"

	)

234 
	$DSDPCompuSS
(
DSDP
 
dsdp
, 
DSDPVec
 
Y
, 
DSDPDuFaMrix
 
ag
, 
DSDPTruth
 *
isdefe
){

235 
fo
,
kk
;

236 
DSDPTruth
 
psd
=
DSDP_TRUE
;

237 
DSDPFuniBeg
;

238 i(
ag
==
DUAL_FACTOR
){

239 
	`DSDPEvtLogBeg
(
CeCompuS
);

240 } i(
ag
==
PRIMAL_FACTOR
){

241 
	`DSDPEvtLogBeg
(
CeCompuSS
);

243 
kk
=
dsdp
->
nces
-1; kk>=0 && 
psd
==
DSDP_TRUE
;kk--){

244 
	`DSDPEvtLogBeg
(
dsdp
->
ceid
[
kk
]);

245 
fo
=
	`DSDPCeCompuS
(
dsdp
->
ce
[
kk
],
Y
,
ag
,&
psd
); 
	`DSDPCHKCONEERR
(kk,info);

246 
	`DSDPEvtLogEnd
(
dsdp
->
ceid
[
kk
]);

248 *
isdefe
=
psd
;

249 i(
ag
==
DUAL_FACTOR
){

250 
	`DSDPEvtLogEnd
(
CeCompuS
);

251 } i(
ag
==
PRIMAL_FACTOR
){

252 
	`DSDPEvtLogEnd
(
CeCompuSS
);

254 
	`DSDPFuniRu
(0);

255 
	}
}

267 #unde
__FUNCT__


268 
	#__FUNCT__
 "DSDPInvtS"

	)

269 
	$DSDPInvtS
(
DSDP
 
dsdp
){

270 
fo
,
kk
;

271 
DSDPFuniBeg
;

272 
	`DSDPEvtLogBeg
(
CeInvtS
);

273 
kk
=0;kk<
dsdp
->
nces
;kk++){

274 
	`DSDPEvtLogBeg
(
dsdp
->
ceid
[
kk
]);

275 
fo
=
	`DSDPCeInvtS
(
dsdp
->
ce
[
kk
]); 
	`DSDPCHKCONEERR
(kk,info);

276 
	`DSDPEvtLogEnd
(
dsdp
->
ceid
[
kk
]);

278 
	`DSDPEvtLogEnd
(
CeInvtS
);

279 
	`DSDPFuniRu
(0);

280 
	}
}

296 #unde
__FUNCT__


297 
	#__FUNCT__
 "DSDPCompuMaxSpLgth"

	)

298 
	$DSDPCompuMaxSpLgth
(
DSDP
 
dsdp
, 
DSDPVec
 
DY
, 
DSDPDuFaMrix
 
ag
, *
maxngth
){

299 
fo
,
kk
;

300 
mngth
=1.0e30,
cength
;

301 
DSDPFuniBeg
;

302 i(
ag
==
DUAL_FACTOR
){

303 
	`DSDPEvtLogBeg
(
CeMaxDSp
);

304 } i(
ag
==
PRIMAL_FACTOR
){

305 
	`DSDPEvtLogBeg
(
CeMaxPSp
);

307 
kk
=0;kk<
dsdp
->
nces
;kk++){

308 
	`DSDPEvtLogBeg
(
dsdp
->
ceid
[
kk
]);

309 
cength
=1.0e20;

310 
fo
=
	`DSDPCeCompuMaxSpLgth
(
dsdp
->
ce
[
kk
],
DY
,
ag
,&
cength
);
	`DSDPCHKCONEERR
(kk,info);

311 
mngth
=
	`DSDPM
(mngth,
cength
);

312 
	`DSDPEvtLogEnd
(
dsdp
->
ceid
[
kk
]);

314 *
maxngth
=
mngth
;

315 i(
ag
==
DUAL_FACTOR
){

316 
	`DSDPEvtLogEnd
(
CeMaxDSp
);

317 } i(
ag
==
PRIMAL_FACTOR
){

318 
	`DSDPEvtLogEnd
(
CeMaxPSp
);

320 
	`DSDPFuniRu
(0);

321 
	}
}

338 #unde
__FUNCT__


339 
	#__FUNCT__
 "DSDPPassXVes"

	)

340 
	$DSDPPassXVes
(
DSDP
 
dsdp
, 
mu
, 
DSDPVec
 
Y
, DSDPVe
DY
){

341 
fo
,
kk
;

342 
DSDPFuniBeg
;

343 
kk
=0;kk<
dsdp
->
nces
;kk++){

344 
	`DSDPEvtLogBeg
(
dsdp
->
ceid
[
kk
]);

345 
fo
=
	`DSDPCeSXMak
(
dsdp
->
ce
[
kk
],
mu
,
Y
,
DY
);
	`DSDPCHKCONEERR
(kk,info);

346 
	`DSDPEvtLogEnd
(
dsdp
->
ceid
[
kk
]);

348 
	`DSDPFuniRu
(0);

349 
	}
}

361 #unde
__FUNCT__


362 
	#__FUNCT__
 "DSDPGCicDimsi"

	)

363 
	$DSDPGCicDimsi
(
DSDP
 
dsdp
, *
n
){

364 
fo
,
kk
;

365 

,
n
=0;

366 
DSDPFuniBeg
;

367 
kk
=0;kk<
dsdp
->
nces
;kk++){

368 

=0;

369 
fo
=
	`DSDPCeGDimsi
(
dsdp
->
ce
[
kk
],&

);
	`DSDPCHKCONEERR
(kk,info);

370 
n
+=

;

372 *
n
=
n
;

373 
	`DSDPFuniRu
(0);

374 
	}
}

377 #unde
__FUNCT__


378 
	#__FUNCT__
 "DSDPVwCes"

	)

379 
	$DSDPVwCes
(
DSDP
 
dsdp
){

380 
fo
,
kk
;

381 
DSDPFuniBeg
;

382 
	`DSDPEvtLogBeg
(
CeVw
);

383 
kk
=0;kk<
dsdp
->
nces
;kk++){

384 
	`DSDPEvtLogBeg
(
dsdp
->
ceid
[
kk
]);

385 
fo
=
	`DSDPCeVw
(
dsdp
->
ce
[
kk
]);
	`DSDPCHKCONEERR
(kk,info);

386 
	`DSDPEvtLogEnd
(
dsdp
->
ceid
[
kk
]);

388 
	`DSDPEvtLogEnd
(
CeVw
);

389 
	`DSDPFuniRu
(0);

390 
	}
}

393 #unde
__FUNCT__


394 
	#__FUNCT__
 "DSDPMڙCes"

	)

395 
	$DSDPMڙCes
(
DSDP
 
dsdp
,
g
){

396 
fo
,
kk
;

397 
DSDPFuniBeg
;

398 
	`DSDPEvtLogBeg
(
CeVw
);

399 
kk
=0;kk<
dsdp
->
nces
;kk++){

400 
	`DSDPEvtLogBeg
(
dsdp
->
ceid
[
kk
]);

401 
fo
=
	`DSDPCeMڙ
(
dsdp
->
ce
[
kk
],
g
);
	`DSDPCHKCONEERR
(kk,info);

402 
	`DSDPEvtLogEnd
(
dsdp
->
ceid
[
kk
]);

404 
	`DSDPEvtLogEnd
(
CeVw
);

405 
	`DSDPFuniRu
(0);

406 
	}
}

409 #unde
__FUNCT__


410 
	#__FUNCT__
 "DSDPSrsyInSchurM"

	)

411 
	$DSDPSchurSrsy
(
DSDP
 
dsdp
, 
row
, 
nz
[], 
m
){

412 
fo
,
kk
;

413 
DSDPFuniBeg
;

414 
kk
=0;kk<
dsdp
->
nces
;kk++){

416 
fo
=
	`DSDPCeSrsyInSchurM
(
dsdp
->
ce
[
kk
],
row
,
nz
,
m
+2);
	`DSDPCHKCONEERR
(kk,info);

419 
	`DSDPFuniRu
(0);

420 
	}
}

434 #unde
__FUNCT__


435 
	#__FUNCT__
 "DSDPCompuLogSDmt"

	)

436 
	$DSDPCompuLogSDmt
(
DSDP
 
dsdp
, *
logd
){

437 
fo
,
kk
;

438 
ceobjeive
,
cڕْtl
,
ogd
=0;

439 
DSDPFuniBeg
;

440 
	`DSDPEvtLogBeg
(
CePْtl
);

441 
kk
=0;kk<
dsdp
->
nces
;kk++){

442 
	`DSDPEvtLogBeg
(
dsdp
->
ceid
[
kk
]);

443 
ceobjeive
=0;
cڕْtl
=0;

444 
fo
=
	`DSDPCeCompuLogSDmt
(
dsdp
->
ce
[
kk
],&
ceobjeive
,&
cڕْtl
);
	`DSDPCHKCONEERR
(kk,info);

445 
ogd
+=
cڕْtl
;

446 
	`DSDPEvtLogEnd
(
dsdp
->
ceid
[
kk
]);

448 *
logd
=
ogd
;

449 
	`DSDPEvtLogEnd
(
CePْtl
);

450 
	`DSDPFuniRu
(0);

451 
	}
}

454 #unde
__FUNCT__


455 
	#__FUNCT__
 "DSDPSCe"

	)

456 
	$DSDPSCe
(
DSDP
 
dsdp
,
DSDPCe
 
tce
){

457 
fo
,
i
,
tc
;

458 *
ceid
;

459 
cڒame
[100];

460 
DSDPCe
 *
cces
;

461 
DSDPFuniBeg
;

462 i(
dsdp
->
nces
>=dsdp->
maxces
){

463 
tc
=2*
dsdp
->
maxces
+4;

465 
	`DSDPCALLOC2
(&
cces
,
_P_DSDPCe
,
tc
,&
fo
);
	`DSDPCHKERR
(info);

466 
i
=0;i<
dsdp
->
nces
;i++){
cces
[i]=dsdp->
ce
[i];}

467 
	`DSDPFREE
(&
dsdp
->
ce
,&
fo
);
	`DSDPCHKERR
(info);

468 
dsdp
->
ce
=
cces
;

470 
	`DSDPCALLOC2
(&
ceid
,,
tc
,&
fo
);
	`DSDPCHKERR
(info);

471 
i
=0;i<
dsdp
->
nces
;i++){
ceid
[i]=dsdp->coneid[i];}

472 
	`DSDPFREE
(&
dsdp
->
ceid
,&
fo
);
	`DSDPCHKERR
(info);

473 
dsdp
->
ceid
=coneid;

475 
dsdp
->
maxces
=
tc
;

477 
fo
=
	`DSDPGCeName
(
tce
,
cڒame
,100);
	`DSDPCHKERR
(info);

478 
	`DSDPEvtLogRegi
(
cڒame
,&
tc
);

479 
dsdp
->
ce
[dsdp->
nces
]=
tce
;

480 
dsdp
->
ceid
[dsdp->
nces
]=
tc
;

481 
dsdp
->
nces
++;

482 
	`DSDPFuniRu
(0);

483 
	}
}

510 #unde
__FUNCT__


511 
	#__FUNCT__
 "DSDPAddCe"

	)

512 
	$DSDPAddCe
(
DSDP
 
dsdp
,
_P_DSDPCe_Ops
* 
dsdps
, * 
dsdpce
){

513 
fo
;

514 
DSDPCe
 
K
;

515 
DSDPFuniBeg
;

516 
fo
=
	`DSDPCeInlize
(&
K
); 
	`DSDPCHKERR
(info);

517 
fo
=
	`DSDPCeSDa
(&
K
,
dsdps
,
dsdpce
); 
	`DSDPCHKERR
(info);

518 
fo
=
	`DSDPSCe
(
dsdp
,
K
); 
	`DSDPCHKERR
(info);

519 
	`DSDPFuniRu
(0);

520 
	}
}

546 #unde
__FUNCT__


547 
	#__FUNCT__
 "DSDPSSchurMOps"

	)

548 
	$DSDPSSchurMOps
(
DSDP
 
dsdp
,
_P_DSDPSchurM_Ops
* 
ss
, * 
mda
){

549 
fo
;

550 
DSDPFuniBeg
;

551 
fo
=
	`DSDPSchurMSDa
(&
dsdp
->
M
,
ss
,
mda
);
	`DSDPCHKERR
(info);

552 
	`DSDPFuniRu
(0);

553 
	}
}

556 #unde
__FUNCT__


557 
	#__FUNCT__
 "DSDPSSchurRow"

	)

558 
	$DSDPAddSchurRow
(
DSDP
 
dsdp
,
row
, 
DSDPVec
 
R
){

559 
fo
;

560 
DSDPFuniBeg
;

561 
fo
=
	`DSDPSchurMAddRow
(
dsdp
->
M
,
row
,1.0,
R
);
	`DSDPCHKERR
(info);

562 
	`DSDPFuniRu
(0);

563 
	}
}

590 #unde
__FUNCT__


591 
	#__FUNCT__
 "DSDPCompuXVbs"

	)

592 
	$DSDPCompuXVbs
(
DSDP
 
dsdp
, 
xmakmu
, 
DSDPVec
 
xmaky
, DSDPVe
xmakdy
, DSDPVe
AX
, *
axs
){

593 
kk
,
fo
;

594 
xs
=0,
axs
=0,
ax
;

596 
DSDPFuniBeg
;

597 
	`DSDPEvtLogBeg
(
CeCompuX
);

598 
fo
=
	`DSDPVecZo
(
AX
);
	`DSDPCHKERR
(info);

599 
kk
=0;kk<
dsdp
->
nces
;kk++){

600 
	`DSDPEvtLogBeg
(
dsdp
->
ceid
[
kk
]);

601 
axs
=0;

602 
fo
=
	`DSDPCeCompuX
(
dsdp
->
ce
[
kk
],
xmakmu
,
xmaky
,
xmakdy
,
AX
,&
axs
);
	`DSDPCHKCONEERR
(kk,info);

603 
xs
+=
axs
;

604 
	`DSDPEvtLogEnd
(
dsdp
->
ceid
[
kk
]);

606 
fo
=
	`DSDPVecGR
(
AX
,&
ax
); 
	`DSDPCHKERR
(info);

607 
	`DSDPLogInfo
(0,2,"T(X): %4.2e\n",
dsdp
->
ax
);

608 
fo
=
	`DSDPVecAXPY
(-1.0,
dsdp
->
b
,
AX
); 
	`DSDPCHKERR
(info);

609 
fo
=
	`DSDPCompuFixedYX
(
dsdp
->
M
,
AX
); 
	`DSDPCHKERR
(info);

610 *
axs
=
xs
;

611 
fo
=
	`DSDPVecSR
(
AX
,
ax
); 
	`DSDPCHKERR
(info);

612 
	`DSDPEvtLogEnd
(
CeCompuX
);

613 
	`DSDPFuniRu
(0);

614 
	}
}

	@dsdpobjcone.c

1 
	~"dsdpce_im.h
"

2 
	~"dsdpsys.h
"

9 
DSDPVec
 
	mb
,
	mbb
,
	mT
;

10 
	mdm
;

11 
	mpss
,
	mdss
;

12 
DSDP
 
	mdsdp
;

13 
DSDPTruth
 
	mu
;

14 } 
	tBCe
;

17 
	$BCompuS
(
BCe
 *
K
, 
DSDPVec
 
v
, *
ss
){

18 
fo
;

19 
DSDPFuniBeg
;

20 
fo
=
	`DSDPVecD
(
K
->
bb
,
v
,
ss
);
	`DSDPCHKERR
(info);

21 
	`DSDPFuniRu
(0);

22 
	}
}

24 #unde
__FUNCT__


25 
	#__FUNCT__
 "DSDPRHessn"

	)

26 
	$DSDPRHessn
*
dce
, 
mu
, 
DSDPSchurM
 
M
, 
DSDPVec
 
vrhs1
, DSDPVe
vrhs2
){

27 
BCe
 *
K
=(BCe*)
dce
;

28 
bb
,
dd
,
ss
=
K
->
dss
;

29 
fo
,
i
,
m
,
ncs
;

30 
DSDPVec
 
T
=
K
->T,
b
=K->
bb
;

31 
DSDPFuniBeg
;

32 i(
K
->
u
){

33 
fo
=
	`DSDPVecGSize
(
b
,&
m
);
	`DSDPCHKERR
(info);

34 
i
=0;i<
m
;i++){

35 
fo
=
	`DSDPVecGEmt
(
b
,
i
,&
bb
);
	`DSDPCHKERR
(info);

36 i(
bb
==0) ;

38 
fo
=
	`DSDPSchurMRowCumnSlg
(
M
,
i
,
T
,&
ncs
); 
	`DSDPCHKERR
(info);

39 i(
ncs
==0) ;

41 
fo
=
	`DSDPVecGEmt
(
T
,
i
,&
dd
);
	`DSDPCHKERR
(info);

42 
fo
=
	`DSDPVecAddEmt
(
vrhs2
,
i
,-
bb
*
dd
*
mu
/
ss
);
	`DSDPCHKERR
(info);

44 
fo
=
	`DSDPVecPotwiMu
(
T
,
b
,T);
	`DSDPCHKERR
(info);

46 
fo
=
	`DSDPVecS
(
mu
*
bb
/(
ss
*ss),
T
);
	`DSDPCHKERR
(info);

47 
fo
=
	`DSDPSchurMAddRow
(
M
,
i
,1.0,
T
);
	`DSDPCHKERR
(info);

51 i(
i
==-
m
-1){
fo
=
	`DSDPVecVw
(
T
);}

54 
	`DSDPFuniRu
(0);

55 
	}
}

57 
	$DSDPRRHS
*
dce
, 
mu
, 
DSDPVec
 
vrow
, DSDPVe
vrhs1
, DSDPVe
vrhs2
){

58 
BCe
 *
K
=(BCe*)
dce
;

59 
bb
,
dd
,
ss
=
K
->
dss
;

60 
fo
,
i
,
m
;

61 
DSDPVec
 
b
=
K
->
bb
;

62 
DSDPFuniBeg
;

63 i(
K
->
u
){

64 
fo
=
	`DSDPVecGSize
(
b
,&
m
);
	`DSDPCHKERR
(info);

65 
i
=0;i<
m
;i++){

66 
fo
=
	`DSDPVecGEmt
(
b
,
i
,&
bb
);
	`DSDPCHKERR
(info);

67 
fo
=
	`DSDPVecGEmt
(
vrow
,
i
,&
dd
);
	`DSDPCHKERR
(info);

68 
fo
=
	`DSDPVecAddEmt
(
vrhs2
,
i
,-
bb
*
dd
*
mu
/
ss
);
	`DSDPCHKERR
(info);

78 
	`DSDPFuniRu
(0);

79 
	}
}

81 #unde
__FUNCT__


82 
	#__FUNCT__
 "DSDPSupBCe"

	)

83 
	$DSDPSupBCe
(* 
dce
,
DSDPVec
 
y
){

84 
DSDPFuniBeg
;

85 
	`DSDPFuniRu
(0);

86 
	}
}

89 #unde
__FUNCT__


90 
	#__FUNCT__
 "DSDPSDRDa"

	)

91 
	$DSDPSDRDa
(
BCe
 *
K
){

92 
fo
;

93 
DSDPFuniBeg
;

94 
fo
=
	`DSDPVecCy
(
K
->
b
,K->
bb
);
	`DSDPCHKERR
(info);

95 
fo
=
	`DSDPVecSC
(
K
->
bb
,K->
dm
);
	`DSDPCHKERR
(info);

96 
fo
=
	`DSDPVecSR
(
K
->
bb
,-1.0);
	`DSDPCHKERR
(info);

97 
	`DSDPFuniRu
(0);

98 
	}
}

100 #unde
__FUNCT__


101 
	#__FUNCT__
 "DSDPSupBCe2"

	)

102 
	$DSDPSupBCe2
(* 
dce
, 
DSDPVec
 
y
, 
DSDPSchurM
 
M
){

103 
BCe
 *
K
=(BCe*)
dce
;

104 
fo
;

105 
DSDPFuniBeg
;

106 
fo
=
	`DSDPVecDui
(
K
->
b
,&K->
T
);
	`DSDPCHKERR
(info);

107 
fo
=
	`DSDPVecDui
(
K
->
b
,&K->
bb
);
	`DSDPCHKERR
(info);

108 
fo
=
	`DSDPSDRDa
(
K
);
	`DSDPCHKERR
(info);

109 
	`DSDPFuniRu
(0);

110 
	}
}

113 #unde
__FUNCT__


114 
	#__FUNCT__
 "DSDPDeroyBCe"

	)

115 
	$DSDPDeroyBCe
(* 
dce
){

116 
BCe
 *
K
=(BCe*)
dce
;

117 
fo
;

118 
DSDPFuniBeg
;

119 
fo
=
	`DSDPVecDeroy
(&
K
->
T
);
	`DSDPCHKERR
(info);

120 
fo
=
	`DSDPVecDeroy
(&
K
->
bb
);
	`DSDPCHKERR
(info);

121 
	`DSDPFREE
(&
dce
,&
fo
);
	`DSDPCHKERR
(info);

122 
	`DSDPFuniRu
(0);

123 
	}
}

126 #unde
__FUNCT__


127 
	#__FUNCT__
 "DSDPRSize"

	)

128 
	$DSDPRSize
(*
dce
,*
n
){

129 
DSDPFuniBeg
;

130 *
n
=1.0;

131 
	`DSDPFuniRu
(0);

132 
	}
}

134 #unde
__FUNCT__


135 
	#__FUNCT__
 "DSDPRSrsy"

	)

136 
	$DSDPRSrsy
(*
dce
,
row
, *
nz
, 
nz
[], 
m
){

137 
BCe
 *
K
=(BCe*)
dce
;

138 
i
,
fo
;
dd
;

139 
DSDPFuniBeg
;

140 *
nz
=0;

142 
fo
=
	`DSDPVecGEmt
(
K
->
b
,
row
,&
dd
);
	`DSDPCHKERR
(info);

143 i(
dd
){

144 
i
=0;i<
m
;i++){

145 
fo
=
	`DSDPVecGEmt
(
K
->
b
,
i
,&
dd
);
	`DSDPCHKERR
(info);

146 i(
dd
!=0){
nz
[
i
]++; (*
nz
)++;}

149 
	`DSDPFuniRu
(0);

150 
	}
}

152 #unde
__FUNCT__


153 
	#__FUNCT__
 "DSDPCompuRS"

	)

154 
	$DSDPCompuRS
(*
dce
, 
DSDPVec
 
Y
, 
DSDPDuFaMrix
 
ag
, 
DSDPTruth
 *
isdefe
){

155 
BCe
 *
K
=(BCe*)
dce
;

156 
fo
;

157 
ss
;

158 
DSDPFuniBeg
;

159 
fo
=
	`BCompuS
(
K
,
Y
,&
ss
);
	`DSDPCHKERR
(info);

160 i(
ss
>0){ *
isdefe
=
DSDP_TRUE
; } { *isdefe=
DSDP_FALSE
;}

161 i(
ag
==
DUAL_FACTOR
){ 
K
->
dss
=
ss
; } { K->
pss
=ss;}

162 
	`DSDPLogInfo
(0,2,"DOBJCڐSS: %4.4\n",
ss
);

163 
	`DSDPFuniRu
(0);

164 
	}
}

166 #unde
__FUNCT__


167 
	#__FUNCT__
 "DSDPInvtRS"

	)

168 
	$DSDPInvtRS
(*
dce
){

169 
DSDPFuniBeg
;

170 
	`DSDPFuniRu
(0);

171 
	}
}

174 #unde
__FUNCT__


175 
	#__FUNCT__
 "DSDPCompuRSpLgth"

	)

176 
	$DSDPCompuRSpLgth
(*
dce
, 
DSDPVec
 
DY
, 
DSDPDuFaMrix
 
ag
, *
maxngth
){

177 
BCe
 *
K
=(BCe*)
dce
;

178 
ds
,
ss
,

=1.0e30;

179 
fo
;

181 
DSDPFuniBeg
;

182 
fo
=
	`BCompuS
(
K
,
DY
,&
ds
);
	`DSDPCHKERR
(info);

183 i(
ag
==
DUAL_FACTOR
){ 
ss
=
K
->
dss
; } { ss=K->
pss
;}

184 i(
ds
<0

=-
ss
/ds;

185 i(
K
->
u
){

186 *
maxngth
=

;

188 
	`DSDPFuniRu
(0);

189 
	}
}

191 #unde
__FUNCT__


192 
	#__FUNCT__
 "DSDPSX"

	)

193 
	$DSDPSX
*
dce
, 
mu
, 
DSDPVec
 
y
, DSDPVe
dy
){

194 
DSDPFuniBeg
;

195 
	`DSDPFuniRu
(0);

196 
	}
}

197 #unde
__FUNCT__


198 
	#__FUNCT__
 "DSDPRX"

	)

199 
	$DSDPRX
*
dce
, 
mu
, 
DSDPVec
 
y
, DSDPVe
dy
, DSDPVe
AX
,*
acxs
){

200 
BCe
 *
K
=(BCe*)
dce
;

201 
x
,
dss
,
ss
=
K
->dss;

202 
fo
;

203 
DSDPFuniBeg
;

205 
fo
=
	`BCompuS
(
K
,
y
,&
ss
);
	`DSDPCHKERR
(info);

206 
ss
=1.0/ss;

207 
fo
=
	`BCompuS
(
K
,
dy
,&
dss
);
	`DSDPCHKERR
(info);

208 
x
=
mu
*(
ss
+ss*
dss
*ss);

209 
	`DSDPLogInfo
(0,2,"DOBJCڐSS: %4.4e, RESIDUAL X: %4.4e\n",1.0/
ss
,
x
);

210 i(
	`bs
(
x
*
ss
)>1.0 && 
mu
 < 1
	`tf
("Check Dual Min Bound\n");

211 
fo
=
	`DSDPVecAXPY
(-
x
,
K
->
bb
,
AX
);
	`DSDPCHKERR
(info);

212 
	`DSDPFuniRu
(0);

213 
	}
}

215 #unde
__FUNCT__


216 
	#__FUNCT__
 "DSDPCompuRLog"

	)

217 
	$DSDPCompuRLog
(*
dce
, *
logobj
, *
logd
){

218 
BCe
 *
K
=(BCe*)
dce
;

219 
DSDPFuniBeg
;

220 *
logobj
=0;

221 *
logd
=
	`log
(
K
->
dss
);

222 
	`DSDPFuniRu
(0);

223 
	}
}

225 #unde
__FUNCT__


226 
	#__FUNCT__
 "DSDPRANm2"

	)

227 
	$DSDPRANm2
(*
dce
, 
DSDPVec
 
Anm2
){

228 
DSDPFuniBeg
;

229 
	`DSDPFuniRu
(0);

230 
	}
}

233 #unde
__FUNCT__


234 
	#__FUNCT__
 "DSDPRMuɝlyAdd"

	)

235 
	$DSDPRMuɝlyAdd
(*
dce
,
mu
,
DSDPVec
 
vrow
,DSDPVe
v
,DSDPVe
vout
){

236 
BCe
 *
K
=(BCe*)
dce
;

237 
DSDPVec
 
T
=
K
->T;

238 
fo
;

239 
dd
,
ss
=
K
->
dss
;

240 
DSDPFuniBeg
;

241 
fo
=
	`DSDPVecD
(
v
,
K
->
bb
,&
dd
);
	`DSDPCHKERR
(info);

242 
dd
=-
mu
*dd/(
ss
*ss);

243 
fo
=
	`DSDPVecPotwiMu
(
K
->
bb
,
vrow
,
T
);
	`DSDPCHKERR
(info);

244 
fo
=
	`DSDPVecAXPY
(
dd
,
T
,
vout
);
	`DSDPCHKERR
(info);

245 
	`DSDPFuniRu
(0);

246 
	}
}

249 #unde
__FUNCT__


250 
	#__FUNCT__
 "DSDPRMڙ"

	)

251 
	$DSDPRMڙ
*
dce
, 
g
){

252 
DSDPFuniBeg
;

253 
	`DSDPFuniRu
(0);

254 
	}
}

256 
_P_DSDPCe_Ops
 
	gks
;

257 cڡ * 
	gmme
="Dual Obj Cone";

259 #unde
__FUNCT__


260 
	#__FUNCT__
 "BCeOtisInlize"

	)

261 
	$BCeOtisInlize
(
_P_DSDPCe_Ops
* 
ces
){

262 
fo
;

263 i(
ces
==
NULL
)  0;

264 
fo
=
	`DSDPCeOpsInlize
(
ces
); 
	`DSDPCHKERR
(info);

265 
ces
->
cehessn
=
DSDPRHessn
;

266 
ces
->
cetup
=
DSDPSupBCe
;

267 
ces
->
cetup2
=
DSDPSupBCe2
;

268 
ces
->
cederoy
=
DSDPDeroyBCe
;

269 
ces
->
cecompus
=
DSDPCompuRS
;

270 
ces
->
cevts
=
DSDPInvtRS
;

271 
ces
->
cecompux
=
DSDPRX
;

272 
ces
->
cetxmak
=
DSDPSX
;

273 
ces
->
cemaxngth
=
DSDPCompuRSpLgth
;

274 
ces
->
cږogpْtl
=
DSDPCompuRLog
;

275 
ces
->
cesize
=
DSDPRSize
;

276 
ces
->
cesy
=
DSDPRSrsy
;

277 
ces
->
cڗnm2
=
DSDPRANm2
;

278 
ces
->
cemڙ
=
DSDPRMڙ
;

279 
ces
->
cehmuɝlyadd
=
DSDPRMuɝlyAdd
;

280 
ces
->
cڔhs
=
DSDPRRHS
;

281 
ces
->
id
=119;

282 
ces
->
me
=
mme
;

284 
	}
}

286 #unde
__FUNCT__


287 
	#__FUNCT__
 "DSDPAddBCe"

	)

288 
	$DSDPAddBCe
(
DSDP
 
dsdp
, 
DSDPVec
 
bb
, 
dm
){

289 
BCe
 *
rce
;

290 
fo
;

291 
DSDPFuniBeg
;

292 
fo
=
	`BCeOtisInlize
(&
ks
); 
	`DSDPCHKERR
(info);

293 
	`DSDPCALLOC1
(&
rce
,
BCe
,&
fo
); 
	`DSDPCHKERR
(info);

294 
rce
->
b
=
bb
;

295 
rce
->
dm
=dmin;

296 
rce
->
dsdp
=dsdp;

297 
rce
->
u
=
DSDP_TRUE
;

298 
fo
=
	`DSDPAddCe
(
dsdp
,&
ks
,(*)
rce
); 
	`DSDPCHKERR
(info);

299 
	`DSDPFuniRu
(0);

300 
	}
}

302 
	~"dsdp.h
"

303 #unde
__FUNCT__


304 
	#__FUNCT__
 "DSDPSDuLowBound"

	)

305 
	$DSDPSDuLowBound
(
DSDP
 
dsdp
, 
dobjm
){

306 
fo
;

307 
DSDPFuniBeg
;

308 
fo
 = 
	`DSDPAddBCe
(
dsdp
,dsdp->
b
,
dobjm
);
	`DSDPCHKERR
(info);

309 
	`DSDPFuniRu
(0);

310 
	}
}

	@dsdpprintout.c

1 
	~"dsdp5.h
"

7 
	gdsdrev
=0;

8 
	gdsdrev2
=0;

10 #unde
__FUNCT__


11 
	#__FUNCT__
 "DSDPPrtSts"

	)

12 
	$DSDPPrtStsFe
(
DSDP
 
dsdp
, *
dummy
){

14 
obj
,
ddobj
,
pp
,
dp
,
mu
,
s
,
pas
,
m
;

15 

,
fo
;

16 
ev
=
dsdrev2
;

17 
DSDPTmiRs
 
as
;

19 if(
ev
<=0) (0);

20 if(!
dsdpouutfe
) (0);

22 
fo
 = 
	`DSDPStRs
(
dsdp
,&
as
);
	`DSDPCHKERR
(info);

23 
fo
 = 
	`DSDPGIts
(
dsdp
,&

);
	`DSDPCHKERR
(info);

25 if(
as
!=
CONTINUE_ITERATING
|| ((

 % 
ev
)==0)){

26 
fo
 = 
	`DSDPGDDObjeive
(
dsdp
,&
ddobj
); 
	`DSDPCHKERR
(info);

27 
fo
 = 
	`DSDPGPPObjeive
(
dsdp
,&
obj
); 
	`DSDPCHKERR
(info);

28 
fo
 = 
	`DSDPGR
(
dsdp
,&
s
); 
	`DSDPCHKERR
(info);

29 
fo
 = 
	`DSDPGPInasiby
(
dsdp
,&
pas
); 
	`DSDPCHKERR
(info);

30 
fo
 = 
	`DSDPGSpLgths
(
dsdp
,&
pp
,&
dp
); 
	`DSDPCHKERR
(info);

31 
fo
 = 
	`DSDPGBrrPam
(
dsdp
,&
mu
); 
	`DSDPCHKERR
(info);

32 
fo
 = 
	`DSDPGPnm
(
dsdp
,&
m
); 
	`DSDPCHKERR
(info);

33 i(
as
==
CONTINUE_ITERATING
 && 

>100 && iter%10!=0)  0;

35 i(

==0){

36 
	`rtf
(
dsdpouutfe
,"Iter PP Objective DD Objective PInfeas DInfeas Mu StepLength Pnrm\n");

37 
	`rtf
(
dsdpouutfe
,"--------------------------------------------------------------------------------------\n");

39 
	`rtf
(
dsdpouutfe
,"%-3d %16.8 %16.8%9.1%9.1%9.1e",

,
obj
,
ddobj
,
pas
,
s
,
mu
);

40 
	`rtf
(
dsdpouutfe
," %4.2 %4.2f",
pp
,
dp
);

41 i(
m
>1.0e3){

42 
	`rtf
(
dsdpouutfe
," %1.0\n",
m
);

44 
	`rtf
(
dsdpouutfe
," %5.2\n",
m
);

49 
	}
}

51 #unde
__FUNCT__


52 
	#__FUNCT__
 "DSDPSSnddMڙ"

	)

53 
	$DSDPSFeMڙ
(
DSDP
 
dsdp
, 
ev
){

54 
fo
;

55 
dsdrev2
=
ev
;

56 
fo
=
	`DSDPSMڙ
(
dsdp
,
DSDPPrtStsFe
,0); 
	`DSDPCHKERR
(info);

58 
	}
}

69 #unde
__FUNCT__


70 
	#__FUNCT__
 "DSDPPrtSts"

	)

71 
	$DSDPPrtSts
(
DSDP
 
dsdp
, *
dummy
){

73 
obj
,
ddobj
,
pp
,
dp
,
mu
,
s
,
pas
,
m
;

74 

,
fo
;

75 
ev
=
dsdrev
;

76 
DSDPTmiRs
 
as
;

78 if(
ev
<=0) (0);

80 
fo
 = 
	`DSDPStRs
(
dsdp
,&
as
);
	`DSDPCHKERR
(info);

81 
fo
 = 
	`DSDPGIts
(
dsdp
,&

);
	`DSDPCHKERR
(info);

83 if(
as
!=
CONTINUE_ITERATING
|| ((

 % 
ev
)==0)){

84 
fo
 = 
	`DSDPGDDObjeive
(
dsdp
,&
ddobj
); 
	`DSDPCHKERR
(info);

85 
fo
 = 
	`DSDPGPPObjeive
(
dsdp
,&
obj
); 
	`DSDPCHKERR
(info);

86 
fo
 = 
	`DSDPGR
(
dsdp
,&
s
); 
	`DSDPCHKERR
(info);

87 
fo
 = 
	`DSDPGPInasiby
(
dsdp
,&
pas
); 
	`DSDPCHKERR
(info);

88 
fo
 = 
	`DSDPGSpLgths
(
dsdp
,&
pp
,&
dp
); 
	`DSDPCHKERR
(info);

89 
fo
 = 
	`DSDPGBrrPam
(
dsdp
,&
mu
); 
	`DSDPCHKERR
(info);

90 
fo
 = 
	`DSDPGPnm
(
dsdp
,&
m
); 
	`DSDPCHKERR
(info);

91 i(0 && 
as
==
CONTINUE_ITERATING
 && 

>100 && iter%10!=0)  0;

93 i(

==0){

94 
	`tf
("Iter PP Objective DD Objective PInfeas DInfeas Nu StepLength Pnrm\n")

96 
	`tf
("---------------------------------------------------------------------------------------\n")

99 
	`tf
("%-3d %16.8 %16.8%9.1%9.1%9.1e",

,
obj
,
ddobj
,
pas
,
s
,
mu
);

100 
	`tf
(" %4.2 %4.2f",
pp
,
dp
);

101 i(
m
>1.0e3){

102 
	`tf
(" %1.0\n",
m
);

104 
	`tf
(" %5.2\n",
m
);

106 
	`fush
(
NULL
);

109 
	}
}

151 #unde
__FUNCT__


152 
	#__FUNCT__
 "DSDPSSnddMڙ"

	)

153 
	$DSDPSSnddMڙ
(
DSDP
 
dsdp
, 
k
){

154 
fo
;

155 
fo
=
	`DSDPSMڙ
(
dsdp
,
DSDPPrtSts
,0); 
	`DSDPCHKERR
(info);

156 
dsdrev
=
k
;

158 
	}
}

	@dsdprescone.c

1 
	~"dsdpce_im.h
"

2 
	~"dsdpsys.h
"

3 
	~"dsdpbasiys.h
"

10 
	sRDCe
{

11 
	mimr
,
	mdur
,
	mx
,
	mlogr
;

12 
DSDPPty
 
	mUPty
;

13 
DSDP
 
	mdsdp
;

16 
RDCe
 
	tRCe
;

18 #unde
__FUNCT__


19 
	#__FUNCT__
 "DSDPRHessn"

	)

20 
	$DSDPRHessn
*
dce
, 
mu
, 
DSDPSchurM
 
M
, 
DSDPVec
 
vrhs1
, DSDPVe
vrhs2
){

21 
RCe
 *
K
=(RCe*)
dce
;

22 
fo
,
m
;

23 

,

,
rs
;

24 
DSDPFuniBeg
;

25 i(
K
->
dur
 ){

26 
fo
=
	`DSDPVecGSize
(
vrhs2
,&
m
);
	`DSDPCHKERR
(info);

27 
fo
=
	`DSDPSchurMVbCompu
(
M
,
m
-1,&

);
	`DSDPCHKERR
(info);

28 i(

){

29 

=-
mu
*

/(
K
->
dur
);

30 
rs
=
mu
*

/(
K
->
dur
*K->dualr);

31 
fo
=
	`DSDPVecAddR
(
vrhs2
,

);
	`DSDPCHKERR
(info);

32 
fo
=
	`DSDPSchurMAddDgڮEmt
(
M
,
m
-1,
rs
);
	`DSDPCHKERR
(info);

35 
	`DSDPFuniRu
(0);

36 
	}
}

39 #unde
__FUNCT__


40 
	#__FUNCT__
 "DSDPRHS"

	)

41 
	$DSDPRHS
*
dce
, 
mu
, 
DSDPVec
 
vrow
,DSDPVe
vrhs1
,DSDPVe
vrhs2
){

42 
RCe
 *
K
=(RCe*)
dce
;

43 
fo
;

44 

,

;

45 
DSDPFuniBeg
;

46 i(
K
->
dur
 ){

47 

=-
mu
/(
K
->
dur
);

48 
fo
=
	`DSDPVecGR
(
vrow
,&

);
	`DSDPCHKERR
(info);

49 
fo
=
	`DSDPVecAddR
(
vrhs2
,

*

);
	`DSDPCHKERR
(info);

51 
	`DSDPFuniRu
(0);

52 
	}
}

55 #unde
__FUNCT__


56 
	#__FUNCT__
 "DSDPSupRCe"

	)

57 
	$DSDPSupRCe
(* 
dce
,
DSDPVec
 
y
){

58 
DSDPFuniBeg
;

59 
	`DSDPFuniRu
(0);

60 
	}
}

62 #unde
__FUNCT__


63 
	#__FUNCT__
 "DSDPSupRCe2"

	)

64 
	$DSDPSupRCe2
(* 
dce
, 
DSDPVec
 
y
, 
DSDPSchurM
 
M
){

65 
DSDPFuniBeg
;

66 
	`DSDPFuniRu
(0);

67 
	}
}

70 #unde
__FUNCT__


71 
	#__FUNCT__
 "DSDPDeroyRCe"

	)

72 
	$DSDPDeroyRCe
(* 
dce
){

73 
fo
;

74 
DSDPFuniBeg
;

75 
	`DSDPFREE
(&
dce
,&
fo
);
	`DSDPCHKERR
(info);

76 
	`DSDPFuniRu
(0);

77 
	}
}

80 #unde
__FUNCT__


81 
	#__FUNCT__
 "DSDPRSize"

	)

82 
	$DSDPRSize
(*
dce
,*
n
){

83 
RCe
 *
K
=(RCe*)
dce
;

84 
DSDPFuniBeg
;

85 i(
K
->
dur
){*
n
=1;}

86 {*
n
=0;}

87 
	`DSDPFuniRu
(0);

88 
	}
}

90 #unde
__FUNCT__


91 
	#__FUNCT__
 "DSDPRSrsy"

	)

92 
	$DSDPRSrsy
(*
dce
,
row
, *
nz
, 
nz
[], 
m
){

93 
DSDPFuniBeg
;

94 *
nz
=0;

95 
	`DSDPFuniRu
(0);

96 
	}
}

99 #unde
__FUNCT__


100 
	#__FUNCT__
 "DSDPCompuRS"

	)

101 
	$DSDPCompuRS
(*
dce
, 
DSDPVec
 
Y
, 
DSDPDuFaMrix
 
ag
, 
DSDPTruth
 *
isdefe
){

102 
RCe
 *
K
=(RCe*)
dce
;

103 
fo
;

104 
rba
;

105 
DSDPFuniBeg
;

106 
fo
=
	`DSDPVecGR
(
Y
,&
rba
); 
	`DSDPCHKERR
(info);

107 i(
K
->
UPty
==
DSDPAlways
){

108 i(
rba
<0){ *
isdefe
=
DSDP_TRUE
; } { *isdefe=
DSDP_FALSE
;}

110 i(
rba
>0)beta=0;

111 *
isdefe
=
DSDP_TRUE
;

113 i(
ag
==
DUAL_FACTOR
){ 
K
->
dur
=
rba
; } { K->
imr
=rbeta;}

114 
	`DSDPFuniRu
(0);

115 
	}
}

116 #unde
__FUNCT__


117 
	#__FUNCT__
 "DSDPInvtRS"

	)

118 
	$DSDPInvtRS
(*
dce
){

119 
DSDPFuniBeg
;

120 
	`DSDPFuniRu
(0);

121 
	}
}

125 #unde
__FUNCT__


126 
	#__FUNCT__
 "DSDPCompuRSpLgth"

	)

127 
	$DSDPCompuRSpLgth
(*
dce
, 
DSDPVec
 
DY
, 
DSDPDuFaMrix
 
ag
, *
maxngth
){

128 
RCe
 *
K
=(RCe*)
dce
;

129 
r
,
rba
,
mngth
=1.0e100,

=1.0e30;

130 
fo
;

131 
DSDPFuniBeg
;

133 
fo
=
	`DSDPVecGR
(
DY
,&
rba
); 
	`DSDPCHKERR
(info);

134 i(
ag
==
DUAL_FACTOR
){ 
r
=
K
->
dur
; } {=K->
imr
;}

135 i(
r
 * 
rba
<0

=-r/rbeta;

137 i(
K
->
UPty
==
DSDPAlways
){
mngth
=

;}

138 i(
ag
==
PRIMAL_FACTOR
){ 
mngth
=

;}

139 i(
ag
==
DUAL_FACTOR
){
mngth
=

/0.94;}

141 *
maxngth
=
mngth
;

142 
	`DSDPFuniRu
(0);

143 
	}
}

145 #unde
__FUNCT__


146 
	#__FUNCT__
 "DSDPRX"

	)

147 
	$DSDPRX
*
dce
, 
mu
, 
DSDPVec
 
y
, DSDPVe
dy
, DSDPVe
AX
,*
axs
){

148 
RCe
 *
K
=(RCe*)
dce
;

149 
fo
;

150 

,
dr
,
xs
,
r
=
K
->
dur
;

151 
DSDPFuniBeg
;

153 
fo
=
	`DSDPVecGR
(
y
,&

); 
	`DSDPCHKERR
(info);

154 
fo
=
	`DSDPVecGR
(
dy
,&
dr
); 
	`DSDPCHKERR
(info);

155 i(
K
->
dur
){

156 
r
=-1.0/

;

157 
K
->
x
=
mu
*(
r
-r*
dr
*r);

158 
xs
=
K
->
x
/
r
;

159 
	`DSDPLogInfo
(0,2,"RESIDUAL X (Mimum Pty Pam): %4.4e, T(XS): %4.4e\n",
K
->
x
,
xs
);

162 
K
->
x
=0.0;

164 
	`DSDPFuniRu
(0);

165 
	}
}

167 #unde
__FUNCT__


168 
	#__FUNCT__
 "DSDPSX"

	)

169 
	$DSDPSX
*
dce
, 
mu
, 
DSDPVec
 
y
, DSDPVe
dy
){

170 
DSDPFuniBeg
;

178 
	`DSDPFuniRu
(0);

179 
	}
}

181 #unde
__FUNCT__


182 
	#__FUNCT__
 "DSDPCompuRLog"

	)

183 
	$DSDPCompuRLog
(*
dce
, *
logobj
, *
logd
){

184 
RCe
 *
K
=(RCe*)
dce
;

185 
DSDPFuniBeg
;

186 *
logd
=
K
->
logr
;

187 *
logobj
=0;

188 i(
K
->
dur
<0){

189 *
logd
=
	`log
(-
K
->
dur
);

190 
K
->
logr
=
	`log
(-K->
dur
);

192 
	`DSDPFuniRu
(0);

193 
	}
}

195 #unde
__FUNCT__


196 
	#__FUNCT__
 "DSDPRANm2"

	)

197 
	$DSDPRANm2
(*
dce
,
DSDPVec
 
Anm2
){

198 
DSDPFuniBeg
;

199 
	`DSDPFuniRu
(0);

200 
	}
}

202 #unde
__FUNCT__


203 
	#__FUNCT__
 "DSDPRMuɝlyAdd"

	)

204 
	$DSDPRMuɝlyAdd
(*
dce
,
mu
,
DSDPVec
 
vrow
,DSDPVe
v
,DSDPVe
vout
){

205 
RCe
 *
K
=(RCe*)
dce
;

206 
fo
;

207 
v1
,
v2
,
rs
;

208 
DSDPFuniBeg
;

209 i(
K
->
dur
){

210 
fo
=
	`DSDPVecGR
(
vrow
,&
v1
);
	`DSDPCHKERR
(info);

211 
fo
=
	`DSDPVecGR
(
v
,&
v2
);
	`DSDPCHKERR
(info);

212 
rs
=
v1
*
v2
*
mu
/(
K
->
dur
*K->dualr);

213 
fo
=
	`DSDPVecAddR
(
vout
,
rs
);
	`DSDPCHKERR
(info);

215 
	`DSDPFuniRu
(0);

216 
	}
}

218 #unde
__FUNCT__


219 
	#__FUNCT__
 "DSDPRMڙ"

	)

220 
	$DSDPRMڙ
*
dce
, 
g
){

221 
DSDPFuniBeg
;

222 
	`DSDPFuniRu
(0);

223 
	}
}

225 
_P_DSDPCe_Ops
 
	gks
;

226 cڡ * 
	gmme
="R Cone";

228 #unde
__FUNCT__


229 
	#__FUNCT__
 "RCeOtisInlize"

	)

230 
	$RCeOtisInlize
(
_P_DSDPCe_Ops
* 
ces
){

231 
fo
;

232 i(
ces
==
NULL
)  0;

233 
fo
=
	`DSDPCeOpsInlize
(
ces
); 
	`DSDPCHKERR
(info);

234 
ces
->
cehessn
=
DSDPRHessn
;

235 
ces
->
cetup
=
DSDPSupRCe
;

236 
ces
->
cetup2
=
DSDPSupRCe2
;

237 
ces
->
cederoy
=
DSDPDeroyRCe
;

238 
ces
->
cecompus
=
DSDPCompuRS
;

239 
ces
->
cevts
=
DSDPInvtRS
;

240 
ces
->
cetxmak
=
DSDPSX
;

241 
ces
->
cecompux
=
DSDPRX
;

242 
ces
->
cڔhs
=
DSDPRHS
;

243 
ces
->
cemaxngth
=
DSDPCompuRSpLgth
;

244 
ces
->
cږogpْtl
=
DSDPCompuRLog
;

245 
ces
->
cesize
=
DSDPRSize
;

246 
ces
->
cesy
=
DSDPRSrsy
;

247 
ces
->
cڗnm2
=
DSDPRANm2
;

248 
ces
->
cemڙ
=
DSDPRMڙ
;

249 
ces
->
cehmuɝlyadd
=
DSDPRMuɝlyAdd
;

250 
ces
->
id
=19;

251 
ces
->
me
=
mme
;

253 
	}
}

264 #unde
__FUNCT__


265 
	#__FUNCT__
 "RCeSTy"

	)

266 
	$RCeSTy
(
RCe
 *
rce
, 
DSDPPty
 
UPty
){

267 
DSDPFuniBeg
;

268 
rce
->
UPty
=UsePenalty;

269 
	`DSDPFuniRu
(0);

270 
	}
}

281 #unde
__FUNCT__


282 
	#__FUNCT__
 "DSDPAddRCe"

	)

283 
	$DSDPAddRCe
(
DSDP
 
dsdp
, 
RCe
 **
ce
){

284 
RCe
 *
rce
;

285 
DSDPPty
 
UPty
=
DSDPInasib
;

286 
fo
;

287 
DSDPFuniBeg
;

288 
fo
=
	`RCeOtisInlize
(&
ks
); 
	`DSDPCHKERR
(info);

289 
	`DSDPCALLOC1
(&
rce
,
RCe
,&
fo
); 
	`DSDPCHKERR
(info);

290 
fo
=
	`RCeSTy
(
rce
,
UPty
); 
	`DSDPCHKERR
(info);

291 
rce
->
dsdp
=dsdp;

292 
rce
->
logr
=0;

293 *
ce
=
rce
;

294 
fo
=
	`DSDPAddCe
(
dsdp
,&
ks
,(*)
rce
); 
	`DSDPCHKERR
(info);

295 
	`DSDPFuniRu
(0);

296 
	}
}

	@dsdpschurmat.c

1 
	~"dsdpschurm_im.h
"

2 
	~"dsdpschurm.h
"

3 
	~"dsdpbasiys.h
"

4 
	~"dsdpsys.h
"

12 
	ghevt
=0,
	ghsvvt
=0;

14 
	#DSDPNoOtiE
(
a
); { 
	`DSDPSETERR1
(10,"Schumrixy: %s, Otiڂ defed\n",).
dsdps
->
mme
); }

	)

15 
	#DSDPChkME
(
a
,
b
); { i(b){ 
	`DSDPSETERR1
(b,"Schumrixy: %s,\n",).
dsdps
->
mme
);} }

	)

17 
DSDPAlySMW
(
DSDPSchurM
, 
DSDPVec
, DSDPVec);

18 
DSDPSchurMSveM
(
DSDPSchurM
, 
DSDPVec
, DSDPVec);

20 #unde
__FUNCT__


21 
	#__FUNCT__
 "DSDPSchurMSDa"

	)

22 
	$DSDPSchurMSDa
(
DSDPSchurM
 *
M
, 
_P_DSDPSchurM_Ops
* 
s
, *
da
){

23 
DSDPFuniBeg
;

24 (*
M
).
dsdps
=
s
;

25 (*
M
).
da
=data;

26 
	`DSDPFuniRu
(0);

27 
	}
}

29 cڡ * 
	gschurmme
="NOT NAMED YET";

31 #unde
__FUNCT__


32 
	#__FUNCT__
 "DSDPSchurMOpsInlize"

	)

33 
	$DSDPSchurMOpsInlize
(
_P_DSDPSchurM_Ops
* 
ds
){

34 
DSDPFuniBeg
;

35 i(
ds
==
NULL
)  0;

36 
ds
->
mzo
=0;

37 
ds
->
mrownzos
=0;

38 
ds
->
maddrow
=0;

39 
ds
->
maddemt
=0;

40 
ds
->
madddgڮ
=0;

41 
ds
->
mshidgڮ
=0;

42 
ds
->
masmb
=0;

43 
ds
->
msdmuɝly
=0;

44 
ds
->
mmur
=0;

45 
ds
->
m
=0;

46 
ds
->
msve
=0;

47 
ds
->
pmڴoss
=0;

48 
ds
->
pmwhichdg
=0;

49 
ds
->
pmdiribud
=0;

50 
ds
->
mderoy
=0;

51 
ds
->
mvw
=0;

52 
ds
->
mtup
=0;

53 
ds
->
id
=0;

54 
ds
->
mme
=
schurmme
;

55 
	`DSDPFuniRu
(0);

56 
	}
}

58 
_P_DSDPSchurM_Ops
 
	gdsdpms
;

61 #unde
__FUNCT__


62 
	#__FUNCT__
 "DSDPSchurMOpsInlize"

	)

63 
	$DSDPSchurMInlize
(
DSDPSchurM
 *
M
){

64 
fo
;

65 
DSDPFuniBeg
;

66 
fo
=
	`DSDPSchurMOpsInlize
(&
dsdpms
); 
	`DSDPCHKERR
(info);

67 
fo
=
	`DSDPSchurMSDa
(
M
,&
dsdpms
,0); 
	`DSDPCHKERR
(info);

68 
	`DSDPCALLOC1
(&
M
->
schur
,
DSDPSchurInfo
,&
fo
);
	`DSDPCHKERR
(info);

69 
M
->
schur
->
m
=0; M->schur->
r
=0; M->schur->
dd
=0;

70 
fo
=
	`DSDPInlizeFixedVb
(&
M
->
schur
->
fv
);
	`DSDPCHKERR
(info);

71 
	`DSDPFuniRu
(0);

72 
	}
}

74 #unde
__FUNCT__


75 
	#__FUNCT__
 "DSDPSchurMZoErs"

	)

76 
	$DSDPSchurMZoErs
(
DSDPSchurM
 
M
){

77 
fo
;

78 
DSDPFuniBeg
;

79 i(
M
.
dsdps
->
mzo
){

80 
fo
=(
M
.
dsdps
->
mzo
)(M.
da
); 
	`DSDPChkME
(M,info);

82 
	`DSDPNoOtiE
(
M
);

84 
	`DSDPFuniRu
(0);

85 
	}
}

88 #unde
__FUNCT__


89 
	#__FUNCT__
 "DSDPSchurMRowCumnSlg"

	)

90 
	$DSDPSchurMRowCumnSlg
(
DSDPSchurM
 
M
,
row
, 
DSDPVec
 
V
, *
nzcs
){

91 
fo
,
m
;

92 *
cs
,
r
=
M
.
schur
->r;

93 
DSDPTruth
 
ag
;

94 
DSDPFuniBeg
;

95 
fo
=
	`DSDPVecS
(0.0,
V
);
	`DSDPCHKERR
(info);

96 
fo
=
	`DSDPVecGSize
(
V
,&
m
);
	`DSDPCHKERR
(info);

97 i(
row
==0){
fo
=
	`DSDPVecZo
(
V
);
	`DSDPCHKERR
(fo);*
nzcs
=0;}

98 i(
row
==
m
-1){

99 
fo
=
	`DSDPVecZo
(
V
);
	`DSDPCHKERR
(fo);*
nzcs
=0;

100 i(
r
){
fo
=
	`DSDPVecSR
(
V
,1.0);
	`DSDPCHKERR
(fo);*
nzcs
=1;}

101 } i(
M
.
dsdps
->
mrownzos
){

102 
fo
=
	`DSDPVecGSize
(
V
,&
m
);
	`DSDPCHKERR
(info);

103 
fo
=
	`DSDPVecGAay
(
V
,&
cs
);
	`DSDPCHKERR
(info);

104 
fo
=(
M
.
dsdps
->
mrownzos
)(M.
da
,
row
-1,
cs
+1,
nzcs
,
m
-2); 
	`DSDPChkME
(M,info);

105 
fo
=
	`DSDPVecReeAay
(
V
,&
cs
);
	`DSDPCHKERR
(info);

106 
fo
=
	`DSDPZoFixedVbs
(
M
,
V
);
	`DSDPCHKERR
(info);

107 
fo
=
	`DSDPVecSC
(
V
,0.0);
	`DSDPCHKERR
(info);

108 i(
r
){
fo
=
	`DSDPVecSR
(
V
,1.0);
	`DSDPCHKERR
(info);}

109 
fo
=
	`DSDPIsFixed
(
M
,
row
,&
ag
);
	`DSDPCHKERR
(info);

110 i(
ag
==
DSDP_TRUE
&&*
nzcs
>0){
fo
=
	`DSDPVecZo
(
V
);*nzcs=0;
	`DSDPFuniRu
(0);}

112 
	`DSDPNoOtiE
(
M
);

115 
	`DSDPFuniRu
(0);

116 
	}
}

118 #unde
__FUNCT__


119 
	#__FUNCT__
 "DSDPSchurMAddRow"

	)

120 
	$DSDPSchurMAddRow
(
DSDPSchurM
 
M
, 
row
, 
pha
, 
DSDPVec
 
R
){

121 
fo
,
j
,
m
;

122 *
v
,

,
dd
=1e-1*
M
.
schur
->dd;

123 
DSDPVec
 
rhs3
=
M
.
schur
->rhs3;

124 
DSDPTruth
 
ag
;

125 
DSDPFuniBeg
;

126 
fo
=
	`DSDPVecGSize
(
R
,&
m
); 
	`DSDPCHKERR
(info);

127 i(
row
==0){

128 } i(
row
==
m
-1){

129 
fo
=
	`DSDPVecGR
(
R
,&

);
	`DSDPCHKERR
(info);

130 
fo
=
	`DSDPVecAddR
(
rhs3
,
pha
*

);
	`DSDPCHKERR
(info);

131 } i(
M
.
dsdps
->
maddrow
){

132 
fo
=
	`DSDPVecGAay
(
R
,&
v
); 
	`DSDPCHKERR
(info);

134 
j
=0;j<
m
;j++){ i(
	`bs
(
v
[j]< 1e-25 && 
row
!=j){ v[j]=0.0;} }

135 
v
[
row
]*=(1.0+
dd
);

136 
fo
=
	`DSDPZoFixedVbs
(
M
,
R
);
	`DSDPCHKERR
(info);

137 
fo
=
	`DSDPIsFixed
(
M
,
row
,&
ag
);
	`DSDPCHKERR
(info);

138 i(
ag
==
DSDP_TRUE
){
fo
=
	`DSDPVecSBasis
(
R
,
row
);
	`DSDPCHKERR
(info);}

139 
fo
=(
M
.
dsdps
->
maddrow
)(M.
da
,
row
-1,
pha
,
v
+1,
m
-2); 
	`DSDPChkME
(M,info);

140 
fo
=
	`DSDPVecReeAay
(
R
,&
v
); 
	`DSDPCHKERR
(info);

141 
fo
=
	`DSDPVecGR
(
R
,&

); 
	`DSDPCHKERR
(info);

142 
fo
=
	`DSDPVecAddEmt
(
rhs3
,
row
,
pha
*

); 
	`DSDPCHKERR
(info);

144 
	`DSDPNoOtiE
(
M
);

146 
	`DSDPFuniRu
(0);

147 
	}
}

149 #unde
__FUNCT__


150 
	#__FUNCT__
 "DSDPSchurMAddDgڮEmt"

	)

151 
	$DSDPSchurMAddDgڮEmt
(
DSDPSchurM
 
M
, 
row
, 
dd
){

152 
fo
,
m
;

153 
DSDPVec
 
rhs3
=
M
.
schur
->rhs3;

154 
DSDPFuniBeg
;

155 
fo
=
	`DSDPVecGSize
(
rhs3
,&
m
);
	`DSDPCHKERR
(info);

156 i(
dd
==0){

157 } i(
row
==0){

158 } i(
row
==
m
-1){
fo
=
	`DSDPVecAddR
(
rhs3
,
dd
);

159 } i(
M
.
dsdps
->
maddemt
){

160 
fo
=(
M
.
dsdps
->
maddemt
)(M.
da
,
row
-1,
dd
); 
	`DSDPChkME
(M,info);

162 
	`DSDPNoOtiE
(
M
);

164 
	`DSDPFuniRu
(0);

165 
	}
}

167 #unde
__FUNCT__


168 
	#__FUNCT__
 "DSDPSchurMAddR"

	)

169 
	$DSDPSchurMAddR
(
DSDPSchurM
 
M
, 
row
, 
dd
){

170 
fo
;

171 
DSDPFuniBeg
;

172 i(
dd
==0){
	`DSDPFuniRu
(0);}

173 
fo
=
	`DSDPVecAddEmt
(
M
.
schur
->
rhs3
,
row
,
dd
);
	`DSDPCHKERR
(info);

174 
	`DSDPFuniRu
(0);

175 
	}
}

177 #unde
__FUNCT__


178 
	#__FUNCT__
 "DSDPSchurMAddC"

	)

179 
	$DSDPSchurMAddC
(
DSDPSchurM
 
M
, 
row
, 
dd
){

180 
DSDPFuniBeg
;

181 
	`DSDPFuniRu
(0);

182 
	}
}

184 #unde
__FUNCT__


185 
	#__FUNCT__
 "DSDPSchurMShiDgڮ"

	)

186 
	$DSDPSchurMShiDgڮ
(
DSDPSchurM
 
M
, 
dd
){

187 
fo
;

188 
DSDPFuniBeg
;

189 i(
dd
==0){
	`DSDPFuniRu
(0);}

190 
M
.
schur
->
dd
=dd;

191 i(
M
.
dsdps
->
mshidgڮ
){

193 
fo
=(
M
.
dsdps
->
mshidgڮ
)(M.
da
,
dd
); 
	`DSDPChkME
(M,info);

194 
	`DSDPLogInfo
(0,2,"Add %4.4tthDgڮ oSchuMrix\n",
dd
);

196 
	`DSDPNoOtiE
(
M
);

198 
	`DSDPFuniRu
(0);

199 
	}
}

201 #unde
__FUNCT__


202 
	#__FUNCT__
 "DSDPSchurMAddDgڮ"

	)

203 
	$DSDPSchurMAddDgڮ
(
DSDPSchurM
 
M
, 
DSDPVec
 
D
){

204 
m
,
fo
;

205 *
dd
;

206 
DSDPFuniBeg
;

207 i(
M
.
dsdps
->
madddgڮ
){

208 
fo
=
	`DSDPZoFixedVbs
(
M
,
D
);
	`DSDPCHKERR
(info);

209 
fo
=
	`DSDPVecGSize
(
D
,&
m
); 
	`DSDPCHKERR
(info);

210 
fo
=
	`DSDPVecGAay
(
D
,&
dd
); 
	`DSDPCHKERR
(info);

211 
fo
=(
M
.
dsdps
->
madddgڮ
)(M.
da
,
dd
+1,
m
-2); 
	`DSDPChkME
(M,info);

212 
fo
=
	`DSDPVecAddR
(
M
.
schur
->
rhs3
,
dd
[
m
-1]);
	`DSDPCHKERR
(info);

213 
fo
=
	`DSDPVecReeAay
(
D
,&
dd
); 
	`DSDPCHKERR
(info);

215 
	`DSDPNoOtiE
(
M
);

217 
	`DSDPFuniRu
(0);

218 
	}
}

220 #unde
__FUNCT__


221 
	#__FUNCT__
 "DSDPSchurMInPl"

	)

222 
	$DSDPSchurMInPl
(
DSDPSchurM
 
M
, 
DSDPTruth
 *
ag
){

223 
fo
,
g
;

224 
DSDPFuniBeg
;

225 i(
M
.
dsdps
->
pmdiribud
){

226 
fo
=(
M
.
dsdps
->
pmdiribud
)(M.
da
,&
g
); 
	`DSDPChkME
(M,info);

227 i(
g
*
ag
=
DSDP_TRUE
; *ag=
DSDP_FALSE
;

229 *
ag
=
DSDP_FALSE
;

231 
	`DSDPFuniRu
(0);

232 
	}
}

234 #unde
__FUNCT__


235 
	#__FUNCT__
 "DSDPSchurMVbCompu"

	)

236 
	$DSDPSchurMVbCompu
(
DSDPSchurM
 
M
, 
row
, *
rcv
){

237 
fo
,
m
,
dd
=1;

238 
r
=
M
.
schur
->r;

239 
DSDPTruth
 
ag
;

240 
DSDPFuniBeg
;

241 
fo
=
	`DSDPVecGSize
(
M
.
schur
->
rhs3
,&
m
);

242 i(
row
==0){ *
rcv
=0.0;

243 } i(
row
==
m
-1){

244 i(
r
){*
rcv
=1.0;}

245 {*
rcv
=0.0;}

246 } i(
M
.
dsdps
->
pmڴoss
){

247 
fo
=(
M
.
dsdps
->
pmڴoss
)(M.
da
,
row
-1,&
dd
); 
	`DSDPChkME
(M,info);

248 i(
dd
){*
rcv
=1.0;} {*rcv=0;}

250 
fo
=
	`DSDPSchurMInPl
(
M
,&
ag
);
	`DSDPChkME
(M,info);

251 i(
ag
==
DSDP_FALSE
){ *
rcv
=1.0;

253 
	`DSDPNoOtiE
(
M
);

256 
	`DSDPFuniRu
(0);

257 
	}
}

259 #unde
__FUNCT__


260 
	#__FUNCT__
 "DSDPSchurMVbCompuC"

	)

261 
	$DSDPSchurMVbCompuC
(
DSDPSchurM
 
M
, *
rcv
){

262 
DSDPFuniBeg
;

263 *
rcv
=0.0;

264 
	`DSDPFuniRu
(0);

265 
	}
}

267 #unde
__FUNCT__


268 
	#__FUNCT__
 "DSDPSchurMVbCompuR"

	)

269 
	$DSDPSchurMVbCompuR
(
DSDPSchurM
 
M
, *
rcv
){

270 
DSDPFuniBeg
;

271 *
rcv
=0.0;

272 i(
M
.
schur
->
r
*
rcv
=1.0;

273 
	`DSDPFuniRu
(0);

274 
	}
}

276 #unde
__FUNCT__


277 
	#__FUNCT__
 "DSDPSchurMVbsOnPross"

	)

278 
	$DSDPSchurMDgڮSlg
(
DSDPSchurM
 
M
, 
DSDPVec
 
D
){

279 
m
,
fo
;

280 *
vs
;

281 
DSDPTruth
 
ag
;

282 
DSDPFuniBeg
;

283 
fo
=
	`DSDPVecS
(1.0,
D
);
	`DSDPCHKERR
(info);

284 
fo
=
	`DSDPVecGSize
(
D
,&
m
);
	`DSDPCHKERR
(info);

285 i(
M
.
dsdps
->
pmlolvbs
){

286 
fo
=
	`DSDPVecGAay
(
D
,&
vs
);
	`DSDPCHKERR
(info);

287 
fo
=(
M
.
dsdps
->
pmlolvbs
)(M.
da
,
vs
+1,
m
-2); 
	`DSDPChkME
(M,info);

288 
fo
=
	`DSDPVecReeAay
(
D
,&
vs
);
	`DSDPCHKERR
(info);

290 
fo
=
	`DSDPSchurMInPl
(
M
,&
ag
);
	`DSDPChkME
(M,info);

291 i(
ag
==
DSDP_TRUE
){

292 
	`DSDPNoOtiE
(
M
);

295 
fo
=
	`DSDPVecSC
(
D
,0.0);
	`DSDPCHKERR
(info);

296 i(
M
.
schur
->
r
==0){
fo
=
	`DSDPVecSR
(
D
,0.0);
	`DSDPCHKERR
(info);}

297 
fo
=
	`DSDPZoFixedVbs
(
M
,
D
);
	`DSDPCHKERR
(info);

298 
	`DSDPFuniRu
(0);

299 
	}
}

301 #unde
__FUNCT__


302 
	#__FUNCT__
 "DSDPSchurMRowSlg"

	)

303 
	$DSDPSchurMRowSlg
(
DSDPSchurM
 
M
, 
DSDPVec
 
D
){

304 
fo
;

305 
DSDPFuniBeg
;

306 
fo
=
	`DSDPSchurMDgڮSlg
(
M
,
D
);
	`DSDPCHKERR
(info);

307 
fo
=
	`DSDPZoFixedVbs
(
M
,
D
);
	`DSDPCHKERR
(info);

308 
	`DSDPFuniRu
(0);

309 
	}
}

311 #unde
__FUNCT__


312 
	#__FUNCT__
 "DSDPSchurMZoAsmb"

	)

313 
	$DSDPSchurMAsmb
(
DSDPSchurM
 
M
){

314 
fo
;

315 
DSDPFuniBeg
;

316 i(
M
.
dsdps
->
masmb
){

317 
fo
=(
M
.
dsdps
->
masmb
)(M.
da
); 
	`DSDPChkME
(M,info);

319 
	`DSDPNoOtiE
(
M
);

321 
	`DSDPFuniRu
(0);

322 
	}
}

324 #unde
__FUNCT__


325 
	#__FUNCT__
 "DSDPSchurMFa"

	)

326 
	$DSDPSchurMFa
(
DSDPSchurM
 
M
, 
DSDPTruth
 *
sucssful
){

327 
fo
,
ag
=0;

328 
DSDPVec
 
rhs3
=
M
.
schur
->rhs3,
dy3
=M.schur->dy3;

329 
DSDPFuniBeg
;

330 *
sucssful
=
DSDP_TRUE
;

331 
	`DSDPEvtLogBeg
(
hevt
);

332 i(
M
.
dsdps
->
m
){

333 
fo
=(
M
.
dsdps
->
m
)(M.
da
,&
ag
); 
	`DSDPChkME
(M,info);

334 i(
ag
){

335 *
sucssful
=
DSDP_FALSE
;

336 
	`DSDPLogInfo
(0,2,"Indefinite Schur Matrix -- Bad Factorization\n");

339 
	`DSDPNoOtiE
(
M
);

341 
	`DSDPEvtLogEnd
(
hevt
);

342 i(
M
.
schur
->
r
){

343 
fo
=
	`DSDPSchurMSveM
(
M
,
rhs3
,
dy3
);
	`DSDPCHKERR
(info);}

344 {
fo
=
	`DSDPVecZo
(
dy3
);
	`DSDPCHKERR
(info);}

345 
	`DSDPFuniRu
(0);

346 
	}
}

349 #unde
__FUNCT__


350 
	#__FUNCT__
 "DSDPSchurMMuɝly"

	)

351 
	$DSDPSchurMMuɝly
(
DSDPSchurM
 
M
, 
DSDPVec
 
x
, DSDPVe
y
){

352 
fo
,
n
;

353 *
xx
,*
yy
,
r
=
M
.
schur
->r;

354 
r1
,
r2
,
dd
;

355 
DSDPVec
 
rhs3
;

356 
DSDPFuniBeg
;

358 i(
M
.
dsdps
->
msdmuɝly
){

359 
fo
=
	`DSDPVecGSize
(
x
,&
n
); 
	`DSDPCHKERR
(info);

360 
fo
=
	`DSDPVecGAay
(
x
,&
xx
); 
	`DSDPCHKERR
(info);

361 
fo
=
	`DSDPVecGAay
(
y
,&
yy
); 
	`DSDPCHKERR
(info);

362 
fo
=(
M
.
dsdps
->
msdmuɝly
)(M.
da
,
xx
+1,
yy
+1,
n
-2); 
	`DSDPChkME
(M,info);

363 
yy
[0]=0;

364 
yy
[
n
-1]=0;

365 
fo
=
	`DSDPVecReeAay
(
y
,&
yy
); 
	`DSDPCHKERR
(info);

366 
fo
=
	`DSDPVecReeAay
(
x
,&
xx
); 
	`DSDPCHKERR
(info);

368 
	`DSDPNoOtiE
(
M
);

370 i(
r
){

371 
rhs3
=
M
.
schur
->rhs3;

372 
fo
=
	`DSDPVecGR
(
rhs3
,&
r2
);
	`DSDPCHKERR
(info);

373 
fo
=
	`DSDPVecGR
(
x
,&
r1
);
	`DSDPCHKERR
(info);

374 
fo
=
	`DSDPVecAXPY
(
r1
,
rhs3
,
y
);
	`DSDPCHKERR
(info);

375 
fo
=
	`DSDPVecD
(
rhs3
,
x
,&
dd
);
	`DSDPCHKERR
(info);

376 
fo
=
	`DSDPVecAddR
(
y
,
dd
-
r1
*
r2
);
	`DSDPCHKERR
(info);

378 
	`DSDPFuniRu
(0);

379 
	}
}

381 #unde
__FUNCT__


382 
	#__FUNCT__
 "DSDPSchurMMuR"

	)

383 
	$DSDPSchurMMuR
(
DSDPSchurM
 
M
, 
DSDPVec
 
x
, DSDPVe
y
){

384 
fo
,
n
;

385 *
xx
,*
yy
,
r
=
M
.
schur
->r;

386 
r1
,
r2
,
dd
;

387 
DSDPVec
 
rhs3
;

388 
DSDPFuniBeg
;

390 i(
M
.
dsdps
->
mmur
){

391 
fo
=
	`DSDPVecGSize
(
x
,&
n
); 
	`DSDPCHKERR
(info);

392 
fo
=
	`DSDPVecGAay
(
x
,&
xx
); 
	`DSDPCHKERR
(info);

393 
fo
=
	`DSDPVecGAay
(
y
,&
yy
); 
	`DSDPCHKERR
(info);

394 
fo
=(
M
.
dsdps
->
mmur
)(M.
da
,
xx
+1,
yy
+1,
n
-2); 
	`DSDPChkME
(M,info);

395 
yy
[0]=0;

396 
yy
[
n
-1]=0;

397 
fo
=
	`DSDPVecReeAay
(
y
,&
yy
); 
	`DSDPCHKERR
(info);

398 
fo
=
	`DSDPVecReeAay
(
x
,&
xx
); 
	`DSDPCHKERR
(info);

399 i(
r
){

400 
rhs3
=
M
.
schur
->rhs3;

401 
fo
=
	`DSDPVecGR
(
rhs3
,&
r2
);
	`DSDPCHKERR
(info);

402 
fo
=
	`DSDPVecGR
(
x
,&
r1
);
	`DSDPCHKERR
(info);

403 
fo
=
	`DSDPVecAXPY
(
r1
,
rhs3
,
y
);
	`DSDPCHKERR
(info);

404 
fo
=
	`DSDPVecD
(
rhs3
,
x
,&
dd
);
	`DSDPCHKERR
(info);

405 
fo
=
	`DSDPVecAddR
(
y
,
dd
-
r1
*
r2
);
	`DSDPCHKERR
(info);

408 
fo
=
	`DSDPVecZo
(
y
);
	`DSDPCHKERR
(info);

411 
	`DSDPFuniRu
(0);

412 
	}
}

414 #unde
__FUNCT__


415 
	#__FUNCT__
 "DSDPSchurMReduPVec"

	)

416 
	$DSDPSchurMReduPVec
(
DSDPSchurM
 
M
, 
DSDPVec
 
x
){

417 
fo
,
n
;

418 *
xx
;

419 
DSDPTruth
 
ag
;

420 
DSDPFuniBeg
;

422 i(
M
.
dsdps
->
pmdui
){

423 
fo
=
	`DSDPVecGSize
(
x
,&
n
); 
	`DSDPCHKERR
(info);

424 
fo
=
	`DSDPVecGAay
(
x
,&
xx
); 
	`DSDPCHKERR
(info);

425 
fo
=(
M
.
dsdps
->
pmdui
)(M.
da
,
xx
+1,
n
-2); 
	`DSDPChkME
(M,info);

426 
fo
=
	`DSDPVecReeAay
(
x
,&
xx
); 
	`DSDPCHKERR
(info);

428 
fo
=
	`DSDPSchurMInPl
(
M
,&
ag
);
	`DSDPChkME
(M,info);

429 i(
ag
==
DSDP_TRUE
){

430 
	`DSDPNoOtiE
(
M
);

433 
fo
=
	`DSDPZoFixedVbs
(
M
,
x
);
	`DSDPCHKERR
(info);

434 
	`DSDPFuniRu
(0);

435 
	}
}

439 #unde
__FUNCT__


440 
	#__FUNCT__
 "DSDPSchurMSR"

	)

441 
	$DSDPSchurMSR
(
DSDPSchurM
 
M
, 

){

442 
DSDPFuniBeg
;

443 
M
.
schur
->
r
=

;

444 
	`DSDPFuniRu
(0);

445 
	}
}

447 #unde
__FUNCT__


448 
	#__FUNCT__
 "DSDPSchurMSup"

	)

449 
	$DSDPSchurMSup
(
DSDPSchurM
 
M
, 
DSDPVec
 
Y
){

450 
fo
,
m
;

451 
DSDPFuniBeg
;

452 
fo
=
	`DSDPVecDui
(
Y
,&
M
.
schur
->
rhs3
);

453 
fo
=
	`DSDPVecDui
(
Y
,&
M
.
schur
->
dy3
);

454 
fo
=
	`DSDPVecGSize
(
Y
,&
m
);
	`DSDPCHKERR
(info);

455 i(
M
.
dsdps
->
mtup
){

456 
fo
=(
M
.
dsdps
->
mtup
)(M.
da
,
m
-2); 
	`DSDPChkME
(M,info);

458 
	`DSDPNoOtiE
(
M
);

460 
	`DSDPEvtLogRegi
("Fa Newt Eq.",&
hevt
);

461 
	`DSDPEvtLogRegi
("SvNewt Eq.",&
hsvvt
);

462 
	`DSDPFuniRu
(0);

463 
	}
}

466 #unde
__FUNCT__


467 
	#__FUNCT__
 "DSDPSchurMVw"

	)

468 
	$DSDPSchurMVw
(
DSDPSchurM
 
M
){

469 
fo
;

470 
DSDPFuniBeg
;

471 i(
M
.
dsdps
->
mvw
){

472 
fo
=(
M
.
dsdps
->
mvw
)(M.
da
); 
	`DSDPChkME
(M,info);

474 
	`DSDPNoOtiE
(
M
);

476 
fo
=
	`DSDPVecVw
(
M
.
schur
->
rhs3
);
	`DSDPCHKERR
(info);

477 
	`DSDPFuniRu
(0);

478 
	}
}

481 #unde
__FUNCT__


482 
	#__FUNCT__
 "DSDPSchurMDeroy"

	)

483 
	$DSDPSchurMDeroy
(
DSDPSchurM
 *
M
){

484 
fo
;

485 
DSDPFuniBeg
;

486 i((*
M
).
dsdps
->
mderoy
){

487 
fo
=((*
M
).
dsdps
->
mderoy
)((*M).
da
); 
	`DSDPChkME
(*M,info);

493 
fo
=
	`DSDPVecDeroy
(&
M
->
schur
->
rhs3
);
	`DSDPCHKERR
(info);

494 
fo
=
	`DSDPVecDeroy
(&
M
->
schur
->
dy3
);
	`DSDPCHKERR
(info);

496 
fo
=
	`DSDPSchurMOpsInlize
(&
dsdpms
); 
	`DSDPCHKERR
(info);

497 
fo
=
	`DSDPSchurMSDa
(
M
,&
dsdpms
,0); 
	`DSDPCHKERR
(info);

498 
	`DSDPFREE
(&
M
->
schur
,&
fo
);
	`DSDPCHKERR
(info);

499 
	`DSDPFuniRu
(0);

500 
	}
}

502 #unde
__FUNCT__


503 
	#__FUNCT__
 "DSDPSchurMSveM"

	)

504 
	$DSDPSchurMSveM
(
DSDPSchurM
 
M
, 
DSDPVec
 
b
, DSDPVe
x
){

505 
fo
,
n
;

506 *
xx
,*
bb
;

507 
DSDPFuniBeg
;

508 
fo
=
	`DSDPEvtLogBeg
(
hsvvt
);

509 i(
M
.
dsdps
->
msve
){

510 
fo
=
	`DSDPVecGAay
(
b
,&
bb
); 
	`DSDPCHKERR
(info);

511 
fo
=
	`DSDPVecGSize
(
x
,&
n
); 
	`DSDPCHKERR
(info);

512 
fo
=
	`DSDPVecZo
(
x
);
	`DSDPCHKERR
(info);

513 
fo
=
	`DSDPVecGAay
(
x
,&
xx
); 
	`DSDPCHKERR
(info);

514 
fo
=(
M
.
dsdps
->
msve
)(M.
da
,
bb
+1,
xx
+1,
n
-2); 
	`DSDPChkME
(M,info);

515 
fo
=
	`DSDPVecReeAay
(
b
,&
bb
); 
	`DSDPCHKERR
(info);

516 
fo
=
	`DSDPVecReeAay
(
x
,&
xx
); 
	`DSDPCHKERR
(info);

518 
	`DSDPNoOtiE
(
M
);

520 
fo
=
	`DSDPVecSR
(
x
,0.0);
	`DSDPCHKERR
(info);

521 
fo
=
	`DSDPVecSC
(
x
,0.0);
	`DSDPCHKERR
(info);

522 
fo
=
	`DSDPEvtLogEnd
(
hsvvt
);

523 
	`DSDPFuniRu
(0);

524 
	}
}

526 #unde
__FUNCT__


527 
	#__FUNCT__
 "DSDPSchurMSve"

	)

528 
	$DSDPSchurMSve
(
DSDPSchurM
 
M
, 
DSDPVec
 
b
, DSDPVe
x
){

529 
fo
;

530 
DSDPFuniBeg
;

531 
fo
=
	`DSDPSchurMSveM
(
M
,
b
,
x
);
	`DSDPCHKERR
(info);

532 
fo
=
	`DSDPAlySMW
(
M
,
b
,
x
);
	`DSDPCHKERR
(info);

533 
fo
=
	`DSDPZoFixedVbs
(
M
,
x
);
	`DSDPCHKERR
(info);

534 
	`DSDPFuniRu
(0);

535 
	}
}

537 #unde
__FUNCT__


538 
	#__FUNCT__
 "DSDPAlySMW"

	)

539 
	$DSDPAlySMW
(
DSDPSchurM
 
M
, 
DSDPVec
 
rhs
, DSDPVe
dy
){

540 
fo
;

541 
r
=
M
.
schur
->r,

,
dr
,
rh
,
rs
;

542 
rhm
,
rhm3
,
rhs1mrhs3
=0,
rhs3mrhs3
=0;

543 
DSDPVec
 
rhs3
=
M
.
schur
->rhs3,
dy3
=M.schur->dy3;

544 
DSDPFuniBeg
;

546 
fo
=
	`DSDPVecNmInfy
(
rhs
,&
rhm
);
	`DSDPCHKERR
(info);

547 
fo
=
	`DSDPVecNmInfy
(
rhs3
,&
rhm3
);
	`DSDPCHKERR
(info);

548 i(
r
==0 || 
rhm
==0){

549 
fo
=
	`DSDPVecSR
(
dy
,0); 
	`DSDPCHKERR
(info);

550 
fo
=
	`DSDPVecSR
(
rhs
,0); 
	`DSDPCHKERR
(info);

551 } i(0 && 
rhm3
==0){

552 
fo
=
	`DSDPVecGR
(
rhs
,&

); 
	`DSDPCHKERR
(info);

553 
fo
=
	`DSDPVecSR
(
dy
,

); 
	`DSDPCHKERR
(info);

556 
fo
=
	`DSDPVecGR
(
rhs
,&
rh
); 
	`DSDPCHKERR
(info);

557 
fo
=
	`DSDPVecGR
(
rhs3
,&
rs
); 
	`DSDPCHKERR
(info);

558 
fo
=
	`DSDPVecD
(
rhs3
,
dy
,&
rhs1mrhs3
); 
	`DSDPCHKERR
(info);

559 
fo
=
	`DSDPVecD
(
rhs3
,
dy3
,&
rhs3mrhs3
); 
	`DSDPCHKERR
(info);

560 i(
rs
-
rhs3mrhs3
==0)ssr*=(1.00001);

561 
dr
=-(
rhs1mrhs3
-
rh
 )/(
rs
-
rhs3mrhs3
);

562 
fo
=
	`DSDPVecAXPY
(-
dr
,
dy3
,
dy
);
	`DSDPCHKERR
(info);

563 
fo
=
	`DSDPVecSR
(
dy
,
dr
); 
	`DSDPCHKERR
(info);

564 
fo
=
	`DSDPVecSR
(
rhs
,
rh
); 
	`DSDPCHKERR
(info);

565 
fo
=
	`DSDPVecD
(
rhs
,
dy
,&
rhs3mrhs3
); 
	`DSDPCHKERR
(info);

566 i(
rhs3mrhs3
 <=0){

567 
	`DSDPLogInfo
(0,3,"DSDP Step Direction Not Descent, Adjusting. \n");

568 
fo
=
	`DSDPVecAddR
(
rhs3
,
rs
*0.1);
	`DSDPCHKERR
(info);

569 
fo
=
	`DSDPVecAXPY
(
dr
,
dy3
,
dy
);
	`DSDPCHKERR
(info);

570 
fo
=
	`DSDPVecSR
(
dy
,0); 
	`DSDPCHKERR
(info);

571 
fo
=
	`DSDPAlySMW
(
M
,
rhs
,
dy
);
	`DSDPCHKERR
(info);

574 
	`DSDPFuniRu
(0);

575 
	}
}

577 #unde
__FUNCT__


578 
	#__FUNCT__
 "DSDPZoFixedVbs"

	)

579 
	$DSDPZoFixedVbs

DSDPSchurM
 
M
, 
DSDPVec
 
dy
){

580 
i
,
fo
;

581 
FixedVbs
 *
fv
=&
M
.
schur
->fv;

582 
DSDPFuniBeg
;

583 
i
=0;i<
fv
->
nvs
;i++){

584 
fo
=
	`DSDPVecSEmt
(
dy
,
fv
->
v
[
i
],0.0);
	`DSDPCHKERR
(info);

586 
	`DSDPFuniRu
(0);

587 
	}
}

589 #unde
__FUNCT__


590 
	#__FUNCT__
 "DSDPAlyFixedVbs"

	)

591 
	$DSDPAlyFixedVbs

DSDPSchurM
 
M
, 
DSDPVec
 
y
){

592 
i
,
jj
,
fo
;

593 
vv
,
s
;

594 
FixedVbs
 *
fv
=&
M
.
schur
->fv;

595 
fo
=
	`DSDPVecGC
(
y
,&
s
);
	`DSDPCHKERR
(info);

596 
DSDPFuniBeg
;

597 
i
=0;i<
fv
->
nvs
;i++){

598 
vv
=
fv
->
fv
[
i
]*
	`bs
(
s
);

599 
jj
=
fv
->
v
[
i
];

600 
fo
=
	`DSDPVecSEmt
(
y
,
jj
,
vv
);
	`DSDPCHKERR
(info);

602 
	`DSDPFuniRu
(0);

603 
	}
}

605 #unde
__FUNCT__


606 
	#__FUNCT__
 "DSDPFixedVbNm"

	)

607 
	$DSDPFixedVbsNm

DSDPSchurM
 
M
, 
DSDPVec
 
y
){

608 
i
,
jj
,
fo
;

609 
vv
;

610 
FixedVbs
 *
fv
=&
M
.
schur
->fv;

611 
DSDPFuniBeg
;

612 
i
=0;i<
fv
->
nvs
;i++){

613 
jj
=
fv
->
v
[
i
]; 
vv
=fv->
fv
[i];

614 
fo
=
	`DSDPVecAddC
(
y
,1.0);
	`DSDPCHKERR
(info);

615 
fo
=
	`DSDPVecAddEmt
(
y
,
jj
,
vv
*vv);
	`DSDPCHKERR
(info);

617 
	`DSDPFuniRu
(0);

618 
	}
}

620 #unde
__FUNCT__


621 
	#__FUNCT__
 "DSDPCompuFixedYX"

	)

622 
	$DSDPCompuFixedYX

DSDPSchurM
 
M
, 
DSDPVec
 
br
){

623 
i
,
jj
,
fo
;

624 
vv
;

625 
FixedVbs
 *
fv
=&
M
.
schur
->fv;

626 
DSDPFuniBeg
;

627 
i
=0;i<
fv
->
nvs
;i++){

628 
jj
=
fv
->
v
[
i
];

629 
fo
=
	`DSDPVecGEmt
(
br
,
jj
,&
vv
);
	`DSDPCHKERR
(info);

630 
fo
=
	`DSDPVecSEmt
(
br
,
jj
,0);
	`DSDPCHKERR
(info);

631 
fo
=
	`DSDPVecAddC
(
br
,-
vv
*
fv
->
fv
[
i
]);
	`DSDPCHKERR
(info);

632 
fo
=
	`DSDPVecAddR
(
br
,
	`bs
(
vv
));
	`DSDPCHKERR
(info);

633 
fv
->
fdu
[
i
]=-
vv
;

634 i(
fv
->
xout
fv->xout[
i
]=-
vv
;

635 
	`DSDPLogInfo
(0,2,"FIXED VAR DUAL: %d %4.4f, ADD %4.4tobjeive.\n",
jj
,
vv
,-vv*
fv
->
fv
[
i
]);

637 
	`DSDPFuniRu
(0);

638 
	}
}

640 #unde
__FUNCT__


641 
	#__FUNCT__
 "DSDPIsFixed"

	)

642 
	$DSDPIsFixed

DSDPSchurM
 
M
, 
vi
, 
DSDPTruth
 *
ag
){

643 
i
;

644 
FixedVbs
 *
fv
=&
M
.
schur
->fv;

645 
DSDPFuniBeg
;

646 *
ag
=
DSDP_FALSE
;

647 
i
=0;i<
fv
->
nvs
;i++){

648 i(
fv
->
v
[
i
]==
vi
){

649 *
ag
=
DSDP_TRUE
;

653 
	`DSDPFuniRu
(0);

654 
	}
}

655 #unde
__FUNCT__


656 
	#__FUNCT__
 "DSDPInlizeFixedVbs"

	)

657 
	$DSDPInlizeFixedVb

FixedVbs
 *
fv
){

658 
DSDPFuniBeg
;

659 
fv
->
nmaxvs
=0;

660 
fv
->
nvs
=0;

661 
fv
->
fv
=0;

662 
fv
->
v
=0;

663 
fv
->
fdu
=0;

664 
	`DSDPFuniRu
(0);

665 
	}
}

667 #unde
__FUNCT__


668 
	#__FUNCT__
 "DSDPAddFixedVbs"

	)

669 
	$DSDPAddFixedVb

DSDPSchurM
 
M
, 
vi
, 
v
){

670 
i
,
t
,*
iew
,
fo
,
nvs
;

671 *
ddw
,*
vvw
;

672 
FixedVbs
 *
fv
=&
M
.
schur
->fv;

673 
DSDPFuniBeg
;

674 
nvs
=
fv
->nvars;

675 i(
nvs
>=
fv
->
nmaxvs
){

676 
t
=2*
nvs
 + 2;

677 
	`DSDPCALLOC2
(&
iew
,,
t
,&
fo
);

678 
	`DSDPCALLOC2
(&
ddw
,,
t
,&
fo
);

679 
	`DSDPCALLOC2
(&
vvw
,,
t
,&
fo
);

680 
i
=0;i<
nvs
;i++){

681 
iew
[
i
]=
fv
->
v
[i];

682 
ddw
[
i
]=
fv
->
fv
[i];

683 
vvw
[
i
]=
fv
->
fdu
[i];

685 
	`DSDPFREE
(&
fv
->
v
,&
fo
);
	`DSDPCHKERR
(info);

686 
	`DSDPFREE
(&
fv
->
fv
,&
fo
);
	`DSDPCHKERR
(info);

687 
	`DSDPFREE
(&
fv
->
fdu
,&
fo
);
	`DSDPCHKERR
(info);

688 
fv
->
v
=
iew
;

689 
fv
->
fv
=
ddw
;

690 
fv
->
fdu
=
vvw
;

691 
fv
->
nmaxvs
=
t
;

693 
fv
->
v
[fv->
nvs
]=
vi
;

694 
fv
->
fv
[fv->
nvs
]=
v
;

695 
fv
->
nvs
++;

696 
	`DSDPFuniRu
(0);

697 
	}
}

699 
	~"dsdp.h
"

701 #unde
__FUNCT__


702 
	#__FUNCT__
 "DSDPSrsyInSchurM"

	)

703 
	$DSDPSrsyInSchurM
(
DSDP
 
dsdp
, 
row
, 
nz
[], 
mm
){

704 
fo
,*

,
m
=
mm
+2;

705 *
dd
;

706 
DSDPVec
 
R
=
dsdp
->
M
.
schur
->
rhs3
;

707 
DSDPFuniBeg
;

708 
fo
=
	`DSDPVecZo
(
R
);
	`DSDPCHKERR
(info);

709 
fo
=
	`DSDPVecGAay
(
R
,&
dd
);
	`DSDPCHKERR
(info);

710 

=(*)
dd
;

711 
fo
=
	`DSDPSchurSrsy
(
dsdp
,
row
+1,

,
m
);
	`DSDPCHKERR
(info);

712 
	`memy
((*)
nz
,(*)(

+1),(
mm
)*());

713 
fo
=
	`DSDPVecReeAay
(
R
,&
dd
);
	`DSDPCHKERR
(info);

714 
	`DSDPFuniRu
(0);

715 
	}
}

717 #unde
__FUNCT__


718 
	#__FUNCT__
 "DSDPSFixedVb"

	)

729 
	$DSDPSFixedVb
(
DSDP
 
dsdp
, 
vi
, 
v
){

730 
fo
;

731 
DSDPFuniBeg
;

732 
	`DSDPLogInfo
(0,2,"S Fixed Vb: %d, %12.8f\n",
vi
,
v
);

733 
fo

	`DSDPAddFixedVb
(
dsdp
->
M
,
vi
,
v
);
	`DSDPCHKERR
(info);

734 
	`DSDPFuniRu
(0);

735 
	}
}

737 #unde
__FUNCT__


738 
	#__FUNCT__
 "DSDPSFixedVbs"

	)

749 
	$DSDPSFixedVbs
(
DSDP
 
dsdp
, 
vs
[], 
vs
[], 
xout
[], 
nvs
){

750 
i
,
fo
;

751 
DSDPFuniBeg
;

752 
i
=0;i<
nvs
;i++){

753 
fo
=
	`DSDPSFixedVb
(
dsdp
,()
vs
[
i
],
vs
[i]);

754 
dsdp
->
M
.
schur
->
fv
.
xout
=xout;

756 
	`DSDPFuniRu
(0);

757 
	}
}

759 #unde
__FUNCT__


760 
	#__FUNCT__
 "DSDPGFixedYX"

	)

761 
	$DSDPGFixedYX

DSDP
 
dsdp
, 
vi
, *
dd
){

762 
i
;

763 
FixedVbs
 *
fv
=&
dsdp
->
M
.
schur
->fv;

764 
DSDPFuniBeg
;

765 
i
=0;i<
fv
->
nvs
;i++){

766 i(
vi
==
fv
->
v
[
i
]){

767 *
dd
=
fv
->
fdu
[
i
]; ;

770 
	`DSDPFuniRu
(0);

771 
	}
}

	@dsdpschurmat.h

1 #i!
defed
(
__DSDP_SCHURMATRIXOPERATIONS_H
)

2 
	#__DSDP_SCHURMATRIXOPERATIONS_H


	)

10 
	~"dsdpvec.h
"

11 
	~"dsdpbasiys.h
"

12 
	~"dsdpcg.h
"

16 *
	mv
;

17 
	mnvs
;

18 
	mnmaxvs
;

19 *
	mfv
;

20 *
	mfdu
;

21 *
	mxout
;

22 } 
	tFixedVbs
;

25 
FixedVbs
 
	mfv
;

26 
DSDPVec
 
	mrhs3
,
	mdy3
;

27 
	mdd
,
	mr
;

28 
	mm
;

29 } 
	tDSDPSchurInfo
;

31 
	s_P_DSDPSchurM
{

32 * 
	mda
;

33 
_P_DSDPSchurM_Ops
 *
	mdsdps
;

34 
DSDPSchurInfo
* 
	mschur
;

36 
_P_DSDPSchurM
 
	tDSDPSchurM
;

38 
DSDPSchurMSDa
(
DSDPSchurM
*,
_P_DSDPSchurM_Ops
*, *);

40 
DSDPSchurMInlize
(
DSDPSchurM
*);

41 
DSDPSchurMSup
(
DSDPSchurM
, 
DSDPVec
);

42 
DSDPSchurMZoErs
(
DSDPSchurM
);

43 
DSDPSchurMInPl
(
DSDPSchurM
, 
DSDPTruth
*);

44 
DSDPSchurMShiDgڮ
(
DSDPSchurM
, );

45 
DSDPSchurMAsmb
(
DSDPSchurM
);

46 
DSDPSchurMMuɝly
(
DSDPSchurM
, 
DSDPVec
, DSDPVec);

47 
DSDPSchurMMuR
(
DSDPSchurM
, 
DSDPVec
, DSDPVec);

48 
DSDPSchurMReduPVec
(
DSDPSchurM
, 
DSDPVec
);

49 
DSDPSchurMFa
(
DSDPSchurM
,
DSDPTruth
*);

50 
DSDPSchurMSve
(
DSDPSchurM
, 
DSDPVec
, DSDPVec);

51 
DSDPSchurMDeroy
(
DSDPSchurM
*);

52 
DSDPSchurMVw
(
DSDPSchurM
);

53 
DSDPSchurMSR
(
DSDPSchurM
, );

55 
DSDPSchurMRowCumnSlg
(
DSDPSchurM
,, 
DSDPVec
,*);

56 
DSDPSchurMAddRow
(
DSDPSchurM
, , , 
DSDPVec
);

58 
DSDPSchurMVbCompu
(
DSDPSchurM
, , *);

59 
DSDPSchurMVbCompuC
(
DSDPSchurM
, *);

60 
DSDPSchurMVbCompuR
(
DSDPSchurM
, *);

61 
DSDPSchurMAddDgڮEmt
(
DSDPSchurM
, , );

62 
DSDPSchurMAddC
(
DSDPSchurM
,,);

63 
DSDPSchurMAddR
(
DSDPSchurM
,,);

65 
DSDPSchurMDgڮSlg
(
DSDPSchurM
, 
DSDPVec
);

66 
DSDPSchurMAddDgڮ
(
DSDPSchurM
, 
DSDPVec
);

68 
DSDPSchurMRowSlg
(
DSDPSchurM
, 
DSDPVec
);

70 
DSDPZoFixedVbs

DSDPSchurM
, 
DSDPVec
);

71 
DSDPAlyFixedVbs

DSDPSchurM
, 
DSDPVec
);

72 
DSDPIsFixed

DSDPSchurM
, , 
DSDPTruth
*);

73 
DSDPInlizeFixedVb

FixedVbs
 *);

74 
DSDPAddFixedVb

DSDPSchurM
, , );

	@dsdpschurmat_impl.h

1 
	~"dsdpbasiys.h
"

2 #i!
defed
(
__DSDP_SCHURMATRICES_H
)

3 
	#__DSDP_SCHURMATRICES_H


	)

11 
	s_P_DSDPSchurM_Ops
{

12 
	mid
;

13 (*
	mmzo
)(*);

14 (*
	mmrownzos
)(*,,*,*,);

15 (*
	mmaddrow
)(*,,,[],);

16 (*
	mmaddemt
)(*,,);

17 (*
	mmadddgڮ
)(*,[],);

18 (*
	mmshidgڮ
)(*,);

19 (*
	mmasmb
)(*);

20 (*
	mmsdmuɝly
)(*,[],[],);

21 (*
	mmmur
)(*,[],[],);

22 (*
	mm
)(*,*);

23 (*
	mmsve
)(*,[],[],);

24 (*
	mmtup
)(*,);

25 (*
	mpmwhichdg
)(*,[],);

26 (*
	mpmڴoss
)(*,,*);

27 (*
	mpmlolvbs
)(*,[],);

28 (*
	mpmdui
)(*,[],);

29 (*
	mpmdiribud
)(*,*);

30 (*
	mmderoy
)(*);

31 (*
	mmvw
)(*);

32 cڡ *
	mmme
;

35 
DSDPSSchurMOps
(
DSDP
,
_P_DSDPSchurM_Ops
*,*);

36 
DSDPSchurMOpsInlize
(
_P_DSDPSchurM_Ops
*);

37 
DSDPSrsyInSchurM
(
DSDP
,,[],);

	@dsdpsetdata.c

6 
	~"dsdp.h
"

7 
	~"dsdp5.h
"

8 
	~"dsdpsys.h
"

23 #unde
__FUNCT__


24 
	#__FUNCT__
 "DSDPSDuObjeive"

	)

25 
	$DSDPSDuObjeive
(
DSDP
 
dsdp
,
i
, 
bi
){

26 
fo
;

27 
DSDPFuniBeg
;

28 
	`DSDPVid
(
dsdp
);

29 i(
i
>
dsdp
->
m
 || i<=0){

30 
	`DSDPSETERR2
(1,"Invid vb˂umb: I1 <%d <%d?\n",
i
,
dsdp
->
m
);}

31 
fo
=
	`DSDPVecSEmt
(
dsdp
->
b
,
i
,
bi
);
	`DSDPCHKERR
(info);

32 
	`DSDPFuniRu
(0);

33 
	}
}

44 #unde
__FUNCT__


45 
	#__FUNCT__
 "DSDPCyB"

	)

46 
	$DSDPCyB
(
DSDP
 
dsdp
,
bb
[], 
m
){

47 
i
,
fo
;

48 *
b
;

49 
DSDPFuniBeg
;

50 
	`DSDPVid
(
dsdp
);

51 i(
dsdp
->
m
 < m
	`DSDPFuniRu
(1);

52 
fo
=
	`DSDPVecGAay
(
dsdp
->
b
,&b);
	`DSDPCHKERR
(info);

53 
i
=0;i<
m
;i++
bb
[i]=
b
[i+1];

54 
fo
=
	`DSDPVecReeAay
(
dsdp
->
b
,&b);
	`DSDPCHKERR
(info);

55 
	`DSDPFuniRu
(0);

56 
	}
}

75 #unde
__FUNCT__


76 
	#__FUNCT__
 "DSDPSY0"

	)

77 
	$DSDPSY0
(
DSDP
 
dsdp
,
i
, 
yi0
){

78 
fo
;
s
;

79 
DSDPFuniBeg
;

80 
	`DSDPVid
(
dsdp
);

81 i(
i
>
dsdp
->
m
 || i<=0){

82 
	`DSDPSETERR2
(1,"Invid vb˂umb: I1<%d <%d\n",
i
,
dsdp
->
m
);}

83 
fo
=
	`DSDPGS
(
dsdp
,&
s
);
	`DSDPCHKERR
(info);

84 
fo
=
	`DSDPVecSEmt
(
dsdp
->
y
,
i
,
s
*
yi0
);
	`DSDPCHKERR
(info);

85 
	`DSDPFuniRu
(0);

86 
	}
}

98 #unde
__FUNCT__


99 
	#__FUNCT__
 "DSDPGY"

	)

100 
	$DSDPGY
(
DSDP
 
dsdp
,
y
[], 
m
){

101 
i
,
fo
;

102 
s
,*
yy
;

103 
DSDPFuniBeg
;

104 
	`DSDPVid
(
dsdp
);

105 i(
dsdp
->
m
 < m-1
	`DSDPFuniRu
(1);

106 i(
dsdp
->
m
 > m
	`DSDPFuniRu
(1);

107 
fo
=
	`DSDPVecCy
(
dsdp
->
xmak
[0].
y
,dsdp->
ymp
); 
	`DSDPCHKERR
(info);

108 
fo
=
	`DSDPGS
(
dsdp
,&
s
);
	`DSDPCHKERR
(info);

109 
fo
=
	`DSDPVecGAay
(
dsdp
->
ymp
,&
yy
);
	`DSDPCHKERR
(info);

110 
i
=0;i<
m
;i++
y
[i]=
yy
[i+1]/
s
;

111 
fo
=
	`DSDPVecReeAay
(
dsdp
->
ymp
,&
yy
);
	`DSDPCHKERR
(info);

112 
	`DSDPFuniRu
(0);

113 
	}
}

127 #unde
__FUNCT__


128 
	#__FUNCT__
 "DSDPGYMakeX"

	)

129 
	$DSDPGYMakeX
(
DSDP
 
dsdp
,
y
[], 
m
){

130 
i
,
fo
;

131 
s
,*
yy
;

132 
DSDPFuniBeg
;

133 
	`DSDPVid
(
dsdp
);

134 i(
dsdp
->
m
 < m-1
	`DSDPFuniRu
(1);

135 i(
dsdp
->
m
 > m
	`DSDPFuniRu
(1);

136 
fo
=
	`DSDPVecCy
(
dsdp
->
xmak
[0].
y
,dsdp->
ymp
); 
	`DSDPCHKERR
(info);

137 
fo
=
	`DSDPGS
(
dsdp
,&
s
);
	`DSDPCHKERR
(info);

138 
fo
=
	`DSDPVecGAay
(
dsdp
->
ymp
,&
yy
);
	`DSDPCHKERR
(info);

139 
i
=0;i<
m
;i++
y
[i]=
yy
[i+1]/
s
;

140 
fo
=
	`DSDPVecReeAay
(
dsdp
->
ymp
,&
yy
);
	`DSDPCHKERR
(info);

141 
	`DSDPFuniRu
(0);

142 
	}
}

155 #unde
__FUNCT__


156 
	#__FUNCT__
 "DSDPGDYMakeX"

	)

157 
	$DSDPGDYMakeX
(
DSDP
 
dsdp
,
dy
[], 
m
){

158 
i
,
fo
;

159 
s
,*
yy
;

160 
DSDPFuniBeg
;

161 
	`DSDPVid
(
dsdp
);

162 i(
dsdp
->
m
 < m-1
	`DSDPFuniRu
(1);

163 i(
dsdp
->
m
 > m
	`DSDPFuniRu
(1);

164 
fo
=
	`DSDPVecCy
(
dsdp
->
xmak
[0].
dy
,dsdp->
ymp
); 
	`DSDPCHKERR
(info);

165 
fo
=
	`DSDPGS
(
dsdp
,&
s
);
	`DSDPCHKERR
(info);

166 
fo
=
	`DSDPVecGAay
(
dsdp
->
ymp
,&
yy
);
	`DSDPCHKERR
(info);

167 
i
=0;i<
m
;i++
dy
[i]=
yy
[i+1]/
s
;

168 
fo
=
	`DSDPVecReeAay
(
dsdp
->
ymp
,&
yy
);
	`DSDPCHKERR
(info);

169 
	`DSDPFuniRu
(0);

170 
	}
}

183 #unde
__FUNCT__


184 
	#__FUNCT__
 "DSDPGMuMakeX"

	)

185 
	$DSDPGMuMakeX
(
DSDP
 
dsdp
,*
mu
){

186 
fo
;

187 
s
;

188 
DSDPFuniBeg
;

189 
	`DSDPVid
(
dsdp
);

190 
fo
=
	`DSDPGS
(
dsdp
,&
s
);
	`DSDPCHKERR
(info);

191 *
mu
=
dsdp
->
xmak
[0].mu/
s
;

192 
	`DSDPFuniRu
(0);

193 
	}
}

206 #unde
__FUNCT__


207 
	#__FUNCT__
 "DSDPGS"

	)

208 
	$DSDPGS
(
DSDP
 
dsdp
,*
s
){

209 
fo
;
ss
;

210 
DSDPFuniBeg
;

211 
	`DSDPVid
(
dsdp
);

212 
fo
=
	`DSDPVecGC
(
dsdp
->
y
,&
ss
);
	`DSDPCHKERR
(info);

213 *
s
=
	`bs
(
ss
);

214 i(
ss
==0*
s
=1.0;

215 
	`DSDPFuniRu
(0);

216 
	}
}

231 #unde
__FUNCT__


232 
	#__FUNCT__
 "DSDPSS"

	)

233 
	$DSDPSS
(
DSDP
 
dsdp
,
s
){

234 
fo
;
ss
;

235 
DSDPFuniBeg
;

236 
	`DSDPVid
(
dsdp
);

237 
s
=
	`bs
(scale);

238 i(
s
==0) scale=1.0;

239 
fo
=
	`DSDPGS
(
dsdp
,&
ss
);
	`DSDPCHKERR
(info);

240 
ss
=
s
/sscale;

241 
fo
=
	`DSDPVecS
(
ss
,
dsdp
->
y
);

242 
dsdp
->
murg
*=
ss
;

243 
dsdp
->
pobj
*=
ss
;

244 
dsdp
->
dobj
*=
ss
;

245 
dsdp
->
obj
*=
ss
;

246 
dsdp
->
ddobj
*=
ss
;

247 
dsdp
->
mu
*=
ss
;

248 
	`DSDPLogInfo
(0,2,"S DSDP C Slg: %4.4e\n",
s
);

249 
	`DSDPFuniRu
(0);

250 
	}
}

263 #unde
__FUNCT__


264 
	#__FUNCT__
 "DSDPAddObjeiveCڡt"

	)

265 
	$DSDPAddObjeiveCڡt
(
DSDP
 
dsdp
,
c
){

266 
fo
;

267 
DSDPFuniBeg
;

268 
	`DSDPVid
(
dsdp
);

269 
fo
=
	`DSDPVecSC
(
dsdp
->
b
,-
c
);
	`DSDPCHKERR
(info);

270 
	`DSDPLogInfo
(0,2,"Add ObjeivCڡt: %4.4e\n",
c
);

271 
	`DSDPFuniRu
(0);

272 
	}
}

284 #unde
__FUNCT__


285 
	#__FUNCT__
 "DSDPSMaxIts"

	)

286 
	$DSDPSMaxIts
(
DSDP
 
dsdp
,
s
){

287 
DSDPFuniBeg
;

288 
	`DSDPVid
(
dsdp
);

289 i(
s
 >0
dsdp
->
max
 = its;

290 
	`DSDPLogInfo
(0,2,"S Maximum Is: %4d\n",
s
);

291 
	`DSDPFuniRu
(0);

292 
	}
}

303 #unde
__FUNCT__


304 
	#__FUNCT__
 "DSDPGMaxIts"

	)

305 
	$DSDPGMaxIts
(
DSDP
 
dsdp
,*
s
){

306 
DSDPFuniBeg
;

307 
	`DSDPVid
(
dsdp
);

308 *
s
=
dsdp
->
max
;

309 
	`DSDPFuniRu
(0);

310 
	}
}

329 #unde
__FUNCT__


330 
	#__FUNCT__
 "DSDPGPInasiby"

	)

331 
	$DSDPGPInasiby
(
DSDP
 
dsdp
, *
r
){

332 
DSDPFuniBeg
;

333 
	`DSDPVid
(
dsdp
);

334 i(
r
*r=
dsdp
->
pas
;

335 
	`DSDPFuniRu
(0);

336 
	}
}

351 #unde
__FUNCT__


352 
	#__FUNCT__
 "DSDPSPTޔ"

	)

353 
	$DSDPSPTޔ
(
DSDP
 
dsdp
,

){

354 
DSDPFuniBeg
;

355 
	`DSDPVid
(
dsdp
);

356 i(

 > 0
dsdp
->
pa
 = inftol;

357 
	`DSDPLogInfo
(0,2,"S P Inasiby Tޔ: %4.4e\n",

);

358 
	`DSDPFuniRu
(0);

359 
	}
}

372 #unde
__FUNCT__


373 
	#__FUNCT__
 "DSDPGPTޔ"

	)

374 
	$DSDPGPTޔ
(
DSDP
 
dsdp
,*

){

375 
DSDPFuniBeg
;

376 
	`DSDPVid
(
dsdp
);

377 i(

*=
dsdp
->
pa
;

378 
	`DSDPFuniRu
(0);

379 
	}
}

394 #unde
__FUNCT__


395 
	#__FUNCT__
 "DSDPSRTޔ"

	)

396 
	$DSDPSRTޔ
(
DSDP
 
dsdp
,

){

397 
DSDPFuniBeg
;

398 
	`DSDPVid
(
dsdp
);

399 i(

 > 0
dsdp
->
da
 = inftol;

400 
	`DSDPLogInfo
(0,2,"S D Inasiby Tޔ: %4.4e\n",

);

401 
	`DSDPFuniRu
(0);

402 
	}
}

419 #unde
__FUNCT__


420 
	#__FUNCT__
 "DSDPGRTޔ"

	)

421 
	$DSDPGRTޔ
(
DSDP
 
dsdp
,*

){

422 
DSDPFuniBeg
;

423 
	`DSDPVid
(
dsdp
);

424 *

=
dsdp
->
da
;

425 
	`DSDPFuniRu
(0);

426 
	}
}

439 #unde
__FUNCT__


440 
	#__FUNCT__
 "DSDPSMaxTruRadius"

	)

441 
	$DSDPSMaxTruRadius
(
DSDP
 
dsdp
,
d
){

442 
DSDPFuniBeg
;

443 
	`DSDPVid
(
dsdp
);

444 i(
d
 > 0
dsdp
->
maxudius
 =ad;

445 
	`DSDPLogInfo
(0,2,"S Maximum Tru Radius: %4.4e\n",
d
);

446 
	`DSDPFuniRu
(0);

447 
	}
}

458 #unde
__FUNCT__


459 
	#__FUNCT__
 "DSDPGMaxTruRadius"

	)

460 
	$DSDPGMaxTruRadius
(
DSDP
 
dsdp
,*
d
){

461 
DSDPFuniBeg
;

462 
	`DSDPVid
(
dsdp
);

463 *
d
=
dsdp
->
maxudius
;

464 
	`DSDPFuniRu
(0);

465 
	}
}

476 #unde
__FUNCT__


477 
	#__FUNCT__
 "DSDPSZB"

	)

478 
	$DSDPSZB
(
DSDP
 
dsdp
,
obj
){

479 
fo
;

480 
s
;

481 
DSDPFuniBeg
;

482 
	`DSDPVid
(
dsdp
);

483 
fo
=
	`DSDPGS
(
dsdp
,&
s
);
	`DSDPCHKERR
(info);

484 
dsdp
->
obj
pobj*
s
;

485 
	`DSDPLogInfo
(0,2,"S Prim Objeivd U bound osuti: %4.4e. \n",
obj
);

486 
	`DSDPFuniRu
(0);

487 
	}
}

504 #unde
__FUNCT__


505 
	#__FUNCT__
 "DSDPSR0"

	)

506 
	$DSDPSR0
(
DSDP
 
dsdp
,
s
){

507 
fo
;

508 
s
;

509 
DSDPFuniBeg
;

510 
	`DSDPVid
(
dsdp
);

511 
fo
=
	`DSDPGS
(
dsdp
,&
s
);
	`DSDPCHKERR
(info);

512 
fo
=
	`DSDPSRR
(
dsdp
,
s
*
s
); 
	`DSDPCHKERR
(info);

513 i(
s
>=0)
dsdp
->
gy0
=
DSDP_TRUE
;

514 
	`DSDPLogInfo
(0,2,"S Du InInasiby%4.4timeIdty Mrix. \n",
s
);

515 
	`DSDPFuniRu
(0);

516 
	}
}

533 #unde
__FUNCT__


534 
	#__FUNCT__
 "DSDPSBrrPam"

	)

535 
	$DSDPSBrrPam
(
DSDP
 
dsdp
,
mu
){

536 
fo
;
s
;

537 
DSDPFuniBeg
;

538 
	`DSDPVid
(
dsdp
);

539 
fo
=
	`DSDPGS
(
dsdp
,&
s
);
	`DSDPCHKERR
(info);

540 
dsdp
->
murg
 = 
mu
*
s
;

541 
	`DSDPLogInfo
(0,2,"S InlBrrPam: %4.4\n",
mu
);

542 
	`DSDPFuniRu
(0);

543 
	}
}

557 #unde
__FUNCT__


558 
	#__FUNCT__
 "DSDPGBrrPam"

	)

559 
	$DSDPGBrrPam
(
DSDP
 
dsdp
, *
mu
){

560 
fo
;
s
;

561 
DSDPFuniBeg
;

562 
fo
=
	`DSDPGS
(
dsdp
,&
s
);
	`DSDPCHKERR
(info);

563 *
mu
=
dsdp
->
murg
/
s
;

564 
	`DSDPFuniRu
(0);

565 
	}
}

576 #unde
__FUNCT__


577 
	#__FUNCT__
 "DSDPUPty"

	)

578 
	$DSDPUPty
(
DSDP
 
dsdp
,
yesno
){

579 
DSDPPty
 
UPty
;

580 
fo
;

581 
DSDPFuniBeg
;

582 
	`DSDPVid
(
dsdp
);

583 i(
yesno
>0){

584 
UPty
=
DSDPAlways
;

585 } i(
yesno
<0){

586 
UPty
=
DSDPNev
;

588 
UPty
=
DSDPInasib
;

590 
dsdp
->
UPty
=UsePenalty;

591 
fo
=
	`RCeSTy
(
dsdp
->
rce
,
UPty
);
	`DSDPCHKERR
(info);

592 
	`DSDPLogInfo
(0,2,"S UPty: %d \n",
yesno
);

593 
	`DSDPFuniRu
(0);

594 
	}
}

611 #unde
__FUNCT__


612 
	#__FUNCT__
 "DSDPSPtyPam"

	)

613 
	$DSDPSPtyPam
(
DSDP
 
dsdp
,
Gamma
){

614 
fo
;

615 
s
,
ty
;

616 
DSDPFuniBeg
;

617 
	`DSDPVid
(
dsdp
);

618 
fo
=
	`DSDPGS
(
dsdp
,&
s
);
	`DSDPCHKERR
(info);

619 
ty
=
	`bs
(
Gamma
*
s
);

620 
fo
=
	`DSDPVecSR
(
dsdp
->
b
,
ty
);
	`DSDPCHKERR
(info);

621 
	`DSDPLogInfo
(0,2,"S Pty Pam: %4.4e\n",
Gamma
);

622 
	`DSDPFuniRu
(0);

623 
	}
}

636 #unde
__FUNCT__


637 
	#__FUNCT__
 "DSDPGPtyPam"

	)

638 
	$DSDPGPtyPam
(
DSDP
 
dsdp
,*
Gamma
){

639 
fo
;

640 
ty
;

641 
DSDPFuniBeg
;

642 
	`DSDPVid
(
dsdp
);

643 
fo
=
	`DSDPVecGR
(
dsdp
->
b
,&
ty
);
	`DSDPCHKERR
(info);

644 *
Gamma
=
	`bs
(
ty
);

645 
	`DSDPFuniRu
(0);

646 
	}
}

650 #unde
__FUNCT__


651 
	#__FUNCT__
 "DSDPGPty"

	)

652 
	$DSDPGPty
(
DSDP
 
dsdp
,*
y
){

653 
fo
;
ty
;

654 
DSDPFuniBeg
;

655 
	`DSDPVid
(
dsdp
);

656 
fo
=
	`DSDPVecGR
(
dsdp
->
b
,&
ty
);
	`DSDPCHKERR
(info);

657 *
y
=
	`bs
(
ty
);

658 
	`DSDPFuniRu
(0);

659 
	}
}

673 #unde
__FUNCT__


674 
	#__FUNCT__
 "DSDPGPObjeive"

	)

675 
	$DSDPGPObjeive
(
DSDP
 
dsdp
,*
pobj
){

676 
fo
;

677 
s
;

678 
DSDPFuniBeg
;

679 
	`DSDPVid
(
dsdp
);

680 
fo
=
	`DSDPGS
(
dsdp
,&
s
);
	`DSDPCHKERR
(info);

681 *
pobj
=(
dsdp
->pobj)/
s
;

682 
	`DSDPFuniRu
(0);

683 
	}
}

695 #unde
__FUNCT__


696 
	#__FUNCT__
 "DSDPGPPObjeive"

	)

697 
	$DSDPGPPObjeive
(
DSDP
 
dsdp
,*
obj
){

698 
fo
;

699 
s
;

700 
DSDPFuniBeg
;

701 
	`DSDPVid
(
dsdp
);

702 
fo
=
	`DSDPGS
(
dsdp
,&
s
);
	`DSDPCHKERR
(info);

703 *
obj
=(
dsdp
->obj)/
s
;

704 i(
dsdp
->
m
==0*
obj
=0;

705 
	`DSDPFuniRu
(0);

706 
	}
}

718 #unde
__FUNCT__


719 
	#__FUNCT__
 "DSDPGDObjeive"

	)

720 
	$DSDPGDObjeive
(
DSDP
 
dsdp
,*
dobj
){

721 
fo
; 
s
;

722 
DSDPFuniBeg
;

723 
	`DSDPVid
(
dsdp
);

724 
fo
=
	`DSDPGS
(
dsdp
,&
s
);
	`DSDPCHKERR
(info);

725 *
dobj
 = (
dsdp
->dobj)/
s
;

726 i(
dsdp
->
m
==0*
dobj
=-
	`bs
(*dobj);

727 
	`DSDPFuniRu
(0);

728 
	}
}

739 #unde
__FUNCT__


740 
	#__FUNCT__
 "DSDPGDDObjeive"

	)

741 
	$DSDPGDDObjeive
(
DSDP
 
dsdp
,*
ddobj
){

742 
fo
; 
s
;

743 
DSDPFuniBeg
;

744 
	`DSDPVid
(
dsdp
);

745 
fo
=
	`DSDPGS
(
dsdp
,&
s
);
	`DSDPCHKERR
(info);

746 *
ddobj
 = (
dsdp
->ddobj)/
s
;

747 i(
dsdp
->
m
==0*
ddobj
=-
	`bs
(*ddobj);

748 
	`DSDPFuniRu
(0);

749 
	}
}

761 #unde
__FUNCT__


762 
	#__FUNCT__
 "DSDPGDuyG"

	)

763 
	$DSDPGDuyG
(
DSDP
 
dsdp
,*
dg
){

764 
fo
; 
s
;

765 
DSDPFuniBeg
;

766 
	`DSDPVid
(
dsdp
);

767 
fo
=
	`DSDPGS
(
dsdp
,&
s
);
	`DSDPCHKERR
(info);

768 *
dg
 = (
dsdp
->
duyg
)/
s
;

769 
	`DSDPFuniRu
(0);

770 
	}
}

780 #unde
__FUNCT__


781 
	#__FUNCT__
 "DSDPGIts"

	)

782 
	$DSDPGIts
(
DSDP
 
dsdp
,*
s
){

783 
DSDPFuniBeg
;

784 
	`DSDPVid
(
dsdp
);

785 *
s
=
dsdp
->
now
;

786 
	`DSDPFuniRu
(0);

787 
	}
}

798 #unde
__FUNCT__


799 
	#__FUNCT__
 "DSDPStRs"

	)

800 
	$DSDPStRs
(
DSDP
 
dsdp
,
DSDPTmiRs
 *
as
){

801 
DSDPFuniBeg
;

802 
	`DSDPVid
(
dsdp
);

803 *
as
=
dsdp
->reason;

804 
	`DSDPFuniRu
(0);

805 
	}
}

817 #unde
__FUNCT__


818 
	#__FUNCT__
 "DSDPGSutiTy"

	)

819 
	$DSDPGSutiTy
(
DSDP
 
dsdp
,
DSDPSutiTy
 *
pdasib
){

820 
DSDPFuniBeg
;

821 
	`DSDPVid
(
dsdp
);

822 *
pdasib
=
dsdp
->pdfeasible;

823 
	`DSDPFuniRu
(0);

824 
	}
}

835 #unde
__FUNCT__


836 
	#__FUNCT__
 "DSDPGR"

	)

837 
	$DSDPGR
(
DSDP
 
dsdp
, *
s
){

838 
fo
;

,
s
;

839 
DSDPFuniBeg
;

840 
	`DSDPVid
(
dsdp
);

841 
fo
=
	`DSDPGRR
(
dsdp
,&

);
	`DSDPCHKERR
(info);

842 
fo
=
	`DSDPGS
(
dsdp
,&
s
);
	`DSDPCHKERR
(info);

843 *
s
=

/
s
;

844 
	`DSDPFuniRu
(0);

845 
	}
}

855 #unde
__FUNCT__


856 
	#__FUNCT__
 "DSDPGDaNms"

	)

857 
DSDPGDaNms
(
DSDP
 
dsdp
, 
dnm
[3]){

858 
	gfo
;

859 
	gDSDPFuniBeg
;

860 
DSDPVid
(
dsdp
);

861 i(
	gdsdp
->
	gtuped
==
DSDP_FALSE
){

862 
fo
=
DSDPCompuDaNms
(
dsdp
);
DSDPCHKERR
(info);

864 
	gdnm
[0]=
dsdp
->
m
;

865 
	gdnm
[1]=
dsdp
->
m
;

866 
	gdnm
[2]=
dsdp
->
bnm
;

867 
DSDPFuniRu
(0);

886 #unde
__FUNCT__


887 
	#__FUNCT__
 "DSDPGTX"

	)

888 
	$DSDPGTX
(
DSDP
 
dsdp
, *
ax
){

889 
DSDPFuniBeg
;

890 
	`DSDPVid
(
dsdp
);

891 *
ax
=
dsdp
->tracex;

892 
	`DSDPFuniRu
(0);

893 
	}
}

905 #unde
__FUNCT__


906 
	#__FUNCT__
 "DSDPGFEs"

	)

907 
DSDPGFEs
(
DSDP
 
dsdp
, 
r
[6]){

908 
	gfo
;

909 
	gs
,
	g
,
	gbnm
,
	gdobj
=0,
	gpobj
=0;

910 
	gDSDPFuniBeg
;

911 
DSDPVid
(
dsdp
);

912 
	gfo
=
DSDPGS
(
dsdp
,&
s
);
DSDPCHKERR
(
fo
);

913 
	gfo
=
DSDPVecGR
(
dsdp
->
y
,&

); 
DSDPCHKERR
(
fo
);

914 
	gfo
=
DSDPGPObjeive
(
dsdp
,&
pobj
);
DSDPCHKERR
(
fo
);

915 
	gfo
=
DSDPGDObjeive
(
dsdp
,&
dobj
);
DSDPCHKERR
(
fo
);

916 
	gr
[0]=
dsdp
->

;

917 
	gr
[1]=0;

918 
	gr
[2]=
bs
(

)/
s
;

919 
	gr
[3]=0;

920 
	gr
[4]=
pobj
 - 
dobj
;

921 
	gr
[5]=
dsdp
->
axs
/
s
;

923 
	gr
[2] /(1.0+
dsdp
->
m
);

924 
	gfo
=
DSDPVecCy
(
dsdp
->
b
,dsdp->
ymp
);
DSDPCHKERR
(
fo
);

925 
	gfo
=
DSDPVecSC
(
dsdp
->
ymp
,0);
DSDPCHKERR
(
fo
);

926 
	gfo
=
DSDPVecSR
(
dsdp
->
ymp
,0);
DSDPCHKERR
(
fo
);

927 
	gfo
=
DSDPVecNmInfy
(
dsdp
->
ymp
,&
bnm
);

928 
	gr
[0]=
dsdp
->

/(1.0+
bnm
);

930 
	gr
[4]=(
r
[4])/(1.0+
bs
(
pobj
)+bs(
dobj
));

931 
	gr
[5]=(
r
[5])/(1.0+
bs
(
pobj
)+bs(
dobj
));

932 
DSDPFuniRu
(0);

943 #unde
__FUNCT__


944 
	#__FUNCT__
 "DSDPGMaxYEmt"

	)

945 
	$DSDPGMaxYEmt
(
DSDP
 
dsdp
,* 
ymax
){

946 
fo
;

947 
DSDPFuniBeg
;

948 
fo
=
	`DSDPGYMaxNm
(
dsdp
,
ymax
);
	`DSDPCHKERR
(info);

949 
	`DSDPFuniRu
(0);

950 
	}
}

952 #unde
__FUNCT__


953 
	#__FUNCT__
 "DSDPGDimsi"

	)

961 
	$DSDPGDimsi
(
DSDP
 
dsdp
, *
n
){

962 
fo
;

963 
DSDPFuniBeg
;

964 
fo
=
	`DSDPGCicDimsi
(
dsdp
,
n
);
	`DSDPCHKERR
(info);

965 
	`DSDPFuniRu
(0);

966 
	}
}

976 #unde
__FUNCT__


977 
	#__FUNCT__
 "DSDPGYMaxNm"

	)

978 
	$DSDPGYMaxNm
(
DSDP
 
dsdp
, *
ynm
){

979 
fo
;

980 
cc
,

,
yy
;

981 
DSDPFuniBeg
;

982 
	`DSDPVid
(
dsdp
);

983 
fo
=
	`DSDPVecGC
(
dsdp
->
y
,&
cc
);
	`DSDPCHKERR
(info);

984 
fo
=
	`DSDPVecGR
(
dsdp
->
y
,&

);
	`DSDPCHKERR
(info);

985 
fo
=
	`DSDPVecSC
(
dsdp
->
y
,0);
	`DSDPCHKERR
(info);

986 
fo
=
	`DSDPVecSR
(
dsdp
->
y
,0);
	`DSDPCHKERR
(info);

987 
fo
=
	`DSDPVecNmInfy
(
dsdp
->
y
,&
yy
);
	`DSDPCHKERR
(info);

988 
fo
=
	`DSDPVecSC
(
dsdp
->
y
,
cc
);
	`DSDPCHKERR
(info);

989 
fo
=
	`DSDPVecSR
(
dsdp
->
y
,

);
	`DSDPCHKERR
(info);

990 i(
cc

yy
/=
	`bs
(cc);

991 i(
ynm
*ynm=
yy
;

992 
	`DSDPFuniRu
(0);

993 
	}
}

1005 #unde
__FUNCT__


1006 
	#__FUNCT__
 "DSDPGNumbOfVbs"

	)

1007 
	$DSDPGNumbOfVbs
(
DSDP
 
dsdp
, *
m
){

1008 
DSDPFuniBeg
;

1009 
	`DSDPVid
(
dsdp
);

1010 *
m
=
dsdp
->m;

1011 
	`DSDPFuniRu
(0);

1012 
	}
}

1022 #unde
__FUNCT__


1023 
	#__FUNCT__
 "DSDPGPnm"

	)

1024 
	$DSDPGPnm
(
DSDP
 
dsdp
, *
m
){

1025 
DSDPFuniBeg
;

1026 
	`DSDPVid
(
dsdp
);

1027 *
m
=
dsdp
->pnorm;

1028 
	`DSDPFuniRu
(0);

1029 
	}
}

1040 #unde
__FUNCT__


1041 
	#__FUNCT__
 "DSDPGSpLgths"

	)

1042 
	$DSDPGSpLgths
(
DSDP
 
dsdp
, *
p
, *
d
){

1043 
DSDPFuniBeg
;

1044 
	`DSDPVid
(
dsdp
);

1045 *
d
=
dsdp
->dstep;

1046 *
p
=
dsdp
->pstep;

1047 
	`DSDPFuniRu
(0);

1048 
	}
}

1063 #unde
__FUNCT__


1064 
	#__FUNCT__
 "DSDPSPْtlPam"

	)

1065 
	$DSDPSPْtlPam
(
DSDP
 
dsdp
, 
rho
){

1066 
DSDPFuniBeg
;

1067 
	`DSDPVid
(
dsdp
);

1068 i(
rho
>1
dsdp
->
rh
=rho;

1069 
	`DSDPLogInfo
(0,2,"S PْtPam %4.4f\n",
rho
);

1070 
	`DSDPFuniRu
(0);

1071 
	}
}

1082 #unde
__FUNCT__


1083 
	#__FUNCT__
 "DSDPGPْtlPam"

	)

1084 
	$DSDPGPْtlPam
(
DSDP
 
dsdp
, *
rho
){

1085 
DSDPFuniBeg
;

1086 
	`DSDPVid
(
dsdp
);

1087 *
rho
=
dsdp
->
rh
;

1088 
	`DSDPFuniRu
(0);

1089 
	}
}

1101 #unde
__FUNCT__


1102 
	#__FUNCT__
 "DSDPGPْtl"

	)

1103 
	$DSDPGPْtl
(
DSDP
 
dsdp
, *
pْtl
){

1104 
DSDPFuniBeg
;

1105 
	`DSDPVid
(
dsdp
);

1106 *
pْtl
=
dsdp
->potential;

1107 
	`DSDPFuniRu
(0);

1108 
	}
}

1119 #unde
__FUNCT__


1120 
	#__FUNCT__
 "DSDPUDymicRho"

	)

1121 
	$DSDPUDymicRho
(
DSDP
 
dsdp
, 
yesno
){

1122 
DSDPFuniBeg
;

1123 
	`DSDPVid
(
dsdp
);

1124 i(
yesno

dsdp
->
ufixedrho
=
DSDP_FALSE
;

1125 
dsdp
->
ufixedrho
=
DSDP_TRUE
;

1126 
	`DSDPLogInfo
(0,2,"S UDymicRho: %d \n",
yesno
);

1127 
	`DSDPFuniRu
(0);

1128 
	}
}

1132 #unde
__FUNCT__


1133 
	#__FUNCT__
 "DSDPBoundDuVbs"

	)

1134 
	$DSDPBoundDuVbs
(
DSDP
 
dsdp
,
lbound
, 
ubound
){

1135 
fo
;

1136 
bbound
;

1137 
DSDPFuniBeg
;

1138 
bbound
=
	`DSDPMax
(
	`bs
(
lbound
),bs(
ubound
));

1139 
	`DSDPLogInfo
(0,2,"Bound Vbˠbw%4.4d %4.4\n",-
bbound
,bbound);

1140 
fo
 = 
	`BoundYCeSBounds
(
dsdp
->
ybce
,-
bbound
,bbound);
	`DSDPCHKERR
(info);

1141 
	`DSDPFuniRu
(0);

1142 
	}
}

1154 #unde
__FUNCT__


1155 
	#__FUNCT__
 "DSDPGYBounds"

	)

1156 
	$DSDPGYBounds
(
DSDP
 
dsdp
,*
lbound
, *
ubound
){

1157 
fo
;

1158 
DSDPFuniBeg
;

1159 
fo
=
	`BoundYCeGBounds
(
dsdp
->
ybce
,
lbound
,
ubound
);
	`DSDPCHKERR
(info);

1160 
	`DSDPFuniRu
(0);

1161 
	}
}

1173 #unde
__FUNCT__


1174 
	#__FUNCT__
 "DSDPSYBounds"

	)

1175 
	$DSDPSYBounds
(
DSDP
 
dsdp
,
lbound
, 
ubound
){

1176 
fo
;

1177 
DSDPFuniBeg
;

1178 
fo
=
	`BoundYCeSBounds
(
dsdp
->
ybce
,
lbound
,
ubound
);
	`DSDPCHKERR
(info);

1179 
	`DSDPFuniRu
(0);

1180 
	}
}

1193 #unde
__FUNCT__


1194 
	#__FUNCT__
 "DSDPReuMrix"

	)

1195 
	$DSDPReuMrix
(
DSDP
 
dsdp
, 
rm
){

1196 
DSDPFuniBeg
;

1197 
	`DSDPVid
(
dsdp
);

1198 
dsdp
->
uM
=
rm
;

1199 
	`DSDPLogInfo
(0,2,"ReuhSchuMrix: %dimes\n",
rm
);

1200 
	`DSDPFuniRu
(0);

1201 
	}
}

1213 #unde
__FUNCT__


1214 
	#__FUNCT__
 "DSDPGReuMrix"

	)

1215 
	$DSDPGReuMrix
(
DSDP
 
dsdp
, *
rm
){

1216 
DSDPFuniBeg
;

1217 
	`DSDPVid
(
dsdp
);

1218 *
rm
=
dsdp
->
uM
;

1219 
	`DSDPFuniRu
(0);

1220 
	}
}

1233 #unde
__FUNCT__


1234 
	#__FUNCT__
 "DSDPSMڙ"

	)

1235 
DSDPSMڙ
(
DSDP
 
dsdp
, (*
mڙ
)(DSDP,*), * 
mڙx
){

1236 
DSDPFuniBeg
;

1237 
	`DSDPVid
(
dsdp
);

1238 i(
dsdp
->
nmڙs
<
MAX_DSDP_MONITORS
){

1239 
	`DSDPLogInfo
(0,2,"Set Monitor\n");

1240 
dsdp
->
mڙ
[dsdp->
nmڙs
]=monitor;

1241 
dsdp
->
mڙx
[dsdp->
nmڙs
]=monitorctx;

1242 
dsdp
->
nmڙs
++;

1244 
	`DSDPFuniRu
(0);

1245 
	}
}

1256 #unde
__FUNCT__


1257 
	#__FUNCT__
 "DSDPSCvgFg"

	)

1258 
	$DSDPSCvgFg
(
DSDP
 
dsdp
, 
DSDPTmiRs
 
as
 ){

1259 
DSDPFuniBeg
;

1260 
	`DSDPVid
(
dsdp
);

1261 
dsdp
->
as
=reason;

1262 i(
as
==
DSDP_INFEASIBLE_START
){

1263 
	`DSDPLogInfo
(0,2,"Initial Point Infeasible, Check variable bounds? \n",0);

1265 
	`DSDPFuniRu
(0);

1266 
	}
}

	@dsdpsetoptions.c

1 
	~"dsdp5.h
"

44 #unde
__FUNCT__


45 
	#__FUNCT__
 "DSDPSOis"

	)

46 
	$DSDPSOis
(
DSDP
 
dsdp
,*
rurgs
[],
rgs
){

48 
kk
, 
fo
,
u
;

49 
max
,
os
,
drho
,
ogfo
;

50 
y
,
rho
,
zb
,
cc
,
r0
,
mu0
,
gt
,
dbound
,
dd
;

51 
ylow
,
yhigh
,
maxu
,
t
,

,
t
,
mt
;

53 
DSDPFuniBeg
;

55 
kk
=0; kk<
rgs
-1; kk++){

56 i(
	`cmp
(
rurgs
[
kk
],"-gaptol",5)==0){

57 
gt
=
	`of
(
rurgs
[
kk
+1]);

58 
fo
=
	`DSDPSGTޔ
(
dsdp
,
gt
);
	`DSDPCHKERR
(info);

59 } i(
	`cmp
(
rurgs
[
kk
],"-penalty",7)==0){

60 
y
=
	`of
(
rurgs
[
kk
+1]);

61 
fo
=
	`DSDPSPtyPam
(
dsdp
,
y
); 
	`DSDPCHKERR
(info);

62 } i(
	`cmp
(
rurgs
[
kk
],"-bigM",5)==0){

63 
os
=
	`oi
(
rurgs
[
kk
+1]);

64 
fo
=
	`DSDPUPty
(
dsdp
,
os
); 
	`DSDPCHKERR
(info);

65 } i(
	`cmp
(
rurgs
[
kk
],"-maxit",6)==0){

66 
max
=
	`oi
(
rurgs
[
kk
+1]);

67 
fo
=
	`DSDPSMaxIts
(
dsdp
,
max
); 
	`DSDPCHKERR
(info);

68 } i(
	`cmp
(
rurgs
[
kk
],"-r0",3)==0){

69 
r0
=
	`of
(
rurgs
[
kk
+1]);

70 
fo
=
	`DSDPSR0
(
dsdp
,
r0
); 
	`DSDPCHKERR
(info);

71 } i(
	`cmp
(
rurgs
[
kk
],"-zbar",5)==0){

72 
zb
=
	`of
(
rurgs
[
kk
+1]);

73 
fo
=
	`DSDPSZB
(
dsdp
,
zb
);
	`DSDPCHKERR
(info);

74 } i(
	`cmp
(
rurgs
[
kk
],"-infdtol",7)==0){

75 

=
	`of
(
rurgs
[
kk
+1]);

76 
fo
=
	`DSDPSRTޔ
(
dsdp
,

);
	`DSDPCHKERR
(info);

77 } i(
	`cmp
(
rurgs
[
kk
],"-infptol",7)==0){

78 
t
=
	`of
(
rurgs
[
kk
+1]);

79 
fo
=
	`DSDPSPTޔ
(
dsdp
,
t
);
	`DSDPCHKERR
(info);

80 } i(
	`cmp
(
rurgs
[
kk
],"-rho",4)==0){

81 
rho
=
	`of
(
rurgs
[
kk
+1]);

82 
fo
=
	`DSDPSPْtlPam
(
dsdp
,
rho
); 
	`DSDPCHKERR
(info);

83 } i(
	`cmp
(
rurgs
[
kk
],"-drho",5)==0){

84 
drho
=
	`oi
(
rurgs
[
kk
+1]);

85 
fo
=
	`DSDPUDymicRho
(
dsdp
,
drho
);
	`DSDPCHKERR
(info);

86 } i(
	`cmp
(
rurgs
[
kk
],"-mu0",4)==0){

87 
mu0
=
	`of
(
rurgs
[
kk
+1]);

88 
fo
=
	`DSDPSBrrPam
(
dsdp
,
mu0
);
	`DSDPCHKERR
(info);

89 } i(
	`cmp
(
rurgs
[
kk
],"-maxtrustradius",7)==0){

90 
maxu
=
	`of
(
rurgs
[
kk
+1]);

91 
fo
=
	`DSDPSMaxTruRadius
(
dsdp
,
maxu
); 
	`DSDPCHKERR
(info);

92 } i(
	`cmp
(
rurgs
[
kk
],"-boundy",6)==0){

93 
yhigh
=
	`bs
(
	`of
(
rurgs
[
kk
+1]));
ylow
=-yhigh;

94 
fo
=
	`DSDPSYBounds
(
dsdp
,
ylow
,
yhigh
);
	`DSDPCHKERR
(info);

95 } i(
	`cmp
(
rurgs
[
kk
],"-steptol",7)==0){

96 
t
=
	`bs
(
	`of
(
rurgs
[
kk
+1]));

97 
fo
=
	`DSDPSSpTޔ
(
dsdp
,
t
); 
	`DSDPCHKERR
(info);

98 } i(
	`cmp
(
rurgs
[
kk
],"-pnormtol",7)==0){

99 
mt
=
	`bs
(
	`of
(
rurgs
[
kk
+1]));

100 
fo
=
	`DSDPSPNmTޔ
(
dsdp
,
mt
); 
	`DSDPCHKERR
(info);

101 } i(
	`cmp
(
rurgs
[
kk
],"-reuse",6)==0){

102 
u
=
	`oi
(
rurgs
[
kk
+1]);

103 
fo
=
	`DSDPReuMrix
(
dsdp
,
u
);
	`DSDPCHKERR
(info);

104 } i(
	`cmp
(
rurgs
[
kk
],"-dadd",6)==0){

105 
cc
=
	`of
(
rurgs
[
kk
+1]);

106 
fo
=
	`DSDPAddObjeiveCڡt
(
dsdp
,
cc
);
	`DSDPCHKERR
(info);

107 } i(
	`cmp
(
rurgs
[
kk
],"-dbound",6)==0){

108 
dbound
=
	`of
(
rurgs
[
kk
+1]);

109 
fo
=
	`DSDPSDuBound
(
dsdp
,
dbound
);
	`DSDPCHKERR
(info);

110 } i(
	`cmp
(
rurgs
[
kk
],"-fix",4)==0){

111 
fo
=
	`DSDPSFixedVb
(
dsdp
,1,
	`of
(
rurgs
[
kk
+1]));
	`DSDPCHKERR
(info);

112 } i(
	`cmp
(
rurgs
[
kk
],"-dobjmin",7)==0){

113 
dd
=
	`of
(
rurgs
[
kk
+1]);

114 
fo
 = 
	`DSDPSDuLowBound
(
dsdp
,
dd
);
	`DSDPCHKERR
(info);

115 } i(
	`cmp
(
rurgs
[
kk
],"-dloginfo",8)==0){

116 
ogfo
=
	`oi
(
rurgs
[
kk
+1]);

117 
fo
=
	`DSDPLogInfoAow
(
ogfo
,0);

121 
kk
=0; kk<
rgs
; kk++){

123 } i(
	`cmp
(
rurgs
[
kk
],"-help",5)==0){

124 
fo
=
	`DSDPPrtOis
();

127 
	`DSDPFuniRu
(0);

128 
	}
}

140 
	#MAXOPTIONS
 40

	)

141 
	#STRLENGTH
 40

	)

142 
	#BUFFERSIZ
 100

	)

143 #unde
__FUNCT__


144 
	#__FUNCT__
 "DSDPRdOis"

	)

145 
	$DSDPRdOis
(
DSDP
 
dsdp
, 
fame
[]){

147 
i
,
fo
,
le
=0;

148 
thie
[
BUFFERSIZ
]="%",
dti
[
STRLENGTH
],
dvue
[STRLENGTH];

149 
rgs
[2*
MAXOPTIONS
][
STRLENGTH
];

150 *
rgs2
[2*
MAXOPTIONS
];

151 
FILE
 *

;

153 
DSDPFuniBeg
;

155 
i
=0;i<2*
MAXOPTIONS
;i++){
rgs2
[i]=
rgs
[i];}

157 

=
	`fݒ
(
fame
,"r");

158 i(

){

159 !
	`of
(

) ){

160 i(
le
>=
MAXOPTIONS
) ;

161 
	`fgs
(
thie
,
BUFFERSIZ
,

);

162 i(
	`ssnf
(
thie
,"%%s",
dti
,
dvue
)>=2){

163 i(
dti
[0]!='%'){

164 
	`y
(
rgs
[2*
le
],
dti
,
STRLENGTH
-1);

165 
	`y
(
rgs
[2*
le
+1],
dvue
,
STRLENGTH
-1);

166 
le
++;

169 
thie
[0]='%';

172 
fo
=
	`DSDPSOis
(
dsdp
,
rgs2
,2*
le
);

173 
	`fo
(

);

175 
	`DSDPFuniRu
(0);

176 
	}
}

188 #unde
__FUNCT__


189 
	#__FUNCT__
 "DSDPVw"

	)

190 
	$DSDPVw
(
DSDP
 
dsdp
){

192 
fo
,
u
,
m
,
max
;

193 
y
,
rho
,
mu0
,
gt
,
dnm
[3],
dr
[6],
pْtl
,
ymax
;

194 
ylow
,
yhigh
,
maxu
,
t
,

,
t
,
mt
,
dbound
,
ax
;

195 
DSDPSutiTy
 
pdasib
;

197 
DSDPFuniBeg
;

198 
fo
=
	`DSDPGMaxIts
(
dsdp
,&
max
); 
	`DSDPCHKERR
(info);

199 
	`tf
("TmDSDP %d itis.\n",
max
);

200 
fo
=
	`DSDPGDuBound
(
dsdp
,&
dbound
); 
	`DSDPCHKERR
(info);

201 
	`tf
("TmDSDP idu objeivigh %8.4e\n",
dbound
);

202 
fo
=
	`DSDPGGTޔ
(
dsdp
,&
gt
);
	`DSDPCHKERR
(info);

203 
	`tf
("TmDSDP ithtivduy g isth %8.4e\n",
gt
);

204 
fo
=
	`DSDPGSpTޔ
(
dsdp
,&
t
); 
	`DSDPCHKERR
(info);

205 
	`tf
("TmDSDP iࡕgth iDesth %8.4e\n",
t
);

206 
fo
=
	`DSDPGPNmTޔ
(
dsdp
,&
mt
); 
	`DSDPCHKERR
(info);

207 
	`tf
("TmDSDP oy iPnmesth %8.4e\n",
mt
);

208 
fo
=
	`DSDPGMaxTruRadius
(
dsdp
,&
maxu
); 
	`DSDPCHKERR
(info);

209 
	`tf
("Max Tru Radiui%8.4e\n",
maxu
);

210 
fo
=
	`DSDPGReuMrix
(
dsdp
,&
u
);
	`DSDPCHKERR
(info);

211 
	`tf
("Rly HessoBrut%dimei.\n",
u
);

213 
fo
=
	`DSDPGDaNms
(
dsdp
,
dnm
);
	`DSDPCHKERR
(info);

214 
	`tf
("ThnmoC: %8.4e, A: %4.4e,nd b: %8.4e\n",
dnm
[0],dnorm[1],dnorm[2]);

215 
fo
=
	`DSDPGNumbOfVbs
(
dsdp
,&
m
);
	`DSDPCHKERR
(info);

216 
	`tf
("Th%d y vbs: ",
m
);

217 
fo
=
	`DSDPGYMaxNm
(
dsdp
,&
ymax
); 
	`DSDPCHKERR
(info);

218 
	`tf
("rge i%8.4e, ",
ymax
);

219 
fo
=
	`DSDPGYBounds
(
dsdp
,&
ylow
,&
yhigh
);
	`DSDPCHKERR
(info);

220 
	`tf
("bounded bow by %8.4dbovby %8.4e. \n",
ylow
,
yhigh
);

221 
fo
=
	`DSDPGTX
(
dsdp
,&
ax
);
	`DSDPCHKERR
(info);

222 
	`tf
("ThX vbˠhava o%8.4",
ax
);

223 
fo
=
	`DSDPGPtyPam
(
dsdp
,&
y
); 
	`DSDPCHKERR
(info);

224 
	`tf
("bounded bytyam: %8.4e\n",
y
);

225 
fo
=
	`DSDPGBrrPam
(
dsdp
,&
mu0
);
	`DSDPCHKERR
(info);

226 
	`tf
("CuBrPam: %8.4e\n",
mu0
);

227 
fo
=
	`DSDPGPْtlPam
(
dsdp
,&
rho
); 
	`DSDPCHKERR
(info);

228 
	`tf
("PْtPam: %8.4timedimsi\n",
rho
);

229 
fo
=
	`DSDPGPْtl
(
dsdp
,&
pْtl
);
	`DSDPCHKERR
(info);

230 
	`tf
("Thvuothpْtfuni i%8.4e\n",
pْtl
);

231 
fo
=
	`DSDPGRTޔ
(
dsdp
,&

); 
	`DSDPCHKERR
(info);

232 
	`tf
("(DFsib oy iR < %8.4e\n",

);

233 
fo
=
	`DSDPGPTޔ
(
dsdp
,&
t
); 
	`DSDPCHKERR
(info);

234 
	`tf
("(PFsib oy iPa< %8.4e\n",
t
);

235 
fo
=
	`DSDPGSutiTy
(
dsdp
,&
pdasib
);
	`DSDPCHKERR
(info);

236 i(
pdasib
==
DSDP_PDFEASIBLE
){

237 
	`tf
(" DSDP Solutionsre both feasiblend bounded\n");

238 } i(
pdasib
==
DSDP_UNBOUNDED
){

239 
	`tf
(" (D) is unboundednd (P) is infeasible\n");

240 } i(
pdasib
==
DSDP_INFEASIBLE
){

241 
	`tf
(" (D) is infeasiblend (D) is unbounded\n");

242 } i(
pdasib
==
DSDP_PDUNKNOWN
){

243 
	`tf
(" Hmm. Not clear whetherither solution is feasible.\n");

245 
fo
=
	`DSDPGFEs
(
dsdp
,
dr
);
	`DSDPCHKERR
(info);

246 
	`tf
("Thrs: %8.4e, %4.4e, %8.4e, ",
dr
[0],derror[1],derror[2]);

247 
	`tf
("%8.4e, %4.4e, %8.4e\n",
dr
[3],derror[4],derror[5]);

248 
	`DSDPFuniRu
(0);

249 
	}
}

252 
	gdsdptis
[]="\
-gaptol <1e-6> stop whenelative duality gapesshan \n\
-r0 <-1> ifonnegative, initialize S byddinghis multiple ofhe identity matrix \n\
-penalty <1e10><enalize dual infeasibility \n\
-boundy <1e7> bound for variables y \n\
-maxit <200> set maximum iterates \n\
-zbar <1e10> Upper bound for dual solution \n\
-mu0 <-1> ifositive, set initial barrierarameter \n\
-rho <3> Potentialarameters multiple of dimension \n\
-drho <1> Use dynamicho strategy \n\
-pnormtol <1e30> stop only ifnormesshan \n\
-reuse <4> Reusehe Schur Matrixhis manyimes\n\
-dobjmin <>pply knownower bound forhe objectivet solutions constraint. \n\
-bigM <0> ifositive, modifylgorithmo make dual \n\
ositive withargessociated cost \n\
-dloginfo <0> -rint more information for higherumbers \n\
-params <filename>oead selected options from file \n\
-help forhis help message\n";

279 
	$DSDPPrtOis
(){

280 
DSDPFuniBeg
;

281 
	`tf
("%s",
dsdptis
);

282 
	`DSDPFuniRu
(0);

283 
	}
}

	@dsdpsetup.c

1 
	~"dsdp.h
"

2 
	~"dsdpsys.h
"

3 
	~"dsdp5.h
"

28 #unde
__FUNCT__


29 
	#__FUNCT__
 "DSDPCe"

	)

30 
	$DSDPCe
(
m
,
DSDP
* 
dsdew
){

32 
DSDP
 
dsdp
;

33 
fo
;

35 
DSDPFuniBeg
;

37 
	`DSDPCALLOC1
(&
dsdp
,
PD_DSDP
,&
fo
);
	`DSDPCHKERR
(info);

38 *
dsdew
=
dsdp
;

39 
dsdp
->
keyid
=
DSDPKEY
;

42 
	`DSDPEvtLogInlize
();

43 
dsdp
->
m
=m;

44 
dsdp
->
maxces
=0;

45 
dsdp
->
nces
=0;

46 
dsdp
->
ce
=0;

47 
dsdp
->
ceid
=0;

48 
dsdp
->
tuped
=
DSDP_FALSE
;

49 
dsdp
->
ybce
=0;

52 
fo
 = 
	`DSDPVecCeSeq
(
m
+2,&
dsdp
->
b
);
	`DSDPCHKERR
(info);

53 
fo
 = 
	`DSDPVecZo
(
dsdp
->
b
);
	`DSDPCHKERR
(info);

54 
fo
 = 
	`DSDPVecDui
(
dsdp
->
b
,&dsdp->
y
);
	`DSDPCHKERR
(info);

55 
fo
 = 
	`DSDPVecDui
(
dsdp
->
b
,&dsdp->
ymp
);
	`DSDPCHKERR
(info);

56 
fo
 = 
	`DSDPVecZo
(
dsdp
->
y
);
	`DSDPCHKERR
(info);

57 
fo
 = 
	`DSDPVecSC
(
dsdp
->
y
,-1.0);
	`DSDPCHKERR
(info);

59 
fo
 = 
	`DSDPAddRCe
(
dsdp
,&dsdp->
rce
);
	`DSDPCHKERR
(info);

60 
fo
 = 
	`DSDPCeLUBoundsCe
(
dsdp
,&dsdp->
ybce
);
	`DSDPCHKERR
(info);

62 
fo
=
	`DSDPSDeuStiics
(
dsdp
);
	`DSDPCHKERR
(info);

63 
fo
=
	`DSDPSDeuPams
(
dsdp
);
	`DSDPCHKERR
(info);

64 
fo
=
	`DSDPSDeuMڙs
(
dsdp
);
	`DSDPCHKERR
(info);

67 
fo
 = 
	`DSDPSchurMInlize
(&
dsdp
->
M
);
	`DSDPCHKERR
(info);

68 
fo
 = 
	`DSDPSDeuSchurMrixSuu
(
dsdp
); 
	`DSDPCHKERR
(info);

69 
fo
 = 
	`DSDPCGInlize
(&
dsdp
->
es
); 
	`DSDPCHKERR
(info);

74 
	`DSDPFuniRu
(0);

75 
	}
}

78 #unde
__FUNCT__


79 
	#__FUNCT__
 "DSDPSDeuStiics"

	)

80 
	$DSDPSDeuStiics
(
DSDP
 
dsdp
){

82 
i
;

83 
DSDPFuniBeg
;

84 
	`DSDPVid
(
dsdp
);

85 
dsdp
->
as
=
CONTINUE_ITERATING
;

86 
dsdp
->
pdasib
=
DSDP_PDUNKNOWN
;

87 
dsdp
->
now
=0;

88 
dsdp
->
pobj
= 1.0e10;

89 
dsdp
->
obj
= 1.0e10;

90 
dsdp
->
dobj
= -1.0e+9;

91 
dsdp
->
ddobj
= -1.0e+9;

92 
dsdp
->
duyg
=dsdp->
obj
-dsdp->
ddobj
;

93 
dsdp
->
p
=1.0;

94 
dsdp
->
d
=0.0;

95 
i
=0;i<
MAX_XMAKERS
;i++){

96 
dsdp
->
xmak
[
i
].
mu
=1.0e200;

97 
dsdp
->
xmak
[
i
].
p
=0.0;

99 
dsdp
->
m
=0.001;

100 
dsdp
->
mu
=1000.0;

101 
dsdp
->

=0;

102 
dsdp
->
m
=0;

103 
dsdp
->
bnm
=0;

104 
dsdp
->
m
=0;

105 
dsdp
->
ax
=0;

106 
dsdp
->
axs
=0;

107 
dsdp
->
Mshi
=0;

108 
dsdp
->
gy0
=
DSDP_FALSE
;

109 
	`DSDPFuniRu
(0);

110 
	}
}

111 #unde
__FUNCT__


112 
	#__FUNCT__
 "DSDPSDeuPams"

	)

113 
	$DSDPSDeuPams
(
DSDP
 
dsdp
){

115 
fo
;

116 
DSDPFuniBeg
;

117 
	`DSDPVid
(
dsdp
);

120 
fo
=
	`DSDPSMaxIts
(
dsdp
,500);
	`DSDPCHKERR
(info);

121 
fo
=
	`DSDPSGTޔ
(
dsdp
,1.0e-6);
	`DSDPCHKERR
(info);

122 
fo
=
	`DSDPSPNmTޔ
(
dsdp
,1.0e30);
	`DSDPCHKERR
(info);

123 i(
dsdp
->
m
<100){
fo
=
	`DSDPSGTޔ
(dsdp,1.0e-7);
	`DSDPCHKERR
(info);}

124 i(
dsdp
->
m
>3000){
fo
=
	`DSDPSGTޔ
(dsdp,5.0e-6);
	`DSDPCHKERR
(info);}

125 
fo
=
	`RCeSTy
(
dsdp
->
rce
,
DSDPInasib
);
	`DSDPCHKERR
(info);

126 
fo
=
	`DSDPSDuBound
(
dsdp
,1.0e20);
	`DSDPCHKERR
(info);

127 
fo
=
	`DSDPSSpTޔ
(
dsdp
,5.0e-2);
	`DSDPCHKERR
(info);

128 
fo
=
	`DSDPSRTޔ
(
dsdp
,1.0e-6);
	`DSDPCHKERR
(info);

129 
fo
=
	`DSDPSPTޔ
(
dsdp
,1.0e-4);
	`DSDPCHKERR
(info);

131 
fo
=
	`DSDPSMaxTruRadius
(
dsdp
,1.0e10);
	`DSDPCHKERR
(info);

132 
fo
=
	`DSDPUPty
(
dsdp
,0);
	`DSDPCHKERR
(info);

133 
fo
=
	`DSDPSInlBrrPam
(
dsdp
,-1.0);
	`DSDPCHKERR
(info);

134 
fo
=
	`DSDPSPْtlPam
(
dsdp
,3.0);
	`DSDPCHKERR
(info);

135 
fo
=
	`DSDPUDymicRho
(
dsdp
,1);
	`DSDPCHKERR
(info);

136 
fo
=
	`DSDPSR0
(
dsdp
,-1.0);
	`DSDPCHKERR
(info);

137 
fo
=
	`DSDPSPtyPam
(
dsdp
,1.0e8);
	`DSDPCHKERR
(info);

138 
fo
=
	`DSDPReuMrix
(
dsdp
,4);
	`DSDPCHKERR
(info);

139 i(
dsdp
->
m
>100){
fo
=
	`DSDPReuMrix
(dsdp,7);
	`DSDPCHKERR
(info);}

140 i(
dsdp
->
m
>1000){
fo
=
	`DSDPReuMrix
(dsdp,10);
	`DSDPCHKERR
(info);}

141 i(
dsdp
->
m
<=100){
fo
=
	`DSDPSPْtlPam
(dsdp,5.0);
	`DSDPCHKERR
(info);DSDPCHKERR(info);}

142 
dsdp
->
maxschurshi
=1.0e-11;

143 
dsdp
->
mu0
=-1.0;

144 
dsdp
->
ey
=2;

145 
fo
 = 
	`DSDPSYBounds
(
dsdp
,-1e7,1e7);
	`DSDPCHKERR
(info);

146 
	`DSDPFuniRu
(0);

147 
	}
}

149 #unde
__FUNCT__


150 
	#__FUNCT__
 "DSDPSDeuMڙs"

	)

151 
	$DSDPSDeuMڙs
(
DSDP
 
dsdp
){

153 
fo
;

155 
DSDPFuniBeg
;

156 
	`DSDPVid
(
dsdp
);

157 
dsdp
->
nmڙs
=0;

158 
fo
=
	`DSDPSMڙ
(
dsdp
,
DSDPDeuCvg
,(*)&dsdp->
cv
); 
	`DSDPCHKERR
(info);

159 
	`DSDPFuniRu
(0);

160 
	}
}

177 #unde
__FUNCT__


178 
	#__FUNCT__
 "DSDPSUp"

	)

179 
	$DSDPSup
(
DSDP
 
dsdp
){

181 
i
,
fo
;

182 
DSDPFuniBeg
;

183 
	`DSDPVid
(
dsdp
);

186 
fo
 = 
	`DSDPVecDui
(
dsdp
->
y
,&dsdp->
rhs1
);
	`DSDPCHKERR
(info);

187 
fo
 = 
	`DSDPVecDui
(
dsdp
->
y
,&dsdp->
rhs2
);
	`DSDPCHKERR
(info);

188 
fo
 = 
	`DSDPVecDui
(
dsdp
->
y
,&dsdp->
rhs
);
	`DSDPCHKERR
(info);

189 
fo
 = 
	`DSDPVecDui
(
dsdp
->
y
,&dsdp->
rhemp
);
	`DSDPCHKERR
(info);

190 
fo
 = 
	`DSDPVecDui
(
dsdp
->
y
,&dsdp->
dy1
);
	`DSDPCHKERR
(info);

191 
fo
 = 
	`DSDPVecDui
(
dsdp
->
y
,&dsdp->
dy2
);
	`DSDPCHKERR
(info);

192 
fo
 = 
	`DSDPVecDui
(
dsdp
->
y
,&dsdp->
dy
);
	`DSDPCHKERR
(info);

193 
fo
 = 
	`DSDPVecDui
(
dsdp
->
y
,&dsdp->
y0
);
	`DSDPCHKERR
(info);

194 
fo
 = 
	`DSDPVecDui
(
dsdp
->
y
,&dsdp->
xmakrhs
);
	`DSDPCHKERR
(info);

195 
i
=0;i<
MAX_XMAKERS
;i++){

196 
fo
 = 
	`DSDPVecDui
(
dsdp
->
y
,&dsdp->
xmak
[
i
].y);
	`DSDPCHKERR
(info);

197 
fo
 = 
	`DSDPVecDui
(
dsdp
->
y
,&dsdp->
xmak
[
i
].
dy
);
	`DSDPCHKERR
(info);

198 
fo
 = 
	`DSDPVecDui
(
dsdp
->
y
,&dsdp->
xmak
[
i
].
rhs
);
	`DSDPCHKERR
(info);

202 
fo
 = 
	`DSDPSUpCes
(
dsdp
);
	`DSDPCHKERR
(info);

203 
fo
 = 
	`DSDPSchurMSup
(
dsdp
->
M
,dsdp->
ymp
);
	`DSDPCHKERR
(info);

205 
fo
 = 
	`DSDPCGSup
(
dsdp
->
es
,dsdp->
ymp
); 
	`DSDPCHKERR
(info);

207 
fo
 = 
	`DSDPSUpCes2
(
dsdp
,dsdp->
y
,dsdp->
M
);
	`DSDPCHKERR
(info);

208 
fo
 = 
	`DSDPGCicDimsi
(
dsdp
,&dsdp->

);
	`DSDPCHKERR
(info);

210 
fo
=
	`DSDPCompuDaNms
(
dsdp
);
	`DSDPCHKERR
(info);

211 
dsdp
->
pas
=dsdp->
bnm
+1;

212 
dsdp
->

=dsdp->
bnm
+1;

213 
fo
=
	`DSDPSDa
(
dsdp
);
	`DSDPCHKERR
(info);

215 
fo
=
	`DSDPGCicDimsi
(
dsdp
,&dsdp->

);
	`DSDPCHKERR
(info);

216 
dsdp
->
svime
=0;

217 
dsdp
->
cgtime
=0;

218 
dsdp
->
ime
=0;

219 
dsdp
->
dtime
=0;

220 
dsdp
->
ime
=0;

221 
fo
=
	`DSDPEvtLogRegi
("Prim Sp",&
dsdp
->
ime
);

222 
fo
=
	`DSDPEvtLogRegi
("Du Sp",&
dsdp
->
dtime
);

223 
fo
=
	`DSDPEvtLogRegi
("Cܻ Sp",&
dsdp
->
ime
);

224 
fo
=
	`DSDPEvtLogRegi
("CG Sve",&
dsdp
->
cgtime
);

225 
fo
=
	`DSDPEvtLogRegi
("DSDP Sve",&
dsdp
->
svime
);

226 
dsdp
->
tuped
=
DSDP_TRUE
;

227 
	`DSDPFuniRu
(0);

228 
	}
}

232 #unde
__FUNCT__


233 
	#__FUNCT__
 "DSDPGSchurMrix"

	)

234 
	$DSDPGSchurMrix
(
DSDP
 
dsdp
, 
DSDPSchurM
 *
M
){

235 
DSDPFuniBeg
;

236 
	`DSDPVid
(
dsdp
);

237 *
M
=
dsdp
->M;

238 
	`DSDPFuniRu
(0);

239 
	}
}

241 #unde
__FUNCT__


242 
	#__FUNCT__
 "DSDPGCvgMڙ"

	)

254 
	$DSDPGCvgMڙ
(
DSDP
 
dsdp
, 
CvgMڙ
**
x
){

255 
DSDPFuniBeg
;

256 
	`DSDPVid
(
dsdp
);

257 *
x
=&
dsdp
->
cv
;

258 
	`DSDPFuniRu
(0);

259 
	}
}

262 #unde
__FUNCT__


263 
	#__FUNCT__
 "DSDPCompuDaNms"

	)

264 
	$DSDPCompuDaNms
(
DSDP
 
dsdp
){

265 
fo
;

266 
DSDPVec
 
ymp
=
dsdp
->ytemp;

267 
DSDPFuniBeg
;

268 
	`DSDPVid
(
dsdp
);

269 
fo
 = 
	`DSDPCompuANm2
(
dsdp
,
ymp
);
	`DSDPCHKERR
(info);

270 
fo
 = 
	`DSDPFixedVbsNm
(
dsdp
->
M
,
ymp
);
	`DSDPCHKERR
(info);

271 
fo
 = 
	`DSDPVecGC
(
ymp
,&
dsdp
->
m
);
	`DSDPCHKERR
(info);

272 
dsdp
->
m
=
	`sq
(dsdp->cnorm);

273 
fo
 = 
	`DSDPVecSR
(
ymp
,0);
	`DSDPCHKERR
(info);

274 
fo
 = 
	`DSDPVecSC
(
ymp
,0);
	`DSDPCHKERR
(info);

275 
fo
 = 
	`DSDPVecNm1
(
ymp
,&
dsdp
->
m
);
	`DSDPCHKERR
(info);

276 
dsdp
->
m
=
	`sq
(dsdp->anorm);

277 
	`DSDPLogInfo
(0,2,"Nm oda: %4.2e\n",
dsdp
->
m
);

278 
fo
=
	`DSDPVecCy
(
dsdp
->
b
,
ymp
);
	`DSDPCHKERR
(info);

279 
fo
 = 
	`DSDPVecSR
(
ymp
,0);
	`DSDPCHKERR
(info);

280 
fo
 = 
	`DSDPVecSC
(
ymp
,0);
	`DSDPCHKERR
(info);

281 
fo
 = 
	`DSDPVecNm2
(
ymp
,&
dsdp
->
bnm
);
	`DSDPCHKERR
(info);

282 
	`DSDPFuniRu
(0);

283 
	}
}

285 #unde
__FUNCT__


286 
	#__FUNCT__
 "DSDPSDa"

	)

287 
	$DSDPSDa
(
DSDP
 
dsdp
){

288 
fo
;

289 
s
;

290 
DSDPFuniBeg
;

291 
	`DSDPVid
(
dsdp
);

292 
s
=1.0*
dsdp
->
m
;

293 i(
dsdp
->
bnm
){ 
s
/=dsdp->bnorm;}

294 i(
dsdp
->
m
){ 
s
/=dsdp->cnorm;}

295 
s
=
	`DSDPM
(scale,1.0);

296 
s
=
	`DSDPMax
(scale,1.0e-6);

297 i(
dsdp
->
m
==0){ 
s
=1;}

298 
fo
=
	`DSDPSS
(
dsdp
,
s
);
	`DSDPCHKERR
(info);

299 
	`DSDPFuniRu
(0);

300 
	}
}

317 #unde
__FUNCT__


318 
	#__FUNCT__
 "DSDPSve"

	)

319 
	$DSDPSve
(
DSDP
 
dsdp
){

320 
fo
;

321 
DSDPFuniBeg
;

322 
fo
=
	`DSDPEvtLogBeg
(
dsdp
->
svime
);

323 
dsdp
->
pdasib
=
DSDP_PDUNKNOWN
;

324 
fo
=
	`DSDPSCvgFg
(
dsdp
,
CONTINUE_ITERATING
);
	`DSDPCHKERR
(info);

325 
fo
=
	`DSDPInlizeVbs
(
dsdp
);
	`DSDPCHKERR
(info);

326 
fo
=
	`DSDPSveDymicRho
(
dsdp
);
	`DSDPCHKERR
(info);

327 i(
dsdp
->
p
==1){
fo
=
	`DSDPRefeSpDei
(dsdp,dsdp->
xmakrhs
,dsdp->
xmak
[0].
dy
);
	`DSDPCHKERR
(info);}

328 i(
dsdp
->
pdasib
==
DSDP_PDUNKNOWN
dsdp->pdasib=
DSDP_PDFEASIBLE
;

329 
fo
=
	`DSDPEvtLogEnd
(
dsdp
->
svime
);

330 
	`DSDPFuniRu
(0);

331 
	}
}

335 #unde
__FUNCT__


336 
	#__FUNCT__
 "DSDPCheckCvg"

	)

343 
	$DSDPCheckCvg
(
DSDP
 
dsdp
,
DSDPTmiRs
 *
as
){

344 
i
,
fo
;

345 
dd
=0;

346 
DSDPTruth
 
unbounded
;

348 
DSDPFuniBeg
;

349 
fo
 = 
	`DSDPGCicDimsi
(
dsdp
,&dsdp->

);
	`DSDPCHKERR
(info);

350 
dsdp
->
rg
=(dsdp->
obj
-dsdp->
ddobj
)/(1.0+
	`bs
(dsdp->ppobj)+fabs(dsdp->ddobj));

351 
dsdp
->
pd
=dsdp->
p
;

352 i(
dsdp
->
p
==1){

353 
fo
=
	`DSDPPassXVes
(
dsdp
,dsdp->
xmak
[0].
mu
,dsdp->xmak[0].
y
,dsdp->xmak[0].
dy
); 
	`DSDPCHKERR
(info);

354 
fo
=
	`DSDPVecZo
(
dsdp
->
rhemp
); 
	`DSDPCHKERR
(info);

355 
fo
=
	`BoundYCeAddX
(
dsdp
->
ybce
,dsdp->
xmak
[0].
mu
,dsdp->xmak[0].
y
,dsdp->xmak[0].
dy
,dsdp->
rhemp
,&
dd
); 
	`DSDPCHKERR
(info);

356 
fo
=
	`DSDPVecSC
(
dsdp
->
rhemp
,0);

357 
fo
=
	`DSDPVecSR
(
dsdp
->
rhemp
,0);

358 
fo
=
	`DSDPVecNmInfy
(
dsdp
->
rhemp
,&dsdp->
pas
); 
	`DSDPCHKERR
(info);

359 i(0==1){
fo
=
	`DSDPVecVw
(
dsdp
->
rhemp
);}

361 i(
dsdp
->
as
==
CONTINUE_ITERATING
){

362 i(
dsdp
->
now
>0){

363 
fo
=
	`DSDPCheckFUnboundedObjeive
(
dsdp
,&
unbounded
);
	`DSDPCHKERR
(info);

364 i(
unbounded
==
DSDP_TRUE
){

365 
dsdp
->
pdasib
=
DSDP_UNBOUNDED
;

366 
fo
=
	`DSDPSCvgFg
(
dsdp
,
DSDP_CONVERGED
); 
	`DSDPCHKERR
(info);

369 i(
dsdp
->
as
==
CONTINUE_ITERATING
){

370 i(
dsdp
->
mud
<dsdp->
murg
 && dsdp->
p
==1 && dsdp->
d
==1 && dsdp->
rg
<1e-5){

371 
fo
=
	`DSDPSCvgFg
(
dsdp
,
DSDP_NUMERICAL_ERROR
); 
	`DSDPCHKERR
(info);

372 
	`DSDPLogInfo
(0,2,"DSDP Finished: Numerical issues: Increase in Barrier function. \n");}

373 i(
dsdp
->
now
 >dsdp->
max
){

374 
fo
=
	`DSDPSCvgFg
(
dsdp
,
DSDP_MAX_IT
); 
	`DSDPCHKERR
(info);}

375 i(
dsdp
->
Mshi
>dsdp->
maxschurshi
){

376 
fo
 = 
	`DSDPSCvgFg
(
dsdp
,
DSDP_INDEFINITE_SCHUR_MATRIX
); 
	`DSDPCHKERR
(info);

379 
i
=0; i<
dsdp
->
nmڙs
;i++){

380 
fo
=
dsdp
->
mڙ
[
i
](dsdp,dsdp->
mڙx
[i]); 
	`DSDPCHKERR
(info);

382 
fo
=
	`DSDPMڙCes
(
dsdp
,0); 
	`DSDPCHKERR
(info);

384 
dsdp
->
mud
=dsdp->
murg
;

385 
fo
 = 
	`DSDPStRs
(
dsdp
,
as
); 
	`DSDPCHKERR
(info);

386 
	`DSDPFuniRu
(0);

387 
	}
}

390 #unde
__FUNCT__


391 
	#__FUNCT__
 "DSDPIneXY"

	)

392 
	$DSDPIneXY
(
DSDP
 
dsdp
, 
xmakmu
, 
DSDPVec
 
xmaky
, DSDPVe
xmakdy
, DSDPVe
AX
, *
axs2
, *
pobj2
, *
as2
){

393 
fo
;

394 
DSDPFuniBeg
;

396 
fo
=
	`BoundYCeAddX
(
dsdp
->
ybce
,
xmakmu
,
xmaky
,
xmakdy
,
AX
,
axs2
); 
	`DSDPCHKERR
(info);

397 
fo
=
	`DSDPVecGC
(
AX
,
pobj2
);
	`DSDPCHKERR
(info);

399 
fo
=
	`DSDPVecSC
(
AX
,0);
	`DSDPCHKERR
(info);

400 
fo
=
	`DSDPVecSR
(
AX
,0);
	`DSDPCHKERR
(info);

401 
fo
=
	`DSDPVecNm1
(
AX
,
as2
); 
	`DSDPCHKERR
(info);

402 
	`DSDPFuniRu
(0);

403 
	}
}

434 #unde
__FUNCT__


435 
	#__FUNCT__
 "DSDPCompuX"

	)

436 
	$DSDPCompuX
(
DSDP
 
dsdp
){

437 
i
,
fo
;

438 
pobj
=0,
obj2
=0,
ddobj
,
axs
=0,
axs2
=0,
as
=0,
as2
=0,
objr
=0;

439 
r1
,
cc
,
r
,
bigM
,
ymax
,
pa
=
dsdp
->
pa
;

440 
DSDPTmiRs
 
as
;

441 
DSDPVec
 
AX
=
dsdp
->
ymp
;

443 
DSDPFuniBeg
;

444 
fo
=
	`DSDPStRs
(
dsdp
,&
as
);
	`DSDPCHKERR
(info);

445 
fo
=
	`DSDPGDDObjeive
(
dsdp
,&
ddobj
);
	`DSDPCHKERR
(info);

446 
fo
=
	`DSDPGMaxYEmt
(
dsdp
,&
ymax
);
	`DSDPCHKERR
(info);

447 
fo
=
	`DSDPGR
(
dsdp
,&
r
); 
	`DSDPCHKERR
(info);

448 
fo
=
	`DSDPGPty
(
dsdp
,&
bigM
);
	`DSDPCHKERR
(info);

449 
fo
=
	`DSDPGS
(
dsdp
,&
cc
);
	`DSDPCHKERR
(info);

451 
dsdp
->
pdasib
=
DSDP_PDFEASIBLE
;

452 
i
=0;i<
MAX_XMAKERS
;i++){

453 i(
i
>0 && 
dsdp
->
xmak
[i].
p
<1) ;

454 
fo
=
	`DSDPCompuXVbs
(
dsdp
,dsdp->
xmak
[
i
].
mu
,dsdp->xmak[i].
y
,dsdp->xmak[i].
dy
,
AX
,&
axs
);
	`DSDPCHKERR
(info);

455 
fo
=
	`DSDPVecGC
(
AX
,&
pobj
); 
	`DSDPCHKERR
(info);

456 
fo
=
	`DSDPVecGR
(
AX
,&
dsdp
->
ax
); 
	`DSDPCHKERR
(info);

457 
fo
=
	`DSDPVecSC
(
AX
,0);
	`DSDPCHKERR
(info);

458 
fo
=
	`DSDPVecSR
(
AX
,0);
	`DSDPCHKERR
(info);

459 
fo
=
	`DSDPVecNmInfy
(
AX
,&
as
);
	`DSDPCHKERR
(info);

460 
as
pas/(
dsdp
->
ax
+1);

462 
	`DSDPLogInfo
(0,2,"POBJ: %4.4e, DOBJ: %4.4e\n",
pobj
,
ddobj
/
cc
);

464 
fo
=
	`DSDPVecNm2
(
AX
,&
r1
);
	`DSDPCHKERR
(info);

465 
dsdp
->
axs
=tracexs;

466 
dsdp
->

=
r1
;

467 
dsdp
->
pobj
=
cc
*pobj;

469 
fo
=
	`DSDPIneXY
(
dsdp
,dsdp->
xmak
[
i
].
mu
,dsdp->xmak[i].
y
,dsdp->xmak[i].
dy
,
AX
,&
axs2
,&
obj2
,&
as2
);
	`DSDPCHKERR
(info);

470 
as2
pas2/(
dsdp
->
ax
+1);

473 
	`DSDPLogInfo
(0,2,"X P Inas: %4.2, PObj: %4.8e\n",
as
,
pobj
*(
cc
));

474 
	`DSDPLogInfo
(0,2,"TOTAL P Inas: %4.2PObj: %4.8e\n",
as2
,
obj2
*(
cc
));

475 
objr

	`bs
(
pobj
-
dsdp
->
obj
)/(1+fabs(dsdp->ppobj));

477 i(
as2
 < 
pa
){

479 i(
dsdp
->
rg
<0.1){

480 i(
as
>
pa
/100 && 
	`bs
(
r
)>
dsdp
->
da
){

481 
dsdp
->
pdasib
=
DSDP_PDUNKNOWN
;

482 
	`DSDPLogInfo
(0,2,"Warning: Try Increasingenaltyarameter\n");

483 } i(
as
>
pa
 && 
ddobj
>0 && 
obj2
<0 && 
	`bs
(
r
)<
dsdp
->
da
){

484 
dsdp
->
pdasib
=
DSDP_UNBOUNDED
;

485 
	`DSDPLogInfo
(0,2,"Warning: Drobably unbounded\n");

487 } i
	`bs
(
r
)>
dsdp
->
da
){

488 
dsdp
->
pdasib
=
DSDP_INFEASIBLE
;

489 
	`DSDPLogInfo
(0,2,"Warning: Drobably infeasible \n");

492 
i
=i+10;

497 
	`DSDPLogInfo
(0,2,"Try backup X\n");

498 
fo
=
	`DSDPSCvgFg
(
dsdp
,
DSDP_NUMERICAL_ERROR
); 
	`DSDPCHKERR
(info);

503 
	`DSDPFuniRu
(0);

504 
	}
}

509 #unde
__FUNCT__


510 
	#__FUNCT__
 "DSDPTakeDown"

	)

511 
	$DSDPTakeDown
(
DSDP
 
dsdp
){

513 
i
,
fo
;

515 
DSDPFuniBeg
;

516 
	`DSDPVid
(
dsdp
);

517 
fo
 = 
	`DSDPVecDeroy
(&
dsdp
->
rhs
);
	`DSDPCHKERR
(info);

518 
fo
 = 
	`DSDPVecDeroy
(&
dsdp
->
rhs1
);
	`DSDPCHKERR
(info);

519 
fo
 = 
	`DSDPVecDeroy
(&
dsdp
->
rhs2
);
	`DSDPCHKERR
(info);

520 
fo
 = 
	`DSDPVecDeroy
(&
dsdp
->
rhemp
);
	`DSDPCHKERR
(info);

521 
fo
 = 
	`DSDPVecDeroy
(&
dsdp
->
y
);
	`DSDPCHKERR
(info);

522 
fo
 = 
	`DSDPVecDeroy
(&
dsdp
->
ymp
);
	`DSDPCHKERR
(info);

523 
fo
 = 
	`DSDPVecDeroy
(&
dsdp
->
dy1
);
	`DSDPCHKERR
(info);

524 
fo
 = 
	`DSDPVecDeroy
(&
dsdp
->
dy2
);
	`DSDPCHKERR
(info);

525 
fo
 = 
	`DSDPVecDeroy
(&
dsdp
->
dy
);
	`DSDPCHKERR
(info);

526 
i
=0;i<
MAX_XMAKERS
;i++){

527 
fo
 = 
	`DSDPVecDeroy
(&
dsdp
->
xmak
[
i
].
y
);
	`DSDPCHKERR
(info);

528 
fo
 = 
	`DSDPVecDeroy
(&
dsdp
->
xmak
[
i
].
dy
);
	`DSDPCHKERR
(info);

529 
fo
 = 
	`DSDPVecDeroy
(&
dsdp
->
xmak
[
i
].
rhs
);
	`DSDPCHKERR
(info);

531 
fo
 = 
	`DSDPVecDeroy
(&
dsdp
->
xmakrhs
);
	`DSDPCHKERR
(info);

532 
fo
 = 
	`DSDPVecDeroy
(&
dsdp
->
y0
);
	`DSDPCHKERR
(info);

533 
fo
 = 
	`DSDPVecDeroy
(&
dsdp
->
b
);
	`DSDPCHKERR
(info);

535 
fo
 = 
	`DSDPCGDeroy
(&
dsdp
->
es
);
	`DSDPCHKERR
(info);

536 
fo
 = 
	`DSDPDeroyCes
(
dsdp
);
	`DSDPCHKERR
(info);

537 
fo
 = 
	`DSDPSchurMDeroy
(&
dsdp
->
M
);
	`DSDPCHKERR
(info);

538 
fo
 = 
	`DSDPGCicDimsi
(
dsdp
,&dsdp->

);
	`DSDPCHKERR
(info);

539 
dsdp
->
tuped
=
DSDP_FALSE
;

540 
	`DSDPFuniRu
(0);

541 
	}
}

555 #unde
__FUNCT__


556 
	#__FUNCT__
 "DSDPDeroy"

	)

557 
	$DSDPDeroy
(
DSDP
 
dsdp
){

558 
fo
;

559 
DSDPFuniBeg
;

560 
	`DSDPVid
(
dsdp
);

561 
fo
=
	`DSDPTakeDown
(
dsdp
);
	`DSDPCHKERR
(info);

562 
	`DSDPFREE
(&
dsdp
,&
fo
);
	`DSDPCHKERR
(info);

563 
	`DSDPFuniRu
(0);

564 
	}
}

	@dsdpvec.h

1 #i!
defed
(
__DSDP_VECTORS_H
)

2 
	#__DSDP_VECTORS_H


	)

4 
	~<mh.h
>

20 
	s_P_DSDPVec
{

21 
	mdim
;

22 *
	mv
;

25 
_P_DSDPVec
 
	tDSDPVec
;

27 
	#DSDPVecGAay
(
a
,
b
0;{ *(b)=().
v
); }

	)

28 
	#DSDPVecReeAay
(
a
,
b
0;{ *(b)=0; }

	)

29 
	#DSDPVecGSize
(
a
,
b
0;{ *(b)=().
dim
); }

	)

30 
	#DSDPVecAddEmt
(
a
,
b
,
c
0;{ i(c){().
v
[b])+=(c);} }

	)

31 
	#DSDPVecSEmt
(
a
,
b
,
c
0;{ {().
v
[b])=(c); } }

	)

32 
	#DSDPVecGEmt
(
a
,
b
,
c
0;{ *(c)=().
v
[b]); }

	)

33 
	#DSDPVecSR
(
a
,
b
0;{ {().
v
[).
dim
-1])=(b); } }

	)

34 
	#DSDPVecAddR
(
a
,
b
0;{ if(b){().
v
[).
dim
-1])+=(b); } }

	)

35 
	#DSDPVecGR
(
a
,
b
0;{ *(b)=().
v
[).
dim
-1]); }

	)

36 
	#DSDPVecSC
(
a
,
b
0;{ {().
v
[0])=(b); } }

	)

37 
	#DSDPVecAddC
(
a
,
b
0;{ if(b){().
v
[0])+=(b); } }

	)

38 
	#DSDPVecGC
(
a
,
b
0;{ *(b)=().
v
[0]); }

	)

39 
	#DSDPVecCeWAay
(
a
,
b
,
c
0;{ (*)).
v
=(b); (*)).
dim
=(c);}

	)

49 
DSDPVecCeSeq
(,
DSDPVec
 *);

50 
DSDPVecDui
(
DSDPVec
,DSDPVec *);

51 
DSDPVecS
(, 
DSDPVec
 );

52 
DSDPVecIS
(*,
DSDPVec
);

53 
DSDPVecZo
(
DSDPVec
 );

54 
DSDPVecNmize
(
DSDPVec
 );

55 
DSDPVecSVue
(
DSDPVec
,,);

56 
DSDPVecSBasis
(
DSDPVec
,);

57 
DSDPVecCy

DSDPVec
, DSDPVec);

58 
DSDPVecS
(, 
DSDPVec
);

59 
DSDPVecSCy
(
DSDPVec
, , DSDPVec);

60 
DSDPVecAXPY
(, 
DSDPVec
, DSDPVec);

61 
DSDPVecAYPX
(, 
DSDPVec
, DSDPVec);

62 
DSDPVecWAXPY
(
DSDPVec
,,DSDPVec,DSDPVec);

63 
DSDPVecWAXPBY
(
DSDPVec
,,DSDPVec,,DSDPVec);

64 
DSDPVecPotwiM

DSDPVec
, DSDPVec, DSDPVec);

65 
DSDPVecPotwiMax

DSDPVec
, DSDPVec, DSDPVec);

66 
DSDPVecPotwiMu

DSDPVec
, DSDPVec, DSDPVec);

67 
DSDPVecPotwiDivide

DSDPVec
, DSDPVec, DSDPVec);

68 
DSDPVecRecrolSq
(
DSDPVec
);

69 
DSDPVecD
(
DSDPVec
, DSDPVec, *);

70 
DSDPVecSum

DSDPVec
, *);

71 
DSDPVecNm1

DSDPVec
, *);

72 
DSDPVecNm2

DSDPVec
, *);

73 
DSDPVecNm22

DSDPVec
, *);

74 
DSDPVecNmInfy

DSDPVec
, *);

75 
DSDPVecAbsuVue

DSDPVec
);

76 
DSDPVecShi
(, 
DSDPVec
);

77 
DSDPVecVw

DSDPVec
);

78 
DSDPVecDeroy
(
DSDPVec
*);

	@dualalg.c

1 
	~"dsdp.h
"

2 
	~"dsdpsys.h
"

8 
DSDPChooBrrPam
(
DSDP
,,*,*);

9 
DSDPYSpLeSrch
(
DSDP
,,,
DSDPVec
);

10 
DSDPYSpLeSrch2
(
DSDP
,,,
DSDPVec
);

11 
DSDPRetY0
(
DSDP
);

13 #unde
__FUNCT__


14 
	#__FUNCT__
 "DSDPYSpLeSrch"

	)

24 
	$DSDPYSpLeSrch
(
DSDP
 
dsdp
, 
murg
, 
d0
, 
DSDPVec
 
dy
){

26 
fo
,
m
,
maxms
=30;

27 
d
,
wpْtl
,
logd
;

28 
br
=0.05, 
t
=1e-8,
maxmax
=0;

29 
DSDPTruth
 
psdefe
;

30 
DSDPFuniBeg
;

31 
fo
=
	`DSDPCompuMaxSpLgth
(
dsdp
,
dy
,
DUAL_FACTOR
,&
maxmax
);
	`DSDPCHKERR
(info);

32 
fo
=
	`DSDPCompuPْtl
(
dsdp
,dsdp->
y
,dsdp->
logd
,&dsdp->
pْtl
);
	`DSDPCHKERR
(info);

33 i(
dsdp
->
m
<0.5
br
=0.0;

34 
d
=
	`DSDPM
(
d0
,0.95*
maxmax
);

35 i(
d
 * 
dsdp
->
m
 > dsdp->
maxudius
) dstep=dsdp->maxtrustradius/dsdp->pnorm;

36 
	`DSDPLogInfo
(0,8,"Fu Du SpLgth %4.4e, %4.4e\n",
maxmax
,
d
);

37 
psdefe
=
DSDP_FALSE
;

38 
psdefe
=
DSDP_FALSE
,
m
=0;em<
maxms
 &&sdefinite==DSDP_FALSE;ttempt++){

39 
fo
=
	`DSDPCompuNewY
(
dsdp
,
d
,dsdp->
ymp
);
	`DSDPCHKERR
(info);

40 
fo
=
	`DSDPCompuSS
(
dsdp
,dsdp->
ymp
,
DUAL_FACTOR
,&
psdefe
);
	`DSDPCHKERR
(info);

41 i(
psdefe
==
DSDP_TRUE
){

42 
fo
=
	`DSDPCompuLogSDmt
(
dsdp
,&
logd
);
	`DSDPCHKERR
(info);

43 
fo
=
	`DSDPCompuPْtl
(
dsdp
,dsdp->
ymp
,
logd
,&
wpْtl
);
	`DSDPCHKERR
(info);

44 i(
wpْtl
>
dsdp
->
pْtl
-
br
 && 
d
 > 0.001/dsdp->
m
 ){

45 
	`DSDPLogInfo
(0,2,"N sufficedui. Redu spsize. Tru Radius: %4.4e\n",
d
*
dsdp
->
m
);

46 
psdefe
=
DSDP_FALSE
; 
d
=0.3*dstep;

49 
d
=dstep/3.0;

50 
	`DSDPLogInfo
(0,2,"Du Mrix PosivDefe: Redu s%4.4e",
d
);

52 i(
d
*
dsdp
->
m
 < 
t
 && dstep < steptol) ;

54 i(
psdefe
==
DSDP_TRUE
){

55 
fo
=
	`DSDPSY
(
dsdp
,
d
,
logd
,dsdp->
ymp
);
	`DSDPCHKERR
(info);

57 
fo
=
	`DSDPSY
(
dsdp
,0,dsdp->
logd
,dsdp->
y
);
	`DSDPCHKERR
(info);

59 
	`DSDPFuniRu
(0);

60 
	}
}

62 #unde
__FUNCT__


63 
	#__FUNCT__
 "DSDPYSpLeSrch2"

	)

73 
	$DSDPYSpLeSrch2
(
DSDP
 
dsdp
, 
murg
, 
d0
, 
DSDPVec
 
dy
){

76 
fo
, 
m
, 
maxms
=10;

77 
d
,
wpْtl
,
bddy
,
dpْtl
,
logd
;

78 
maxmax
=0,
t
=1e-6;

79 
a
,
b
;

80 
DSDPTruth
 
psdefe
;

81 
DSDPFuniBeg
;

82 
fo
=
	`DSDPCompuMaxSpLgth
(
dsdp
,
dy
,
DUAL_FACTOR
,&
maxmax
);
	`DSDPCHKERR
(info);

83 
fo
=
	`DSDPCompuPْtl2
(
dsdp
,dsdp->
y
,
murg
, dsdp->
logd
,&
dpْtl
);
	`DSDPCHKERR
(info);

84 
fo
=
	`DSDPVecD
(
dsdp
->
rhs
,
dy
,&
bddy
);
	`DSDPCHKERR
(info);

85 
d
=
	`DSDPM
(
d0
,0.95*
maxmax
);

86 i(
d
 * 
dsdp
->
m
 > dsdp->
maxudius
) dstep=dsdp->maxtrustradius/dsdp->pnorm;

87 
	`DSDPLogInfo
(0,8,"Fu Du SpLgth %4.4e, %4.4e\n",
maxmax
,
d
);

88 
psdefe
=
DSDP_FALSE
,
m
=0;em<
maxms
 &&sdefinite==DSDP_FALSE;ttempt++){

89 i(
d
 < 
t
) ;

90 
fo
=
	`DSDPCompuNewY
(
dsdp
,
d
,dsdp->
ymp
);
	`DSDPCHKERR
(info);

91 
fo
=
	`DSDPCompuSS
(
dsdp
,dsdp->
ymp
,
DUAL_FACTOR
,&
psdefe
);
	`DSDPCHKERR
(info);

92 i(
psdefe
==
DSDP_TRUE
){

93 
fo
=
	`DSDPCompuLogSDmt
(
dsdp
,&
logd
);
	`DSDPCHKERR
(info);

94 
fo
=
	`DSDPCompuPْtl2
(
dsdp
,dsdp->
ymp
,
murg
,
logd
,&
wpْtl
);
	`DSDPCHKERR
(info);

95 
b
=
bddy
; 
a
=2*(
wpْtl
-
dpْtl
+bddy*
d
)/(dstep*dstep);

96 i(
wpْtl
>
dpْtl
-0.1*
d
*
bddy
 ){

97 
	`DSDPLogInfo
(0,2,"N sufficedui. Redu spsize. Sp:: %4.4e\n",
d
);

98 
psdefe
=
DSDP_FALSE
;

99 i(
b
/
a
<
d
 && b/a>0){ dstep=b/a;} { dstep=dstep/2; }

102 
d
=dstep/2.0;

103 
	`DSDPLogInfo
(0,2,"Du Mrix PosivDefe: Redu s%4.4e",
d
);

106 i(
psdefe
==
DSDP_TRUE
 && 
d
>=
t
){

107 
fo
=
	`DSDPSY
(
dsdp
,
d
,
logd
,dsdp->
ymp
);
	`DSDPCHKERR
(info);

109 
fo
=
	`DSDPSY
(
dsdp
,0,dsdp->
logd
,dsdp->
y
);
	`DSDPCHKERR
(info);

111 
	`DSDPFuniRu
(0);

112 
	}
}

114 #unde
__FUNCT__


115 
	#__FUNCT__
 "DSDPSveDynmaicRho"

	)

116 
	$DSDPSveDymicRho
(
DSDP
 
dsdp
){

118 
fo
,
m
,
maxms
;

119 
dd1
,
dd2
,
murg
,
nm
;

120 
DSDPTmiRs
 
as
;

121 
DSDPTruth
 
cg1
;

122 
DSDPTruth
 
psdefe
;

124 
DSDPFuniBeg
;

126 
fo
=
	`DSDPVecCy
(
dsdp
->
y
,dsdp->
y0
);
	`DSDPCHKERR
(info);

127 
dsdp
->
now
=0; dsdp->now <dsdp->
max
+1 ; dsdp->itnow++){

130 
fo
=
	`DSDPCheckCvg
(
dsdp
,&
as
);
	`DSDPCHKERR
(info);

131 i(
as
 !
CONTINUE_ITERATING
){;}

132 i(
dsdp
->
mu0
>0){dsdp->
murg
=
	`DSDPM
(dsdp->mutarget,dsdp->mu0);}

135 
fo
=
	`DSDPCompuDuSpDeis
(
dsdp
); 
	`DSDPCHKERR
(info);

136 i(
dsdp
->
as
==
DSDP_INDEFINITE_SCHUR_MATRIX
){;}

138 
fo
=
	`DSDPCompuPDY
(
dsdp
,dsdp->
murg
,dsdp->
dy
,&dsdp->
m
); 
	`DSDPCHKERR
(info);

140 
	`DSDPEvtLogBeg
(
dsdp
->
ime
);

141 
fo
=
	`DSDPCompuPY
(
dsdp
,1.0,dsdp->
ymp
);
	`DSDPCHKERR
(info);

142 
fo
=
	`DSDPCompuSS
(
dsdp
,dsdp->
ymp
,
PRIMAL_FACTOR
,&
psdefe
);
	`DSDPCHKERR
(info);

143 i(
psdefe
==
DSDP_TRUE
){

144 
dsdp
->
p
=1.0;

145 
fo
=
	`DSDPSaveYFX
(
dsdp
,dsdp->
murg
,dsdp->
p
);
	`DSDPCHKERR
(info);

147 
dsdp
->
p
=0.0;

150 i(
dsdp
->
ufixedrho
==
DSDP_TRUE
){

151 
dsdp
->
rho
=dsdp->
rh
*dsdp->

;

152 
murg
=(
dsdp
->
obj
-dsdp->
ddobj
)/(dsdp->
rho
);

153 
dsdp
->
p
=0.5;

155 
fo
 = 
	`DSDPChooBrrPam
(
dsdp
,dsdp->
murg
,&dsdp->
p
,&murg);
	`DSDPCHKERR
(info);

156 
dsdp
->
rho
=(dsdp->
obj
-dsdp->
ddobj
)/(
murg
);

158 
	`DSDPEvtLogEnd
(
dsdp
->
ime
);

160 
	`DSDPLogInfo
(0,6,"Cumu=%4.8e, Tg X wh mu=%4.8e, Rho: %8.4e, Prim SLgth: %4.8f,nm: %4.8e\n",
dsdp
->
mu
,
murg
,dsdp->
rho
/dsdp->

,dsdp->
p
, dsdp->
m
);

165 
	`DSDPEvtLogBeg
(
dsdp
->
dtime
);

166 
fo
=
	`DSDPCompuDY
(
dsdp
,
murg
,dsdp->
dy
,&dsdp->
m
); 
	`DSDPCHKERR
(info);

167 i(
dsdp
->
m
<0.1){ 
murg
/=10; 
fo
=
	`DSDPCompuDY
(dsdp,murg,dsdp->
dy
,&dsdp->m); 
	`DSDPCHKERR
(info);}

169 
fo
=
	`DSDPYSpLeSrch
(
dsdp
, 
murg
, 1.0, dsdp->
dy
);
	`DSDPCHKERR
(info);

170 
	`DSDPEvtLogEnd
(
dsdp
->
dtime
);

172 
maxms
=
dsdp
->
uM
;

173 i(
dsdp
->
d
<1 && dsdp->
rg
<1e-5
maxms
=0;

174 i(
dsdp
->
d
<1e-13
maxms
=0;

175 i(
dsdp
->
rg
<1e-6
maxms
=0;

176 i(
maxms
>
dsdp
->
uM
) maxattempts=dsdp->reuseM;

177 
m
=0;m<
maxms
;attempt++){

178 
cgt
=1e-6;

179 i(
m
>0 && 
dsdp
->
m
 < 0.1) ;

180 i(
m
 > 0 && 
dsdp
->
d
<1e-4) ;

181 i(
dsdp
->
rag
) ;

182 
	`DSDPEvtLogBeg
(
dsdp
->
ime
);

183 
	`DSDPLogInfo
(0,2,"Reu Mrix %d: Ddobj: %12.8e, Pnm: %4.2f, Sp: %4.2f\n",
m
,
dsdp
->
ddobj
,dsdp->
m
,dsdp->
d
);

184 
fo
=
	`DSDPInvtS
(
dsdp
);
	`DSDPCHKERR
(info);

185 
fo
=
	`DSDPCompuG
(
dsdp
,dsdp->
rhemp
,dsdp->
rhs1
,dsdp->
rhs2
);
	`DSDPCHKERR
(info);

186 i(
dsdp
->
ey
==2 || dsdp->slestype==3){

187 i(
dsdp
->
rag
){
fo
=
	`DSDPCGSve
(dsdp,dsdp->
M
,dsdp->
rhs1
,dsdp->
dy1
,
cgt
,&
cg1
);
	`DSDPCHKERR
(info);}

188 
fo
=
	`DSDPCGSve
(
dsdp
,dsdp->
M
,dsdp->
rhs2
,dsdp->
dy2
,
cgt
,&
cg1
);
	`DSDPCHKERR
(info);

190 
fo
=
	`DSDPVecD
(
dsdp
->
b
,dsdp->
dy1
,&
dd1
);
	`DSDPCHKERR
(info);

191 
fo
=
	`DSDPVecD
(
dsdp
->
b
,dsdp->
dy2
,&
dd2
);
	`DSDPCHKERR
(info);

192 i(
dd1
>0 && 
dd2
>0){

193 
murg
=
	`DSDPM
(murg,
dd1
/
dd2
*
dsdp
->
schurmu
);

195 
murg
=murg*(
dsdp
->

/(dsdp->+
	`sq
(dsdp->np)));

196 
fo
=
	`DSDPCompuDY
(
dsdp
,
murg
,dsdp->
dy
, &
nm
);
	`DSDPCHKERR
(info);

197 i(
nm
<=0){ 
	`DSDPEvtLogEnd
(
dsdp
->
ime
); ; }

198 
dsdp
->
m
=
nm
;

199 
fo
=
	`DSDPYSpLeSrch2
(
dsdp
, 
murg
, dsdp->
d
, dsdp->
dy
);
	`DSDPCHKERR
(info);

200 
	`DSDPEvtLogEnd
(
dsdp
->
ime
);

202 i(
m
>0)
dsdp
->
d
=1.0;

204 
dsdp
->
murg
=
	`DSDPM
(dsdp->
mu
,mutarget);

206 
fo
=
	`DSDPGRR
(
dsdp
,&
dd1
);
	`DSDPCHKERR
(info);

207 i(
dsdp
->
now
==0 && dsdp->
xmak
[0].
p
<1.0 && 
dd1
> 0 && dsdp->p<1.0 && dsdp->
gy0
==
DSDP_FALSE
){

208 
fo
=
	`DSDPRetY0
(
dsdp
);
	`DSDPCHKERR
(info); ;

209 
dsdp
->
gy0
=
DSDP_FALSE
;

215 
	`DSDPFuniRu
(0);

216 
	}
}

220 #unde
__FUNCT__


221 
	#__FUNCT__
 "DSDPChooBrrPam"

	)

235 
	$DSDPChooBrrPam
(
DSDP
 
dsdp
, 
murg
, *

, *
xtmurg
){

236 
m
,
fo
,
cou
=0;

237 
m
,
p
=*

,
pmum
,
mur
, 
dmury1
, 
murg2
;

238 
DSDPTruth
 
psdefe
=
DSDP_FALSE
;

240 
DSDPFuniBeg
;

242 *
xtmurg
=
murg
;

245 i(*

 >=1){

246 
p
=1.0;

249 
mur
=-1.0/
murg
;

250 
fo
=
	`DSDPCompuPDY
(
dsdp
,
murg
,dsdp->
dy
,&
m
); 
	`DSDPCHKERR
(info);

251 
fo
=
	`DSDPCompuMaxSpLgth
(
dsdp
,dsdp->
dy
,
DUAL_FACTOR
,&
p
);
	`DSDPCHKERR
(info);

253 i(
p
<1.0{p=
	`DSDPM
(0.97*pstep,1.0);} {pstep=DSDPMin(1.0*pstep,1.0);}

254 
psdefe
==
DSDP_FALSE
){

255 i(
cou
 > 2 && 
p
 <1e-8){pstep=0;;}

256 
fo
=
	`DSDPCompuPY
(
dsdp
,
p
,dsdp->
ymp
);
	`DSDPCHKERR
(info);

257 
fo
=
	`DSDPCompuSS
(
dsdp
,dsdp->
ymp
,
PRIMAL_FACTOR
,&
psdefe
);
	`DSDPCHKERR
(info);

258 i(
psdefe
==
DSDP_FALSE
){

259 i(
cou
>1
p
=0.5*pstep; pstep=0.97*pstep;

260 
	`DSDPLogInfo
(0,2,"Reducg: %8.8e\n",
p
);

261 
cou
++;

264 *

=
p
;

265 i(
p
 > 
dsdp
->
xmak
[0].p || 
murg
 < dsdp->xmak[0].
mu
 * 1.0e-8){

266 
fo
=
	`DSDPSaveYFX
(
dsdp
,
murg
,
p
);
	`DSDPCHKERR
(info);

268 i(
p
==0){

269 
	`DSDPFuniRu
(0);

274 
mur
=
p
/
murg
;

275 
fo
=
	`DSDPCompuPDY1
(
dsdp
,
mur
,dsdp->
rhemp
); 
	`DSDPCHKERR
(info);

278 
fo
=
	`DSDPCompuMaxSpLgth
(
dsdp
,dsdp->
rhemp
,
PRIMAL_FACTOR
,&
dmury1
);
	`DSDPCHKERR
(info);

279 
dmury1
 = 
	`DSDPM
(1000,0.97*dmury1);

282 
m
=0;
psdefe
=
DSDP_FALSE
;

283 
pmum
=
murg
 / (1.0 + 1.0 * 
dmury1
);

284  0 && 
psdefe
==
DSDP_FALSE
){

285 
pmum
=
murg
 / (1.0 + 1.0 * 
dmury1
);

286 i(
m
>2){
pmum
=
murg
;}

287 
fo
=
	`DSDPCompuPDY
(
dsdp
,
pmum
,dsdp->
dy
,&
m
); 
	`DSDPCHKERR
(info);

288 
fo
=
	`DSDPCompuPY
(
dsdp
,
p
,dsdp->
ymp
); 
	`DSDPCHKERR
(info);

289 
fo
=
	`DSDPCompuSS
(
dsdp
,dsdp->
ymp
,
PRIMAL_FACTOR
,&
psdefe
);
	`DSDPCHKERR
(info);

290 i(
psdefe
==
DSDP_FALSE
){ 
dmury1
*=0.9; }

292 
m
++;

293 
	`DSDPLogInfo
(0,2,"GOT X: Smˡ Mu f fsib X: %4.4e.\n",
pmum
);

296 
	`DSDPLogInfo
(0,6,"GOT X: Smˡ Mu f fsib X: %4.4\n",
pmum
);

298 
murg2
=
murg
;

299 i(
dsdp
->
p
==1){

300 
murg2
 = 
pmum
;

303 
murg2
 = 
murg
;

304 
murg2
 = (
p
)*
murg
 + (1.0-p)*
dsdp
->
mu
;

305 
murg2
 = (
p
)*
pmum
 + (1.0-p)*
dsdp
->
mu
;

308 
murg2
=
	`DSDPMax
(
dsdp
->
mu
/dsdp->
rh
,mutarget2);

309 i(
dsdp
->
mu0
>0){
murg2
=
	`DSDPM
(mutarget2,dsdp->mu0);}

311 *
xtmurg
=
murg2
;

312 
	`DSDPFuniRu
(0);

313 
	}
}

315 #unde
__FUNCT__


316 
	#__FUNCT__
 "DSDPRetY0"

	)

323 
	$DSDPRetY0
(
DSDP
 
dsdp
){

324 
fo
;

325 
r
,

,
dd
;

326 
DSDPTruth
 
psdefe
;

327 
DSDPFuniBeg
;

328 
fo
=
	`DSDPCompuDY
(
dsdp
,dsdp->
murg
,dsdp->
dy
,&dsdp->
m
); 
	`DSDPCHKERR
(info);

329 
fo
=
	`DSDPVecCy
(
dsdp
->
y0
,dsdp->
y
);
	`DSDPCHKERR
(info);

330 
fo
=
	`DSDPGRR
(
dsdp
,&
r
);
	`DSDPCHKERR
(info);

331 

=
	`DSDPMax
(
r
*10000,1e12);

332 
fo
=
	`DSDPSRR
(
dsdp
,

);
	`DSDPCHKERR
(info);

333 
fo
=
	`DSDPCompuSS
(
dsdp
,dsdp->
y
,
DUAL_FACTOR
,&
psdefe
);
	`DSDPCHKERR
(info);

334 
fo
=
	`DSDPCompuLogSDmt
(
dsdp
,&dsdp->
logd
);
	`DSDPCHKERR
(info);

335 
fo
=
	`DSDPSY
(
dsdp
,1.0,dsdp->
logd
,dsdp->
y
);
	`DSDPCHKERR
(info);

336 
fo
=
	`DSDPVecGR
(
dsdp
->
b
,&
dd
);
	`DSDPCHKERR
(info);

338 
dsdp
->
murg
=
	`bs
(

*
dd
);

339 
dsdp
->
mu
=
	`bs
(

*
dd
);

342 
dsdp
->
gy0
=
DSDP_TRUE
;

343 
	`DSDPLogInfo
(0,2,"Restartlgorithm\n");

344 
	`DSDPFuniRu
(0);

345 
	}
}

364 #unde
__FUNCT__


365 
	#__FUNCT__
 "DSDPCompuDuSpDeis"

	)

366 
	$DSDPCompuDuSpDeis
(
DSDP
 
dsdp
){

367 
fo
,
compum
=1;

368 
madd
,
ymax
,
cgt
=1e-7;

369 
DSDPTruth
 
cg1
,
cg2
,
psdefe
;

370 
DSDPFuniBeg
;

372 i(
dsdp
->
now
>30dsdp->
ey
=3;

373 i(
dsdp
->
rg
<1e-3dsdp->
ey
=3;

374 i(
dsdp
->
m
<40dsdp->
ey
=3;

375 i(0 && 
dsdp
->
now
>20 && dsdp->
m
<500dsdp->
ey
=3;

376 
fo
=
	`DSDPGMaxYEmt
(
dsdp
,&
ymax
);
	`DSDPCHKERR
(info);

377 i(
dsdp
->
ey
==1){

378 
cg1
=
DSDP_TRUE
; 
cg2
=DSDP_TRUE;

379 
fo
=
	`DSDPInvtS
(
dsdp
);
	`DSDPCHKERR
(info);

380 
fo
=
	`DSDPCompuG
(
dsdp
,dsdp->
rhemp
,dsdp->
rhs1
,dsdp->
rhs2
);
	`DSDPCHKERR
(info);

381 
fo
=
	`DSDPCGSve
(
dsdp
,dsdp->
M
,dsdp->
rhs1
,dsdp->
dy1
,
cgt
,&
cg1
);
	`DSDPCHKERR
(info);

382 i(
cg1
==
DSDP_TRUE
){
fo
=
	`DSDPCGSve
(
dsdp
,dsdp->
M
,dsdp->
rhs2
,dsdp->
dy2
,
cgt
,&
cg2
);
	`DSDPCHKERR
(info);}

383 i(
cg1
==
DSDP_FALSE
 || 
cg2
==DSDP_FALSE
dsdp
->
ey
=2;

385 i(
dsdp
->
ey
==2){

386 
cg1
=
DSDP_TRUE
; 
cg2
=DSDP_TRUE;

387 
	`DSDPLogInfo
(0,9,"Compute Hessian\n");

388 
fo
=
	`DSDPInvtS
(
dsdp
);
	`DSDPCHKERR
(info);

389 
fo
=
	`DSDPCompuHessn
(
dsdp
,dsdp->
M
,dsdp->
rhs1
,dsdp->
rhs2
);
	`DSDPCHKERR
(info);

390 
compum
=0;

391 
	`DSDPLogInfo
(0,9,"Apply CG\n");

392 
fo
=
	`DSDPCGSve
(
dsdp
,dsdp->
M
,dsdp->
rhs1
,dsdp->
dy1
,
cgt
,&
cg1
);
	`DSDPCHKERR
(info);

393 i(
cg1
==
DSDP_TRUE
){
fo
=
	`DSDPCGSve
(
dsdp
,dsdp->
M
,dsdp->
rhs2
,dsdp->
dy2
,
cgt
,&
cg2
);
	`DSDPCHKERR
(info);}

394 i(
cg1
==
DSDP_FALSE
 || 
cg2
==DSDP_FALSE
dsdp
->
ey
=3;

397 i(
dsdp
->
ey
==3){

398 
	`DSDPLogInfo
(0,9,"Factor Hessian\n");

399 
psdefe
=
DSDP_FALSE
;

400 i(
dsdp
->
Mshi
 < 1e-12 || dsdp->
rg
<0.1 || dsdp->Mshift > 1e-6){

401 
madd
=
dsdp
->
Mshi
;

403 
madd
=1e-13;

405 i(
compum
){

406 
fo
=
	`DSDPInvtS
(
dsdp
);
	`DSDPCHKERR
(info);

408 
psdefe
==
DSDP_FALSE
){

409 i(0==1 && 
dsdp
->
Mshi
>dsdp->
maxschurshi
){

410 
fo
 = 
	`DSDPSCvgFg
(
dsdp
,
DSDP_INDEFINITE_SCHUR_MATRIX
); 
	`DSDPCHKERR
(info);

413 i(0 && 
dsdp
->
Mshi
*
ymax
>dsdp->
pa
/10){

414 
fo
 = 
	`DSDPSCvgFg
(
dsdp
,
DSDP_INDEFINITE_SCHUR_MATRIX
); 
	`DSDPCHKERR
(info);

417 i(
madd
*
ymax
>
dsdp
->
pa
*1000){

418 
fo
 = 
	`DSDPSCvgFg
(
dsdp
,
DSDP_INDEFINITE_SCHUR_MATRIX
); 
	`DSDPCHKERR
(info);

421 i(
compum
){

422 
fo
=
	`DSDPCompuHessn
(
dsdp
,dsdp->
M
,dsdp->
rhs1
,dsdp->
rhs2
);
	`DSDPCHKERR
(info);}

423 i(0==1){
fo
=
	`DSDPSchurMVw
(
dsdp
->
M
);
	`DSDPCHKERR
(info);}

424 
fo
 = 
	`DSDPSchurMShiDgڮ
(
dsdp
->
M
,
madd
);
	`DSDPCHKERR
(info);

425 
fo
 = 
	`DSDPSchurMFa
(
dsdp
->
M
,&
psdefe
); 
	`DSDPCHKERR
(info);

426 
compum
=1;

427 i(
psdefe
==
DSDP_FALSE
){

428 
madd
=madd*4 + 1.0e-13;

431 
dsdp
->
Mshi
=
madd
;

432 i(
psdefe
==
DSDP_TRUE
){

433 
fo
=
	`DSDPCGSve
(
dsdp
,dsdp->
M
,dsdp->
rhs1
,dsdp->
dy1
,
cgt
,&
cg1
);
	`DSDPCHKERR
(info);

434 
fo
=
	`DSDPCGSve
(
dsdp
,dsdp->
M
,dsdp->
rhs2
,dsdp->
dy2
,
cgt
,&
cg2
);
	`DSDPCHKERR
(info);

438 
	`DSDPFuniRu
(0);

439 
	}
}

440 #unde
__FUNCT__


441 
	#__FUNCT__
 "DSDPCompuDuSpDeis"

	)

442 
	$DSDPRefeSpDei
(
DSDP
 
dsdp
,
DSDPVec
 
rhs
, DSDPVe
dy
){

443 
fo
;

444 
cgt
=1e-20;

445 
DSDPTruth
 
cg1
;

446 
DSDPFuniBeg
;

448 i(
dsdp
->
as
==
DSDP_INDEFINITE_SCHUR_MATRIX
){

449 } i(
dsdp
->
as
==
DSDP_SMALL_STEPS
){

450 } i(
dsdp
->
p
<1){

452 
dsdp
->
ey
=4;

453 
fo
=
	`DSDPCGSve
(
dsdp
,dsdp->
M
,
rhs
,
dy
,
cgt
,&
cg1
);
	`DSDPCHKERR
(info);

454 
dsdp
->
ey
=3;

457 
	`DSDPFuniRu
(0);

458 
	}
}

460 
	~"dsdp5.h
"

463 #unde
__FUNCT__


464 
	#__FUNCT__
 "DSDPInlizeVbs"

	)

471 
	$DSDPInlizeVbs

DSDP
 
dsdp
 ){

473 
fo
;

474 
r0
,
murg
=
dsdp
->murg,
y
;

475 
DSDPTruth
 
psdefe
=
DSDP_FALSE
;

477 
DSDPFuniBeg
;

478 
fo
=
	`DSDPGRR
(
dsdp
,&
r0
);
	`DSDPCHKERR
(info);

479 
dsdp
->
rho
=dsdp->

*dsdp->
rh
;

480 i(
r0
>=0) {

481 
fo
=
	`DSDPCompuObjeive
(
dsdp
,dsdp->
y
,&dsdp->
ddobj
);
	`DSDPCHKERR
(info);

482 
fo
=
	`DSDPCompuSS
(
dsdp
,dsdp->
y
,
DUAL_FACTOR
,&
psdefe
);
	`DSDPCHKERR
(info);

483 i(
murg
<0murg=(
dsdp
->
obj
-dsdp->
ddobj
)/(dsdp->
rho
);

485 
fo
=
	`DSDPGPty
(
dsdp
,&
y
);
	`DSDPCHKERR
(info);

486 
r0
=0.1/(1.0+
dsdp
->
m
);

487 
psdefe
==
DSDP_FALSE
 ){

488 
r0
=r0*100;

489 
	`DSDPLogInfo
(0,9,"S InR0 %4.2e\n",
r0
);

490 
fo
=
	`DSDPSRR
(
dsdp
,
r0
);
	`DSDPCHKERR
(info);

491 
fo
=
	`DSDPCompuSS
(
dsdp
,dsdp->
y
,
DUAL_FACTOR
,&
psdefe
);
	`DSDPCHKERR
(info);

493 
r0
0*
dsdp
->

;

494 i(
dsdp
->
m
>0 && dsdp->
m
>0 && dsdp->m/dsdp->m<1){ 
r0
=r0/(dsdp->cnorm/dsdp->anorm);}

495 
dsdp
->
mu
=
r0
*
y
;

496 i(
murg
<0){

497 
murg
=(
dsdp
->
obj
-dsdp->
ddobj
)/(dsdp->
rho
);

498 
murg
=(
dsdp
->
obj
-dsdp->
ddobj
)/(dsdp->

);

499 
murg
=
r0
*
y
;

501 
	`DSDPLogInfo
(0,9,"S InR0 %4.2e\n",
r0
);

502 
fo
=
	`DSDPSRR
(
dsdp
,
r0
);
	`DSDPCHKERR
(info);

503 
fo
=
	`DSDPCompuObjeive
(
dsdp
,dsdp->
y
,&dsdp->
ddobj
);
	`DSDPCHKERR
(info);

504 
fo
=
	`DSDPCompuSS
(
dsdp
,dsdp->
y
,
DUAL_FACTOR
,&
psdefe
);
	`DSDPCHKERR
(info);

506 
fo
=
	`DSDPCompuObjeive
(
dsdp
,dsdp->
y
,&dsdp->
ddobj
);
	`DSDPCHKERR
(info);

507 i(
psdefe
==
DSDP_FALSE
){

508 
fo
=
	`DSDPSCvgFg
(
dsdp
,
DSDP_INFEASIBLE_START
);
	`DSDPCHKERR
(info);

510 
fo
=
	`DSDPCompuLogSDmt
(
dsdp
,&dsdp->
logd
);
	`DSDPCHKERR
(info);

511 
fo
=
	`DSDPCompuPْtl
(
dsdp
,dsdp->
y
,dsdp->
logd
,&dsdp->
pْtl
);
	`DSDPCHKERR
(info);

514 
fo
=
	`DSDPSY
(
dsdp
,0,dsdp->
logd
,dsdp->
y
);
	`DSDPCHKERR
(info);

515 
fo
=
	`DSDPSaveYFX
(
dsdp
,dsdp->
xmak
[0].
mu
,0);
	`DSDPCHKERR
(info);

516 
dsdp
->
murg
=mutarget;

517 
dsdp
->
p
=0.0;

518 
dsdp
->
m
=0;

520 
	`DSDPFuniRu
(0);

521 
	}
}

534 #unde
__FUNCT__


535 
	#__FUNCT__
 "DSDPCompuAndFaS"

	)

536 
	$DSDPCompuAndFaS
(
DSDP
 
dsdp
,
DSDPTruth
 *
psdefe
){

537 
fo
;

538 
DSDPFuniBeg
;

539 
fo
=
	`DSDPCompuSS
(
dsdp
,dsdp->
y
,
DUAL_FACTOR
,
psdefe
);
	`DSDPCHKERR
(info);

540 
	`DSDPFuniRu
(0);

541 
	}
}

	@dualimpl.c

1 
	~"dsdp.h
"

2 
	~"dsdpsys.h
"

20 #unde
__FUNCT__


21 
	#__FUNCT__
 "DSDPCompuObjeive"

	)

22 
	$DSDPCompuObjeive
(
DSDP
 
dsdp
, 
DSDPVec
 
Y
, *
ddobj
){

23 
fo
;

24 
DSDPFuniBeg
;

25 
fo
 = 
	`DSDPVecD
(
Y
,
dsdp
->
b
,
ddobj
);
	`DSDPCHKERR
(info);

26 
	`DSDPFuniRu
(0);

27 
	}
}

45 #unde
__FUNCT__


46 
	#__FUNCT__
 "DSDPCompuDY"

	)

47 
	$DSDPCompuDY
(
DSDP
 
dsdp
, 
mu
, 
DSDPVec
 
DY
, *
m
){

48 
fo
;

49 
nm
,
ddy1
=
	`bs
(1.0/
mu
*
dsdp
->
schurmu
),
ddy2
=-1.0;

50 
DSDPFuniBeg
;

51 
fo
=
	`DSDPCompuRHS
(
dsdp
,
mu
,dsdp->
rhs
); 
	`DSDPCHKERR
(info);

52 
fo
=
	`DSDPVecWAXPBY
(
DY
,
ddy1
,
dsdp
->
dy1
,
ddy2
,dsdp->
dy2
);
	`DSDPCHKERR
(info);

53 
fo
=
	`DSDPCompuPNm
(
dsdp
,
mu
,
DY
,&
nm
);
	`DSDPCHKERR
(info);

54 i(
nm
<0){

55 
	`DSDPLogInfo
(0,2,"Probm wh PNORM: %4.4< 0 \n",
nm
);

58 *
m
=
nm
;

59 
	`DSDPFuniRu
(0);

60 
	}
}

78 #unde
__FUNCT__


79 
	#__FUNCT__
 "DSDPCompuPDY"

	)

80 
	$DSDPCompuPDY
(
DSDP
 
dsdp
, 
mu
, 
DSDPVec
 
DY
, *
m
){

81 
fo
;

82 
nm
,
ddy1
=-
	`bs
(1.0/
mu
*
dsdp
->
schurmu
),
ddy2
=1.0;

83 
DSDPFuniBeg
;

84 
fo
=
	`DSDPCompuRHS
(
dsdp
,
mu
,dsdp->
rhs
); 
	`DSDPCHKERR
(info);

85 
fo
=
	`DSDPVecWAXPBY
(
DY
,
ddy1
,
dsdp
->
dy1
,
ddy2
,dsdp->
dy2
);
	`DSDPCHKERR
(info);

86 
fo
=
	`DSDPCompuPNm
(
dsdp
,
mu
,
DY
,&
nm
);
	`DSDPCHKERR
(info);

87 i(
nm
<0){

88 
	`DSDPLogInfo
(0,2,"Probm wh PNORM: %4.4< 0 \n",
nm
);

91 *
m
=
nm
;

92 
	`DSDPFuniRu
(0);

93 
	}
}

108 #unde
__FUNCT__


109 
	#__FUNCT__
 "DSDPCompuPDY1"

	)

110 
	$DSDPCompuPDY1
(
DSDP
 
dsdp
, 
mur
, 
DSDPVec
 
DY1
){

111 
fo
;

112 
ddy1
=-
	`bs
(
mur
*
dsdp
->
schurmu
);

113 
DSDPFuniBeg
;

114 
fo
=
	`DSDPVecSCy
(
dsdp
->
dy1
,
ddy1
,
DY1
); 
	`DSDPCHKERR
(info);

115 
	`DSDPFuniRu
(0);

116 
	}
}

130 #unde
__FUNCT__


131 
	#__FUNCT__
 "DSDPCompuNewY"

	)

132 
	$DSDPCompuNewY
(
DSDP
 
dsdp
, 
ba
, 
DSDPVec
 
Y
){

133 
fo
;

134 
emp
;

135 
DSDPFuniBeg
;

136 
fo
=
	`DSDPVecWAXPY
(
Y
,
ba
,
dsdp
->
dy
,dsdp->
y
);
	`DSDPCHKERR
(info);

137 
fo
=
	`DSDPVecGR
(
Y
,&
emp
);
	`DSDPCHKERR
(info);

138 
emp
=
	`DSDPM
(0,rtemp);

139 
fo
=
	`DSDPSchurMSR
(
dsdp
->
M
,
emp
);
	`DSDPCHKERR
(info);

140 
fo
=
	`DSDPVecSR
(
Y
,
emp
);
	`DSDPCHKERR
(info);

141 
fo
=
	`DSDPAlyFixedVbs
(
dsdp
->
M
,
Y
);
	`DSDPCHKERR
(info);

142 
	`DSDPFuniRu
(0);

143 
	}
}

157 #unde
__FUNCT__


158 
	#__FUNCT__
 "DSDPCompuPY"

	)

159 
	$DSDPCompuPY
(
DSDP
 
dsdp
, 
ba
, 
DSDPVec
 
PY
){

160 
fo
;

161 
DSDPFuniBeg
;

162 
fo
=
	`DSDPVecWAXPY
(
PY
,
ba
,
dsdp
->
dy
,dsdp->
y
);
	`DSDPCHKERR
(info);

163 
fo
=
	`DSDPAlyFixedVbs
(
dsdp
->
M
,
PY
);
	`DSDPCHKERR
(info);

164 
	`DSDPFuniRu
(0);

165 
	}
}

186 #unde
__FUNCT__


187 
	#__FUNCT__
 "DSDPCompuRHS"

	)

188 
	$DSDPCompuRHS
(
DSDP
 
dsdp
, 
mu
, 
DSDPVec
 
RHS
){

189 
fo
;

190 
ddrhs1
=1.0/
mu
*
dsdp
->
schurmu
,
ddrhs2
=-mu/
	`bs
(mu) );

191 
DSDPFuniBeg
;

192 
fo
=
	`DSDPVecWAXPBY
(
RHS
,
ddrhs1
,
dsdp
->
rhs1
,
ddrhs2
,dsdp->
rhs2
);
	`DSDPCHKERR
(info);

193 
	`DSDPFuniRu
(0);

194 
	}
}

196 #unde
__FUNCT__


197 
	#__FUNCT__
 "DSDPCompuPNm"

	)

198 
	$DSDPCompuPNm
(
DSDP
 
dsdp
, 
mu
, 
DSDPVec
 
DY
, *
m
){

199 
fo
;

200 
nm
=0;

201 
DSDPFuniBeg
;

202 
fo
=
	`DSDPCompuRHS
(
dsdp
,
mu
,dsdp->
rhs
); 
	`DSDPCHKERR
(info);

203 
fo
 = 
	`DSDPVecD
(
dsdp
->
rhs
,
DY
,&
nm
);
	`DSDPCHKERR
(info);

204 
nm
/=
dsdp
->
schurmu
;

205 i(
nm
 >= 0){

206 *
m
=
	`sq
(
nm
);

208 
	`DSDPLogInfo
(0,2,"Probm wh PNORM: %4.4inمosive.\n",
nm
);

209 *
m
=
nm
;

211 i(*
m
!=*m){
	`DSDPSETERR1
(1,"Probm wh PNORM: %4.4inمosive.\n",
nm
);}

212 
	`DSDPFuniRu
(0);

213 
	}
}

227 #unde
__FUNCT__


228 
	#__FUNCT__
 "DSDPCompuDuyG"

	)

229 
	$DSDPCompuDuyG
(
DSDP
 
dsdp
, 
mu
, *
g
){

230 
fo
;

231 
wg
=0,
m
;

232 
smu
=1.0/
dsdp
->
schurmu
;

233 
DSDPFuniBeg
;

234 
fo
=
	`DSDPCompuDY
(
dsdp
,
mu
,dsdp->
dy
,&
m
); 
	`DSDPCHKERR
(info);

235 
fo
=
	`DSDPVecD
(
dsdp
->
dy
,dsdp->
rhs2
,&
wg
);
	`DSDPCHKERR
(info);

236 
wg
 = (wg*
smu
+
dsdp
->

)*
mu
;

237 i(
wg
<=0){

238 
	`DSDPLogInfo
(0,2,"GAP :%4.4e<0: Probm\n",
wg
);

240 
	`DSDPLogInfo
(0,2,"Duy G: %12.8e, Updim objeive: %12.8e\n",
wg
,
dsdp
->
ddobj
+newgap);

242 
wg
=
	`DSDPMax
(0,newgap);

243 *
g
=
wg
;

244 
	`DSDPFuniRu
(0);

245 
	}
}

259 #unde
__FUNCT__


260 
	#__FUNCT__
 "DSDPCompuPْtl"

	)

261 
	$DSDPCompuPْtl
(
DSDP
 
dsdp
, 
DSDPVec
 
y
, 
logd
, *
pْtl
){

262 
fo
;

263 
dpْtl
,
g
,
ddobj
;

264 
DSDPFuniBeg
;

265 
fo
=
	`DSDPCompuObjeive
(
dsdp
,
y
,&
ddobj
);
	`DSDPCHKERR
(info);

266 
g
=
dsdp
->
obj
-
ddobj
;

267 i(
g
>0
dpْtl
=
dsdp
->
rho
*
	`log
(g)-
logd
;

268 {
dpْtl
=
dsdp
->
pْtl
+1;}

269 *
pْtl
=
dpْtl
;

270 
	`DSDPLogInfo
(0,9,"G: %4.4e, Log Dmt: %4.4e, Log G: %4.4e\n",
g
,
logd
,
	`log
(gap));

271 
	`DSDPFuniRu
(0);

272 
	}
}

287 #unde
__FUNCT__


288 
	#__FUNCT__
 "DSDPCompuPْtl2"

	)

289 
	$DSDPCompuPْtl2
(
DSDP
 
dsdp
, 
DSDPVec
 
y
, 
mu
, 
logd
, *
pْtl
){

290 
fo
;

291 
ddobj
;

292 
DSDPFuniBeg
;

293 
fo
=
	`DSDPCompuObjeive
(
dsdp
,
y
,&
ddobj
);
	`DSDPCHKERR
(info);

294 *
pْtl
=-(
ddobj
 + 
mu
*
logd
)*
dsdp
->
schurmu
;

295 *
pْtl
=-(
ddobj
/
mu
 + 
logd
)*
dsdp
->
schurmu
;

296 
	`DSDPFuniRu
(0);

297 
	}
}

311 #unde
__FUNCT__


312 
	#__FUNCT__
 "DSDPSY"

	)

313 
	$DSDPSY
(
DSDP
 
dsdp
, 
ba
, 
logd
, 
DSDPVec
 
yw
){

314 
fo
;

315 
r1
,
r2
,

,

;

316 
DSDPFuniBeg
;

317 
fo
=
	`DSDPVecGR
(
dsdp
->
y
,&
r1
);
	`DSDPCHKERR
(info);

318 
fo
=
	`DSDPVecGR
(
yw
,&
r2
);
	`DSDPCHKERR
(info);

319 i(
r2
==0&&
r1
!=0){
dsdp
->
rag
=1;} {dsdp->rflag=0;};

320 
fo
=
	`DSDPVecCy
(
yw
,
dsdp
->
y
);
	`DSDPCHKERR
(info);

321 
fo
 = 
	`DSDPCompuObjeive
(
dsdp
,dsdp->
y
,&dsdp->
ddobj
);
	`DSDPCHKERR
(info);

323 i(
dsdp
->
obj
<=dsdp->
ddobj
){

324 
dsdp
->
obj
=dsdp->
ddobj
+2*dsdp->
mu
 * dsdp->

;

325 
	`DSDPLogInfo
(0,2,"Prim ObjeivN Right. Assigd: %8.8e\n",
dsdp
->
obj
);

327 
fo
=
	`DSDPVecGR
(
yw
,&

);
	`DSDPCHKERR
(info);

328 
fo
=
	`DSDPVecGR
(
dsdp
->
b
,&

);
	`DSDPCHKERR
(info);

329 
dsdp
->
dobj
=dsdp->
ddobj
-

*

;

330 
	`DSDPLogInfo
(0,2,"Duy G: %4.4e, Pْtl: %4.4\n",
dsdp
->
duyg
,dsdp->
pْtl
);

331 
dsdp
->
duyg
=dsdp->
obj
-dsdp->
ddobj
;

332 
dsdp
->
mu
=(dsdp->
duyg
)/(dsdp->

);

333 
dsdp
->
d
=
ba
;

334 
dsdp
->
logd
=logdet;

335 
fo
=
	`DSDPCompuPْtl
(
dsdp
,dsdp->
y
,dsdp->
logd
,&dsdp->
pْtl
);
	`DSDPCHKERR
(info);

336 
	`DSDPLogInfo
(0,2,"Duy G: %4.4e, Pْtl: %4.4\n",
dsdp
->
duyg
,dsdp->
pْtl
);

337 
	`DSDPFuniRu
(0);

338 
	}
}

340 #unde
__FUNCT__


341 
	#__FUNCT__
 "DSDPSaveBackupYFX"

	)

342 
	$DSDPSaveBackupYFX
(
DSDP
 
dsdp
, 
cou
,
mu
, 
p
){

343 
fo
;

344 
m
;

345 
DSDPFuniBeg
;

346 
fo
=
	`DSDPVecCy
(
dsdp
->
y
,dsdp->
xmak
[
cou
].y);
	`DSDPCHKERR
(info);

347 
fo
=
	`DSDPCompuDY
(
dsdp
,
mu
,dsdp->
xmak
[
cou
].
dy
,&
m
); 
	`DSDPCHKERR
(info);

348 
dsdp
->
xmak
[
cou
].
p
=pstep;

349 
dsdp
->
xmak
[
cou
].
mu
 = mu;

350 
	`DSDPFuniRu
(0);

351 
	}
}

363 #unde
__FUNCT__


364 
	#__FUNCT__
 "DSDPSaveYFX"

	)

365 
	$DSDPSaveYFX
(
DSDP
 
dsdp
, 
mu
, 
p
){

366 
fo
;

367 
m
,
wg
,
ymax
;

368 
DSDPFuniBeg
;

369 
fo
=
	`DSDPGMaxYEmt
(
dsdp
,&
ymax
);
	`DSDPCHKERR
(info);

370 i(
p
==0){

371 
fo
=
	`DSDPVecCy
(
dsdp
->
y
,dsdp->
xmak
[0].y);
	`DSDPCHKERR
(info);

372 
dsdp
->
xmak
[0].
p
=pstep;

373 } i(
dsdp
->
Mshi
*
ymax
>dsdp->
pa
*10){

374 
fo
=
	`DSDPCompuDuyG
(
dsdp
,
mu
,&
wg
);
	`DSDPCHKERR
(info);

375 i(
p
==1 && 
wg
>0){

376 
dsdp
->
obj
 = dsdp->
ddobj
 + 
wg
; dsdp->
mu
=ewg)/(dsdp->

);

377 
dsdp
->
duyg
=
wg
;

381 
fo
=
	`DSDPVecCy
(
dsdp
->
y
,dsdp->
xmak
[0].y);
	`DSDPCHKERR
(info);

382 
dsdp
->
xmak
[0].
p
=pstep;

383 
fo
=
	`DSDPCompuRHS
(
dsdp
,
mu
,dsdp->
xmakrhs
); 
	`DSDPCHKERR
(info);

384 
fo
=
	`DSDPCompuDY
(
dsdp
,
mu
,dsdp->
xmak
[0].
dy
,&
m
); 
	`DSDPCHKERR
(info);

385 
dsdp
->
xmak
[0].
mu
 = mu;

386 
fo
=
	`DSDPCompuDuyG
(
dsdp
,
mu
,&
wg
);
	`DSDPCHKERR
(info);

387 i(
p
==1 && 
wg
>0){

388 
dsdp
->
obj
 = dsdp->
ddobj
 + 
wg
; dsdp->
mu
=ewg)/(dsdp->

);

389 
dsdp
->
duyg
=
wg
;

393 i(
p
==1.0 && 
dsdp
->
rg
>5.0e-1) {

394 
fo
=
	`DSDPSaveBackupYFX
(
dsdp
,
MAX_XMAKERS
-1,
mu
,
p
);
	`DSDPCHKERR
(info);

396 i(
p
==1.0 && 
dsdp
->
rg
>1.0e-3) {

397 
fo
=
	`DSDPSaveBackupYFX
(
dsdp
,2,
mu
,
p
);
	`DSDPCHKERR
(info);

399 i(
p
==1.0 && 
dsdp
->
rg
>1.0e-5) {

400 
fo
=
	`DSDPSaveBackupYFX
(
dsdp
,1,
mu
,
p
);
	`DSDPCHKERR
(info);

403 
	`DSDPFuniRu
(0);

404 
	}
}

406 #unde
__FUNCT__


407 
	#__FUNCT__
 "DSDPSRR"

	)

414 
	$DSDPSRR
(
DSDP
 
dsdp
,
s
){

415 
fo
;

416 
DSDPFuniBeg
;

417 
	`DSDPVid
(
dsdp
);

418 
fo
=
	`DSDPVecSR
(
dsdp
->
y
,-
s
);
	`DSDPCHKERR
(info);

419 
	`DSDPFuniRu
(0);

420 
	}
}

422 #unde
__FUNCT__


423 
	#__FUNCT__
 "DSDPGRR"

	)

430 
	$DSDPGRR
(
DSDP
 
dsdp
,*
s
){

431 
fo
;

432 
DSDPFuniBeg
;

433 
	`DSDPVid
(
dsdp
);

434 
fo
=
	`DSDPVecGR
(
dsdp
->
y
,
s
);
	`DSDPCHKERR
(info);

435 *
s
=-*res;

436 i(*
s
==0) *res=0;

437 
	`DSDPFuniRu
(0);

438 
	}
}

441 #unde
__FUNCT__


442 
	#__FUNCT__
 "DSDPObjeiveGH"

	)

443 
	$DSDPObjeiveGH

DSDP
 
dsdp
 , 
DSDPSchurM
 
M
, 
DSDPVec
 
vrhs1
){

444 
i
,
fo
,
m
;

445 
emp
,
dd
;

447 
DSDPFuniBeg
;

448 
fo
=
	`DSDPVecGSize
(
vrhs1
,&
m
); 
	`DSDPCHKERR
(info);

449 
i
=0;i<
m
;i++){

450 
fo
=
	`DSDPSchurMVbCompu
(
M
,
i
,&
dd
); 
	`DSDPCHKERR
(info);

451 i(
dd
){

452 
fo
=
	`DSDPVecGEmt
(
dsdp
->
b
,
i
,&
emp
);
	`DSDPCHKERR
(info);

453 
fo
=
	`DSDPVecAddEmt
(
vrhs1
,
i
,
emp
);
	`DSDPCHKERR
(info);

456 
	`DSDPFuniRu
(0);

457 
	}
}

459 #unde
__FUNCT__


460 
	#__FUNCT__
 "DSDPCheckFUnboundedObjeive"

	)

461 
	$DSDPCheckFUnboundedObjeive
(
DSDP
 
dsdp
, 
DSDPTruth
 *
unbounded
){

462 
fo
;

463 
dmp
;

464 
DSDPTruth
 
psdefe
;

465 
DSDPFuniBeg
;

466 *
unbounded
=
DSDP_FALSE
;

467 
fo
 = 
	`DSDPVecD
(
dsdp
->
b
,dsdp->
dy2
,&
dmp
);
	`DSDPCHKERR
(info);

468 i
dmp
 < 0 ) {

469 
fo
 = 
	`DSDPVecSCy
(
dsdp
->
dy2
,-1.0,dsdp->
ymp
); 
	`DSDPCHKERR
(info);

470 
fo
 = 
	`DSDPCompuSS
(
dsdp
,dsdp->
ymp
,
PRIMAL_FACTOR
,&
psdefe
);
	`DSDPCHKERR
(info);

471 i(
psdefe
 =
DSDP_TRUE
){

472 
psdefe
=
DSDP_FALSE
;

473 
psdefe
==
DSDP_FALSE
){

474 
fo
=
	`DSDPCompuSS
(
dsdp
,dsdp->
ymp
,
PRIMAL_FACTOR
,&
psdefe
);
	`DSDPCHKERR
(info);

475 i(
psdefe
 =
DSDP_TRUE
) ;

476 
fo
=
	`DSDPVecS
(2.0,
dsdp
->
ymp
); 
	`DSDPCHKERR
(info);

478 
fo
 = 
	`DSDPVecCy
(
dsdp
->
ymp
,dsdp->
y
); 
	`DSDPCHKERR
(info);

479 
fo
 = 
	`DSDPSaveYFX
(
dsdp
,1.0e-12,1.0);
	`DSDPCHKERR
(info);

480 
fo
 = 
	`DSDPCompuObjeive
(
dsdp
,dsdp->
y
,&dsdp->
ddobj
);
	`DSDPCHKERR
(info);

481 
fo
 = 
	`DSDPVecNmize
(
dsdp
->
y
); 
	`DSDPCHKERR
(info);

482 *
unbounded
=
DSDP_TRUE
;

485 
	`DSDPFuniRu
(0);

486 
	}
}

	@/usr/include/math.h

24 #idef 
_MATH_H


25 
	#_MATH_H
 1

	)

27 
	~<us.h
>

29 
	g__BEGIN_DECLS


33 
	~<bs/huge_v.h
>

36 #ifdef 
__USE_ISOC99


37 
	~<bs/n.h
>

40 
	~<bs/mhdef.h
>

48 
	#__MATHCALL
(
funi
,
suffix
, 
gs
) \

49 
	`__MATHDECL
 (
_Mdoub_
,
funi
,
suffix
, 
gs
)

	)

50 
	#__MATHDECL
(
ty
, 
funi
,
suffix
, 
gs
) \

51 
	`__MATHDECL_1
(
ty
, 
funi
,
suffix
, 
gs
); \

52 
	`__MATHDECL_1
(
ty
, 
	`__CONCAT
(
__
,
funi
),
suffix
, 
gs
)

	)

53 
	#__MATHCALLX
(
funi
,
suffix
, 
gs
, 
ib
) \

54 
	`__MATHDECLX
 (
_Mdoub_
,
funi
,
suffix
, 
gs
, 
ib
)

	)

55 
	#__MATHDECLX
(
ty
, 
funi
,
suffix
, 
gs
, 
ib
) \

56 
	`__MATHDECL_1
(
ty
, 
funi
,
suffix
, 
gs

	`__ibu__
 (
ib
); \

57 
	`__MATHDECL_1
(
ty
, 
	`__CONCAT
(
__
,
funi
),
suffix
, 
gs

	`__ibu__
 (
ib
)

	)

58 
	#__MATHDECL_1
(
ty
, 
funi
,
suffix
, 
gs
) \

59 
ty
 
	`__MATH_PRECNAME
(
funi
,
suffix

gs
 
__THROW


	)

61 
	#_Mdoub_
 

	)

62 
	#__MATH_PRECNAME
(
me
,
r

	`__CONCAT
ame,r)

	)

63 
	#_Mdoub_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_STD


	)

64 
	#_Mdoub_END_NAMESPACE
 
__END_NAMESPACE_STD


	)

65 
	~<bs/mhs.h
>

66 #unde
_Mdoub_


67 #unde
_Mdoub_BEGIN_NAMESPACE


68 #unde
_Mdoub_END_NAMESPACE


69 #unde
__MATH_PRECNAME


71 #i
defed
 
__USE_MISC
 || defed 
__USE_ISOC99


77 #ide
_Mt_


78 
	#_Mt_
 

	)

80 
	#_Mdoub_
 
_Mt_


	)

81 #ifde
__STDC__


82 
	#__MATH_PRECNAME
(
me
,
r
me##
f
##
	)
r

84 
	#__MATH_PRECNAME
(
me
,
r
m
f
 
	)
r

86 
	#_Mdoub_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

87 
	#_Mdoub_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

88 
	~<bs/mhs.h
>

89 #unde
_Mdoub_


90 #unde
_Mdoub_BEGIN_NAMESPACE


91 #unde
_Mdoub_END_NAMESPACE


92 #unde
__MATH_PRECNAME


94 #i(
__STDC__
 - 0 || 
__GNUC__
 - 0&& !
defed
 
__NO_LONG_DOUBLE_MATH


98 #ide
_Mlg_doub_


99 
	#_Mlg_doub_
 

	)

101 
	#_Mdoub_
 
_Mlg_doub_


	)

102 #ifde
__STDC__


103 
	#__MATH_PRECNAME
(
me
,
r
me##
l
##
	)
r

105 
	#__MATH_PRECNAME
(
me
,
r
m
l
 
	)
r

107 
	#_Mdoub_BEGIN_NAMESPACE
 
__BEGIN_NAMESPACE_C99


	)

108 
	#_Mdoub_END_NAMESPACE
 
__END_NAMESPACE_C99


	)

109 
	~<bs/mhs.h
>

110 #unde
_Mdoub_


111 #unde
_Mdoub_BEGIN_NAMESPACE


112 #unde
_Mdoub_END_NAMESPACE


113 #unde
__MATH_PRECNAME


118 #unde
__MATHDECL_1


119 #unde
__MATHDECL


120 #unde
__MATHCALL


123 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN


125 
signgam
;

130 #i
__USE_ISOC99


168 
	mFP_NAN
,

169 
	#FP_NAN
 
FP_NAN


	)

170 
	mFP_INFINITE
,

171 
	#FP_INFINITE
 
FP_INFINITE


	)

172 
	mFP_ZERO
,

173 
	#FP_ZERO
 
FP_ZERO


	)

174 
	mFP_SUBNORMAL
,

175 
	#FP_SUBNORMAL
 
FP_SUBNORMAL


	)

176 
	mFP_NORMAL


177 
	#FP_NORMAL
 
FP_NORMAL


	)

181 #ifde
__NO_LONG_DOUBLE_MATH


182 
	#assify
(
x
) \

183 ( (
x
= (? 
	`__assifyf
 (x: 
	`__assify
 (x))

	)

185 
	#assify
(
x
) \

186 ( (
x
) ==  () \

187 ? 
	`__assifyf
 (
x
) \

188 :  (
x
) ==  () \

189 ? 
	`__assify
 (
x
: 
	`__assifyl
 (x))

	)

193 #ifde
__NO_LONG_DOUBLE_MATH


194 
	#signb
(
x
) \

195 ( (
x
= (? 
	`__signbf
 (x: 
	`__signb
 (x))

	)

197 
	#signb
(
x
) \

198 ( (
x
) ==  () \

199 ? 
	`__signbf
 (
x
) \

200 :  (
x
) ==  () \

201 ? 
	`__signb
 (
x
: 
	`__signbl
 (x))

	)

205 #ifde
__NO_LONG_DOUBLE_MATH


206 
	#isfe
(
x
) \

207 ( (
x
= (? 
	`__fef
 (x: 
	`__fe
 (x))

	)

209 
	#isfe
(
x
) \

210 ( (
x
) ==  () \

211 ? 
	`__fef
 (
x
) \

212 :  (
x
) ==  () \

213 ? 
	`__fe
 (
x
: 
	`__f
 (x))

	)

217 
	#im
(
x
(
	`assify
 (x=
FP_NORMAL
)

	)

221 #ifde
__NO_LONG_DOUBLE_MATH


222 
	#i
(
x
) \

223 ( (
x
= (? 
	`__if
 (x: 
	`__i
 (x))

	)

225 
	#i
(
x
) \

226 ( (
x
) ==  () \

227 ? 
	`__if
 (
x
) \

228 :  (
x
) ==  () \

229 ? 
	`__i
 (
x
: 
	`__il
 (x))

	)

233 #ifde
__NO_LONG_DOUBLE_MATH


234 
	#isf
(
x
) \

235 ( (
x
= (? 
	`__isff
 (x: 
	`__isf
 (x))

	)

237 
	#isf
(
x
) \

238 ( (
x
) ==  () \

239 ? 
	`__isff
 (
x
) \

240 :  (
x
) ==  () \

241 ? 
	`__isf
 (
x
: 
	`__is
 (x))

	)

245 
	#MATH_ERRNO
 1

	)

246 
	#MATH_ERREXCEPT
 2

	)

250 #ifdef 
__USE_MISC


254 
	m_IEEE_
 = -1,

255 
	m_SVID_
,

256 
	m_XOPEN_
,

257 
	m_POSIX_
,

258 
	m_ISOC_


259 } 
	t_LIB_VERSION_TYPE
;

264 
_LIB_VERSION_TYPE
 
_LIB_VERSION
;

268 #ifde
__USE_SVID


274 #ifde
__lulus


275 
	g__exi


277 
	gexi


280 
	gty
;

281 *
	gme
;

282 
	gg1
;

283 
	gg2
;

284 
	gtv
;

287 #ifde
__lulus


288 
	$mhr
 (
__exi
 *
__exc

	`throw
 ();

290 
	`mhr
 (
exi
 *
__exc
);

293 
	#X_TLOSS
 1.41484755040568800000e+16

	)

296 
	#DOMAIN
 1

	)

297 
	#SING
 2

	)

298 
	#OVERFLOW
 3

	)

299 
	#UNDERFLOW
 4

	)

300 
	#TLOSS
 5

	)

301 
	#PLOSS
 6

	)

304 
	#HUGE
 3.40282347e+38F

	)

308 #ifde
__USE_XOPEN


310 
	#MAXFLOAT
 3.40282347e+38F

	)

317 #i
defed
 
__USE_BSD
 || defed 
__USE_XOPEN


318 
	#M_E
 2.7182818284590452354

	)

319 
	#M_LOG2E
 1.4426950408889634074

	)

320 
	#M_LOG10E
 0.43429448190325182765

	)

321 
	#M_LN2
 0.69314718055994530942

	)

322 
	#M_LN10
 2.30258509299404568402

	)

323 
	#M_PI
 3.14159265358979323846

	)

324 
	#M_PI_2
 1.57079632679489661923

	)

325 
	#M_PI_4
 0.78539816339744830962

	)

326 
	#M_1_PI
 0.31830988618379067154

	)

327 
	#M_2_PI
 0.63661977236758134308

	)

328 
	#M_2_SQRTPI
 1.12837916709551257390

	)

329 
	#M_SQRT2
 1.41421356237309504880

	)

330 
	#M_SQRT1_2
 0.70710678118654752440

	)

336 #ifde
__USE_GNU


337 
	#M_El
 2.7182818284590452353602874713526625L

	)

338 
	#M_LOG2El
 1.4426950408889634073599246810018921L

	)

339 
	#M_LOG10El
 0.4342944819032518276511289189166051L

	)

340 
	#M_LN2l
 0.6931471805599453094172321214581766L

	)

341 
	#M_LN10l
 2.3025850929940456840179914546843642L

	)

342 
	#M_PIl
 3.1415926535897932384626433832795029L

	)

343 
	#M_PI_2l
 1.5707963267948966192313216916397514L

	)

344 
	#M_PI_4l
 0.7853981633974483096156608458198757L

	)

345 
	#M_1_PIl
 0.3183098861837906715377675267450287L

	)

346 
	#M_2_PIl
 0.6366197723675813430755350534900574L

	)

347 
	#M_2_SQRTPIl
 1.1283791670955125738961589031215452L

	)

348 
	#M_SQRT2l
 1.4142135623730950488016887242096981L

	)

349 
	#M_SQRT1_2l
 0.7071067811865475244008443621048490L

	)

356 #i
defed
 
__STRICT_ANSI__
 && !defed 
__NO_MATH_INLINES


357 
	#__NO_MATH_INLINES
 1

	)

361 #ifde
__USE_EXTERN_INLINES


362 
	~<bs/mhle.h
>

366 #i
__USE_ISOC99


374 #ide
isg


375 
	#isg
(
x
, 
y
) \

376 (
__exnsi__
 \

377 ({ 
	`__tyof__
(
x

__x
 = (x); __tyof__(
y

__y
 = (y); \

378 !
	`isunded
 (
__x
, 
__y
&& __x > __y; 
	}
}))

	)

382 #ide
isgequ


383 
	#isgequ
(
x
, 
y
) \

384 (
__exnsi__
 \

385 ({ 
	`__tyof__
(
x

__x
 = (x); __tyof__(
y

__y
 = (y); \

386 !
	`isunded
 (
__x
, 
__y
&& __x >__y; }))

	)

390 #ide
iess


391 
	#iess
(
x
, 
y
) \

392 (
__exnsi__
 \

393 ({ 
	`__tyof__
(
x

__x
 = (x); __tyof__(
y

__y
 = (y); \

394 !
	`isunded
 (
__x
, 
__y
&& __x < __y; }))

	)

398 #ide
iesqu


399 
	#iesqu
(
x
, 
y
) \

400 (
__exnsi__
 \

401 ({ 
	`__tyof__
(
x

__x
 = (x); __tyof__(
y

__y
 = (y); \

402 !
	`isunded
 (
__x
, 
__y
&& __x <__y; }))

	)

406 #ide
iessg


407 
	#iessg
(
x
, 
y
) \

408 (
__exnsi__
 \

409 ({ 
	`__tyof__
(
x

__x
 = (x); __tyof__(
y

__y
 = (y); \

410 !
	`isunded
 (
__x
, 
__y
&& (__x < __y || __y < __x); }))

	)

414 #ide
isunded


415 
	#isunded
(
u
, 
v
) \

416 (
__exnsi__
 \

417 ({ 
	`__tyof__
(
u

__u
 = (u); __tyof__(
v

__v
 = (v); \

418 
	`assify
 (
__u
=
FP_NAN
 || fpassify (
__v
=FP_NAN; }))

	)

423 
	g__END_DECLS


	@/usr/include/bits/huge_val.h

21 #ide
_MATH_H


25 
	~<us.h
>

29 #i
__GNUC_PREREQ
(2,96)

30 
	#HUGE_VAL
 (
__exnsi__
 0x1.0
p2047
)

	)

32 
	#__HUGE_VAL_bys
 { 0, 0, 0, 0, 0, 0, 0xf0, 0x7}

	)

34 
	#__huge_v_t
 uni { 
__c
[8]; 
__d
; }

	)

35 #ifdef 
__GNUC__


36 
	#HUGE_VAL
 (
__exnsi__
 \

37 ((
__huge_v_t
{ 
__c
: 
__HUGE_VAL_bys
 }).
__d
)

	)

39 
__huge_v_t
 
	g__huge_v
 = { 
__HUGE_VAL_bys
 };

40 
	#HUGE_VAL
 (
__huge_v
.
__d
)

	)

47 #ifde
__USE_ISOC99


49 #i
__GNUC_PREREQ
(2,96)

51 
	#HUGE_VALF
 (
__exnsi__
 0x1.0
p255f
)

	)

52 
	#HUGE_VALL
 (
__exnsi__
 0x1.0
p32767L
)

	)

56 
	#__HUGE_VALF_bys
 { 0, 0, 0x80, 0x7}

	)

58 
	#__huge_vf_t
 uni { 
__c
[4]; 
__f
; }

	)

59 #ifdef 
__GNUC__


60 
	#HUGE_VALF
 (
__exnsi__
 \

61 ((
__huge_vf_t
{ 
__c
: 
__HUGE_VALF_bys
 }).
__f
)

	)

63 
__huge_vf_t
 
	g__huge_vf
 = { 
__HUGE_VALF_bys
 };

64 
	#HUGE_VALF
 (
__huge_vf
.
__f
)

	)

68 
	#__HUGE_VALL_bys
 { 0, 0, 0, 0, 0, 0, 0, 0x80, 0xff, 0x7f, 0, 0 }

	)

70 
	#__huge_vl_t
 uni { 
__c
[12]; 
__ld
; }

	)

71 #ifde
__GNUC__


72 
	#HUGE_VALL
 (
__exnsi__
 \

73 ((
__huge_vl_t
{ 
__c
: 
__HUGE_VALL_bys
 }).
__ld
)

	)

75 
__huge_vl_t
 
	g__huge_vl
 = { 
__HUGE_VALL_bys
 };

76 
	#HUGE_VALL
 (
__huge_vl
.
__ld
)

	)

	@/usr/include/bits/mathcalls.h

46 #ide
_MATH_H


53 
_Mdoub_BEGIN_NAMESPACE


55 
__MATHCALL
 (
acos
,, (
_Mdoub_
 
__x
));

57 
__MATHCALL
 (
as
,, (
_Mdoub_
 
__x
));

59 
__MATHCALL
 (

,, (
_Mdoub_
 
__x
));

61 
__MATHCALL
 (
2
,, (
_Mdoub_
 
__y
, _Mdoub_ 
__x
));

64 
__MATHCALL
 (
cos
,, (
_Mdoub_
 
__x
));

66 
__MATHCALL
 (
s
,, (
_Mdoub_
 
__x
));

68 
__MATHCALL
 (
n
,, (
_Mdoub_
 
__x
));

73 
__MATHCALL
 (
cosh
,, (
_Mdoub_
 
__x
));

75 
__MATHCALL
 (
sh
,, (
_Mdoub_
 
__x
));

77 
__MATHCALL
 (
nh
,, (
_Mdoub_
 
__x
));

78 
	g_Mdoub_END_NAMESPACE


80 #ifde
__USE_GNU


82 
__MATHDECL
 (,
scos
,,

83 (
_Mdoub_
 
__x
, _Mdoub_ *
__sx
, _Mdoub_ *
__cosx
));

86 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN_EXTENDED
 || defed 
__USE_ISOC99


87 
__BEGIN_NAMESPACE_C99


89 
__MATHCALL
 (
acosh
,, (
_Mdoub_
 
__x
));

91 
__MATHCALL
 (
ash
,, (
_Mdoub_
 
__x
));

93 
__MATHCALL
 (
h
,, (
_Mdoub_
 
__x
));

94 
	g__END_NAMESPACE_C99


99 
_Mdoub_BEGIN_NAMESPACE


101 
__MATHCALL
 (
exp
,, (
_Mdoub_
 
__x
));

104 
__MATHCALL
 (
exp
,, (
_Mdoub_
 
__x
, *
__expڒt
));

107 
__MATHCALL
 (
ldexp
,, (
_Mdoub_
 
__x
, 
__expڒt
));

110 
__MATHCALL
 (
log
,, (
_Mdoub_
 
__x
));

113 
__MATHCALL
 (
log10
,, (
_Mdoub_
 
__x
));

116 
__MATHCALL
 (
modf
,, (
_Mdoub_
 
__x
, _Mdoub_ *
__
));

117 
	g_Mdoub_END_NAMESPACE


119 #ifde
__USE_GNU


121 
__MATHCALL
 (
exp10
,, (
_Mdoub_
 
__x
));

123 
__MATHCALL
 (
pow10
,, (
_Mdoub_
 
__x
));

126 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN_EXTENDED
 || defed 
__USE_ISOC99


127 
__BEGIN_NAMESPACE_C99


129 
__MATHCALL
 (
expm1
,, (
_Mdoub_
 
__x
));

132 
__MATHCALL
 (
log1p
,, (
_Mdoub_
 
__x
));

135 
__MATHCALL
 (
logb
,, (
_Mdoub_
 
__x
));

136 
	g__END_NAMESPACE_C99


139 #ifde
__USE_ISOC99


140 
__BEGIN_NAMESPACE_C99


142 
__MATHCALL
 (
exp2
,, (
_Mdoub_
 
__x
));

145 
__MATHCALL
 (
log2
,, (
_Mdoub_
 
__x
));

146 
	g__END_NAMESPACE_C99


152 
_Mdoub_BEGIN_NAMESPACE


154 
__MATHCALL
 (
pow
,, (
_Mdoub_
 
__x
, _Mdoub_ 
__y
));

157 
__MATHCALL
 (
sq
,, (
_Mdoub_
 
__x
));

158 
	g_Mdoub_END_NAMESPACE


160 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN
 || defed 
__USE_ISOC99


161 
__BEGIN_NAMESPACE_C99


163 
__MATHCALL
 (
hyp
,, (
_Mdoub_
 
__x
, _Mdoub_ 
__y
));

164 
	g__END_NAMESPACE_C99


167 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN_EXTENDED
 || defed 
__USE_ISOC99


168 
__BEGIN_NAMESPACE_C99


170 
__MATHCALL
 (
cb
,, (
_Mdoub_
 
__x
));

171 
	g__END_NAMESPACE_C99


177 
_Mdoub_BEGIN_NAMESPACE


179 
__MATHCALLX
 (

,, (
_Mdoub_
 
__x
), (
__cڡ__
));

182 
__MATHCALLX
 (
bs
,, (
_Mdoub_
 
__x
), (
__cڡ__
));

185 
__MATHCALLX
 (
o
,, (
_Mdoub_
 
__x
), (
__cڡ__
));

188 
__MATHCALL
 (
fmod
,, (
_Mdoub_
 
__x
, _Mdoub_ 
__y
));

193 
__MATHDECL_1
 (,
__isf
,, (
_Mdoub_
 
__vue
)
__ibu__
 ((
__cڡ__
));

196 
__MATHDECL_1
 (,
__fe
,, (
_Mdoub_
 
__vue
)
__ibu__
 ((
__cڡ__
));

197 
	g_Mdoub_END_NAMESPACE


199 #ifde
__USE_MISC


202 
__MATHDECL_1
 (,
isf
,, (
_Mdoub_
 
__vue
)
__ibu__
 ((
__cڡ__
));

205 
__MATHDECL_1
 (,
fe
,, (
_Mdoub_
 
__vue
)
__ibu__
 ((
__cڡ__
));

208 
__MATHCALL
 (
dm
,, (
_Mdoub_
 
__x
, _Mdoub_ 
__y
));

212 
__MATHCALL
 (
signifind
,, (
_Mdoub_
 
__x
));

215 #i
defed
 
__USE_MISC
 || defed 
__USE_ISOC99


216 
__BEGIN_NAMESPACE_C99


218 
__MATHCALLX
 (
cysign
,, (
_Mdoub_
 
__x
, _Mdoub_ 
__y
), (
__cڡ__
));

219 
	g__END_NAMESPACE_C99


222 #ifde
__USE_ISOC99


223 
__BEGIN_NAMESPACE_C99


225 
__MATHCALLX
 (
n
,, (
__cڡ
 *
__gb
), (
__cڡ__
));

226 
	g__END_NAMESPACE_C99


231 
__MATHDECL_1
 (,
__i
,, (
_Mdoub_
 
__vue
)
__ibu__
 ((
__cڡ__
));

233 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN


235 
__MATHDECL_1
 (,
i
,, (
_Mdoub_
 
__vue
)
__ibu__
 ((
__cڡ__
));

238 
__MATHCALL
 (
j0
,, (
_Mdoub_
));

239 
__MATHCALL
 (
j1
,, (
_Mdoub_
));

240 
__MATHCALL
 (
jn
,, (, 
_Mdoub_
));

241 
__MATHCALL
 (
y0
,, (
_Mdoub_
));

242 
__MATHCALL
 (
y1
,, (
_Mdoub_
));

243 
__MATHCALL
 (
yn
,, (, 
_Mdoub_
));

247 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN
 || defed 
__USE_ISOC99


248 
__BEGIN_NAMESPACE_C99


250 
__MATHCALL
 (
f
,, (
_Mdoub_
));

251 
__MATHCALL
 (
fc
,, (
_Mdoub_
));

252 
__MATHCALL
 (
lgamma
,, (
_Mdoub_
));

253 
	g__END_NAMESPACE_C99


256 #ifde
__USE_ISOC99


257 
__BEGIN_NAMESPACE_C99


259 
__MATHCALL
 (
tgamma
,, (
_Mdoub_
));

260 
	g__END_NAMESPACE_C99


263 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN


265 
__MATHCALL
 (
gamma
,, (
_Mdoub_
));

268 #ifde
__USE_MISC


272 
__MATHCALL
 (
lgamma
,
_r
, (
_Mdoub_
, *
__signgamp
));

276 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN_EXTENDED
 || defed 
__USE_ISOC99


277 
__BEGIN_NAMESPACE_C99


280 
__MATHCALL
 (
rt
,, (
_Mdoub_
 
__x
));

283 
__MATHCALLX
 (
x
,, (
_Mdoub_
 
__x
, _Mdoub_ 
__y
), (
__cڡ__
));

284 #ifde
__USE_ISOC99


285 
__MATHCALLX
 (
xowd
,, (
_Mdoub_
 
__x
, 
__y
), (
__cڡ__
));

289 
__MATHCALL
 (
mad
,, (
_Mdoub_
 
__x
, _Mdoub_ 
__y
));

291 #i
defed
 
__USE_MISC
 || defed 
__USE_ISOC99


293 
__MATHCALL
 (
slbn
,, (
_Mdoub_
 
__x
, 
__n
));

297 
__MATHDECL
 (,
ogb
,, (
_Mdoub_
 
__x
));

300 #ifde
__USE_ISOC99


302 
__MATHCALL
 (
slb
,, (
_Mdoub_
 
__x
, 
__n
));

306 
__MATHCALL
 (
ìbyt
,, (
_Mdoub_
 
__x
));

310 
__MATHCALLX
 (
round
,, (
_Mdoub_
 
__x
), (
__cڡ__
));

314 
__MATHCALLX
 (
unc
,, (
_Mdoub_
 
__x
), (
__cڡ__
));

319 
__MATHCALL
 (
mquo
,, (
_Mdoub_
 
__x
, _Mdoub_ 
__y
, *
__quo
));

326 
__MATHDECL
 (,
̚t
,, (
_Mdoub_
 
__x
));

327 
__MATHDECL
 (,
rt
,, (
_Mdoub_
 
__x
));

331 
__MATHDECL
 (,
ound
,, (
_Mdoub_
 
__x
));

332 
__MATHDECL
 (,
round
,, (
_Mdoub_
 
__x
));

336 
__MATHCALL
 (
fdim
,, (
_Mdoub_
 
__x
, _Mdoub_ 
__y
));

339 
__MATHCALL
 (
fmax
,, (
_Mdoub_
 
__x
, _Mdoub_ 
__y
));

342 
__MATHCALL
 (
fm
,, (
_Mdoub_
 
__x
, _Mdoub_ 
__y
));

346 
__MATHDECL_1
 (, 
__assify
,, (
_Mdoub_
 
__vue
))

347 
__ibu__
 ((
__cڡ__
));

350 
__MATHDECL_1
 (, 
__signb
,, (
_Mdoub_
 
__vue
))

351 
__ibu__
 ((
__cڡ__
));

355 
__MATHCALL
 (
fma
,, (
_Mdoub_
 
__x
, _Mdoub_ 
__y
, _Mdoub_ 
__z
));

356 
	g__END_NAMESPACE_C99


358 #i
defed
 
__USE_MISC
 || defed 
__USE_XOPEN_EXTENDED


360 
__MATHCALL
 (
slb
,, (
_Mdoub_
 
__x
, _Mdoub_ 
__n
));

	@/usr/include/bits/mathdef.h

19 #i!
defed
 
_MATH_H
 && !defed 
_COMPLEX_H


23 #i
defed
 
__USE_ISOC99
 && defed 
_MATH_H
 && !defed 
_MATH_H_MATHDEF


24 
	#_MATH_H_MATHDEF
 1

	)

29 
	tt_t
;

31 
	tdoub_t
;

35 
	#INFINITY
 
HUGE_VALF


	)

38 
	#FP_ILOGB0
 (-2147483647 - 1)

	)

39 
	#FP_ILOGBNAN
 (-2147483647 - 1)

	)

	@/usr/include/bits/mathinline.h

21 #ide
_MATH_H


25 #ifde
__lulus


26 
	#__MATH_INLINE
 
__le


	)

28 
	#__MATH_INLINE
 
__le


	)

32 #i
defed
 
__USE_ISOC99
 && defed 
__GNUC__
 && __GNUC__ >= 2

33 #i
__GNUC_PREREQ
 (2,97)

35 
	#isg
(
x
, 
y

	`__but_isg
 (x, y)

	)

36 
	#isgequ
(
x
, 
y

	`__but_isgequ
 (x, y)

	)

37 
	#iess
(
x
, 
y

	`__but_iess
 (x, y)

	)

38 
	#iesqu
(
x
, 
y

	`__but_iesqu
 (x, y)

	)

39 
	#iessg
(
x
, 
y

	`__but_iessg
 (x, y)

	)

40 
	#isunded
(
x
, 
y

	`__but_isunded
 (x, y)

	)

46 #ifde
__i686__


49 
	#isg
(
x
, 
y
) \

50 ({ 
__su
; \

51 
	`__asm__
 ("fucomip %%st(1), %%st; seta %%al" \

52 : "" (
__su
: "u" (
y
), "t" (
x
) : "cc", "st"); \

53 
__su
; })

	)

54 
	#isgequ
(
x
, 
y
) \

55 ({ 
__su
; \

56 
	`__asm__
 ("fucomip %%st(1), %%st; setae %%al" \

57 : "" (
__su
: "u" (
y
), "t" (
x
) : "cc", "st"); \

58 
__su
; })

	)

60 
	#iess
(
x
, 
y
) \

61 ({ 
__su
; \

62 
	`__asm__
 ("fucomip %%st(1), %%st; seta %%al" \

63 : "" (
__su
: "u" (
x
), "t" (
y
) : "cc", "st"); \

64 
__su
; })

	)

66 
	#iesqu
(
x
, 
y
) \

67 ({ 
__su
; \

68 
	`__asm__
 ("fucomip %%st(1), %%st; setae %%al" \

69 : "" (
__su
: "u" (
x
), "t" (
y
) : "cc", "st"); \

70 
__su
; })

	)

72 
	#iessg
(
x
, 
y
) \

73 ({ 
__su
; \

74 
	`__asm__
 ("fucomip %%st(1), %%st; setne %%al" \

75 : "" (
__su
: "u" (
y
), "t" (
x
) : "cc", "st"); \

76 
__su
; })

	)

78 
	#isunded
(
x
, 
y
) \

79 ({ 
__su
; \

80 
	`__asm__
 ("fucomip %%st(1), %%st; setp %%al" \

81 : "" (
__su
: "u" (
y
), "t" (
x
) : "cc", "st"); \

82 
__su
; })

	)

85 
	#isg
(
x
, 
y
) \

86 ({ 
__su
; \

87 
	`__asm__
 ("fucompp; fnstsw;estb $0x45, %%ah; setz %%al" \

88 : "" (
__su
: "u" (
y
), "t" (
x
) : "cc", "st", "st(1)"); \

89 
__su
; })

	)

91 
	#isgequ
(
x
, 
y
) \

92 ({ 
__su
; \

93 
	`__asm__
 ("fucompp; fnstsw;estb $0x05, %%ah; setz %%al" \

94 : "" (
__su
: "u" (
y
), "t" (
x
) : "cc", "st", "st(1)"); \

95 
__su
; })

	)

97 
	#iess
(
x
, 
y
) \

98 ({ 
__su
; \

99 
	`__asm__
 ("fucompp; fnstsw;estb $0x45, %%ah; setz %%al" \

100 : "" (
__su
: "u" (
x
), "t" (
y
) : "cc", "st", "st(1)"); \

101 
__su
; })

	)

103 
	#iesqu
(
x
, 
y
) \

104 ({ 
__su
; \

105 
	`__asm__
 ("fucompp; fnstsw;estb $0x05, %%ah; setz %%al" \

106 : "" (
__su
: "u" (
x
), "t" (
y
) : "cc", "st", "st(1)"); \

107 
__su
; })

	)

109 
	#iessg
(
x
, 
y
) \

110 ({ 
__su
; \

111 
	`__asm__
 ("fucompp; fnstsw;estb $0x44, %%ah; setz %%al" \

112 : "" (
__su
: "u" (
y
), "t" (
x
) : "cc", "st", "st(1)"); \

113 
__su
; })

	)

115 
	#isunded
(
x
, 
y
) \

116 ({ 
__su
; \

117 
	`__asm__
 ("fucompp; fnstsw; sahf; setp %%al" \

118 : "" (
__su
: "u" (
y
), "t" (
x
) : "cc", "st", "st(1)"); \

119 
__su
; })

	)

125 #i
__GNUC_PREREQ
 (2, 8)

127 
__MATH_INLINE
 

128 
	$__signbf
 (
__x

__THROW


130 
__exnsi__
 uni { 
__f
; 
__i
; } 
__u
 = { __f: 
__x
 };

131  
__u
.
__i
 < 0;

132 
	}
}

133 
__MATH_INLINE
 

134 
	$__signb
 (
__x

__THROW


136 
__exnsi__
 uni { 
__d
; 
__i
[2]; } 
__u
 = { __d: 
__x
 };

137  
__u
.
__i
[1] < 0;

138 
	}
}

139 
__MATH_INLINE
 

140 
	$__signbl
 (
__x

__THROW


142 
__exnsi__
 uni { 
__l
; 
__i
[3]; } 
__u
 = { __l: 
__x
 };

143  (
__u
.
__i
[2] & 0x8000) != 0;

144 
	}
}

151 #i
__GNUC_PREREQ
 (2, 8)

153 #i((!
defed
 
__NO_MATH_INLINES
 || defed 
__LIBC_INTERNAL_MATH_INLINES
) \

154 && 
defed
 
__OPTIMIZE__
)

163 #i
defed
 
__USE_MISC
 || defed 
__USE_ISOC99


164 
	#__le_mh
(
func
, 

) \

165 
	`__le_mh_
 (, 
func
, 

) \

166 
	`__le_mh_
 (, 
	`__CONCAT
(
func
,
f
), 

) \

167 
	`__le_mh_
 (, 
	`__CONCAT
(
func
,
l
), 

)

	)

168 
	#__le_mhNP
(
func
, 

) \

169 
	`__le_mhNP_
 (, 
func
, 

) \

170 
	`__le_mhNP_
 (, 
	`__CONCAT
(
func
,
f
), 

) \

171 
	`__le_mhNP_
 (, 
	`__CONCAT
(
func
,
l
), 

)

	)

173 
	#__le_mh
(
func
, 

) \

174 
	`__le_mh_
 (, 
func
, 

)

	)

175 
	#__le_mhNP
(
func
, 

) \

176 
	`__le_mhNP_
 (, 
func
, 

)

	)

179 
	#__le_mh_
(
t_ty
, 
func
, 

) \

180 
	`__le_mh_de_
 (
t_ty
, 
func
, 

, "0" (
__x
))

	)

181 
	#__le_mhNP_
(
t_ty
, 
func
, 

) \

182 
	`__le_mh_deNP_
 (
t_ty
, 
func
, 

, "0" (
__x
))

	)

185 #i
defed
 
__USE_MISC
 || defed 
__USE_ISOC99


186 
	#__le_mh_de
(
func
, 

, 
ms
...) \

187 
	`__le_mh_de_
 (, 
func
, 

, 
ms
) \

188 
	`__le_mh_de_
 (, 
	`__CONCAT
(
func
,
f
), 

, 
ms
) \

189 
	`__le_mh_de_
 (, 
	`__CONCAT
(
func
,
l
), 

, 
ms
)

	)

190 
	#__le_mh_deNP
(
func
, 

, 
ms
...) \

191 
	`__le_mh_deNP_
 (, 
func
, 

, 
ms
) \

192 
	`__le_mh_deNP_
 (, 
	`__CONCAT
(
func
,
f
), 

, 
ms
) \

193 
	`__le_mh_deNP_
 (, 
	`__CONCAT
(
func
,
l
), 

, 
ms
)

	)

195 
	#__le_mh_de
(
func
, 

, 
ms
...) \

196 
	`__le_mh_de_
 (, 
func
, 

, 
ms
)

	)

197 
	#__le_mh_deNP
(
func
, 

, 
ms
...) \

198 
	`__le_mh_deNP_
 (, 
func
, 

, 
ms
)

	)

201 
	#__le_mh_de_
(
t_ty
, 
func
, 

, 
ms
...) \

202 
__MATH_INLINE
 
t_ty
 
	`func
 (t_ty
__THROW
; \

203 
	`__le_mh_deNP_
 (
t_ty
, 
func
, 

, 
ms
)

	)

205 
	#__le_mh_deNP_
(
t_ty
, 
func
, 

, 
ms
...) \

206 
__MATH_INLINE
 
t_ty
 
	`func
 (t_ty 
__x

__THROW
 \

208 
t_ty
 
__su
; \

209 
__asm
 
	`__vީe__
 (

 : "" (
__su
: 
ms
); \

210  
__su
; \

211 }

	)

214 #i
defed
 
__USE_MISC
 || defed 
__USE_ISOC99


215 
	#__le_mhcode
(
func
, 
g
, 
code
) \

216 
	`__le_mhcode_
 (, 
func
, 
g
, 
code
) \

217 
	`__le_mhcode_
 (, 
	`__CONCAT
(
func
,
f
), 
g
, 
code
) \

218 
	`__le_mhcode_
 (, 
	`__CONCAT
(
func
,
l
), 
g
, 
code
)

	)

219 
	#__le_mhcodeNP
(
func
, 
g
, 
code
) \

220 
	`__le_mhcodeNP_
 (, 
func
, 
g
, 
code
) \

221 
	`__le_mhcodeNP_
 (, 
	`__CONCAT
(
func
,
f
), 
g
, 
code
) \

222 
	`__le_mhcodeNP_
 (, 
	`__CONCAT
(
func
,
l
), 
g
, 
code
)

	)

223 
	#__le_mhcode2
(
func
, 
g1
, 
g2
, 
code
) \

224 
	`__le_mhcode2_
 (, 
func
, 
g1
, 
g2
, 
code
) \

225 
	`__le_mhcode2_
 (, 
	`__CONCAT
(
func
,
f
), 
g1
, 
g2
, 
code
) \

226 
	`__le_mhcode2_
 (, 
	`__CONCAT
(
func
,
l
), 
g1
, 
g2
, 
code
)

	)

227 
	#__le_mhcodeNP2
(
func
, 
g1
, 
g2
, 
code
) \

228 
	`__le_mhcodeNP2_
 (, 
func
, 
g1
, 
g2
, 
code
) \

229 
	`__le_mhcodeNP2_
 (, 
	`__CONCAT
(
func
,
f
), 
g1
, 
g2
, 
code
) \

230 
	`__le_mhcodeNP2_
 (, 
	`__CONCAT
(
func
,
l
), 
g1
, 
g2
, 
code
)

	)

231 
	#__le_mhcode3
(
func
, 
g1
, 
g2
, 
g3
, 
code
) \

232 
	`__le_mhcode3_
 (, 
func
, 
g1
, 
g2
, 
g3
, 
code
) \

233 
	`__le_mhcode3_
 (, 
	`__CONCAT
(
func
,
f
), 
g1
, 
g2
, 
g3
, 
code
) \

234 
	`__le_mhcode3_
 (, 
	`__CONCAT
(
func
,
l
), 
g1
, 
g2
, 
g3
, 
code
)

	)

235 
	#__le_mhcodeNP3
(
func
, 
g1
, 
g2
, 
g3
, 
code
) \

236 
	`__le_mhcodeNP3_
 (, 
func
, 
g1
, 
g2
, 
g3
, 
code
) \

237 
	`__le_mhcodeNP3_
 (, 
	`__CONCAT
(
func
,
f
), 
g1
, 
g2
, 
g3
, 
code
) \

238 
	`__le_mhcodeNP3_
 (, 
	`__CONCAT
(
func
,
l
), 
g1
, 
g2
, 
g3
, 
code
)

	)

240 
	#__le_mhcode
(
func
, 
g
, 
code
) \

241 
	`__le_mhcode_
 (, 
func
, (
g
), 
code
)

	)

242 
	#__le_mhcodeNP
(
func
, 
g
, 
code
) \

243 
	`__le_mhcodeNP_
 (, 
func
, (
g
), 
code
)

	)

244 
	#__le_mhcode2
(
func
, 
g1
, 
g2
, 
code
) \

245 
	`__le_mhcode2_
 (, 
func
, 
g1
, 
g2
, 
code
)

	)

246 
	#__le_mhcodeNP2
(
func
, 
g1
, 
g2
, 
code
) \

247 
	`__le_mhcodeNP2_
 (, 
func
, 
g1
, 
g2
, 
code
)

	)

248 
	#__le_mhcode3
(
func
, 
g1
, 
g2
, 
g3
, 
code
) \

249 
	`__le_mhcode3_
 (, 
func
, 
g1
, 
g2
, 
g3
, 
code
)

	)

250 
	#__le_mhcodeNP3
(
func
, 
g1
, 
g2
, 
g3
, 
code
) \

251 
	`__le_mhcodeNP3_
 (, 
func
, 
g1
, 
g2
, 
g3
, 
code
)

	)

254 
	#__le_mhcode_
(
t_ty
, 
func
, 
g
, 
code
) \

255 
__MATH_INLINE
 
t_ty
 
	`func
 (t_ty
__THROW
; \

256 
	`__le_mhcodeNP_
(
t_ty
, 
func
, 
g
, 
code
)

	)

258 
	#__le_mhcodeNP_
(
t_ty
, 
func
, 
g
, 
code
) \

259 
__MATH_INLINE
 
t_ty
 
	`func
 (t_ty 
g

__THROW
 \

261 
code
; \

262 }

	)

265 
	#__le_mhcode2_
(
t_ty
, 
func
, 
g1
, 
g2
, 
code
) \

266 
__MATH_INLINE
 
t_ty
 
	`func
 (t_ty, flt_ty
__THROW
; \

267 
	`__le_mhcodeNP2_
 (
t_ty
, 
func
, 
g1
, 
g2
, 
code
)

	)

269 
	#__le_mhcodeNP2_
(
t_ty
, 
func
, 
g1
, 
g2
, 
code
) \

270 
__MATH_INLINE
 
t_ty
 
	`func
 (t_ty 
g1
, flt_ty 
g2

__THROW
 \

272 
code
; \

273 }

	)

275 
	#__le_mhcode3_
(
t_ty
, 
func
, 
g1
, 
g2
, 
g3
, 
code
) \

276 
__MATH_INLINE
 
t_ty
 
	`func
 (t_ty, flt_ty, flt_ty
__THROW
; \

277 
	`__le_mhcodeNP3_
(
t_ty
, 
func
, 
g1
, 
g2
, 
g3
, 
code
)

	)

279 
	#__le_mhcodeNP3_
(
t_ty
, 
func
, 
g1
, 
g2
, 
g3
, 
code
) \

280 
__MATH_INLINE
 
t_ty
 
	`func
 (t_ty 
g1
, flt_ty 
g2
, \

281 
t_ty
 
g3

__THROW
 \

283 
code
; \

284 }

	)

288 #i!
defed
 
__NO_MATH_INLINES
 && defed 
__OPTIMIZE__


291 
__le_mhcode
 (
__sgn
, 
__x
, \

292  
__x
 == 0.0 ? 0.0 : (__x > 0.0 ? 1.0 : -1.0))

295 #ifde
__FAST_MATH__


296 
__le_mhcode
 (
__pow2
, 
__x
, \

297 
__vue
; \

298 
__expڒt
; \

299 
__exnsi__
 
__p
 = (
__x
; \

300 i(
__x
 =(
__p
) \

302 
__asm
 
__vީe__
 \

304 : "" (
__vue
: "0" (1.0), "u" (
__x
)); \

305  
__vue
; \

307 
__asm
 
__vީe__
 \

313 : "" (
__vue
), "=u" (
__expڒt
: "0" (
__x
)); \

314 
__vue
 += 1.0; \

315 
__asm
 
__vީe__
 \

317 : "" (
__vue
: "0" (__vue), "u" (
__expڒt
)); \

318  
__vue
)

320 #ifde
__USE_GNU


321 
	#__scos_code
 \

322 
__co
; \

323 
__sr
; \

324 
__asm
 
__vީe__
 \

339 : "" (
__co
), "=u" (
__sr
: "0" (
__x
)); \

340 *
__sx
 = 
__sr
; \

341 *
__cosx
 = 
__co


	)

343 
__MATH_INLINE
 

344 
	$__scos
 (
__x
, *
__sx
, *
__cosx

__THROW


346 
__scos_code
;

347 
	}
}

349 
__MATH_INLINE
 

350 
	$__scosf
 (
__x
, *
__sx
, *
__cosx

__THROW


352 
__scos_code
;

353 
	}
}

355 
__MATH_INLINE
 

356 
	$__sco
 (
__x
, *
__sx
, *
__cosx

__THROW


358 
__scos_code
;

359 
	}
}

366 
	#__expm1_code
 \

367 
__vue
; \

368 
__expڒt
; \

369 
__mp
; \

370 
__asm
 
__vީe__
 \

379 : "" (
__vue
), "=u" (
__expڒt
: "0" (
__x
)); \

380 
__asm
 
__vީe__
 \

382 : "" (
__mp
: "0" (1.0), "u" (
__expڒt
)); \

383 
__mp
 -= 1.0; \

384  
__mp
 + 
__vue
 ?: 
__x


	)

385 
	$__le_mhcodeNP_
 (, 
__expm1l
, 
__x
, 
__expm1_code
)

388 
	#__exp_code
 \

389 
__vue
; \

390 
__expڒt
; \

391 
__asm
 
__vީe__
 \

399 : "" (
__vue
), "=u" (
__expڒt
: "0" (
__x
)); \

400 
__vue
 += 1.0; \

401 
__asm
 
__vީe__
 \

403 : "" (
__vue
: "0" (__vue), "u" (
__expڒt
)); \

404  
__vue


	)

405 
	$__le_mhcodeNP
 (
exp
, 
__x
, 
__exp_code
)

406 
	$__le_mhcodeNP_
 (, 
__ex
, 
__x
, 
__exp_code
)

409 
	`__le_mhcodeNP
 (
n
, 
__x
, \

410 
__vue
; \

411 
__vue2
 
	`__ibu__
 ((
__unud__
)); \

412 
__asm
 
__vީe__
 \

414 : "" (
__vue2
), "=u" (
__vue
: "0" (
__x
)); \

415  
__vue
)

419 
	#__2_code
 \

420 
__vue
; \

421 
__asm
 
__vީe__
 \

423 : "" (
__vue
: "0" (
__x
), "u" (
__y
) : "st(1)"); \

424  
__vue


	)

425 
	$__le_mhcodeNP2
 (
2
, 
__y
, 
__x
, 
__2_code
)

426 
	$__le_mhcodeNP2_
 (, 
__2l
, 
__y
, 
__x
, 
__2_code
)

429 
	`__le_mhcodeNP2
 (
fmod
, 
__x
, 
__y
, \

430 
__vue
; \

431 
__asm
 
__vީe__
 \

436 : "" (
__vue
: "0" (
__x
), "u" (
__y
) : "ax", "cc"); \

437  
__vue
)

440 #ifde
__FAST_MATH__


441 
	`__le_mhNP
 (
sq
, "fsqrt")

442 
	`__le_mhNP_
 (, 
__sql
, "fsqrt")

445 #i
	`__GNUC_PREREQ
 (2, 8)

446 
	`__le_mhcodeNP_
 (, 
bs
, 
__x
,  
	$__but_bs
 (
__x
))

447 
	`__le_mhcodeNP_
 (, 
bsf
, 
__x
,  
	$__but_bsf
 (
__x
))

448 
	`__le_mhcodeNP_
 (, 
b
, 
__x
,  
	$__but_b
 (
__x
))

449 
	`__le_mhcodeNP_
 (, 
__b
, 
__x
,  
	$__but_b
 (
__x
))

451 
	`__le_mh
 (
bs
, "fabs")

452 
	`__le_mh_
 (, 
__b
, "fabs")

455 #ifde
__FAST_MATH__


457 
	`__le_mhNP
 (
s
, "fsin")

459 
	`__le_mhNP
 (
cos
, "fcos")

461 
	`__le_mh_deNP
 (
log
, "d2; fxch; fyl2x", "0" (
__x
) : "st(1)")

462 
	`__le_mh_deNP
 (
log10
, "dlg2; fxch; fyl2x", "0" (
__x
) : "st(1)")

464 
	`__le_mhcodeNP
 (
as
, 
__x
,  
	`__2l
 (__x, 
	`__sql
 (1.0 - __x * __x)))

465 
	`__le_mhcodeNP
 (
acos
, 
__x
,  
	`__2l
 (
	`__sql
 (1.0 - __x * __x), __x))

468 
	`__le_mh_deNP
 (

, "d1; fn", "0" (
__x
) : "st(1)")

470 
	`__le_mhcode_
 (, 
__sgn1l
, 
__x
, \

471 
__exnsi__
 uni { 
__xld
; 
__xi
[3]; } 
__n
 = \

472 { 
__xld
: 
__x
 
	}
}; \

473 
	g__n
.
	g__xi
[2] = (
__n
.
__xi
[2] & 0x8000) | 0x3fff; \

474 
	g__n
.
	g__xi
[1] = 0x80000000; \

475 
	g__n
.
	g__xi
[0] = 0; \

476  
	g__n
.
	g__xld
)

479 #ifde
__FAST_MATH__


481 
__le_mhcodeNP
 (
sh
, 
__x
, \

482 
__exm1
 = 
__expm1l
 (
__b
 (
__x
)); \

483  0.5 * (
__exm1
 / (__exm1 + 1.0+ __exm1* 
	$__sgn1l
 (
__x
))

485 
	`__le_mhcodeNP
 (
cosh
, 
__x
, \

486 
__ex
 = 
	`__ex
 (
__x
); \

487  0.5 * (
__ex
 + 1.0 / __ex))

489 
	`__le_mhcodeNP
 (
nh
, 
__x
, \

490 
__exm1
 = 
	`__expm1l
 (-
	`__b
 (
__x
 + __x)); \

491  
__exm1
 / (__exm1 + 2.0* 
	`__sgn1l
 (-
__x
))

494 
	`__le_mhcodeNP
 (
o
, 
__x
, \

495 
__vue
; \

496 
__vީe
 
__cw
; \

497 
__vީe
 
__cwtmp
; \

498 
__asm
 
	`__vީe
 ("cw %0" : "=m" (
__cw
)); \

499 
__cwtmp
 = (
__cw
 & 0xf3ff) | 0x0400; \

500 
__asm
 
	`__vީe
 ("dcw %0" : : "m" (
__cwtmp
)); \

501 
__asm
 
	`__vީe
 ("ndt" : "" (
__vue
: "0" (
__x
)); \

502 
__asm
 
	`__vީe
 ("dcw %0" : : "m" (
__cw
)); \

503  
__vue
)

505 
	`__le_mhcodeNP
 (

, 
__x
, \

506 
__vue
; \

507 
__vީe
 
__cw
; \

508 
__vީe
 
__cwtmp
; \

509 
__asm
 
	`__vީe
 ("cw %0" : "=m" (
__cw
)); \

510 
__cwtmp
 = (
__cw
 & 0xf3ff) | 0x0800; \

511 
__asm
 
	`__vީe
 ("dcw %0" : : "m" (
__cwtmp
)); \

512 
__asm
 
	`__vީe
 ("ndt" : "" (
__vue
: "0" (
__x
)); \

513 
__asm
 
	`__vީe
 ("dcw %0" : : "m" (
__cw
)); \

514  
__vue
)

516 #ifde
__FAST_MATH__


517 
	#__ldexp_code
 \

518 
__vue
; \

519 
__asm
 
__vީe__
 \

521 : "" (
__vue
: "0" (
__x
), "u" ((
__y
)); \

522  
__vue


	)

524 
__MATH_INLINE
 

525 
	$ldexp
 (
__x
, 
__y

__THROW


527 
__ldexp_code
;

528 
	}
}

533 #i
defed
 
__USE_ISOC99
 || defed 
__USE_MISC


535 #ifde
__FAST_MATH__


536 
	$__le_mhcodeNP
 (
expm1
, 
__x
, 
__expm1_code
)

540 
	#__M_SQRT2
 1.41421356237309504880L

	)

542 
	`__le_mhcodeNP
 (
log1p
, 
__x
, \

543 
__vue
; \

544 i(
	`__b
 (
__x
>1.0 - 0.5 * 
__M_SQRT2
) \

545 
__vue
 = 
	`logl
 (1.0 + 
__x
); \

547 
__asm
 
__vީe__
 \

551 : "" (
__vue
: "0" (
__x
) : "st(1)"); \

552  
__vue
)

556 
	`__le_mhcodeNP
 (
ash
, 
__x
, \

557 
__y
 = 
	`__b
 (
__x
); \

558  (
	`log1
 (
__y
 * __y / (
	`__sql
 (__y * __y + 1.0) + 1.0) + __y) \

559 * 
	$__sgn1l
 (
__x
)))

561 
	`__le_mhcodeNP
 (
acosh
, 
__x
, \

562  
	`logl
 (
__x
 + 
	`__sql
 (__x - 1.0) * __sqrtl (__x + 1.0)))

564 
	`__le_mhcodeNP
 (
h
, 
__x
, \

565 
__y
 = 
	`__b
 (
__x
); \

566  -0.5 * 
	`log1
 (-(
__y
 + __y/ (1.0 + __y)* 
	$__sgn1l
 (
__x
))

569 
	`__le_mhcodeNP2
 (
hyp
, 
__x
, 
__y
,  
	`__sql
 (__x * __x + __y * __y))

571 
	`__le_mhcodeNP
(
logb
, 
__x
, \

572 
__vue
; \

573 
__junk
; \

574 
__asm
 
__vީe__
 \

576 : "" (
__junk
), "=u" (
__vue
: "0" (
__x
)); \

577  
__vue
)

582 #ifde
__USE_ISOC99


583 #ifde
__FAST_MATH__


584 
	`__le_mh_deNP
 (
log2
, "d1; fxch; fyl2x", "0" (
__x
) : "st(1)")

586 
__MATH_INLINE
 

587 
	$ldexpf
 (
__x
, 
__y

__THROW


589 
__ldexp_code
;

590 
	}
}

592 
__MATH_INLINE
 

593 
	$ldex
 (
__x
, 
__y

__THROW


595 
__ldexp_code
;

596 
	}
}

598 
__le_mhcodeNP3
 (
fma
, 
__x
, 
__y
, 
__z
,  (__x * __y) + __z)

600 
__le_mhNP
 (
rt
, "frndint")

603 
	#__̚t_code
 \

604 
__̚es
; \

605 
__asm__
 
__vީe__
 \

607 : "=m" (
__̚es
: "t" (
__x
) : "st"); \

608  
__̚es


	)

609 
__MATH_INLINE
 

610 
	$̚tf
 (
__x

__THROW


612 
__̚t_code
;

613 
	}
}

614 
__MATH_INLINE
 

615 
	$̚t
 (
__x

__THROW


617 
__̚t_code
;

618 
	}
}

619 
__MATH_INLINE
 

620 
	$̚
 (
__x

__THROW


622 
__̚t_code
;

623 
	}
}

624 #unde
__̚t_code


626 
	#__rt_code
 \

627 
__res
; \

628 
__asm__
 
__vީe__
 \

630 : "=m" (
__res
: "t" (
__x
) : "st"); \

631  
__res


	)

632 
__MATH_INLINE
 

633 
	$rtf
 (
__x

__THROW


635 
__rt_code
;

636 
	}
}

637 
__MATH_INLINE
 

638 
	$rt
 (
__x

__THROW


640 
__rt_code
;

641 
	}
}

642 
__MATH_INLINE
 

643 
	$r
 (
__x

__THROW


645 
__rt_code
;

646 
	}
}

647 #unde
__rt_code


652 #ifde
__USE_MISC


654 
__le_mhcodeNP2
 (
dm
, 
__x
, 
__y
, \

655 
__vue
; \

656 
__obbed
; \

657 
__asm
 
__vީe__
 \

662 : "" (
__vue
), "=&a" (
__obbed
: "0" (
__x
), "u" (
__y
) : "cc"); \

663  
__vue
)

667 
__MATH_INLINE
 

668 
	$__fe
 (
__x

__THROW


670  (
__exnsi__


671 (((((uni { 
__d
; 
__i
[2]; }{__d: 
__x
}).__i[1]

673 
	}
}

676 #ifde
__FAST_MATH__


677 
__le_mhcode
 (
__coshm1
, 
__x
, \

678 
__exm1
 = 
__expm1l
 (
__b
 (
__x
)); \

679  0.5 * (
__exm1
 / (__exm1 + 1.0)) * __exm1)

681 
__le_mhcode
 (
__acosh1p
, 
__x
, \

682  
log1
 (
__x
 + 
__sql
 (__x) * __sqrtl (__x + 2.0)))

688 #unde
__2_code


689 #ifde
__FAST_MATH__


690 #unde
__expm1_code


691 #unde
__exp_code


692 #unde
__scos_code


699 #ifde
__LIBC_INTERNAL_MATH_INLINES


700 
__le_mh
 (
__754_sq
, "fsqrt")

701 
__le_mhcode2
 (
__754_2
, 
__y
, 
__x
,

702 
__vue
;

703 
__asm
 
__vީe__
 ("fpatan\n\t"

704 : "" (
__vue
)

705 : "0" (
__x
), "u" (
__y
) : "st(1)");

706  
__vue
;)

	@/usr/include/bits/nan.h

20 #ide
_MATH_H


27 #ifdef 
__GNUC__


29 
	#NAN
 \

30 (
__exnsi__
 \

31 ((uni { 
__l
 
	`__ibu__
((
	`__mode__
(
__SI__
))); 
__d
; }) \

32 { 
__l
: 0x7fc00000UL }).
__d
)

	)

36 
	~<dn.h
>

38 #i
__BYTE_ORDER
 =
__BIG_ENDIAN


39 
	#__n_bys
 { 0x7f, 0xc0, 0, 0 }

	)

41 #i
__BYTE_ORDER
 =
__LITTLE_ENDIAN


42 
	#__n_bys
 { 0, 0, 0xc0, 0x7}

	)

45 uni { 
	m__c
[4]; 
	m__d
; } 
	g__n_uni
 = { 
__n_bys
 };

46 
	#NAN
 (
__n_uni
.
__d
)

	)

	@/usr/include/features.h

19 #idef 
_FEATURES_H


20 
	#_FEATURES_H
 1

	)

86 #unde
__USE_ISOC99


87 #unde
__USE_POSIX


88 #unde
__USE_POSIX2


89 #unde
__USE_POSIX199309


90 #unde
__USE_POSIX199506


91 #unde
__USE_XOPEN


92 #unde
__USE_XOPEN_EXTENDED


93 #unde
__USE_UNIX98


94 #unde
__USE_XOPEN2K


95 #unde
__USE_LARGEFILE


96 #unde
__USE_LARGEFILE64


97 #unde
__USE_FILE_OFFSET64


98 #unde
__USE_BSD


99 #unde
__USE_SVID


100 #unde
__USE_MISC


101 #unde
__USE_GNU


102 #unde
__USE_REENTRANT


103 #unde
__FAVOR_BSD


104 #unde
__KERNEL_STRICT_NAMES


108 #ide
_LOOSE_KERNEL_NAMES


109 
	#__KERNEL_STRICT_NAMES


	)

113 
	#__USE_ANSI
 1

	)

117 #i
defed
 
_BSD_SOURCE
 && \

118 !(
defed
 
	g_POSIX_SOURCE
 || defed 
	g_POSIX_C_SOURCE
 || \

119 
defed
 
	g_XOPEN_SOURCE
 || defed 
	g_XOPEN_SOURCE_EXTENDED
 || \

120 
defed
 
	g_GNU_SOURCE
 || defed 
	g_SVID_SOURCE
)

121 
	#__FAVOR_BSD
 1

	)

125 #ifde
_GNU_SOURCE


126 #unde
_ISOC99_SOURCE


127 
	#_ISOC99_SOURCE
 1

	)

128 #unde
_POSIX_SOURCE


129 
	#_POSIX_SOURCE
 1

	)

130 #unde
_POSIX_C_SOURCE


131 
	#_POSIX_C_SOURCE
 199506L

	)

132 #unde
_XOPEN_SOURCE


133 
	#_XOPEN_SOURCE
 600

	)

134 #unde
_XOPEN_SOURCE_EXTENDED


135 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

136 #unde
_LARGEFILE64_SOURCE


137 
	#_LARGEFILE64_SOURCE
 1

	)

138 #unde
_BSD_SOURCE


139 
	#_BSD_SOURCE
 1

	)

140 #unde
_SVID_SOURCE


141 
	#_SVID_SOURCE
 1

	)

146 #i(!
defed
 
__STRICT_ANSI__
 && !defed 
_ISOC99_SOURCE
 && \

147 !
defed
 
	g_POSIX_SOURCE
 && !defed 
	g_POSIX_C_SOURCE
 && \

148 !
defed
 
	g_XOPEN_SOURCE
 && !defed 
	g_XOPEN_SOURCE_EXTENDED
 && \

149 !
defed
 
	g_BSD_SOURCE
 && !defed 
	g_SVID_SOURCE
)

150 
	#_BSD_SOURCE
 1

	)

151 
	#_SVID_SOURCE
 1

	)

158 #i(
defed
 
_ISOC99_SOURCE
 || defed 
_ISOC9X_SOURCE
 \

159 || (
defed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

160 
	#__USE_ISOC99
 1

	)

165 #i(!
defed
 
__STRICT_ANSI__
 && !defed 
_POSIX_SOURCE
 && \

166 !
defed
 
_POSIX_C_SOURCE
)

167 
	#_POSIX_SOURCE
 1

	)

168 #i
defed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

169 
	#_POSIX_C_SOURCE
 2

	)

171 
	#_POSIX_C_SOURCE
 199506L

	)

175 #i
defed
 
_POSIX_SOURCE
 || 
_POSIX_C_SOURCE
 >1 || defed 
_XOPEN_SOURCE


176 
	#__USE_POSIX
 1

	)

179 #i
defed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >2 || defed 
_XOPEN_SOURCE


180 
	#__USE_POSIX2
 1

	)

183 #i(
_POSIX_C_SOURCE
 - 0) >= 199309L

184 
	#__USE_POSIX199309
 1

	)

187 #i(
_POSIX_C_SOURCE
 - 0) >= 199506L

188 
	#__USE_POSIX199506
 1

	)

191 #i(
_POSIX_C_SOURCE
 - 0) >= 200112L

192 
	#__USE_XOPEN2K
 1

	)

195 #ifdef 
_XOPEN_SOURCE


196 
	#__USE_XOPEN
 1

	)

197 #i(
_XOPEN_SOURCE
 - 0) >= 500

198 
	#__USE_XOPEN_EXTENDED
 1

	)

199 
	#__USE_UNIX98
 1

	)

200 #unde
_LARGEFILE_SOURCE


201 
	#_LARGEFILE_SOURCE
 1

	)

202 #i(
_XOPEN_SOURCE
 - 0) >= 600

203 
	#__USE_XOPEN2K
 1

	)

204 #unde
__USE_ISOC99


205 
	#__USE_ISOC99
 1

	)

208 #ifde
_XOPEN_SOURCE_EXTENDED


209 
	#__USE_XOPEN_EXTENDED
 1

	)

214 #ifde
_LARGEFILE_SOURCE


215 
	#__USE_LARGEFILE
 1

	)

218 #ifde
_LARGEFILE64_SOURCE


219 
	#__USE_LARGEFILE64
 1

	)

222 #i
defed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

223 
	#__USE_FILE_OFFSET64
 1

	)

226 #i
defed
 
_BSD_SOURCE
 || defed 
_SVID_SOURCE


227 
	#__USE_MISC
 1

	)

230 #ifdef 
_BSD_SOURCE


231 
	#__USE_BSD
 1

	)

234 #ifdef 
_SVID_SOURCE


235 
	#__USE_SVID
 1

	)

238 #ifdef 
_GNU_SOURCE


239 
	#__USE_GNU
 1

	)

242 #i
defed
 
_REENTRANT
 || defed 
_THREAD_SAFE


243 
	#__USE_REENTRANT
 1

	)

247 
	#__STDC_IEC_559__
 1

	)

248 
	#__STDC_IEC_559_COMPLEX__
 1

	)

251 
	#__STDC_ISO_10646__
 200009L

	)

259 #unde
__GNU_LIBRARY__


260 
	#__GNU_LIBRARY__
 6

	)

264 
	#__GLIBC__
 2

	)

265 
	#__GLIBC_MINOR__
 3

	)

274 #i
defed
 
__GNUC__
 && defed 
__GNUC_MINOR__


275 
	#__GNUC_PREREQ
(
maj
, 
m
) \

276 ((
__GNUC__
 << 16+ 
__GNUC_MINOR__
 >((
maj
<< 16+ (
m
))

	)

278 
	#__GNUC_PREREQ
(
maj
, 
m
0

	)

281 
	#__GLIBC_PREREQ
(
maj
, 
m
) \

282 ((
__GLIBC__
 << 16+ 
__GLIBC_MINOR__
 >((
maj
<< 16+ (
m
))

	)

285 #i
defed
 
__GNUC__
 \

286 || (
defed
 
	g__PGI
 && defed 
	g__i386__
 ) \

287 || (
defed
 
	g__INTEL_COMPILER
 && (defed 
	g__i386__
 || defed 
	g__64__
)) \

288 || (
defed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L)

289 
	#__GLIBC_HAVE_LONG_LONG
 1

	)

293 #ide
__ASSEMBLER__


294 #ide
_SYS_CDEFS_H


295 
	~<sys/cdefs.h
>

300 #i
defed
 
__USE_FILE_OFFSET64
 && !defed 
__REDIRECT


301 
	#__USE_LARGEFILE
 1

	)

302 
	#__USE_LARGEFILE64
 1

	)

308 #i
__GNUC_PREREQ
 (2, 7&& 
defed
 
__OPTIMIZE__
 \

309 && !
defed
 
	g__OPTIMIZE_SIZE__
 && !defed 
	g__NO_INLINE__


310 
	#__USE_EXTERN_INLINES
 1

	)

318 
	~<gnu/ubs.h
>

	@/usr/include/endian.h

19 #idef 
_ENDIAN_H


20 
	#_ENDIAN_H
 1

	)

22 
	~<us.h
>

32 
	#__LITTLE_ENDIAN
 1234

	)

33 
	#__BIG_ENDIAN
 4321

	)

34 
	#__PDP_ENDIAN
 3412

	)

37 
	~<bs/dn.h
>

41 #ide
__FLOAT_WORD_ORDER


42 
	#__FLOAT_WORD_ORDER
 
__BYTE_ORDER


	)

45 #ifdef 
__USE_BSD


46 
	#LITTLE_ENDIAN
 
__LITTLE_ENDIAN


	)

47 
	#BIG_ENDIAN
 
__BIG_ENDIAN


	)

48 
	#PDP_ENDIAN
 
__PDP_ENDIAN


	)

49 
	#BYTE_ORDER
 
__BYTE_ORDER


	)

52 #i
__BYTE_ORDER
 =
__LITTLE_ENDIAN


53 
	#__LONG_LONG_PAIR
(
HI
, 
LO
LO, 
	)
HI

54 #i
__BYTE_ORDER
 =
__BIG_ENDIAN


55 
	#__LONG_LONG_PAIR
(
HI
, 
LO
HI, 
	)
LO

	@/usr/include/gnu/stubs.h

6 #ifde
_LIBC


7 #r 
Alitis
 
may
 
n
 
defe
 
the
 
mao
 
_LIBC


10 
	#__ub___kl_co


	)

11 
	#__ub___kl_sl


	)

12 
	#__ub___kl_


	)

13 
	#__ub_chags


	)

14 
	#__ub_ach


	)

15 
	#__ub_fchags


	)

16 
	#__ub_fdach


	)

17 
	#__ub_gy


	)

18 
	#__ub_lchmod


	)

19 
	#__ub_lutimes


	)

20 
	#__ub_voke


	)

21 
	#__ub_og


	)

22 
	#__ub_sk


	)

23 
	#__ub_ty


	)

	@/usr/include/sys/cdefs.h

19 #idef 
_SYS_CDEFS_H


20 
	#_SYS_CDEFS_H
 1

	)

23 #ide
_FEATURES_H


24 
	~<us.h
>

30 #i
defed
 
__GNUC__
 && !defed 
__STDC__


35 #unde
__P


36 #unde
__PMT


38 #ifde
__GNUC__


43 #i
defed
 
__lulus
 && 
__GNUC_PREREQ
 (2,8)

44 
	#__THROW
 
	`throw
 ()

	)

46 
	#__THROW


	)

48 
	#__P
(
gs
g
__THROW


	)

51 
	#__PMT
(
gs

	)
args

55 
	#__le


	)

57 
	#__THROW


	)

58 
	#__P
(
gs

	)
args

59 
	#__PMT
(
gs

	)
args

61 
	#__cڡ
 cڡ

	)

62 
	#__sigd
 sigd

	)

63 
	#__vީe
 vީe

	)

70 
	#__CONCAT
(
x
,
y
x ## 
	)
y

71 
	#__STRING
(
x
#x

	)

74 
	#__r_t
 *

	)

75 
	#__lg_doub_t
 

	)

79 #ifdef 
__lulus


80 
	#__BEGIN_DECLS
 "C" {

	)

81 
	#__END_DECLS
 }

	)

83 
	#__BEGIN_DECLS


	)

84 
	#__END_DECLS


	)

93 #i
defed
 
__lulus
 && defed 
_GLIBCPP_USE_NAMESPACES


94 
	#__BEGIN_NAMESPACE_STD
 
mea
 
d
 {

	)

95 
	#__END_NAMESPACE_STD
 }

	)

96 
	#__USING_NAMESPACE_STD
(
me

usg
 
d
::me;

	)

97 
	#__BEGIN_NAMESPACE_C99
 
mea
 
__c99
 {

	)

98 
	#__END_NAMESPACE_C99
 }

	)

99 
	#__USING_NAMESPACE_C99
(
me

usg
 
__c99
::me;

	)

104 
	#__BEGIN_NAMESPACE_STD


	)

105 
	#__END_NAMESPACE_STD


	)

106 
	#__USING_NAMESPACE_STD
(
me
)

	)

107 
	#__BEGIN_NAMESPACE_C99


	)

108 
	#__END_NAMESPACE_C99


	)

109 
	#__USING_NAMESPACE_C99
(
me
)

	)

114 #ide
__BOUNDED_POINTERS__


115 
	#__bounded


	)

116 
	#__unbounded


	)

117 
	#__rvue


	)

122 #i
__GNUC_PREREQ
 (2,97)

124 
	#__exr
 []

	)

126 #ifde
__GNUC__


127 
	#__exr
 [0]

	)

129 #i
defed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

130 
	#__exr
 []

	)

133 
	#__exr
 [1]

	)

149 #i
defed
 
__GNUC__
 && __GNUC__ >= 2

151 
	#__REDIRECT
(
me
, 
o
, 
s
m
	`__asm__
 (
	`__ASMNAME
 (#s))

	)

152 
	#__ASMNAME
(
ame

	`__ASMNAME2
 (
__USER_LABEL_PREFIX__
, cme)

	)

153 
	#__ASMNAME2
(
efix
, 
ame

	`__STRING
 (efix
	)
cname

166 #i!
defed
 
__GNUC__
 || __GNUC__ < 2

167 
	#__ibu__
(
xyz


	)

173 #i
__GNUC_PREREQ
 (2,96)

174 
	#__ibu_mloc__
 
	`__ibu__
 ((
__mloc__
))

	)

176 
	#__ibu_mloc__


	)

182 #i
__GNUC_PREREQ
 (2,96)

183 
	#__ibu_pu__
 
	`__ibu__
 ((
__pu__
))

	)

185 
	#__ibu_pu__


	)

191 #i
__GNUC_PREREQ
 (3,1)

192 
	#__ibu_ud__
 
	`__ibu__
 ((
__ud__
))

	)

193 
	#__ibu_nole__
 
	`__ibu__
 ((
__nole__
))

	)

195 
	#__ibu_ud__
 
	`__ibu__
 ((
__unud__
))

	)

196 
	#__ibu_nole__


	)

200 #i
__GNUC_PREREQ
 (3,2)

201 
	#__ibu_dd__
 
	`__ibu__
 ((
__dd__
))

	)

203 
	#__ibu_dd__


	)

212 #i
__GNUC_PREREQ
 (2,8)

213 
	#__ibu_fm_g__
(
x

	`__ibu__
 ((
	`__fm_g__
 (x)))

	)

215 
	#__ibu_fm_g__
(
x


	)

222 #i
__GNUC_PREREQ
 (2,97)

223 
	#__ibu_fm_rfm__
(
a
,
b
) \

224 
	`__ibu__
 ((
	`__fm__
 (
__rfm__
, 
a
, 
b
)))

	)

226 
	#__ibu_fm_rfm__
(
a
,
b


	)

233 #i!
__GNUC_PREREQ
 (2,8)

234 
	#__exnsi__


	)

238 #i!
__GNUC_PREREQ
 (2,92)

239 
	#__ri


	)

245 #i
__GNUC_PREREQ
 (3,1&& !
defed
 
__GNUG__


246 
	#__ri_r
 
__ri


	)

248 #ifde
__GNUC__


249 
	#__ri_r


	)

251 #i
defed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

252 
	#__ri_r
 
ri


	)

255 
	#__ri_r


	)

	@/usr/include/bits/endian.h

3 #ide
_ENDIAN_H


7 
	#__BYTE_ORDER
 
__LITTLE_ENDIAN


	)

	@
1
.
1
/usr/include
33
569
.#dsdpcops.c
dsdp.h
dsdpcg.c
dsdpcg.h
dsdpcone.c
dsdpcone.h
dsdpcone_impl.h
dsdpconverge.c
dsdpconverge.h
dsdpcops.c
dsdpobjcone.c
dsdpprintout.c
dsdprescone.c
dsdpschurmat.c
dsdpschurmat.h
dsdpschurmat_impl.h
dsdpsetdata.c
dsdpsetoptions.c
dsdpsetup.c
dsdpvec.h
dualalg.c
dualimpl.c
/usr/include/math.h
/usr/include/bits/huge_val.h
/usr/include/bits/mathcalls.h
/usr/include/bits/mathdef.h
/usr/include/bits/mathinline.h
/usr/include/bits/nan.h
/usr/include/features.h
/usr/include/endian.h
/usr/include/gnu/stubs.h
/usr/include/sys/cdefs.h
/usr/include/bits/endian.h
