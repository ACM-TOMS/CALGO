<?xml version="1.0" encoding="utf-8" ?>
<NEKTAR>
    <!-- Embed a 2-dimensional object in a 2-dimensional space -->
    <!-- DIM <= SPACE -->
    <!-- This provides a method of optimizing code for a 1-D curve embedded in 3-space. -->
    <GEOMETRY DIM="3" SPACE="3">
        <!-- Definitions that can be used below in this file. -->
        <!-- Not currently implemented -->
        <DEF>
            A = 1.0
            B = 2.0
            C = 3.0
        </DEF>
        <VERTEX>
            <!-- Always must have four values per entry. -->
            <V ID="0">  0.00  -0.1  1.11 </V>
            <V ID="1">  0.86  -0.1  1.11 </V>
            <V ID="2">  1.49  -0.1  1.11 </V>
            <V ID="3">  2.41  -0.1  1.11 </V>
            <V ID="4">  0.00  0.53  1.11 </V>
            <V ID="5">  0.86  0.53  1.11 </V>
            <V ID="6">  1.49  0.53  1.11 </V>
            <V ID="7">  2.41  0.53  1.11 </V>
            <V ID="8">  0.00  0.99  1.11 </V>
            <V ID="9">  0.86  0.99  1.11 </V>
            <V ID="10">  1.49  0.99  1.11 </V>
            <V ID="11">  2.41  0.99  1.11 </V>
            <V ID="12">  0.00  2.03  1.11 </V>
            <V ID="13">  0.86  2.03  1.11 </V>
            <V ID="14">  1.49  2.03  1.11 </V>
            <V ID="15">  2.41  2.03  1.11 </V>
            <V ID="16">  0.00  -0.1  1.92 </V>
            <V ID="17">  0.86  -0.1  1.92 </V>
            <V ID="18">  1.49  -0.1  1.92 </V>
            <V ID="19">  2.41  -0.1  1.92 </V>
            <V ID="20">  0.00  0.53  1.92 </V>
            <V ID="21">  0.86  0.53  1.92 </V>
            <V ID="22">  1.49  0.53  1.92 </V>
            <V ID="23">  2.41  0.53  1.92 </V>
            <V ID="24">  0.00  0.99  1.92 </V>
            <V ID="25">  0.86  0.99  1.92 </V>
            <V ID="26">  1.49  0.99  1.92 </V>
            <V ID="27">  2.41  0.99  1.92 </V>
            <V ID="28">  0.00  2.03  1.92 </V>
            <V ID="29">  0.86  2.03  1.92 </V>
            <V ID="30">  1.49  2.03  1.92 </V>
            <V ID="31">  2.41  2.03  1.92 </V>
            <V ID="32">  0.00  -0.1  2.31 </V>
            <V ID="33">  0.86  -0.1  2.31 </V>
            <V ID="34">  1.49  -0.1  2.31 </V>
            <V ID="35">  2.41  -0.1  2.31 </V>
            <V ID="36">  0.00  0.53  2.31 </V>
            <V ID="37">  0.86  0.53  2.31 </V>
            <V ID="38">  1.49  0.53  2.31 </V>
            <V ID="39">  2.41  0.53  2.31 </V>
            <V ID="40">  0.00  0.99  2.31 </V>
            <V ID="41">  0.86  0.99  2.31 </V>
            <V ID="42">  1.49  0.99  2.31 </V>
            <V ID="43">  2.41  0.99  2.31 </V>
            <V ID="44">  0.00  2.03  2.31 </V>
            <V ID="45">  0.86  2.03  2.31 </V>
            <V ID="46">  1.49  2.03  2.31 </V>
            <V ID="47">  2.41  2.03  2.31 </V>
            <V ID="48">  0.00  -0.1  3.00 </V>
            <V ID="49">  0.86  -0.1  3.00 </V>
            <V ID="50">  1.49  -0.1  3.00 </V>
            <V ID="51">  2.41  -0.1  3.00 </V>
            <V ID="52">  0.00  0.53  3.00 </V>
            <V ID="53">  0.86  0.53  3.00 </V>
            <V ID="54">  1.49  0.53  3.00 </V>
            <V ID="55">  2.41  0.53  3.00 </V>
            <V ID="56">  0.00  0.99  3.00 </V>
            <V ID="57">  0.86  0.99  3.00 </V>
            <V ID="58">  1.49  0.99  3.00 </V>
            <V ID="59">  2.41  0.99  3.00 </V>
            <V ID="60">  0.00  2.03  3.00 </V>
            <V ID="61">  0.86  2.03  3.00 </V>
            <V ID="62">  1.49  2.03  3.00 </V>
            <V ID="63">  2.41  2.03  3.00 </V>
        </VERTEX>

        <!-- Edges are vertex pairs -->
        <EDGE>
            <E ID="0"> 0 1 </E>
            <E ID="1"> 1 2 </E>
            <E ID="2"> 2 3 </E>
            <E ID="3"> 0 4 </E>
            <E ID="4"> 1 5 </E>
            <E ID="5"> 2 6 </E>
            <E ID="6"> 3 7 </E>
            <E ID="7"> 4 5 </E>
            <E ID="8"> 5 6 </E>
            <E ID="9"> 6 7 </E>
            <E ID="10"> 4 8 </E>
            <E ID="11"> 5 9 </E>
            <E ID="12"> 6 10 </E>
            <E ID="13"> 7 11 </E>
            <E ID="14"> 8 9 </E>
            <E ID="15"> 9 10 </E>
            <E ID="16"> 10 11 </E>
            <E ID="17"> 8 12 </E>
            <E ID="18"> 9 13 </E>
            <E ID="19"> 10 14 </E>
            <E ID="20"> 11 15 </E>
            <E ID="21"> 12 13 </E>
            <E ID="22"> 13 14 </E>
            <E ID="23"> 14 15 </E>

            <E ID="24"> 0 16 </E>
            <E ID="25"> 1 17 </E>
            <E ID="26"> 2 18 </E>
            <E ID="27"> 3 19 </E>
            <E ID="28"> 4 20 </E>
            <E ID="29"> 5 21 </E>
            <E ID="30"> 6 22 </E>
            <E ID="31"> 7 23 </E>
            <E ID="32"> 8 24 </E>
            <E ID="33"> 9 25 </E>
            <E ID="34"> 10 26 </E>
            <E ID="35"> 11 27 </E>
            <E ID="36"> 12 28 </E>
            <E ID="37"> 13 29 </E>
            <E ID="38"> 14 30 </E>
            <E ID="39"> 15 31 </E>

            <E ID="40"> 16 17 </E>
            <E ID="41"> 17 18 </E>
            <E ID="42"> 18 19 </E>
            <E ID="43"> 16 20 </E>
            <E ID="44"> 17 21 </E>
            <E ID="45"> 18 22 </E>
            <E ID="46"> 19 23 </E>
            <E ID="47"> 20 21 </E>
            <E ID="48"> 21 22 </E>
            <E ID="49"> 22 23 </E>
            <E ID="50"> 20 24 </E>
            <E ID="51"> 21 25 </E>
            <E ID="52"> 22 26 </E>
            <E ID="53"> 23 27 </E>
            <E ID="54"> 24 25 </E>
            <E ID="55"> 25 26 </E>
            <E ID="56"> 26 27 </E>
            <E ID="57"> 24 28 </E>
            <E ID="58"> 25 29 </E>
            <E ID="59"> 26 30 </E>
            <E ID="60"> 27 31 </E>
            <E ID="61"> 28 29 </E>
            <E ID="62"> 29 30 </E>
            <E ID="63"> 30 31 </E>

            <E ID="64"> 16 32 </E>
            <E ID="65"> 17 33 </E>
            <E ID="66"> 18 34 </E>
            <E ID="67"> 19 35 </E>
            <E ID="68"> 20 36 </E>
            <E ID="69"> 21 37 </E>
            <E ID="70"> 22 38 </E>
            <E ID="71"> 23 39 </E>
            <E ID="72"> 24 40 </E>
            <E ID="73"> 25 41 </E>
            <E ID="74"> 26 42 </E>
            <E ID="75"> 27 43 </E>
            <E ID="76"> 28 44 </E>
            <E ID="77"> 29 45 </E>
            <E ID="78"> 30 46 </E>
            <E ID="79"> 31 47 </E>

            <E ID="80"> 32 33 </E>
            <E ID="81"> 33 34 </E>
            <E ID="82"> 34 35 </E>
            <E ID="83"> 32 36 </E>
            <E ID="84"> 33 37 </E>
            <E ID="85"> 34 38 </E>
            <E ID="86"> 35 39 </E>
            <E ID="87"> 36 37 </E>
            <E ID="88"> 37 38 </E>
            <E ID="89"> 38 39 </E>
            <E ID="90"> 36 40 </E>
            <E ID="91"> 37 41 </E>
            <E ID="92"> 38 42 </E>
            <E ID="93"> 39 43 </E>
            <E ID="94"> 40 41 </E>
            <E ID="95"> 41 42 </E>
            <E ID="96"> 42 43 </E>
            <E ID="97"> 40 44 </E>
            <E ID="98"> 41 45 </E>
            <E ID="99"> 42 46 </E>
            <E ID="100"> 43 47 </E>
            <E ID="101"> 44 45 </E>
            <E ID="102"> 45 46 </E>
            <E ID="103"> 46 47 </E>

            <E ID="104"> 32 48 </E>
            <E ID="105"> 33 49 </E>
            <E ID="106"> 34 50 </E>
            <E ID="107"> 35 51 </E>
            <E ID="108"> 36 52 </E>
            <E ID="109"> 37 53 </E>
            <E ID="110"> 38 54 </E>
            <E ID="111"> 39 55 </E>
            <E ID="112"> 40 56 </E>
            <E ID="113"> 41 57 </E>
            <E ID="114"> 42 58 </E>
            <E ID="115"> 43 59 </E>
            <E ID="116"> 44 60 </E>
            <E ID="117"> 45 61 </E>
            <E ID="118"> 46 62 </E>
            <E ID="119"> 47 63 </E>

            <E ID="120"> 48 49 </E>
            <E ID="121"> 49 50 </E>
            <E ID="122"> 50 51 </E>
            <E ID="123"> 48 52 </E>
            <E ID="124"> 49 53 </E>
            <E ID="125"> 50 54 </E>
            <E ID="126"> 51 55 </E>
            <E ID="127"> 52 53 </E>
            <E ID="128"> 53 54 </E>
            <E ID="129"> 54 55 </E>
            <E ID="130"> 52 56 </E>
            <E ID="131"> 53 57 </E>
            <E ID="132"> 54 58 </E>
            <E ID="133"> 55 59 </E>
            <E ID="134"> 56 57 </E>
            <E ID="135"> 57 58 </E>
            <E ID="136"> 58 59 </E>
            <E ID="137"> 56 60 </E>
            <E ID="138"> 57 61 </E>
            <E ID="139"> 58 62 </E>
            <E ID="140"> 59 63 </E>
            <E ID="141"> 60 61 </E>
            <E ID="142"> 61 62 </E>
            <E ID="143"> 62 63 </E>
        </EDGE>

        <!-- Can include Q - quads, T - triangles -->
        <FACE>
            <Q ID="0"> 0 4 7 3 </Q>
            <Q ID="1"> 1 5 8 4 </Q>
            <Q ID="2"> 2 6 9 5 </Q>
            <Q ID="3"> 7 11 14 10 </Q>
            <Q ID="4"> 8 12 15 11 </Q>
            <Q ID="5"> 9 13 16 12 </Q>
            <Q ID="6"> 14 18 21 17 </Q>
            <Q ID="7"> 15 19 22 18 </Q>
            <Q ID="8"> 16 20 23 19 </Q>

            <Q ID="9"> 0 25 40 24 </Q>
            <Q ID="10"> 1 26 41 25 </Q>
            <Q ID="11"> 2 27 42 26 </Q>
            <Q ID="12"> 3 28 43 24 </Q>
            <Q ID="13"> 4 29 44 25 </Q>
            <Q ID="14"> 5 30 45 26 </Q>
            <Q ID="15"> 6 31 46 27 </Q>
            <Q ID="16"> 7 29 47 28 </Q>
            <Q ID="17"> 8 30 48 29 </Q>
            <Q ID="18"> 9 31 49 30 </Q>
            <Q ID="19"> 10 32 50 28 </Q>
            <Q ID="20"> 11 33 51 29 </Q>
            <Q ID="21"> 12 34 52 30 </Q>
            <Q ID="22"> 13 35 53 31 </Q>
            <Q ID="23"> 14 33 54 32 </Q>
            <Q ID="24"> 15 34 55 33 </Q>
            <Q ID="25"> 16 35 56 34 </Q>
            <Q ID="26"> 17 36 57 32 </Q>
            <Q ID="27"> 18 37 58 33 </Q>
            <Q ID="28"> 19 38 59 34 </Q>
            <Q ID="29"> 20 39 60 35 </Q>
            <Q ID="30"> 21 37 61 36 </Q>
            <Q ID="31"> 22 38 62 37 </Q>
            <Q ID="32"> 23 39 63 38 </Q>

            <Q ID="33"> 40 44 47 43 </Q>
            <Q ID="34"> 41 45 48 44 </Q>
            <Q ID="35"> 42 46 49 45 </Q>
            <Q ID="36"> 47 51 54 50 </Q>
            <Q ID="37"> 48 52 55 51 </Q>
            <Q ID="38"> 49 53 56 52 </Q>
            <Q ID="39"> 54 58 61 57 </Q>
            <Q ID="40"> 55 59 62 58 </Q>
            <Q ID="41"> 56 60 63 59 </Q>

            <Q ID="42"> 40 65 80 64 </Q>
            <Q ID="43"> 41 66 81 65 </Q>
            <Q ID="44"> 42 67 82 66 </Q>
            <Q ID="45"> 43 68 83 64 </Q>
            <Q ID="46"> 44 69 84 65 </Q>
            <Q ID="47"> 45 70 85 66 </Q>
            <Q ID="48"> 46 71 86 67 </Q>
            <Q ID="49"> 47 69 87 68 </Q>
            <Q ID="50"> 48 70 88 69 </Q>
            <Q ID="51"> 49 71 89 70 </Q>
            <Q ID="52"> 50 72 90 68 </Q>
            <Q ID="53"> 51 73 91 69 </Q>
            <Q ID="54"> 52 74 92 70 </Q>
            <Q ID="55"> 53 75 93 71 </Q>
            <Q ID="56"> 54 73 94 72 </Q>
            <Q ID="57"> 55 74 95 73 </Q>
            <Q ID="58"> 56 75 96 74 </Q>
            <Q ID="59"> 57 76 97 72 </Q>
            <Q ID="60"> 58 77 98 73 </Q>
            <Q ID="61"> 59 78 99 74 </Q>
            <Q ID="62"> 60 79 100 75 </Q>
            <Q ID="63"> 61 77 101 76 </Q>
            <Q ID="64"> 62 78 102 77 </Q>
            <Q ID="65"> 63 79 103 78 </Q>

            <Q ID="66"> 80 84 87 83 </Q>
            <Q ID="67"> 81 85 88 84 </Q>
            <Q ID="68"> 82 86 89 85 </Q>
            <Q ID="69"> 87 91 94 90 </Q>
            <Q ID="70"> 88 92 95 91 </Q>
            <Q ID="71"> 89 93 96 92 </Q>
            <Q ID="72"> 94 98 101 97 </Q>
            <Q ID="73"> 95 99 102 98 </Q>
            <Q ID="74"> 96 100 103 99 </Q>

            <Q ID="75"> 80 105 120 104 </Q>
            <Q ID="76"> 81 106 121 105 </Q>
            <Q ID="77"> 82 107 122 106 </Q>
            <Q ID="78"> 83 108 123 104 </Q>
            <Q ID="79"> 84 109 124 105 </Q>
            <Q ID="80"> 85 110 125 106 </Q>
            <Q ID="81"> 86 111 126 107 </Q>
            <Q ID="82"> 87 109 127 108 </Q>
            <Q ID="83"> 88 110 128 109 </Q>
            <Q ID="84"> 89 111 129 110 </Q>
            <Q ID="85"> 90 112 130 108 </Q>
            <Q ID="86"> 91 113 131 109 </Q>
            <Q ID="87"> 92 114 132 110 </Q>
            <Q ID="88"> 93 115 133 111 </Q>
            <Q ID="89"> 94 113 134 112 </Q>
            <Q ID="90"> 95 114 135 113 </Q>
            <Q ID="91"> 96 115 136 114 </Q>
            <Q ID="92"> 97 116 137 112 </Q>
            <Q ID="93"> 98 117 138 113 </Q>
            <Q ID="94"> 99 118 139 114 </Q>
            <Q ID="95"> 100 119 140 115 </Q>
            <Q ID="96"> 101 117 141 116 </Q>
            <Q ID="97"> 102 118 142 117 </Q>
            <Q ID="98"> 103 119 143 118 </Q>

            <Q ID="99"> 120 124 127 123 </Q>
            <Q ID="100"> 121 125 128 124 </Q>
            <Q ID="101"> 122 126 129 125 </Q>
            <Q ID="102"> 127 131 134 130 </Q>
            <Q ID="103"> 128 132 135 131 </Q>
            <Q ID="104"> 129 133 136 132 </Q>
            <Q ID="105"> 134 138 141 137 </Q>
            <Q ID="106"> 135 139 142 138 </Q>
            <Q ID="107"> 136 140 143 139 </Q>
        </FACE>

        <!-- Q - quads, T - triangles, S - segments, A - tet, P - pyramid, R - prism, H - hex -->
        <!-- Only certain element types are appropriate for the given dimension (dim on mesh) -->
        <!-- Can also use faces to define 3-D elements.  Specify with F[1] for face 1, for example. -->
        <!-- Element need to be entered in consistent "anti-clockwise" manner -->
        <ELEMENT>

            <H ID="0"> 0 9  13 16 12 33 </H>
            <H ID="1"> 1 10 14 17 13 34 </H>
            <H ID="2"> 2 11 15 18 14 35 </H>
            <H ID="3"> 3 16 20 23 19 36 </H>
            <H ID="4"> 4 17 21 24 20 37 </H>
            <H ID="5"> 5 18 22 25 21 38 </H>
            <H ID="6"> 6 23 27 30 26 39 </H>
            <H ID="7"> 7 24 28 31 27 40 </H>
            <H ID="8"> 8 25 29 32 28 41 </H>

            <H ID="9"> 33 42 46 49 45 66 </H>
            <H ID="10"> 34 43 47 50 46 67 </H>
            <H ID="11"> 35 44 48 51 47 68 </H>
            <H ID="12"> 36 49 53 56 52 69 </H>
            <H ID="13"> 50 70 54 37 53 57 </H>
            <H ID="14"> 38 51 55 58 54 71 </H>
            <H ID="15"> 39 56 60 63 59 72 </H>
            <H ID="16"> 40 57 61 64 60 73 </H>
            <H ID="17"> 41 58 62 65 61 74 </H>

            <H ID="18"> 66 75 79 82 78 99 </H>
            <H ID="19"> 67 76 80 83 79 100 </H>
            <H ID="20"> 68 77 81 84 80 101 </H>
            <H ID="21"> 69 82 86 89 85 102 </H>
            <H ID="22"> 70 83 87 90 86 103 </H>
            <H ID="23"> 71 84 88 91 87 104 </H>
            <H ID="24"> 72 89 93 96 92 105 </H>
            <H ID="25"> 73 90 94 97 93 106 </H>
            <H ID="26"> 74 91 95 98 94 107 </H>

        </ELEMENT>

        <!-- V - vertex, E - edge, F - face, T - Triangle, Q - Quad -->
        <COMPOSITE>
            <C ID="0"> H[0-26] </C>
            <C ID="1"> Q[0-8] </C>
            <C ID="2"> Q[9-11,42-44,75-77] </C>
            <C ID="3"> Q[15,22,29,48,55,62,81,88,95] </C>
            <C ID="4"> Q[30-32,63-65,96-98] </C>
            <C ID="5"> Q[12,19,26,45,52,59,78,85,92] </C>
            <C ID="6"> Q[99-107] </C>
        </COMPOSITE>

        <DOMAIN> C[0] </DOMAIN>

    </GEOMETRY>    

<EXPANSIONS>
  <E COMPOSITE="C[0]" NUMMODES="3" TYPE="MODIFIED" />
</EXPANSIONS>

<CONDITIONS>
        <!-- Removed redundancy since we can specify any level of granularity
         in the ExpansionTypes section below.-->
        <PARAMETERS>
            <P> Lambda    = 1 </P>
        </PARAMETERS>

        <!--One of these for each dimension. These are the vector
        components, say, s = (u,v); comprised of two components in
        this example for a 2D dimension.-->
        <VARIABLES>
            <V ID="0"> u </V> 
        </VARIABLES>

        <!--These composites must be defined in the geometry file.-->
        <BOUNDARYREGIONS>
            <B ID="0"> C[1] </B>
            <B ID="1"> C[2] </B>
            <B ID="2"> C[3] </B>
            <B ID="3"> C[4] </B>
            <B ID="4"> C[5] </B> 
            <B ID="5"> C[6] </B>
        </BOUNDARYREGIONS>

        <!--The region numbers below correspond to the regions specified in the
        BoundaryRegion definition above.-->
        <BOUNDARYCONDITIONS>
            <REGION REF="0">
                <D VAR="u" VALUE="sin(PI*x)*sin(PI*y)*sin(PI*z)" />
            </REGION>
            <REGION REF="1">
                <D VAR="u" VALUE="sin(PI*x)*sin(PI*y)*sin(PI*z)" />
            </REGION>
            <REGION REF="2">
                <D VAR="u" VALUE="sin(PI*x)*sin(PI*y)*sin(PI*z)" />
            </REGION>
            <REGION REF="3">
                <D VAR="u" VALUE="sin(PI*x)*sin(PI*y)*sin(PI*z)" />
            </REGION>
            <REGION REF="4">
                <D VAR="u" VALUE="sin(PI*x)*sin(PI*y)*sin(PI*z)" />
            </REGION>
            <REGION REF="5">
                <D VAR="u" VALUE="sin(PI*x)*sin(PI*y)*sin(PI*z)" />
            </REGION>
        </BOUNDARYCONDITIONS>
        
        <FORCING>
            <F VAR="u" VALUE="sin(PI*x)*sin(PI*y)*sin(PI*z)" />
        </FORCING>

        <EXACTSOLUTION>
            <F VAR ="u" VALUE="sin(PI*x)*sin(PI*y)*sin(PI*z)" />
        </EXACTSOLUTION>

    </CONDITIONS>


</NEKTAR>
