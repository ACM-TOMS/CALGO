        PROGRAM WKTEST
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCC  THIS IS A TEST PROGRAM FOR THE ROUTINES DKIA AND DLIA.
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC 
CCC  FIRST, WE COMPARE THE VALUES OBTAINED FROM
CCC  THE ROUTINES WITH 20(NON-SCALED)+20(SCALED) 
CCC  PRE-COMPUTED VALUES OF THE K_IA(X), K_IA'(X), 
CCC  L_IA(X), L_IA'(X) FUNCTIONS. 
CCC  RELATIVE ERRORS ARE SHOWN.
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        DOUBLE PRECISION A,A1(20),A2(20),ERR1,ERR2,ERR3,ERR4,
     +  KI(20),KIA,KIAP,KIP(20),KIPS(20),KIS(20),LI(20),LIA,
     +  LIAP,LIP(20),LIPS(20),LIS(20),WKILI,WMAX,X,X1(20),
     +  X2(20)
        INTEGER I,IERR1,IERR2,IFAC,J
        DATA X1/1.D0,2.D0,4.D0,6.D0,8.D0,10.D0,20.D0,30.D0,
     +        40.D0,50.D0,60.D0,70.D0,80.D0,90.D0,100.D0,110.D0,
     +        120.D0,130.D0,140.D0,150.D0/
        DATA A1/150.D0,140.D0,130.D0,120.D0,110.D0,100.D0,90.D0,
     +          80.D0,70.D0,60.D0,50.D0,40.D0,30.D0,20.D0,10.D0,
     +          8.D0,6.D0,4.D0,2.D0,1.D0/
        DATA X2/10.D0,30.D0,50.D0,70.D0,90.D0,110.D0,130.D0,150.D0,
     +          170.D0,190.D0,210.D0,230.D0,300.D0,350.D0,400.D0,
     +          450.D0,500.D0,550.D0,600.D0,1000.D0/
        DATA A2/1000.D0,600.D0,550.D0,500.D0,450.D0,400.D0,
     +          350.D0,300.D0,230.D0,210.D0,190.D0,170.D0,150.D0,
     +          130.D0,110.D0,90.D0,70.D0,50.D0,30.D0,10.D0/
        DATA KI/4.6459642814487D-104,-1.9411952078515D-97,
     +          -4.2454441778618D-90,1.8459505138282D-84,
     +          -1.8586595362018D-76,-6.6567482660523D-70,
     +           3.2023919540906D-63,6.5889532942282D-56,
     +          -3.6683946835532D-49,-4.9527096312644D-42,
     +           3.4304632381987D-37,5.0365831118869D-37,
     +           8.8239913220317D-39,1.1752645784103D-41,
     +           2.8302336906411D-45,1.5088757838133D-49,
     +           7.5473164457079D-54,3.5955363786557D-58,
     +           1.6489206017421D-62,7.3120381225095D-67/
        DATA KIP/1.2621961347941D-101,-4.4169741448774D-95,
     +          -5.2927180566489D-89,6.2650669669425D-82,
     +           1.5597363053925D-75,-1.3578086419107D-68,
     +           4.4928562943487D-62,-1.0038564433216D-55,
     +          -6.5451759692658D-49,-8.8936889262989D-43,
     +          -1.9827493875810D-37,-4.1859420782458D-37,
     +          -8.2438494849568D-39,-1.1527224542051D-41,
     +          -2.8303037451092D-45,-1.5117590940217D-49,
     +          -7.5693363356202D-54,-3.6076494841867D-58,
     +          -1.6546320846520D-62,-7.3362098087182D-67/
        DATA LI/-6.0718133124582D+100,1.0341432633441D+94,
     +          6.0637749124694D+86,-2.6510722091492D+80,
     +         -2.1834147196919D+73,5.9492950832761D+66,
     +         -1.0138118922006D+60,9.1476313015052D+52,
     +          2.3193283928606D+46,1.3580216912150D+39,
     +          4.4179418706912D+34,1.7284668020496D+34,
     +          7.6408995646371D+35,4.8483988671162D+38,
     +          1.7755623619757D+42,3.0205086366265D+46,
     +          5.5276887787140D+50,1.0702170837946D+55,
     +          2.1661539486827D+59,4.5588191419541D+63/
        DATA LIP/5.0284086667481D+102,-2.2265454909523D+95,
     +          -5.1327055521212D+88,3.1161042355098D+80,
     +          -4.8930148931703D+74,-2.8872891775895D+67,
     +           1.3898637806421D+60,3.6652900137178D+53,
     +          -2.6768078097588D+46,-3.7943306091860D+39,
     +           2.3049351003502D+34,1.3998483121471D+34,
     +           7.0273838443872D+35,4.6987316485906D+38,
     +           1.7576708289761D+42,2.9986747348300D+46,
     +           5.4976358957640D+50,1.0655822048506D+55,
     +           2.1581811248591D+59,4.5434955896932D+63/       
        DATA KIS/7.8472200752424D-02,-2.9337081559928D-02,
     +           8.8250602497608D-02,-3.8547847571986D-02,
     +           8.9831637526943D-02,-6.4291284802431D-03,
     +           0.11613787400357D0,-0.12881102538026D0,
     +           0.13421837026894D0,0.14445491788195D0,
     +           0.13106736280859D0,1.0045472166660D-01,
     +           7.7698096235925D-02,6.9491690653934D-02,
     +           6.3886304416143D-02,5.9669771294809D-02,
     +           5.6313293442941D-02,5.3540106335192D-02,
     +           5.1187650274291D-02,3.9629311299016D-02/
        DATA KIPS/-1.1207165096700D0,-1.9596302401387D0,
     +           0.66483564964473D0,0.74865993938252D0,
     +          -0.38512843465564D0,-0.44631514237633D0,
     +          -0.19107259534381D0,0.15077089591635D0,
     +           0.13730072565776D0,-1.0296790701385D-01,
     +          -5.7446432538801D-02,-6.8138584839609D-02,
     +          -6.7460748750760D-02,-6.4635364385151D-02,
     +          -6.1509430896961D-02,-5.8533212149322D-02,
     +          -5.5816099440864D-02,-5.3367462361202D-02,
     +          -5.1166370921143D-02,-3.9647141469294D-02/
        DATA LIS/1.7837655381280D-03,1.5613761576696D-02,
     +          -9.6591519368687D-03,-1.6847454253603D-02,
     +           1.2512482829322D-02,2.0317388853924D-02,
     +           1.2170039362900D-02,-1.3867160855031D-02,
     +          -2.3894808167256D-02,3.5321796899890D-02,
     +           4.2742676164314D-02,3.2131359207386D-02,
     +           2.4769121304795D-02,2.2141459308109D-02,
     +           2.0350669922650D-02,1.9004999051914D-02,
     +           1.7934433775710D-02,1.7050233762627D-02,
     +           1.6300362441923D-02,1.2617556248941D-02/
        DATA LIPS/1.2488614257325D0,-9.3265377462138D-02,
     +           0.15386015576951D0,-4.3392830231001D-02,
     +           7.0044344716655D-02,-3.5698138442038D-03,
     +           4.6211855795097D-02,-3.5524151657274D-02,
     +           1.9383177095253D-02,1.1257120351664D-02,
     +           1.7597748590334D-02,2.1486702723200D-02,
     +           2.1395503168649D-02,2.0520749363341D-02,
     +           1.9538489291148D-02,1.8599008454981D-02,
     +           1.7739503408225D-02,1.6963995250943D-02,
     +           1.6266350796578D-02,1.2610614366489D-02/
        OPEN(UNIT=1,FILE='TESTF.DAT',STATUS='UNKNOWN') 
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCC WE CHECK THE VALUES OF THE UNSCALED FUNCTIONS       C
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        WRITE(1,*)'ERR MEANS RELATIVE ERROR'
        WRITE(1,*)'********************************************'
        WRITE(1,*)'TEST OF THE VALUES OF THE UNSCALED FUNCTIONS'
        WRITE(1,*)'********************************************'
        WRITE(1,30)'X','A','ERR(KIA)','ERR(KIAP)','ERR(LIA)','ERR(LIAP)'
        DO 10 I=1,20
          X=X1(I)
          A=A1(I) 
          IERR1=0
          IERR2=0
          IFAC=1
          CALL DKIA(IFAC,X,A,KIA,KIAP,IERR1)
          CALL DLIA(IFAC,X,A,LIA,LIAP,IERR2)
          ERR1=ABS(1.D0-KIA/KI(I))
          ERR2=ABS(1.D0-KIAP/KIP(I))
          ERR3=ABS(1.D0-LIA/LI(I))
          ERR4=ABS(1.D0-LIAP/LIP(I))
          WRITE(1,31)INT(X),INT(A),ERR1,ERR2,ERR3,ERR4
 10    CONTINUE
        WRITE(1,*)'******************************************'
        WRITE(1,*)'TEST OF THE VALUES OF THE SCALED FUNCTIONS'
        WRITE(1,*)'******************************************'
        WRITE(1,30)'X','A','ERR(KIA)','ERR(KIAP)','ERR(LIA)','ERR(LIAP)'
        DO 20 I=1,20     
          IFAC=2
          X=X2(I)
          A=A2(I) 
          CALL DKIA(IFAC,X,A,KIA,KIAP,IERR1)
          CALL DLIA(IFAC,X,A,LIA,LIAP,IERR2)
          ERR1=ABS(1.D0-KIA/KIS(I))
          ERR2=ABS(1.D0-KIAP/KIPS(I))
          ERR3=ABS(1.D0-LIA/LIS(I))
          ERR4=ABS(1.D0-LIAP/LIPS(I))
          WRITE(1,31)INT(X),INT(A),ERR1,ERR2,ERR3,ERR4   
 20    CONTINUE
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCC  TEST OF THE WRONSKIAN RELATION:  W[KIA(X),LIA(X)]=1/X
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CCC  WE TEST THE RELATION FOR 0<X<=1000,  0<A<=1000 
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC       
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
CC THIS IS A WRONSKIAN TEST FOR THE SCALED FUNCTIONS       C
        IFAC=2
CC ONE CAN CHOOSE A WRONSKIAN TEST FOR THE UNSCALED        C 
CC FUNCTIONS BY UNCOMMENTING THE FOLLOWING LINE:           C
CC        IFAC=1                                              
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCC
        WRITE(1,*)' '
        WRITE(1,*)'*********************************************'
        WRITE(1,*)'TEST OF THE WRONSKIAN RELATION FOR DKIA, DLIA' 
        WRITE(1,*)'*********************************************'
        WMAX=0.D0
        DO 1 I=1,1000,10
          DO 2 J=1,1000,10
            X=I*0.95D0
            A=J*0.9D0
            IERR1=0
            IERR2=0
            CALL DKIA(IFAC,X,A,KIA,KIAP,IERR1)
            CALL DLIA(IFAC,X,A,LIA,LIAP,IERR2)
            IF ((IERR1.EQ.0).AND.(IERR2.EQ.0)) THEN
              WKILI=ABS((X*KIA*LIAP-1.D0)-X*KIAP*LIA)     
              IF (WKILI.GT.WMAX) THEN
                WMAX=WKILI
              ENDIF
            ENDIF
   2       CONTINUE
 1      CONTINUE
        WRITE(1,*)' '
        WRITE(1,*)'MAXIMUM VALUE OF THE WRONSKIAN CHECK =',WMAX
 30     FORMAT(3X,A1,3X,A1,8X,A8,8X,A9,8X,A8,8X,A9)
 31     FORMAT(I4,1X,I4,D16.9,1X,D16.9,1X,D16.9,1X,D16.9)
        END   
