SRC= Compute_Solution.f9h Compute_Z_Matrix.f9h Connected_m.f90 Decay.f90 \
     Dose_Factors_m.f90 ENDF_m.f90 ENDF_data.f9h Triangular_ODE.f90 \
     Triangularize_m.f90

OBJ= Connected_m.o Decay.o Dose_Factors_m.o ENDF_m.o Triangular_ODE.o \
     Triangularize_m.o

FC= gfortran

FOPTS= -g -fbounds-check

all: Decay

Connected_m.o connected_m.mod: Connected_m.f90
	$(FC) $(FOPTS) -c Connected_m.f90

Dose_Factors_m.o dose_factors_m.mod: Dose_Factors_m.f90
	$(FC) $(FOPTS) -c Dose_Factors_m.f90

ENDF_m.o ENDF_m.mod: ENDF_m.f90
	$(FC) $(FOPTS) -c ENDF_m.f90

Triangular_ODE.o triangular_ode.mod: Triangular_ODE.f90 Compute_Solution.f9h \
        Compute_Z_Matrix.f9h
	$(FC) $(FOPTS) -c Triangular_ODE.f90

Triangularize_m.o triangularize_m.mod: Triangularize_m.f90
	$(FC) $(FOPTS) -c Triangularize_m.f90

Decay.o: Decay.f90 connected_m.mod dose_factors_m.mod ENDF_m.mod \
         triangular_ode.mod triangularize_m.mod
	$(FC) $(FOPTS) -c Decay.f90

Decay: $(OBJ)
	$(FC) -o Decay $(OBJ)

Decay_eq_3.dvi: Decay_eq_3.tex Decay_eq_3.bib
	latex Decay_eq_3
	bibtex Decay_eq_3
	latex Decay_eq_3
	latex Decay_eq_3

Decay_eq_3.pdf: Decay_eq_3.tex Decay_eq_3.bib
	pdflatex Decay_eq_3
	bibtex Decay_eq_3
	pdflatex Decay_eq_3
	pdflatex Decay_eq_3

Decay_Remark.dvi: Decay_Remark.tex
	pdflatex Decay_Remark.tex

Decay_Remark.pdf:  Decay_Remark.tex
	latex Decay_Remark.tex

Eu-152.out: Decay Eu-152.txt
	./Decay -s 30 -t 300 -u y -v 9 Eu-152.txt Eu-152.out

Sr-Cs-solution-10.out: Decay Sr-Cs-solution-10.txt
	./Decay -s 50 -t 1000 -u y Sr-Cs-solution-10.txt Sr-Cs-solution-10.out

clean:
	rm -f Decay *.o *.mod

tar: Decay_eq_3.pdf Decay_Remark.pdf Eu-152.out Sr-Cs-solution-10.out Makefile \
     00README
	tar czf Decay.tgz -h $(SRC) \
          Decay_eq_3.tex Decay_eq_3.bib Decay_eq_3.dvi Decay_eq_3.pdf \
          Decay_Remark.pdf Decay_Remark.tex \
          Eu-152.txt Eu-152.out Sr-Cs-solution-10.txt Sr-Cs-solution-10.out \
          Makefile 00README

zip: Decay_eq_3.pdf Decay_Remark.pdf Eu-152.out Sr-Cs-solution-10.out Makefile \
     00README
	zip -9 Decay.zip $(SRC) \
          Decay_eq_3.tex Decay_eq_3.bib Decay_eq_3.dvi Decay_eq_3.pdf \
          Decay_Remark.pdf Decay_Remark.tex \
          Eu-152.txt Eu-152.out Sr-Cs-solution-10.txt Sr-Cs-solution-10.out \
          Makefile 00README
