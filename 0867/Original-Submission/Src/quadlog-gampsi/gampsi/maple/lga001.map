### Numerical evaluation of ln(Gamma(x))
###
### x = f * 2^p
###
### Line format: 2 f p neval result relerr abserr
###
interface(quiet = true):
Digits := 50 :
n := 7 :
f := array(1..7) :
p := array(1..7) :

f := [
0.0,
1.0,
2.0,
3.0,
4.0,
Inf,
NaN
] :

p := [
0,
0,
0,
0,
0,
0,
0
] :

for i from 1 by 1 to n do
	if (evalb(f[i] = 'Inf')) then
		printf("%1d %20s %5d %1d %57s %1d %1d\n",
			2, f[i], p[i], 0, "Infinity", 0, 0)
	elif (evalb(f[i] = 'NaN')) then
		printf("%1d %20s %5d %1d %57s %1d %1d\n",
			2, f[i], p[i], 0, "NaN", 0, 0)
	else
		xx := f[i]*2^p[i]:
		if (evalb((xx <= 0) and (floor(xx) = ceil(xx)))) then
			printf("%1d %20.0f. %5d %1d %57s %1d %1d\n",
				2, f[i], p[i], 0, "Infinity", 0, 0)
		else
			printf("%1d %20.0f. %5d %1d %57.49e %1d %1d\n",
				2, f[i], p[i], 0, lnGAMMA(xx), 0, 0)
		fi:
	fi:
od :
